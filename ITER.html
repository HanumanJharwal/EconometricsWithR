<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Introduction to Econometrics with R</title>
  <meta name="description" content="Beginners with little background in statistics and econometrics often have a hard time understanding the benefits of having programming skills for learning and applying Econometrics. ‘Introduction to Econometrics with R’ is an interactive companion to the well-received textbook ‘Introduction to Econometrics’ by James H. Stock and Mark W. Watson (2015). It gives a gentle introduction to the essentials of R programming and guides students in implementing the empirical applications presented throughout the textbook using the newly aquired skills. This is supported by interactive programming exercises generated with DataCamp Light and integration of interactive visualizations of central concepts which are based on the flexible JavaScript library D3.js." />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="Introduction to Econometrics with R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://www.econometrics-with-r.org//images/cover.png" />
  <meta property="og:description" content="Beginners with little background in statistics and econometrics often have a hard time understanding the benefits of having programming skills for learning and applying Econometrics. ‘Introduction to Econometrics with R’ is an interactive companion to the well-received textbook ‘Introduction to Econometrics’ by James H. Stock and Mark W. Watson (2015). It gives a gentle introduction to the essentials of R programming and guides students in implementing the empirical applications presented throughout the textbook using the newly aquired skills. This is supported by interactive programming exercises generated with DataCamp Light and integration of interactive visualizations of central concepts which are based on the flexible JavaScript library D3.js." />
  <meta name="github-repo" content="mca91/EconometricsWithR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Introduction to Econometrics with R" />
  
  <meta name="twitter:description" content="Beginners with little background in statistics and econometrics often have a hard time understanding the benefits of having programming skills for learning and applying Econometrics. ‘Introduction to Econometrics with R’ is an interactive companion to the well-received textbook ‘Introduction to Econometrics’ by James H. Stock and Mark W. Watson (2015). It gives a gentle introduction to the essentials of R programming and guides students in implementing the empirical applications presented throughout the textbook using the newly aquired skills. This is supported by interactive programming exercises generated with DataCamp Light and integration of interactive visualizations of central concepts which are based on the flexible JavaScript library D3.js." />
  <meta name="twitter:image" content="https://www.econometrics-with-r.org//images/cover.png" />

<meta name="author" content="Christoph Hanck, Martin Arnold, Alexander Gerber, and Martin Schmelzer" />


<meta name="date" content="2023-05-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<!-- font families -->

<link href="https://fonts.googleapis.com/css?family=PT+Sans|Pacifico|Source+Sans+Pro" rel="stylesheet">

<script src="js/hideOutput.js"></script>

<!-- Mathjax -->
<script type="text/javascript" id="MathJax-script" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/mml-chtml.min.js"></script>

 <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["tex2jax.js", "TeX/AMSmath.js"],
        tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
        jax: ["input/TeX","output/CommonHTML"]
      });
      MathJax.Hub.processSectionDelay = 0;
  </script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110299877-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110299877-1');
</script>

<!-- open review block -->

<script type="application/json" class="js-hypothesis-config">
{
"showHighlights": false
}
</script>
<script async defer src="https://hypothes.is/embed.js"></script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">Introduction to Econometrics with R</h1>
<p class="author"><em>Christoph Hanck, Martin Arnold, Alexander Gerber, and Martin Schmelzer</em></p>
<p class="date"><em>2023-05-06</em></p>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#preface" id="toc-preface">Preface</a></li>
<li><a href="#introduction" id="toc-introduction"><span class="toc-section-number">1</span> Introduction</a>
<ul>
<li><a href="#colophon" id="toc-colophon"><span class="toc-section-number">1.1</span> Colophon</a></li>
<li><a href="#a-very-short-introduction-to-r-and-rstudio" id="toc-a-very-short-introduction-to-r-and-rstudio"><span class="toc-section-number">1.2</span> A Very Short Introduction to <tt>R</tt> and <em>RStudio</em></a></li>
</ul></li>
<li><a href="#pt" id="toc-pt"><span class="toc-section-number">2</span> Probability Theory</a>
<ul>
<li><a href="#random-variables-and-probability-distributions" id="toc-random-variables-and-probability-distributions"><span class="toc-section-number">2.1</span> Random Variables and Probability Distributions</a>
<ul>
<li><a href="#probability-distributions-of-discrete-random-variables" id="toc-probability-distributions-of-discrete-random-variables">Probability Distributions of Discrete Random Variables</a></li>
<li><a href="#bernoulli-trials" id="toc-bernoulli-trials">Bernoulli Trials</a></li>
<li><a href="#expected-value-mean-and-variance" id="toc-expected-value-mean-and-variance">Expected Value, Mean and Variance</a></li>
<li><a href="#probability-distributions-of-continuous-random-variables" id="toc-probability-distributions-of-continuous-random-variables">Probability Distributions of Continuous Random Variables</a></li>
<li><a href="#the-normal-distribution" id="toc-the-normal-distribution">The Normal Distribution</a></li>
<li><a href="#the-chi-squared-distribution" id="toc-the-chi-squared-distribution">The Chi-Squared Distribution</a></li>
<li><a href="#thetdist" id="toc-thetdist">The Student t Distribution</a></li>
<li><a href="#the-f-distribution" id="toc-the-f-distribution">The F Distribution</a></li>
</ul></li>
<li><a href="#RSATDOSA" id="toc-RSATDOSA"><span class="toc-section-number">2.2</span> Random Sampling and the Distribution of Sample Averages</a>
<ul>
<li><a href="#mean-and-variance-of-the-sample-mean" id="toc-mean-and-variance-of-the-sample-mean">Mean and Variance of the Sample Mean</a></li>
<li><a href="#large-sample-approximations-to-sampling-distributions" id="toc-large-sample-approximations-to-sampling-distributions">Large Sample Approximations to Sampling Distributions</a></li>
</ul></li>
<li><a href="#exercises-2" id="toc-exercises-2"><span class="toc-section-number">2.3</span> Exercises</a></li>
</ul></li>
<li><a href="#arosur" id="toc-arosur"><span class="toc-section-number">3</span> A Review of Statistics using R</a>
<ul>
<li><a href="#estimation-of-the-population-mean" id="toc-estimation-of-the-population-mean"><span class="toc-section-number">3.1</span> Estimation of the Population Mean</a></li>
<li><a href="#potsm" id="toc-potsm"><span class="toc-section-number">3.2</span> Properties of the Sample Mean</a></li>
<li><a href="#hypothesis-tests-concerning-the-population-mean" id="toc-hypothesis-tests-concerning-the-population-mean"><span class="toc-section-number">3.3</span> Hypothesis Tests Concerning the Population Mean</a>
<ul>
<li><a href="#the-p-value" id="toc-the-p-value">The p-Value</a></li>
<li><a href="#calculating-the-p-value-when-the-standard-deviation-is-known" id="toc-calculating-the-p-value-when-the-standard-deviation-is-known">Calculating the p-Value when the Standard Deviation is Known</a></li>
<li><a href="#SVSSDASE" id="toc-SVSSDASE">Sample Variance, Sample Standard Deviation and Standard Error</a></li>
<li><a href="#calculating-the-p-value-when-the-standard-deviation-is-unknown" id="toc-calculating-the-p-value-when-the-standard-deviation-is-unknown">Calculating the p-value When the Standard Deviation is Unknown</a></li>
<li><a href="#the-t-statistic" id="toc-the-t-statistic">The t-statistic</a></li>
<li><a href="#hypothesis-testing-with-a-prespecified-significance-level" id="toc-hypothesis-testing-with-a-prespecified-significance-level">Hypothesis Testing with a Prespecified Significance Level</a></li>
<li><a href="#one-sided-alternatives" id="toc-one-sided-alternatives">One-sided Alternatives</a></li>
</ul></li>
<li><a href="#confidence-intervals-for-the-population-mean" id="toc-confidence-intervals-for-the-population-mean"><span class="toc-section-number">3.4</span> Confidence Intervals for the Population Mean</a></li>
<li><a href="#cmfdp" id="toc-cmfdp"><span class="toc-section-number">3.5</span> Comparing Means from Different Populations</a></li>
<li><a href="#aattggoe" id="toc-aattggoe"><span class="toc-section-number">3.6</span> An Application to the Gender Gap of Earnings</a></li>
<li><a href="#scatterplots-sample-covariance-and-sample-correlation" id="toc-scatterplots-sample-covariance-and-sample-correlation"><span class="toc-section-number">3.7</span> Scatterplots, Sample Covariance and Sample Correlation</a></li>
<li><a href="#exercises-3" id="toc-exercises-3"><span class="toc-section-number">3.8</span> Exercises</a></li>
</ul></li>
<li><a href="#lrwor" id="toc-lrwor"><span class="toc-section-number">4</span> Linear Regression with One Regressor</a>
<ul>
<li><a href="#simple-linear-regression" id="toc-simple-linear-regression"><span class="toc-section-number">4.1</span> Simple Linear Regression</a></li>
<li><a href="#estimating-the-coefficients-of-the-linear-regression-model" id="toc-estimating-the-coefficients-of-the-linear-regression-model"><span class="toc-section-number">4.2</span> Estimating the Coefficients of the Linear Regression Model</a>
<ul>
<li><a href="#the-ordinary-least-squares-estimator" id="toc-the-ordinary-least-squares-estimator">The Ordinary Least Squares Estimator</a></li>
</ul></li>
<li><a href="#measures-of-fit" id="toc-measures-of-fit"><span class="toc-section-number">4.3</span> Measures of Fit</a>
<ul>
<li><a href="#the-coefficient-of-determination" id="toc-the-coefficient-of-determination">The Coefficient of Determination</a></li>
<li><a href="#the-standard-error-of-the-regression" id="toc-the-standard-error-of-the-regression">The Standard Error of the Regression</a></li>
<li><a href="#application-to-the-test-score-data" id="toc-application-to-the-test-score-data">Application to the Test Score Data</a></li>
</ul></li>
<li><a href="#tlsa" id="toc-tlsa"><span class="toc-section-number">4.4</span> The Least Squares Assumptions</a>
<ul>
<li><a href="#assumption-1-the-error-term-has-conditional-mean-of-zero" id="toc-assumption-1-the-error-term-has-conditional-mean-of-zero">Assumption 1: The Error Term has Conditional Mean of Zero</a></li>
<li><a href="#assumption-2-independently-and-identically-distributed-data" id="toc-assumption-2-independently-and-identically-distributed-data">Assumption 2: Independently and Identically Distributed Data</a></li>
<li><a href="#assumption-3-large-outliers-are-unlikely" id="toc-assumption-3-large-outliers-are-unlikely">Assumption 3: Large Outliers are Unlikely</a></li>
</ul></li>
<li><a href="#tsdotoe" id="toc-tsdotoe"><span class="toc-section-number">4.5</span> The Sampling Distribution of the OLS Estimator</a>
<ul>
<li><a href="#simulation-study-1" id="toc-simulation-study-1">Simulation Study 1</a></li>
<li><a href="#simulation-study-2" id="toc-simulation-study-2">Simulation Study 2</a></li>
<li><a href="#simulation-study-3" id="toc-simulation-study-3">Simulation Study 3</a></li>
</ul></li>
<li><a href="#exercises-4" id="toc-exercises-4"><span class="toc-section-number">4.6</span> Exercises</a></li>
</ul></li>
<li><a href="#htaciitslrm" id="toc-htaciitslrm"><span class="toc-section-number">5</span> Hypothesis Tests and Confidence Intervals in the Simple Linear Regression Model</a>
<ul>
<li><a href="#testing-two-sided-hypotheses-concerning-the-slope-coefficient" id="toc-testing-two-sided-hypotheses-concerning-the-slope-coefficient"><span class="toc-section-number">5.1</span> Testing Two-Sided Hypotheses Concerning the Slope Coefficient</a></li>
<li><a href="#cifrc" id="toc-cifrc"><span class="toc-section-number">5.2</span> Confidence Intervals for Regression Coefficients</a>
<ul>
<li><a href="#simulation-study-confidence-intervals" id="toc-simulation-study-confidence-intervals">Simulation Study: Confidence Intervals</a></li>
</ul></li>
<li><a href="#rwxiabv" id="toc-rwxiabv"><span class="toc-section-number">5.3</span> Regression when X is a Binary Variable</a></li>
<li><a href="#hah" id="toc-hah"><span class="toc-section-number">5.4</span> Heteroskedasticity and Homoskedasticity</a>
<ul>
<li><a href="#a-real-world-example-for-heteroskedasticity" id="toc-a-real-world-example-for-heteroskedasticity">A Real-World Example for Heteroskedasticity</a></li>
<li><a href="#should-we-care-about-heteroskedasticity" id="toc-should-we-care-about-heteroskedasticity">Should We Care About Heteroskedasticity?</a></li>
<li><a href="#computation-of-heteroskedasticity-robust-standard-errors" id="toc-computation-of-heteroskedasticity-robust-standard-errors">Computation of Heteroskedasticity-Robust Standard Errors</a></li>
</ul></li>
<li><a href="#the-gauss-markov-theorem" id="toc-the-gauss-markov-theorem"><span class="toc-section-number">5.5</span> The Gauss-Markov Theorem</a>
<ul>
<li><a href="#simulation-study-blue-estimator" id="toc-simulation-study-blue-estimator">Simulation Study: BLUE Estimator</a></li>
</ul></li>
<li><a href="#using-the-t-statistic-in-regression-when-the-sample-size-is-small" id="toc-using-the-t-statistic-in-regression-when-the-sample-size-is-small"><span class="toc-section-number">5.6</span> Using the t-Statistic in Regression When the Sample Size Is Small</a></li>
<li><a href="#exercises-5" id="toc-exercises-5"><span class="toc-section-number">5.7</span> Exercises</a></li>
</ul></li>
<li><a href="#rmwmr" id="toc-rmwmr"><span class="toc-section-number">6</span> Regression Models with Multiple Regressors</a>
<ul>
<li><a href="#omitted-variable-bias" id="toc-omitted-variable-bias"><span class="toc-section-number">6.1</span> Omitted Variable Bias</a></li>
<li><a href="#tmrm" id="toc-tmrm"><span class="toc-section-number">6.2</span> The Multiple Regression Model</a></li>
<li><a href="#mofimr" id="toc-mofimr"><span class="toc-section-number">6.3</span> Measures of Fit in Multiple Regression</a></li>
<li><a href="#ols-assumptions-in-multiple-regression" id="toc-ols-assumptions-in-multiple-regression"><span class="toc-section-number">6.4</span> OLS Assumptions in Multiple Regression</a>
<ul>
<li><a href="#multicollinearity" id="toc-multicollinearity">Multicollinearity</a></li>
<li><a href="#simulation-study-imperfect-multicollinearity" id="toc-simulation-study-imperfect-multicollinearity">Simulation Study: Imperfect Multicollinearity</a></li>
</ul></li>
<li><a href="#the-distribution-of-the-ols-estimators-in-multiple-regression" id="toc-the-distribution-of-the-ols-estimators-in-multiple-regression"><span class="toc-section-number">6.5</span> The Distribution of the OLS Estimators in Multiple Regression</a></li>
<li><a href="#exercises-6" id="toc-exercises-6"><span class="toc-section-number">6.6</span> Exercises</a></li>
</ul></li>
<li><a href="#htaciimr" id="toc-htaciimr"><span class="toc-section-number">7</span> Hypothesis Tests and Confidence Intervals in Multiple Regression</a>
<ul>
<li><a href="#hypothesis-tests-and-confidence-intervals-for-a-single-coefficient" id="toc-hypothesis-tests-and-confidence-intervals-for-a-single-coefficient"><span class="toc-section-number">7.1</span> Hypothesis Tests and Confidence Intervals for a Single Coefficient</a></li>
<li><a href="#an-application-to-test-scores-and-the-student-teacher-ratio" id="toc-an-application-to-test-scores-and-the-student-teacher-ratio"><span class="toc-section-number">7.2</span> An Application to Test Scores and the Student-Teacher Ratio</a>
<ul>
<li><a href="#another-augmentation-of-the-model" id="toc-another-augmentation-of-the-model">Another Augmentation of the Model</a></li>
</ul></li>
<li><a href="#joint-hypothesis-testing-using-the-f-statistic" id="toc-joint-hypothesis-testing-using-the-f-statistic"><span class="toc-section-number">7.3</span> Joint Hypothesis Testing Using the F-Statistic</a></li>
<li><a href="#confidence-sets-for-multiple-coefficients" id="toc-confidence-sets-for-multiple-coefficients"><span class="toc-section-number">7.4</span> Confidence Sets for Multiple Coefficients</a></li>
<li><a href="#model-specification-for-multiple-regression" id="toc-model-specification-for-multiple-regression"><span class="toc-section-number">7.5</span> Model Specification for Multiple Regression</a>
<ul>
<li><a href="#model-specification-in-theory-and-in-practice" id="toc-model-specification-in-theory-and-in-practice">Model Specification in Theory and in Practice</a></li>
</ul></li>
<li><a href="#analysis-of-the-test-score-data-set" id="toc-analysis-of-the-test-score-data-set"><span class="toc-section-number">7.6</span> Analysis of the Test Score Data Set</a></li>
<li><a href="#exercises-7" id="toc-exercises-7"><span class="toc-section-number">7.7</span> Exercises</a></li>
</ul></li>
<li><a href="#nrf" id="toc-nrf"><span class="toc-section-number">8</span> Nonlinear Regression Functions</a>
<ul>
<li><a href="#a-general-strategy-for-modelling-nonlinear-regression-functions" id="toc-a-general-strategy-for-modelling-nonlinear-regression-functions"><span class="toc-section-number">8.1</span> A General Strategy for Modelling Nonlinear Regression Functions</a></li>
<li><a href="#nfoasiv" id="toc-nfoasiv"><span class="toc-section-number">8.2</span> Nonlinear Functions of a Single Independent Variable</a>
<ul>
<li><a href="#polynomials" id="toc-polynomials">Polynomials</a></li>
<li><a href="#logarithms" id="toc-logarithms">Logarithms</a></li>
</ul></li>
<li><a href="#interactions-between-independent-variables" id="toc-interactions-between-independent-variables"><span class="toc-section-number">8.3</span> Interactions Between Independent Variables</a></li>
<li><a href="#nonlinear-effects-on-test-scores-of-the-student-teacher-ratio" id="toc-nonlinear-effects-on-test-scores-of-the-student-teacher-ratio"><span class="toc-section-number">8.4</span> Nonlinear Effects on Test Scores of the Student-Teacher Ratio</a></li>
<li><a href="#exercises-8" id="toc-exercises-8"><span class="toc-section-number">8.5</span> Exercises</a></li>
</ul></li>
<li><a href="#asbomr" id="toc-asbomr"><span class="toc-section-number">9</span> Assessing Studies Based on Multiple Regression</a>
<ul>
<li><a href="#internal-and-external-validity" id="toc-internal-and-external-validity"><span class="toc-section-number">9.1</span> Internal and External Validity</a></li>
<li><a href="#ttivomra" id="toc-ttivomra"><span class="toc-section-number">9.2</span> Threats to Internal Validity of Multiple Regression Analysis</a></li>
<li><a href="#internal-and-external-validity-when-the-regression-is-used-for-forecasting" id="toc-internal-and-external-validity-when-the-regression-is-used-for-forecasting"><span class="toc-section-number">9.3</span> Internal and External Validity when the Regression is Used for Forecasting</a></li>
<li><a href="#etsacs" id="toc-etsacs"><span class="toc-section-number">9.4</span> Example: Test Scores and Class Size</a></li>
<li><a href="#exercises-9" id="toc-exercises-9"><span class="toc-section-number">9.5</span> Exercises</a></li>
</ul></li>
<li><a href="#rwpd" id="toc-rwpd"><span class="toc-section-number">10</span> Regression with Panel Data</a>
<ul>
<li><a href="#panel-data" id="toc-panel-data"><span class="toc-section-number">10.1</span> Panel Data</a></li>
<li><a href="#PDWTTP" id="toc-PDWTTP"><span class="toc-section-number">10.2</span> Panel Data with Two Time Periods: “Before and After” Comparisons</a></li>
<li><a href="#fixed-effects-regression" id="toc-fixed-effects-regression"><span class="toc-section-number">10.3</span> Fixed Effects Regression</a>
<ul>
<li><a href="#estimation-and-inference" id="toc-estimation-and-inference">Estimation and Inference</a></li>
<li><a href="#application-to-traffic-deaths" id="toc-application-to-traffic-deaths">Application to Traffic Deaths</a></li>
</ul></li>
<li><a href="#regression-with-time-fixed-effects" id="toc-regression-with-time-fixed-effects"><span class="toc-section-number">10.4</span> Regression with Time Fixed Effects</a></li>
<li><a href="#tferaaseffer" id="toc-tferaaseffer"><span class="toc-section-number">10.5</span> The Fixed Effects Regression Assumptions and Standard Errors for Fixed Effects Regression</a></li>
<li><a href="#drunk-driving-laws-and-traffic-deaths" id="toc-drunk-driving-laws-and-traffic-deaths"><span class="toc-section-number">10.6</span> Drunk Driving Laws and Traffic Deaths</a></li>
<li><a href="#exercises-10" id="toc-exercises-10"><span class="toc-section-number">10.7</span> Exercises</a></li>
</ul></li>
<li><a href="#rwabdv" id="toc-rwabdv"><span class="toc-section-number">11</span> Regression with a Binary Dependent Variable</a>
<ul>
<li><a href="#binary-dependent-variables-and-the-linear-probability-model" id="toc-binary-dependent-variables-and-the-linear-probability-model"><span class="toc-section-number">11.1</span> Binary Dependent Variables and the Linear Probability Model</a></li>
<li><a href="#palr" id="toc-palr"><span class="toc-section-number">11.2</span> Probit and Logit Regression</a>
<ul>
<li><a href="#probit-regression" id="toc-probit-regression">Probit Regression</a></li>
<li><a href="#logit-regression" id="toc-logit-regression">Logit Regression</a></li>
</ul></li>
<li><a href="#estimation-and-inference-in-the-logit-and-probit-models" id="toc-estimation-and-inference-in-the-logit-and-probit-models"><span class="toc-section-number">11.3</span> Estimation and Inference in the Logit and Probit Models</a></li>
<li><a href="#application-to-the-boston-hmda-data" id="toc-application-to-the-boston-hmda-data"><span class="toc-section-number">11.4</span> Application to the Boston HMDA Data</a></li>
<li><a href="#exercises-11" id="toc-exercises-11"><span class="toc-section-number">11.5</span> Exercises</a></li>
</ul></li>
<li><a href="#ivr" id="toc-ivr"><span class="toc-section-number">12</span> Instrumental Variables Regression</a>
<ul>
<li><a href="#TIVEWASRAASI" id="toc-TIVEWASRAASI"><span class="toc-section-number">12.1</span> The IV Estimator with a Single Regressor and a Single Instrument</a></li>
<li><a href="#TGIVRM" id="toc-TGIVRM"><span class="toc-section-number">12.2</span> The General IV Regression Model</a></li>
<li><a href="#civ" id="toc-civ"><span class="toc-section-number">12.3</span> Checking Instrument Validity</a></li>
<li><a href="#attdfc" id="toc-attdfc"><span class="toc-section-number">12.4</span> Application to the Demand for Cigarettes</a></li>
<li><a href="#where-do-valid-instruments-come-from" id="toc-where-do-valid-instruments-come-from"><span class="toc-section-number">12.5</span> Where Do Valid Instruments Come From?</a></li>
<li><a href="#exercises-12" id="toc-exercises-12"><span class="toc-section-number">12.6</span> Exercises</a></li>
</ul></li>
<li><a href="#eaqe" id="toc-eaqe"><span class="toc-section-number">13</span> Experiments and Quasi-Experiments</a>
<ul>
<li><a href="#poceaie" id="toc-poceaie"><span class="toc-section-number">13.1</span> Potential Outcomes, Causal Effects and Idealized Experiments</a></li>
<li><a href="#threats-to-validity-of-experiments" id="toc-threats-to-validity-of-experiments"><span class="toc-section-number">13.2</span> Threats to Validity of Experiments</a></li>
<li><a href="#experimental-estimates-of-the-effect-of-class-size-reductions" id="toc-experimental-estimates-of-the-effect-of-class-size-reductions"><span class="toc-section-number">13.3</span> Experimental Estimates of the Effect of Class Size Reductions</a>
<ul>
<li><a href="#experimental-design-and-the-data-set" id="toc-experimental-design-and-the-data-set">Experimental Design and the Data Set</a></li>
<li><a href="#analysis-of-the-star-data" id="toc-analysis-of-the-star-data">Analysis of the STAR Data</a></li>
</ul></li>
<li><a href="#qe" id="toc-qe"><span class="toc-section-number">13.4</span> Quasi Experiments</a>
<ul>
<li><a href="#the-differences-in-differences-estimator" id="toc-the-differences-in-differences-estimator">The Differences-in-Differences Estimator</a></li>
<li><a href="#regression-discontinuity-estimators" id="toc-regression-discontinuity-estimators">Regression Discontinuity Estimators</a></li>
</ul></li>
<li><a href="#exercises-13" id="toc-exercises-13"><span class="toc-section-number">13.5</span> Exercises</a></li>
</ul></li>
<li><a href="#ittsraf" id="toc-ittsraf"><span class="toc-section-number">14</span> Introduction to Time Series Regression and Forecasting</a>
<ul>
<li><a href="#using-regression-models-for-forecasting" id="toc-using-regression-models-for-forecasting"><span class="toc-section-number">14.1</span> Using Regression Models for Forecasting</a></li>
<li><a href="#tsdasc" id="toc-tsdasc"><span class="toc-section-number">14.2</span> Time Series Data and Serial Correlation</a>
<ul>
<li><a href="#notation-lags-differences-logarithms-and-growth-rates" id="toc-notation-lags-differences-logarithms-and-growth-rates">Notation, Lags, Differences, Logarithms and Growth Rates</a></li>
</ul></li>
<li><a href="#autoregressions" id="toc-autoregressions"><span class="toc-section-number">14.3</span> Autoregressions</a>
<ul>
<li><a href="#autoregressive-models-of-order-p" id="toc-autoregressive-models-of-order-p">Autoregressive Models of Order <span class="math inline">\(p\)</span></a></li>
</ul></li>
<li><a href="#cybtmpi" id="toc-cybtmpi"><span class="toc-section-number">14.4</span> Can You Beat the Market? (Part I)</a></li>
<li><a href="#apatadlm" id="toc-apatadlm"><span class="toc-section-number">14.5</span> Additional Predictors and The ADL Model</a>
<ul>
<li><a href="#forecast-uncertainty-and-forecast-intervals" id="toc-forecast-uncertainty-and-forecast-intervals">Forecast Uncertainty and Forecast Intervals</a></li>
</ul></li>
<li><a href="#llsuic" id="toc-llsuic"><span class="toc-section-number">14.6</span> Lag Length Selection Using Information Criteria</a></li>
<li><a href="#nit" id="toc-nit"><span class="toc-section-number">14.7</span> Nonstationarity I: Trends</a></li>
<li><a href="#niib" id="toc-niib"><span class="toc-section-number">14.8</span> Nonstationarity II: Breaks</a></li>
<li><a href="#can-you-beat-the-market-part-ii" id="toc-can-you-beat-the-market-part-ii"><span class="toc-section-number">14.9</span> Can You Beat the Market? (Part II)</a></li>
</ul></li>
<li><a href="#eodce" id="toc-eodce"><span class="toc-section-number">15</span> Estimation of Dynamic Causal Effects</a>
<ul>
<li><a href="#the-orange-juice-data" id="toc-the-orange-juice-data"><span class="toc-section-number">15.1</span> The Orange Juice Data</a></li>
<li><a href="#dynamic-causal-effects" id="toc-dynamic-causal-effects"><span class="toc-section-number">15.2</span> Dynamic Causal Effects</a></li>
<li><a href="#dynamic-multipliers-and-cumulative-dynamic-multipliers" id="toc-dynamic-multipliers-and-cumulative-dynamic-multipliers"><span class="toc-section-number">15.3</span> Dynamic Multipliers and Cumulative Dynamic Multipliers</a></li>
<li><a href="#hac-standard-errors" id="toc-hac-standard-errors"><span class="toc-section-number">15.4</span> HAC Standard Errors</a></li>
<li><a href="#estimation-of-dynamic-causal-effects-with-strictly-exogeneous-regressors" id="toc-estimation-of-dynamic-causal-effects-with-strictly-exogeneous-regressors"><span class="toc-section-number">15.5</span> Estimation of Dynamic Causal Effects with Strictly Exogeneous Regressors</a></li>
<li><a href="#orange-juice-prices-and-cold-weather" id="toc-orange-juice-prices-and-cold-weather"><span class="toc-section-number">15.6</span> Orange Juice Prices and Cold Weather</a></li>
</ul></li>
<li><a href="#atitsr" id="toc-atitsr"><span class="toc-section-number">16</span> Additional Topics in Time Series Regression</a>
<ul>
<li><a href="#vector-autoregressions" id="toc-vector-autoregressions"><span class="toc-section-number">16.1</span> Vector Autoregressions</a></li>
<li><a href="#ooiatdfglsurt" id="toc-ooiatdfglsurt"><span class="toc-section-number">16.2</span> Orders of Integration and the DF-GLS Unit Root Test</a></li>
<li><a href="#cointegration" id="toc-cointegration"><span class="toc-section-number">16.3</span> Cointegration</a></li>
<li><a href="#volatility-clustering-and-autoregressive-conditional-heteroskedasticity" id="toc-volatility-clustering-and-autoregressive-conditional-heteroskedasticity"><span class="toc-section-number">16.4</span> Volatility Clustering and Autoregressive Conditional Heteroskedasticity</a>
<ul>
<li><a href="#arch-and-garch-models" id="toc-arch-and-garch-models">ARCH and GARCH Models</a></li>
<li><a href="#application-to-stock-price-volatility" id="toc-application-to-stock-price-volatility">Application to Stock Price Volatility</a></li>
<li><a href="#summary-8" id="toc-summary-8">Summary</a></li>
</ul></li>
</ul></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Econometrics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div class = rmdreview>
This book is in <b>Open Review</b>. We want your feedback to make the book better for you and other students. You may annotate some text by <span style="background-color: #3297FD; color: white">selecting it with the cursor</span> and then click "Annotate" in the pop-up menu. You can also see the annotations of others: click the arrow in the upper right hand corner of the page <i class="fa fa-arrow-circle-right  fa-rotate-315" aria-hidden="true"></i>
</div>
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="preface" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">Preface<a href="#preface" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<hr style="background-color:#3C6690;height:2px">
<center>
<img src='images/cover.png' style = 'width:60%;'>
</center>
<p><br> Chair of Econometrics <img style='float: right; margin: 0px 100px 0px 0px; width:35%' src='images/logo_claim_en_rgb.png'/> <br> Department of Business Administration and Economics <br> University of Duisburg-Essen <br> Essen, Germany <br> <a href=\"mailto:info@econometrics-with-r.org?subject=Econometrics%20with%20R\">info@econometrics-with-r.org</a> <br><br> Last updated on Saturday, May 06, 2023
<br>
<br>
<iframe src="https://www.facebook.com/plugins/like.php?href=https%3A%2F%2Fwww.facebook.com%2FEconometricsWithR%2F&width=450&layout=standard&action=like&size=small&show_faces=true&share=true&height=80&appId" width="400" height="70" style="border:none;overflow:hidden" scrolling="no" frameborder="0" allowTransparency="true" allow="encrypted-media" align="left"></iframe>
<br>
<br>
<br></p>
<hr style="background-color:#3C6690;height:2px">
<p>Over the last few years, the statistical programming language R has become an integral part of the curricula of econometrics classes we teach at the University of Duisburg-Essen. We regularly found that a large share of the students, especially in our introductory undergraduate econometrics courses, had not been exposed to any programming language before and thus had difficulty to engage with learning R on their own. With little background in statistics and econometrics, beginners naturally have a hard time understanding the benefits of having R skills for learning and applying econometrics. These particularly include the ability to conduct, document and communicate empirical studies and having the ability to program simulation studies which is helpful for, e.g., comprehending and validating theorems which usually are not easily grasped by mere brooding over formulas. Being applied economists and econometricians, we value and wish to share with our students all of these capabilities.</p>
<p>Instead of confronting students with pure coding exercises and complementary classic literature like the book by <span class="citation">Venables and Smith (<a href="#ref-venables2010" role="doc-biblioref">2010</a>)</span>, we figured it would be better to provide interactive learning material that blends R code with the contents of the well-received textbook <em>Introduction to Econometrics</em> by <span class="citation">Stock and Watson (<a href="#ref-stock2015" role="doc-biblioref">2015</a>)</span> which serves as a basis for the lecture. This material is gathered in the present book <em>Introduction to Econometrics with R</em>, an empirical companion to <span class="citation">Stock and Watson (<a href="#ref-stock2015" role="doc-biblioref">2015</a>)</span>. It is an interactive script in the style of a reproducible research report and not only enables students to learn how results of case studies can be replicated with R but also strengthens their ability in using the newly acquired skills in other empirical applications.</p>
<div id="conventions-used-in-this-book" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Conventions Used in this Book<a href="#conventions-used-in-this-book" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p><em>Italic</em> text indicates new terms, names, buttons and the like.</p></li>
<li><p><tt>Monospaced font</tt> is generally used in paragraphs to refer to <tt>R</tt> code. This includes commands, variables, functions, data types, databases, and file names.</p></li>
<li><p><code>Monospaced font on gray background</code> indicates <tt>R</tt> code that can be typed literally by you. It may appear in paragraphs for better distinguishability among executable and non-executable code statements but it will mostly be encountered in shape of large blocks of <tt>R</tt> code. These blocks are referred to as <em>code chunks</em>.</p></li>
</ul>
</div>
<div id="acknowledgement" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Acknowledgement<a href="#acknowledgement" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We thank the <em>Stifterverband für die Deutsche Wissenschaft e.V.</em> and the <em>Ministry of Culture and Science of North Rhine-Westphalia</em> for their financial support. Also, we are grateful to Alexander Blasberg for proofreading and his effort in helping with programming the exercises.
A special thanks goes to Achim Zeileis (University of Innsbruck) and Christian Kleiber (University of Basel) for their advice and constructive criticism. Another thanks goes to Rebecca Arnold from the Münster University of Applied Sciences for several suggestions regarding the website design and for providing us with her nice designs for the book cover, logos and icons. We are also indebted to all past students of our introductory econometrics courses at the University of Duisburg-Essen for their feedback.</p>
<p><br>
<img src="https://mirrors.creativecommons.org/presskit/buttons/88x31/svg/by-nc-sa.eu.svg" alt="Creative Commons License" /></p>
<p>This book is licensed under the <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.</p>
</div>
</div>
<div id="introduction" class="section level1 hasAnchor" number="1">
<h1 class="hasAnchor"><span class="header-section-number">1</span> Introduction<a href="#introduction" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<hr style="background-color:#3C6690;height:2px">
<p>The interest in the freely available statistical programming language and software environment <tt>R</tt> <span class="citation">(<a href="#ref-R-base" role="doc-biblioref">R Core Team 2023</a>)</span> is soaring. By the time we wrote first drafts for this project, more than 11000 add-ons (many of them providing cutting-edge methods) were made available on the Comprehensive <tt>R</tt> Archive Network (<a href="https://cran.r-project.org/">CRAN</a>), an extensive network of FTP servers around the world that store identical and up-to-date versions of <tt>R</tt> code and its documentation. <tt>R</tt> dominates other (commercial) software for statistical computing in most fields of research in applied statistics. The benefits of it being freely available, open source and having a large and constantly growing community of users that contribute to CRAN render <tt>R</tt> more and more appealing for empirical economists and econometricians alike.</p>
<p>A striking advantage of using <tt>R</tt> in econometrics is that it enables students to explicitly document their analysis step-by-step such that it is easy to update and to expand. This allows to re-use code for similar applications with different data. Furthermore, <tt>R</tt> programs are fully reproducible, which makes it straightforward for others to comprehend and validate results.</p>
<p>Over the recent years, <tt>R</tt> has thus become an integral part of the curricula of econometrics classes we teach at the University of Duisburg-Essen. In some sense, learning to code is comparable to learning a foreign language and continuous practice is essential for the learning success. Needless to say, presenting bare <tt>R</tt> code on slides does not encourage the students to engage with hands-on experience on their own. This is why <tt>R</tt> is crucial. As for accompanying literature, there are some excellent books that deal with <tt>R</tt> and its applications to econometrics, e.g., <span class="citation">C. Kleiber and Zeileis (<a href="#ref-kleiber2008" role="doc-biblioref">2008</a>)</span>. However, such sources may be somewhat beyond the scope of undergraduate students in economics having little understanding of econometric methods and barely any experience in programming at all. Consequently, we started to compile a collection of reproducible reports for use in class. These reports provide guidance on how to implement selected applications from the textbook <em>Introduction to Econometrics</em> <span class="citation">(<a href="#ref-stock2015" role="doc-biblioref">Stock and Watson 2015</a>)</span> which serves as a basis for the lecture and the accompanying tutorials. This process was facilitated considerably by <tt>knitr</tt> <span class="citation">(<a href="#ref-R-knitr" role="doc-biblioref">Xie 2023b</a>)</span> and <tt>R markdown</tt> <span class="citation">(<a href="#ref-R-rmarkdown" role="doc-biblioref">Allaire et al. 2023</a>)</span>. In conjunction, both <tt>R</tt> packages provide powerful functionalities for dynamic report generation which allow to seamlessly combine pure text, LaTeX, <tt>R</tt> code and its output in a variety of formats, including PDF and HTML. Moreover, writing and distributing reproducible reports for use in academia has been enriched tremendously by the <tt>bookdown</tt> package <span class="citation">(<a href="#ref-R-bookdown" role="doc-biblioref">Xie 2023a</a>)</span> which has become our main tool for this project. <tt>bookdown</tt> builds on top of <tt>R markdown</tt> and allows to create appealing HTML pages like this one, among other things.
Being inspired by <em>Using R for Introductory Econometrics</em> <span class="citation">(<a href="#ref-heiss2016" role="doc-biblioref">Heiss 2016</a>)</span><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> and with this powerful toolkit at hand we wrote up our own empirical companion to <span class="citation">Stock and Watson (<a href="#ref-stock2015" role="doc-biblioref">2015</a>)</span>. The result, which you started to look at, is <em>Introduction to Econometrics with R</em>.</p>
<p>Similarly to the book by <span class="citation">Heiss (<a href="#ref-heiss2016" role="doc-biblioref">2016</a>)</span>, this project is neither a comprehensive econometrics textbook nor is it intended to be a general introduction to <tt>R</tt>. We feel that Stock and Watson do a great job at explaining the intuition and theory of econometrics, and at any rate better than we could in yet another introductory textbook! <em>Introduction to Econometrics with R</em> is best described as an interactive script in the style of a reproducible research report which aims to provide students with a platform-independent e-learning arrangement by seamlessly intertwining theoretical core knowledge and empirical skills in undergraduate econometrics. Of course, the focus is on empirical applications with <tt>R</tt>. We leave out derivations and proofs wherever we can. Our goal is to enable students not only to learn how results of case studies can be replicated with <tt>R</tt> but we also intend to strengthen their ability in using the newly acquired skills in other empirical applications — immediately within <em>Introduction to Econometrics with R</em>.</p>
<p>To realize this, each chapter contains interactive <tt>R</tt> programming exercises. These exercises are used as supplements to code chunks that display how previously discussed techniques can be implemented within <tt>R</tt>. They are generated using the <a href="https://github.com/datacamp/datacamp-light">DataCamp light widget</a> and are backed by an <tt>R</tt> session which is maintained on <a href="https://www.datacamp.com/home">DataCamp</a>’s servers. You may play around with the example exercise presented below.</p>
<iframe src="DCL/intro_1.html" frameborder="0" scrolling="no" style="width:100%;height:360px">
</iframe>
<p>As you can see above, the widget consists of two tabs. <tt>script.R</tt> mimics an <tt>.R</tt>-file, a file format that is commonly used for storing <tt>R</tt> code. Lines starting with a # are commented out, that is, they are not recognized as code. Furthermore, <tt>script.R</tt> works like an exercise sheet where you may write down the solution you come up with. If you hit the button <em>Run</em>, the code will be executed, submission correctness tests are run and you will be notified whether your approach is correct. If it is not correct, you will receive feedback suggesting improvements or hints. The other tab, <tt>R Console</tt>, is a fully functional <tt>R</tt> console that can be used for trying out solutions to exercises before submitting them. Of course you may submit (almost any) <tt>R</tt> code and use the console to play around and explore. Simply type a command and hit the <em>Enter</em> key on your keyboard.</p>
<p>Looking at the widget above, you will notice that there is a <tt>&gt;</tt> in the right panel (in the console). This symbol is called “prompt” and indicates that the user can enter code that will be executed. To avoid confusion, we will not show this symbol in this book. Output produced by R code is commented out with <tt>#&gt;</tt>.</p>
<p>Most commonly we display R code together with the generated output in code chunks. As an example, consider the following line of code presented in chunk below. It tells <tt>R</tt> to compute the number of packages available on <tt>CRAN</tt>. The code chunk is followed by the output produced.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check the number of R packages available on CRAN</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(<span class="fu">available.packages</span>(<span class="at">repos =</span> <span class="st">&quot;http://cran.us.r-project.org&quot;</span>))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 19453</span></span></code></pre></div>
<p>Each code chunk is equipped with a button on the outer right hand side which copies the code to your clipboard. This makes it convenient to work with larger code segments in your version of <tt>R</tt>/<em>RStudio</em> or in the widgets presented throughout the book. In the widget above, you may click on <tt>R Console</tt> and type <code>nrow(available.packages(repos = "http://cran.us.r-project.org"))</code> (the command from the code chunk above) and execute it by hitting <em>Enter</em> on your keyboard.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<p>Note that some lines in the widget are out-commented which ask you to assign a numeric value to a variable and then to print the variable’s content to the console. You may enter your solution approach to <tt>script.R</tt> and hit the button <em>Run</em> in order to get the feedback described further above. In case you do not know how to solve this sample exercise (don’t panic, that is probably why you are reading this), a click on <em>Hint</em> will provide you with some advice. If you still can’t find a solution, a click on <em>Solution</em> will provide you with another tab, <tt>Solution.R</tt> which contains sample solution code. It will often be the case that exercises can be solved in many different ways and <tt>Solution.R</tt> presents what we consider as comprehensible and idiomatic.</p>
<div id="colophon" class="section level2 hasAnchor" number="1.1">
<h2 class="hasAnchor"><span class="header-section-number">1.1</span> Colophon<a href="#colophon" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This book was built with:</p>
<pre><code>#&gt; ─ Session info ────────────────────────────────────────────────────────────────────────────────────
#&gt;  setting  value
#&gt;  version  R version 4.2.3 (2023-03-15)
#&gt;  os       macOS Ventura 13.1
#&gt;  system   aarch64, darwin20
#&gt;  ui       X11
#&gt;  language (EN)
#&gt;  collate  en_US.UTF-8
#&gt;  ctype    en_US.UTF-8
#&gt;  tz       Europe/Berlin
#&gt;  date     2023-05-06
#&gt;  pandoc   2.19.2 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/ (via rmarkdown)
#&gt; 
#&gt; ─ Packages ────────────────────────────────────────────────────────────────────────────────────────
#&gt;  package       * version    date (UTC) lib source
#&gt;  abind           1.4-5      2016-07-21 [1] CRAN (R 4.2.0)
#&gt;  AER             1.2-10     2022-06-14 [1] CRAN (R 4.2.0)
#&gt;  askpass         1.1        2019-01-13 [1] CRAN (R 4.2.0)
#&gt;  backports       1.4.1      2021-12-13 [1] CRAN (R 4.2.0)
#&gt;  base64enc       0.1-3      2015-07-28 [1] CRAN (R 4.2.0)
#&gt;  bdsmatrix       1.3-6      2022-06-03 [1] CRAN (R 4.2.0)
#&gt;  bit             4.0.5      2022-11-15 [1] CRAN (R 4.2.0)
#&gt;  bit64           4.0.5      2020-08-30 [1] CRAN (R 4.2.0)
#&gt;  bitops          1.0-7      2021-04-24 [1] CRAN (R 4.2.0)
#&gt;  blob            1.2.4      2023-03-17 [1] CRAN (R 4.2.0)
#&gt;  bookdown        0.33       2023-03-06 [1] CRAN (R 4.2.0)
#&gt;  boot            1.3-28.1   2022-11-22 [1] CRAN (R 4.2.3)
#&gt;  brio            1.1.3      2021-11-30 [1] CRAN (R 4.2.0)
#&gt;  broom           1.0.4      2023-03-11 [1] CRAN (R 4.2.0)
#&gt;  bslib           0.4.2      2022-12-16 [1] CRAN (R 4.2.0)
#&gt;  cachem          1.0.7      2023-02-24 [1] CRAN (R 4.2.0)
#&gt;  callr           3.7.3      2022-11-02 [1] CRAN (R 4.2.0)
#&gt;  car             3.1-2      2023-03-30 [1] CRAN (R 4.2.0)
#&gt;  carData         3.0-5      2022-01-06 [1] CRAN (R 4.2.0)
#&gt;  cellranger      1.1.0      2016-07-27 [1] CRAN (R 4.2.0)
#&gt;  cli             3.6.1      2023-03-23 [1] CRAN (R 4.2.0)
#&gt;  clipr           0.8.0      2022-02-22 [1] CRAN (R 4.2.0)
#&gt;  collapse        1.9.3      2023-02-27 [1] CRAN (R 4.2.0)
#&gt;  colorspace      2.1-0      2023-01-23 [1] CRAN (R 4.2.0)
#&gt;  conflicted      1.2.0      2023-02-01 [1] CRAN (R 4.2.0)
#&gt;  cpp11           0.4.3      2022-10-12 [1] CRAN (R 4.2.0)
#&gt;  crayon          1.5.2      2022-09-29 [1] CRAN (R 4.2.0)
#&gt;  cubature        2.0.4.6    2023-01-23 [1] CRAN (R 4.2.0)
#&gt;  curl            5.0.0      2023-01-12 [1] CRAN (R 4.2.0)
#&gt;  cvar            0.5        2022-11-03 [1] CRAN (R 4.2.0)
#&gt;  data.table      1.14.8     2023-02-17 [1] CRAN (R 4.2.0)
#&gt;  DBI             1.1.3      2022-06-18 [1] CRAN (R 4.2.0)
#&gt;  dbplyr          2.3.2      2023-03-21 [1] CRAN (R 4.2.0)
#&gt;  desc            1.4.2      2022-09-08 [1] CRAN (R 4.2.0)
#&gt;  diffobj         0.3.5      2021-10-05 [1] CRAN (R 4.2.0)
#&gt;  digest          0.6.31     2022-12-11 [1] CRAN (R 4.2.0)
#&gt;  dplyr           1.1.1      2023-03-22 [1] CRAN (R 4.2.0)
#&gt;  dtplyr          1.3.1      2023-03-22 [1] CRAN (R 4.2.0)
#&gt;  dynlm           0.3-6      2019-01-06 [1] CRAN (R 4.2.0)
#&gt;  ellipsis        0.3.2      2021-04-29 [1] CRAN (R 4.2.0)
#&gt;  evaluate        0.20       2023-01-17 [1] CRAN (R 4.2.0)
#&gt;  fansi           1.0.4      2023-01-22 [1] CRAN (R 4.2.0)
#&gt;  farver          2.1.1      2022-07-06 [1] CRAN (R 4.2.0)
#&gt;  fastICA         1.2-3      2021-09-25 [1] CRAN (R 4.2.0)
#&gt;  fastmap         1.1.1      2023-02-24 [1] CRAN (R 4.2.0)
#&gt;  fBasics         4022.94    2023-03-04 [1] CRAN (R 4.2.0)
#&gt;  fGarch          4022.89    2022-11-05 [1] CRAN (R 4.2.0)
#&gt;  fontawesome     0.5.0      2023-01-25 [1] CRAN (R 4.2.0)
#&gt;  forcats         1.0.0      2023-01-29 [1] CRAN (R 4.2.0)
#&gt;  Formula         1.2-5      2023-02-24 [1] CRAN (R 4.2.0)
#&gt;  fs              1.6.1      2023-02-06 [1] CRAN (R 4.2.0)
#&gt;  gargle          1.3.0      2023-01-30 [1] CRAN (R 4.2.0)
#&gt;  gbutils         0.5        2022-05-27 [1] CRAN (R 4.2.0)
#&gt;  generics        0.1.3      2022-07-05 [1] CRAN (R 4.2.0)
#&gt;  ggplot2         3.4.2      2023-04-03 [1] CRAN (R 4.2.0)
#&gt;  glue            1.6.2      2022-02-24 [1] CRAN (R 4.2.0)
#&gt;  googledrive     2.1.0      2023-03-22 [1] CRAN (R 4.2.0)
#&gt;  googlesheets4   1.0.1      2022-08-13 [1] CRAN (R 4.2.0)
#&gt;  gss             2.2-4      2023-03-15 [1] CRAN (R 4.2.0)
#&gt;  gtable          0.3.3      2023-03-21 [1] CRAN (R 4.2.0)
#&gt;  haven           2.5.2      2023-02-28 [1] CRAN (R 4.2.0)
#&gt;  highr           0.10       2022-12-22 [1] CRAN (R 4.2.0)
#&gt;  hms             1.1.3      2023-03-21 [1] CRAN (R 4.2.0)
#&gt;  htmltools       0.5.5      2023-03-23 [1] CRAN (R 4.2.0)
#&gt;  httr            1.4.5      2023-02-24 [1] CRAN (R 4.2.0)
#&gt;  ids             1.0.1      2017-05-31 [1] CRAN (R 4.2.0)
#&gt;  isoband         0.2.7      2022-12-20 [1] CRAN (R 4.2.0)
#&gt;  itewrpkg        0.0.0.9000 2023-03-23 [1] Github (mca91/itewrpkg@eb72ddb)
#&gt;  jquerylib       0.1.4      2021-04-26 [1] CRAN (R 4.2.0)
#&gt;  jsonlite        1.8.4      2022-12-06 [1] CRAN (R 4.2.0)
#&gt;  KernSmooth      2.23-20    2021-05-03 [1] CRAN (R 4.2.3)
#&gt;  knitr           1.42       2023-01-25 [1] CRAN (R 4.2.0)
#&gt;  labeling        0.4.2      2020-10-20 [1] CRAN (R 4.2.0)
#&gt;  lattice         0.20-45    2021-09-22 [1] CRAN (R 4.2.3)
#&gt;  lifecycle       1.0.3      2022-10-07 [1] CRAN (R 4.2.0)
#&gt;  lme4            1.1-32     2023-03-14 [1] CRAN (R 4.2.0)
#&gt;  lmtest          0.9-40     2022-03-21 [1] CRAN (R 4.2.0)
#&gt;  locpol          0.8.0      2022-11-29 [1] CRAN (R 4.2.0)
#&gt;  lubridate       1.9.2      2023-02-10 [1] CRAN (R 4.2.0)
#&gt;  magrittr        2.0.3      2022-03-30 [1] CRAN (R 4.2.0)
#&gt;  MASS            7.3-58.3   2023-03-07 [1] CRAN (R 4.2.0)
#&gt;  Matrix          1.5-3      2022-11-11 [1] CRAN (R 4.2.3)
#&gt;  MatrixModels    0.5-1      2022-09-11 [1] CRAN (R 4.2.0)
#&gt;  maxLik          1.5-2      2021-07-26 [1] CRAN (R 4.2.0)
#&gt;  memoise         2.0.1      2021-11-26 [1] CRAN (R 4.2.0)
#&gt;  mgcv            1.8-42     2023-03-02 [1] CRAN (R 4.2.3)
#&gt;  mime            0.12       2021-09-28 [1] CRAN (R 4.2.0)
#&gt;  minqa           1.2.5      2022-10-19 [1] CRAN (R 4.2.0)
#&gt;  miscTools       0.6-26     2019-12-08 [1] CRAN (R 4.2.0)
#&gt;  modelr          0.1.11     2023-03-22 [1] CRAN (R 4.2.0)
#&gt;  munsell         0.5.0      2018-06-12 [1] CRAN (R 4.2.0)
#&gt;  mvtnorm         1.1-3      2021-10-08 [1] CRAN (R 4.2.0)
#&gt;  nlme            3.1-162    2023-01-31 [1] CRAN (R 4.2.3)
#&gt;  nloptr          2.0.3      2022-05-26 [1] CRAN (R 4.2.0)
#&gt;  nnet            7.3-18     2022-09-28 [1] CRAN (R 4.2.3)
#&gt;  np              0.60-17    2023-03-13 [1] CRAN (R 4.2.0)
#&gt;  numDeriv        2016.8-1.1 2019-06-06 [1] CRAN (R 4.2.0)
#&gt;  openssl         2.0.6      2023-03-09 [1] CRAN (R 4.2.0)
#&gt;  orcutt          2.3        2018-09-27 [1] CRAN (R 4.2.0)
#&gt;  pbkrtest        0.5.2      2023-01-19 [1] CRAN (R 4.2.0)
#&gt;  pillar          1.9.0      2023-03-22 [1] CRAN (R 4.2.0)
#&gt;  pkgconfig       2.0.3      2019-09-22 [1] CRAN (R 4.2.0)
#&gt;  pkgload         1.3.2      2022-11-16 [1] CRAN (R 4.2.0)
#&gt;  plm             2.6-2      2022-08-16 [1] CRAN (R 4.2.0)
#&gt;  praise          1.0.0      2015-08-11 [1] CRAN (R 4.2.0)
#&gt;  prettyunits     1.1.1      2020-01-24 [1] CRAN (R 4.2.0)
#&gt;  processx        3.8.0      2022-10-26 [1] CRAN (R 4.2.0)
#&gt;  progress        1.2.2      2019-05-16 [1] CRAN (R 4.2.0)
#&gt;  ps              1.7.4      2023-04-02 [1] CRAN (R 4.2.0)
#&gt;  purrr           1.0.1      2023-01-10 [1] CRAN (R 4.2.0)
#&gt;  quadprog        1.5-8      2019-11-20 [1] CRAN (R 4.2.0)
#&gt;  quantmod        0.4.20     2022-04-29 [1] CRAN (R 4.2.0)
#&gt;  quantreg        5.95       2023-04-08 [1] CRAN (R 4.2.0)
#&gt;  R6              2.5.1      2021-08-19 [1] CRAN (R 4.2.0)
#&gt;  ragg            1.2.5      2023-01-12 [1] CRAN (R 4.2.0)
#&gt;  rappdirs        0.3.3      2021-01-31 [1] CRAN (R 4.2.0)
#&gt;  rbibutils       2.2.13     2023-01-13 [1] CRAN (R 4.2.0)
#&gt;  RColorBrewer    1.1-3      2022-04-03 [1] CRAN (R 4.2.0)
#&gt;  Rcpp            1.0.10     2023-01-22 [1] CRAN (R 4.2.0)
#&gt;  RcppEigen       0.3.3.9.3  2022-11-05 [1] CRAN (R 4.2.0)
#&gt;  RCurl           1.98-1.10  2023-01-27 [1] CRAN (R 4.2.0)
#&gt;  rdd             0.57       2016-03-14 [1] CRAN (R 4.2.0)
#&gt;  rddtools        1.6.0      2022-01-10 [1] CRAN (R 4.2.0)
#&gt;  Rdpack          2.4        2022-07-20 [1] CRAN (R 4.2.0)
#&gt;  rdrobust        2.1.1      2022-12-05 [1] CRAN (R 4.2.0)
#&gt;  readr           2.1.4      2023-02-10 [1] CRAN (R 4.2.0)
#&gt;  readxl          1.4.2      2023-02-09 [1] CRAN (R 4.2.0)
#&gt;  rematch         1.0.1      2016-04-21 [1] CRAN (R 4.2.0)
#&gt;  rematch2        2.1.2      2020-05-01 [1] CRAN (R 4.2.0)
#&gt;  reprex          2.0.2      2022-08-17 [1] CRAN (R 4.2.0)
#&gt;  rlang           1.1.0      2023-03-14 [1] CRAN (R 4.2.0)
#&gt;  rmarkdown       2.21       2023-03-26 [1] CRAN (R 4.2.0)
#&gt;  rprojroot       2.0.3      2022-04-02 [1] CRAN (R 4.2.0)
#&gt;  rstudioapi      0.14       2022-08-22 [1] CRAN (R 4.2.0)
#&gt;  rvest           1.0.3      2022-08-19 [1] CRAN (R 4.2.0)
#&gt;  sandwich        3.0-2      2022-06-15 [1] CRAN (R 4.2.0)
#&gt;  sass            0.4.5      2023-01-24 [1] CRAN (R 4.2.0)
#&gt;  scales          1.2.1      2022-08-20 [1] CRAN (R 4.2.0)
#&gt;  selectr         0.4-2      2019-11-20 [1] CRAN (R 4.2.0)
#&gt;  SparseM         1.81       2021-02-18 [1] CRAN (R 4.2.0)
#&gt;  spatial         7.3-16     2023-01-23 [1] CRAN (R 4.2.3)
#&gt;  stabledist      0.7-1      2016-09-12 [1] CRAN (R 4.2.0)
#&gt;  stargazer       5.2.3      2022-03-04 [1] CRAN (R 4.2.3)
#&gt;  stringi         1.7.12     2023-01-11 [1] CRAN (R 4.2.0)
#&gt;  stringr         1.5.0      2022-12-02 [1] CRAN (R 4.2.0)
#&gt;  strucchange     1.5-3      2022-06-15 [1] CRAN (R 4.2.0)
#&gt;  survival        3.5-5      2023-03-12 [1] CRAN (R 4.2.0)
#&gt;  sys             3.4.1      2022-10-18 [1] CRAN (R 4.2.0)
#&gt;  systemfonts     1.0.4      2022-02-11 [1] CRAN (R 4.2.0)
#&gt;  testthat        3.1.7      2023-03-12 [1] CRAN (R 4.2.0)
#&gt;  textshaping     0.3.6      2021-10-13 [1] CRAN (R 4.2.0)
#&gt;  tibble          3.2.1      2023-03-20 [1] CRAN (R 4.2.0)
#&gt;  tidyr           1.3.0      2023-01-24 [1] CRAN (R 4.2.0)
#&gt;  tidyselect      1.2.0      2022-10-10 [1] CRAN (R 4.2.0)
#&gt;  tidyverse       2.0.0      2023-02-22 [1] CRAN (R 4.2.0)
#&gt;  timechange      0.2.0      2023-01-11 [1] CRAN (R 4.2.0)
#&gt;  timeDate        4022.108   2023-01-07 [1] CRAN (R 4.2.0)
#&gt;  timeSeries      4021.105   2022-10-16 [1] CRAN (R 4.2.0)
#&gt;  tinytex         0.44       2023-02-01 [1] CRAN (R 4.2.0)
#&gt;  TTR             0.24.3     2021-12-12 [1] CRAN (R 4.2.0)
#&gt;  tzdb            0.3.0      2022-03-28 [1] CRAN (R 4.2.0)
#&gt;  urca            1.3-3      2022-08-29 [1] CRAN (R 4.2.0)
#&gt;  utf8            1.2.3      2023-01-31 [1] CRAN (R 4.2.0)
#&gt;  uuid            1.1-0      2022-04-19 [1] CRAN (R 4.2.0)
#&gt;  vars            1.5-9      2023-03-22 [1] CRAN (R 4.2.0)
#&gt;  vctrs           0.6.1      2023-03-22 [1] CRAN (R 4.2.0)
#&gt;  viridisLite     0.4.1      2022-08-22 [1] CRAN (R 4.2.0)
#&gt;  vroom           1.6.1      2023-01-22 [1] CRAN (R 4.2.0)
#&gt;  waldo           0.4.0      2022-03-16 [1] CRAN (R 4.2.0)
#&gt;  withr           2.5.0      2022-03-03 [1] CRAN (R 4.2.0)
#&gt;  xfun            0.38       2023-03-24 [1] CRAN (R 4.2.0)
#&gt;  xml2            1.3.3      2021-11-30 [1] CRAN (R 4.2.0)
#&gt;  xts             0.13.0     2023-02-20 [1] CRAN (R 4.2.0)
#&gt;  yaml            2.3.7      2023-01-23 [1] CRAN (R 4.2.0)
#&gt;  zoo             1.8-11     2022-09-17 [1] CRAN (R 4.2.0)
#&gt; 
#&gt;  [1] /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/library
#&gt; 
#&gt; ───────────────────────────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
<div id="a-very-short-introduction-to-r-and-rstudio" class="section level2 hasAnchor" number="1.2">
<h2 class="hasAnchor"><span class="header-section-number">1.2</span> A Very Short Introduction to <tt>R</tt> and <em>RStudio</em><a href="#a-very-short-introduction-to-r-and-rstudio" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="figure" style="text-align: center">
<img src="images/rstudio.jpg" alt="RStudio: the four panes" width="80%" />
<p class="caption">
(#fig:unnamed-chunk-8)RStudio: the four panes
</p>
</div>
<div id="r-basics" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor"><tt>R</tt> Basics<a href="#r-basics" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As mentioned before, this book is not intended to be an introduction to <tt>R</tt> but a guide on how to use its capabilities for applications commonly encountered in undergraduate econometrics. Those having basic knowledge in <tt>R</tt> programming will feel comfortable starting with Chapter @ref(pt). This section, however, is meant for those who have not worked with <tt>R</tt> or <em>RStudio</em> before. If you at least know how to create objects and call functions, you can skip it. If you would like to refresh your skills or get a feeling for how to work with <em>RStudio</em>, keep reading.</p>
<p>First of all, start <em>RStudio</em> and open a new <tt>R</tt> script by selecting <em>File</em>, <em>New File</em>, <em>R Script</em>. In the editor pane, type</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span></span></code></pre></div>
<p>and click on the button labeled <em>Run</em> in the top right corner of the editor. By doing so, your line of code is sent to the console and the result of this operation should be displayed right underneath it. As you can see, <tt>R</tt> works just like a calculator. You can do all arithmetic calculations by using the corresponding operator (<tt>+</tt>, <tt>-</tt>, <tt>*</tt>, <tt>/</tt> or <tt>^</tt>). If you are not sure what the last operator does, try it out and check the results.</p>
</div>
<div id="vectors" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Vectors<a href="#vectors" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><tt>R</tt> is of course more sophisticated than that. We can work with variables or, more generally, objects. Objects are defined by using the assignment operator <tt>&lt;-</tt>. To create a variable named <tt>x</tt> which contains the value <tt>10</tt> type <code>x &lt;- 10</code> and click the button <em>Run</em> yet again. The new variable should have appeared in the environment pane on the top right. The console however did not show any results, because our line of code did not contain any call that creates output. When you now type <code>x</code> in the console and hit return, you ask <tt>R</tt> to show you the value of <tt>x</tt> and the corresponding value should be printed in the console.</p>
<p><tt>x</tt> is a scalar, a vector of length <span class="math inline">\(1\)</span>. You can easily create longer vectors by using the function <tt>c()</tt> (<em>c</em> is for “concatenate” or “combine”). To create a vector <tt>y</tt> containing the numbers <span class="math inline">\(1\)</span> to <span class="math inline">\(5\)</span> and print it, do the following.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>y</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1 2 3 4 5</span></span></code></pre></div>
<p>You can also create a vector of letters or words. For now just remember that characters have to be surrounded by quotes, else they will be parsed as object names.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>hello <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Hello&quot;</span>, <span class="st">&quot;World&quot;</span>)</span></code></pre></div>
<p>Here we have created a vector of length 2 containing the words <tt>Hello</tt> and <tt>World</tt>.</p>
<p>Do not forget to save your script! To do so, select <em>File</em>, <em>Save</em>.</p>
</div>
<div id="functions" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Functions<a href="#functions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You have seen the function <tt>c()</tt> that can be used to combine objects. In general, all function calls look the same: a function name is always followed by round parentheses. Often the parentheses include arguments.</p>
<p>Here are two simple examples.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate the vector `z`</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">5</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the mean of the enries in `z`</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(z)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3</span></span></code></pre></div>
<p>In the first line we use a function called <tt>seq()</tt> to create the exact same vector as we did in the previous section, calling it <tt>z</tt>. The function takes on the arguments <tt>from</tt>, <tt>to</tt> and <tt>by</tt> which should be self-explanatory.
The function <tt>mean()</tt> computes the arithmetic mean of its argument <tt>x</tt>. Since we pass the vector <tt>z</tt> as the argument <tt>x</tt>, the result is <tt>3</tt>!</p>
<p>If you are not sure which arguments a function expects, you may consult the function’s documentation. Let’s say we are not sure how the arguments required for <tt>seq()</tt> work. We then type <code>?seq</code> in the console. By hitting return the documentation page for that function pops up in the lower right pane of <em>RStudio</em>. In there, the section <em>Arguments</em> holds the information we seek. On the bottom of almost every help page you find examples on how to use the corresponding functions. This is very helpful for beginners and we recommend to look out for those.</p>
<p>Of course, all of the commands presented above also work in interactive widgets throughout the book. You may try them below.</p>
<iframe src="DCL/playground.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<!--chapter:end:index.Rmd-->
</div>
</div>
</div>
<div id="pt" class="section level1 hasAnchor" number="2">
<h1 class="hasAnchor"><span class="header-section-number">2</span> Probability Theory<a href="#pt" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter reviews some basic concepts of probability theory and demonstrates how they can be
applied in <tt>R</tt>.</p>
<p>Most of the statistical functionalities in base <tt>R</tt> are collected in the <tt>stats</tt> package. It provides simple functions which compute descriptive measures and facilitate computations involving a variety of probability distributions. It also contains more sophisticated routines that, e.g., enable the user to estimate a large number of models based on the same data or help to conduct extensive simulation studies. <tt>stats</tt> is part of the base distribution of <tt>R</tt>, meaning that it is installed by default so there is no need to run <code>install.packages("stats")</code> or <code>library("stats")</code>. Simply execute <code>library(help = "stats")</code> in the console to view the documentation and a complete list of all functions gathered in <tt>stats</tt>. For most packages a documentation that can be viewed within <em>RStudio</em> is available. Documentations can be invoked using the <tt>?</tt> operator, e.g., upon execution of <code>?stats</code> the documentation of the <tt>stats</tt> package is shown in the help tab of the bottom-right pane.</p>
<p>In what follows, our focus is on (some of) the probability distributions that are handled by <tt>R</tt> and show how to use the relevant functions to solve simple problems. Thereby, we refresh some core concepts of probability theory. Among other things, you will learn how to draw random numbers, how to compute densities, probabilities, quantiles and alike. As we shall see, it is very convenient to rely on these routines.</p>
<div id="random-variables-and-probability-distributions" class="section level2 hasAnchor" number="2.1">
<h2 class="hasAnchor"><span class="header-section-number">2.1</span> Random Variables and Probability Distributions<a href="#random-variables-and-probability-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let us briefly review some basic concepts of probability theory.</p>
<ul>
<li>The mutually exclusive results of a random process are called the <em>outcomes</em>. ‘Mutually exclusive’ means that only one of the possible outcomes can be observed.</li>
<li>We refer to the <em>probability</em> of an outcome as the proportion that the outcome occurs in the long run, that is, if the experiment is repeated many times.</li>
<li>The set of all possible outcomes of a random variable is called the <em>sample space</em>.</li>
<li>An <em>event</em> is a subset of the sample space and consists of one or more outcomes.</li>
</ul>
<p>These ideas are unified in the concept of a <em>random variable</em> which is a numerical summary of random outcomes. Random variables can be <em>discrete</em> or <em>continuous</em>.</p>
<ul>
<li>Discrete random variables have discrete outcomes, e.g., <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>.</li>
<li>A continuous random variable may take on a continuum of possible values.</li>
</ul>
<div id="probability-distributions-of-discrete-random-variables" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Probability Distributions of Discrete Random Variables<a href="#probability-distributions-of-discrete-random-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A typical example for a discrete random variable <span class="math inline">\(D\)</span> is the result of a dice
roll: in terms of a random experiment this is nothing but randomly selecting a
sample of size <span class="math inline">\(1\)</span> from a set of numbers which are mutually exclusive outcomes.
Here, the sample space is <span class="math inline">\(\{1,2,3,4,5,6\}\)</span> and we can think of many different
events, e.g., ‘the observed outcome lies between <span class="math inline">\(2\)</span> and <span class="math inline">\(5\)</span>’.</p>
<p>A basic function to draw random samples from a specified set of elements is the function <tt>sample()</tt>, see <code>?sample</code>. We can use it to simulate the random outcome of a dice roll. Let’s roll the dice!</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">1</span>) </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 4</span></span></code></pre></div>
<p>The probability distribution of a discrete random variable is the list of all possible values of the variable and their probabilities which sum to <span class="math inline">\(1\)</span>. The cumulative probability distribution function gives the probability that the random variable is less than or equal to a particular value.</p>
<p>For the dice roll, the probability distribution and the cumulative probability distribution are summarized in Table @ref(tab:pdist).</p>
<table>
<caption>
(#tab:pdist)PDF and CDF of a Dice Roll
</caption>
<tbody>
<tr>
<td style="text-align:left;">
Outcome
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
Probability
</td>
<td style="text-align:left;">
1/6
</td>
<td style="text-align:left;">
1/6
</td>
<td style="text-align:left;">
1/6
</td>
<td style="text-align:left;">
1/6
</td>
<td style="text-align:left;">
1/6
</td>
<td style="text-align:left;">
1/6
</td>
</tr>
<tr>
<td style="text-align:left;">
Cumulative Probability
</td>
<td style="text-align:left;">
1/6
</td>
<td style="text-align:left;">
2/6
</td>
<td style="text-align:left;">
3/6
</td>
<td style="text-align:left;">
4/6
</td>
<td style="text-align:left;">
5/6
</td>
<td style="text-align:left;">
1
</td>
</tr>
</tbody>
</table>
<p>We can easily plot both functions using <tt>R</tt>. Since the probability equals <span class="math inline">\(1/6\)</span> for each outcome, we set up the vector <tt>probability</tt> by using the function <tt>rep()</tt> which replicates a given value a specified number of times.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate the vector of probabilities </span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>probability <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="dv">6</span>) </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the probabilities </span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(probability,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;outcomes&quot;</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Probability Distribution&quot;</span>) </span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-15-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>For the cumulative probability distribution we need the cumulative probabilities, i.e., we need the cumulative sums of the vector <tt>probability</tt>. These sums can be computed using <tt>cumsum()</tt>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate the vector of cumulative probabilities </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>cum_probability <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(probability) </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the probabilites </span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cum_probability, </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;outcomes&quot;</span>, </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Cumulative Probability Distribution&quot;</span>) </span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-16-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="bernoulli-trials" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Bernoulli Trials<a href="#bernoulli-trials" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The set of elements from which <tt>sample()</tt> draws outcomes does not have to consist of numbers
only. We might as well simulate coin tossing with outcomes <span class="math inline">\(H\)</span> (heads) and <span class="math inline">\(T\)</span>
(tails).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;H&quot;</span>, <span class="st">&quot;T&quot;</span>), <span class="dv">1</span>) </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;T&quot;</span></span></code></pre></div>
<p>The result of a single coin toss is a <em>Bernoulli</em> distributed random variable, i.e., a variable with two possible distinct outcomes.</p>
<p>Imagine you are about to toss a coin <span class="math inline">\(10\)</span> times in a row and wonder how likely it
is to end up with a <span class="math inline">\(5\)</span> times heads. This is a typical example of what we call a <em>Bernoulli experiment</em> as it consists of <span class="math inline">\(n=10\)</span> Bernoulli trials that are independent of each other and we are interested in the likelihood of observing <span class="math inline">\(k=5\)</span> successes <span class="math inline">\(H\)</span> that occur with probability <span class="math inline">\(p=0.5\)</span> (assuming a fair coin) in each trial. Note that the order of the outcomes does not matter here.</p>
<p>It is a <a href="https://en.wikipedia.org/wiki/Binomial_distribution">well known result</a> that the number of successes <span class="math inline">\(k\)</span> in a Bernoulli experiment follows a binomial distribution. We denote this as</p>
<p><span class="math display">\[k \sim B(n,p).\]</span></p>
<p>The probability of observing <span class="math inline">\(k\)</span> successes in the experiment <span class="math inline">\(B(n,p)\)</span> is given by</p>
<p><span class="math display">\[f(k)=P(k)=\begin{pmatrix}n\\ k \end{pmatrix} \cdot p^k \cdot
(1-p)^{n-k}=\frac{n!}{k!(n-k)!} \cdot p^k \cdot (1-p)^{n-k}\]</span></p>
<p>with <span class="math inline">\(\begin{pmatrix}n\\ k \end{pmatrix}\)</span> the binomial coefficient.</p>
<p>In <tt>R</tt>, we can solve problems like the one stated above by means of the function <tt>dbinom()</tt> which calculates <span class="math inline">\(P(k\vert n, p)\)</span> the probability of the binomial distribution given the parameters <tt>x</tt> (<span class="math inline">\(k\)</span>),
<tt>size</tt> (<span class="math inline">\(n\)</span>), and <tt>prob</tt> (<span class="math inline">\(p\)</span>), see <code>?dbinom</code>. Let us compute <span class="math inline">\(P(k=5\vert n = 10, p = 0.5)\)</span> (we write this short as <span class="math inline">\(P(k=5)\)</span>.)</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">5</span>,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">size =</span> <span class="dv">10</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">prob =</span> <span class="fl">0.5</span>) </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.2460938</span></span></code></pre></div>
<p>We conclude that <span class="math inline">\(P(k=5)\)</span>, the probability of observing Head <span class="math inline">\(k=5\)</span> times when tossing a fair coin <span class="math inline">\(n=10\)</span> times is about <span class="math inline">\(24.6\%\)</span>.</p>
<p>Now assume we are interested in <span class="math inline">\(P(4 \leq k \leq 7)\)</span>, i.e., the probability of
observing <span class="math inline">\(4\)</span>, <span class="math inline">\(5\)</span>, <span class="math inline">\(6\)</span> or <span class="math inline">\(7\)</span> successes for <span class="math inline">\(B(10, 0.5)\)</span>. This may be computed by providing a vector as the argument <tt>x</tt> in our call of <tt>dbinom()</tt> and summing up using <tt>sum()</tt>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute P(4 &lt;= k &lt;= 7) using &#39;dbinom()&#39;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.7734375</span></span></code></pre></div>
<p>An alternative approach is to use <tt>pbinom()</tt>, the distribution function of the binomial distribution to compute <span class="math display">\[P(4 \leq k \leq 7) = P(k \leq 7) - P(k\leq3 ).\]</span></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute P(4 &lt;= k &lt;= 7) using &#39;pbinom()&#39;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>, <span class="at">q =</span> <span class="dv">7</span>) <span class="sc">-</span> <span class="fu">pbinom</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>, <span class="at">q =</span> <span class="dv">3</span>) </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.7734375</span></span></code></pre></div>
<p>The probability distribution of a discrete random variable is nothing but a list
of all possible outcomes that can occur and their respective probabilities. In the coin tossing example we have <span class="math inline">\(11\)</span> possible outcomes for <span class="math inline">\(k\)</span>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up vector of possible outcomes</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>k</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1]  0  1  2  3  4  5  6  7  8  9 10</span></span></code></pre></div>
<p>To visualize the probability distribution function of <span class="math inline">\(k\)</span> we may therefore do the following:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># assign the probabilities</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>probability <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="at">x =</span> k,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size =</span> <span class="dv">10</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the outcomes against their probabilities</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> k, </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> probability,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Probability Distribution Function&quot;</span>) </span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-22-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>In a similar fashion we may plot the cumulative distribution function of <span class="math inline">\(k\)</span> by
executing the following code chunk:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute cumulative probabilities</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">pbinom</span>(<span class="at">q =</span> k, </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">10</span>, </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the cumulative probabilities</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> k, </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> prob,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Cumulative Distribution Function&quot;</span>) </span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-23-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="expected-value-mean-and-variance" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Expected Value, Mean and Variance<a href="#expected-value-mean-and-variance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The expected value of a random variable is, loosely, the long-run average value of its outcomes when the number of repeated trials is large. For a discrete random variable, the
expected value is computed as a weighted average of its possible outcomes
whereby the weights are the related probabilities. This is formalized in Key
Concept 2.1.</p>
<div class = "keyconcept" <div class = "keyconcept" id="KC2.1"> 
<h3 class = "right"> Key Concept 2.1 </h3> 
<h3 class= "left"> Expected Value and the Mean </h3> 

<p> Suppose the random variable $Y$
takes on $k$ possible values, $y_1, \dots, y_k$, where $y_1$ denotes the first
value, $y_2$ denotes the second value, and so forth, and that the probability
that $Y$ takes on $y_1$ is $p_1$, the probability that $Y$ takes on $y_2$ is
$p_2$ and so forth. The expected value of $Y$, $E(Y)$ is defined as

$$ E(Y) = y_1 p_1 + y_2 p_2 + \cdots + y_k p_k = \sum_{i=1}^k y_i p_i $$

where the notation $\sum_{i=1}^k y_i p_i$ means "the sum of $y_i$ $p_i$ for $i$
running from $1$ to $k$". The expected value of $Y$ is also called the mean of $Y$
or the expectation of $Y$ and is denoted by $\mu_Y$.
</p> 
</div>
<p>In the dice example, the random variable, <span class="math inline">\(D\)</span> say, takes on <span class="math inline">\(6\)</span> possible values
<span class="math inline">\(d_1 = 1, d_2 = 2, \dots, d_6 = 6\)</span>. Assuming a fair dice, each of the <span class="math inline">\(6\)</span> outcomes occurs with a probability of <span class="math inline">\(1/6\)</span>. It is therefore easy to calculate the exact value of <span class="math inline">\(E(D)\)</span> by hand:</p>
<p><span class="math display">\[ E(D) = 1/6 \sum_{i=1}^6 d_i = 3.5 \]</span></p>
<p><span class="math inline">\(E(D)\)</span> is simply the average of the natural numbers from <span class="math inline">\(1\)</span> to <span class="math inline">\(6\)</span> since all weights <span class="math inline">\(p_i\)</span> are <span class="math inline">\(1/6\)</span>. This can be easily calculated using the function <tt>mean()</tt> which computes the arithmetic mean of a numeric vector.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute mean of natural numbers from 1 to 6</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3.5</span></span></code></pre></div>
<p>An example of sampling with replacement is rolling a dice three times in a row.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for reproducibility</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rolling a dice three times in a row</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">3</span>, <span class="at">replace =</span> T)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1 4 1</span></span></code></pre></div>
<p>Note that every call of <code>sample(1:6, 3, replace = T)</code> gives a different outcome since we draw with replacement at random. To allow you to reproduce the results of computations that involve random numbers, we will used <code>set.seed()</code> to set R’s random number generator to a specific state. You should check that it actually works: set the seed in your R session to 1 and verify that you obtain the same three random numbers!</p>

<div class="rmdknit">
<p>Sequences of random numbers generated by R are pseudo-random numbers, i.e., they are not “truly” random but approximate the properties of sequences of random numbers. Since this approximation is good enough for our purposes we refer to pseudo-random numbers as random numbers throughout this book.</p>
<p>In general, sequences of random numbers are generated by functions called “pseudo-random number generators” (PRNGs). The PRNG in R works by performing some operation on a deterministic value. Generally, this value is the previous number generated by the PRNG. However, the first time the PRNG is used, there is no previous value. A “seed” is the first value of a sequence of numbers — it initializes the sequence. Each seed value will correspond to a different sequence of values. In R a seed can be set using <tt>set.seed()</tt>.</p>
<p>This is convenient for us:</p>
If we provide the same seed twice, we get the same sequence of numbers twice. Thus, setting a seed before executing R code which involves random numbers makes the outcome reproducible!
</div>
<p>Of course we could also consider a much bigger number of trials, <span class="math inline">\(10000\)</span> say.
Doing so, it would be pointless to simply print the results to the console: by
default <tt>R</tt> displays up to <span class="math inline">\(1000\)</span> entries of large vectors and omits the
remainder (give it a try). Eyeballing the numbers does not reveal much.
Instead, let us calculate the sample average of the outcomes using <tt>mean()</tt> and see if the result comes close to the expected value <span class="math inline">\(E(D)=3.5\)</span>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for reproducibility</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the sample mean of 10000 dice rolls</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>           <span class="dv">10000</span>, </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">replace =</span> T))</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3.5138</span></span></code></pre></div>
<p>We find the sample mean to be fairly close to the expected value. This result will be discussed in Chapter @ref(RSATDOSA) in more detail.</p>
<p>Other frequently encountered measures are the variance and the standard deviation. Both are measures of the <em>dispersion</em> of a random variable.</p>
<div id="KC2.2" class="keyconcept">
<h3 class="right">
Key Concept 2.2
</h3>
<h3 class="left">
Variance and Standard Deviation
</h3>
<p>
The variance of the discrete random variable <span class="math inline">\(Y\)</span>, denoted <span class="math inline">\(\sigma^2_Y\)</span>, is
<span class="math display">\[ \sigma^2_Y = \text{Var}(Y) = E\left[(Y-\mu_y)^2\right] = \sum_{i=1}^k (y_i - \mu_y)^2 p_i \]</span>
The standard deviation of <span class="math inline">\(Y\)</span> is <span class="math inline">\(\sigma_Y\)</span>, the square root of the variance. The units of the standard deviation are the same as the units of <span class="math inline">\(Y\)</span>.
</p>
</div>
<p>The variance as defined in Key Concept 2.2, being a population quantity, <em>is not</em> implemented as a function in R. Instead we have the function <tt>var()</tt> which computes the <em>sample variance</em></p>
<p><span class="math display">\[ s^2_Y = \frac{1}{n-1} \sum_{i=1}^n (y_i - \overline{y})^2. \]</span></p>
<p>Remember that <span class="math inline">\(s^2_Y\)</span> is different from the so called <em>population variance</em> of a discrete random variable <span class="math inline">\(Y\)</span>,</p>
<p><span class="math display">\[ \text{Var}(Y) = \frac{1}{N} \sum_{i=1}^N (y_i - \mu_Y)^2 \]</span></p>
<p>since it measures how the <span class="math inline">\(n\)</span> observations in the sample are dispersed around the sample average <span class="math inline">\(\overline{y}\)</span>. Instead, <span class="math inline">\(\text{Var}(Y)\)</span> measures the dispersion of the whole population (<span class="math inline">\(N\)</span> members) around the population mean <span class="math inline">\(\mu_Y\)</span>. The difference becomes clear when we look at our dice rolling example. For <span class="math inline">\(D\)</span> we have</p>
<p><span class="math display">\[ \text{Var}(D) = 1/6 \sum_{i=1}^6 (d_i - 3.5)^2 = 2.92  \]</span>
which is obviously different from the result of <span class="math inline">\(s^2\)</span> as computed by <tt>var()</tt>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3.5</span></span></code></pre></div>
<p>The sample variance as computed by <tt>var()</tt> is an <em>estimator</em> of the population variance. You may check this using the widget below.</p>
<iframe src="DCL/playground.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="probability-distributions-of-continuous-random-variables" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Probability Distributions of Continuous Random Variables<a href="#probability-distributions-of-continuous-random-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Since a continuous random variable takes on a continuum of possible values, we
cannot use the concept of a probability distribution as used for discrete random
variables. Instead, the probability distribution of a continuous random variable
is summarized by its <em>probability density function</em> (PDF).</p>
<p>The cumulative probability distribution function (CDF) for a continuous random variable is defined just as in the discrete case. Hence, the CDF of a continuous random variables states the probability that the random variable is less than or equal to a particular value.</p>
<p>For completeness, we present revisions of Key Concepts 2.1 and 2.2 for the continuous case.</p>
<div id="KC2.3" class="keyconcept">
<h3 class="right">
Key Concept 2.3
</h3>
<h3 class="left">
Probabilities, Expected Value and Variance of a Continuous Random Variable
</h3>
<p>
<p>Let <span class="math inline">\(f_Y(y)\)</span> denote the probability density function of <span class="math inline">\(Y\)</span>. The probability that <span class="math inline">\(Y\)</span> falls between <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> where <span class="math inline">\(a &lt; b\)</span> is
<span class="math display">\[ P(a \leq Y \leq b) = \int_a^b f_Y(y) \mathrm{d}y. \]</span>
We further have that <span class="math inline">\(P(-\infty \leq Y \leq \infty) = 1\)</span> and therefore <span class="math inline">\(\int_{-\infty}^{\infty} f_Y(y) \mathrm{d}y = 1\)</span>.</p>
<p>As for the discrete case, the expected value of <span class="math inline">\(Y\)</span> is the probability weighted average of its values. Due to continuity, we use integrals instead of sums. The expected value of <span class="math inline">\(Y\)</span> is defined as</p>
<p><span class="math display">\[ E(Y) =  \mu_Y = \int y f_Y(y) \mathrm{d}y. \]</span></p>
<p>The variance is the expected value of <span class="math inline">\((Y - \mu_Y)^2\)</span>. We thus have</p>
<span class="math display">\[\text{Var}(Y) =  \sigma_Y^2 = \int (y - \mu_Y)^2 f_Y(y) \mathrm{d}y.\]</span>
</p>
</div>
<p>Let us discuss an example:</p>
<p>Consider the continuous random variable <span class="math inline">\(X\)</span> with PDF</p>
<p><span class="math display">\[ f_X(x) = \frac{3}{x^4}, x&gt;1. \]</span></p>
<ul>
<li>We can show analytically that the integral of <span class="math inline">\(f_X(x)\)</span> over the real line equals <span class="math inline">\(1\)</span>.</li>
</ul>
<p><span class="math display">\[\begin{align}
\int f_X(x) \mathrm{d}x =&amp;  \int_{1}^{\infty} \frac{3}{x^4} \mathrm{d}x \\
  =&amp; \lim_{t \rightarrow \infty} \int_{1}^{t} \frac{3}{x^4} \mathrm{d}x \\
  =&amp; \lim_{t \rightarrow \infty}  -x^{-3} \rvert_{x=1}^t \\
  =&amp; -\left(\lim_{t \rightarrow \infty}\frac{1}{t^3} - 1\right) \\
  =&amp; 1
\end{align}\]</span></p>
<ul>
<li>The expectation of <span class="math inline">\(X\)</span> can be computed as follows:</li>
</ul>
<p><span class="math display">\[\begin{align}
E(X) = \int x \cdot f_X(x) \mathrm{d}x =&amp;  \int_{1}^{\infty} x \cdot \frac{3}{x^4} \mathrm{d}x \\
  =&amp; - \frac{3}{2} x^{-2} \rvert_{x=1}^{\infty} \\
  =&amp; -\frac{3}{2} \left( \lim_{t \rightarrow \infty} \frac{1}{t^2} - 1 \right) \\
  =&amp; \frac{3}{2}
\end{align}\]</span></p>
<ul>
<li>Note that the variance of <span class="math inline">\(X\)</span> can be expressed as <span class="math inline">\(\text{Var}(X) = E(X^2) - E(X)^2\)</span>. Since <span class="math inline">\(E(X)\)</span> has been computed in the previous step, we seek <span class="math inline">\(E(X^2)\)</span>:</li>
</ul>
<p><span class="math display">\[\begin{align}
E(X^2)= \int x^2 \cdot f_X(x) \mathrm{d}x =&amp;  \int_{1}^{\infty} x^2 \cdot \frac{3}{x^4} \mathrm{d}x \\
  =&amp; -3 x^{-1} \rvert_{x=1}^{\infty} \\
  =&amp; -3 \left( \lim_{t \rightarrow \infty} \frac{1}{t} - 1 \right) \\
  =&amp; 3
\end{align}\]</span></p>
<p>So we have shown that the area under the curve equals one, that the expectation is <span class="math inline">\(E(X)=\frac{3}{2}\)</span> and we found the variance to be <span class="math inline">\(\text{Var}(X) = \frac{3}{4}\)</span>. However, this was tedious and, as we shall see, an analytic approach is not applicable for some PDFs, e.g., if integrals have no closed form solutions.</p>
<p>Luckily, <tt>R</tt> also enables us to easily find the results derived above. The tool we use for this is the function <tt>integrate()</tt>. First, we have to define the functions we want to calculate integrals for as <tt>R</tt> functions, i.e., the PDF <span class="math inline">\(f_X(x)\)</span> as well as the expressions <span class="math inline">\(x\cdot f_X(x)\)</span> and <span class="math inline">\(x^2\cdot f_X(x)\)</span>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define functions</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="dv">3</span> <span class="sc">/</span> x<span class="sc">^</span><span class="dv">4</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x <span class="sc">*</span> <span class="fu">f</span>(x)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">f</span>(x)</span></code></pre></div>
<p>Next, we use <tt>integrate()</tt> and set lower and upper limits of integration to <span class="math inline">\(1\)</span> and <span class="math inline">\(\infty\)</span> using arguments <tt>lower</tt> and <tt>upper</tt>. By default, <tt>integrate()</tt> prints the result along with an estimate of the approximation error to the console. However, the outcome is not a numeric value one can readily do further calculation with. In order to get only a numeric value of the integral, we need to use the <tt>$</tt> operator in conjunction with <tt>value</tt>. The <tt>$</tt> operator is used to extract elements by name from an object of type <tt>list</tt>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute area under the density curve</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>area <span class="ot">&lt;-</span> <span class="fu">integrate</span>(f, </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">lower =</span> <span class="dv">1</span>, </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">upper =</span> <span class="cn">Inf</span>)<span class="sc">$</span>value</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>area </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># compute E(X)</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>EX <span class="ot">&lt;-</span> <span class="fu">integrate</span>(g,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">lower =</span> <span class="dv">1</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">upper =</span> <span class="cn">Inf</span>)<span class="sc">$</span>value</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>EX</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.5</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co"># compute Var(X)</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>VarX <span class="ot">&lt;-</span> <span class="fu">integrate</span>(h,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">lower =</span> <span class="dv">1</span>,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">upper =</span> <span class="cn">Inf</span>)<span class="sc">$</span>value <span class="sc">-</span> EX<span class="sc">^</span><span class="dv">2</span> </span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>VarX</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.75</span></span></code></pre></div>
<p>Although there is a wide variety of distributions, the ones most often
encountered in econometrics are the normal, chi-squared, Student <span class="math inline">\(t\)</span> and <span class="math inline">\(F\)</span>
distributions. Therefore we will discuss some core <tt>R</tt> functions that allow to do
calculations involving densities, probabilities and quantiles of these
distributions.</p>
<p>Every probability distribution that <tt>R</tt> handles has four basic functions whose names consist of a prefix followed by a root name. As an example, take the normal distribution. The root name of all four functions associated with the normal distribution is <tt>norm</tt>. The four prefixes are</p>
<ul>
<li><tt>d</tt> for “density” - probability function / probability density function</li>
<li><tt>p</tt> for “probability” - cumulative distribution function</li>
<li><tt>q</tt> for “quantile” - quantile function (inverse cumulative distribution function)</li>
<li><tt>r</tt> for “random” - random number generator</li>
</ul>
<p>Thus, for the normal distribution we have the <tt>R</tt> functions <tt>dnorm()</tt>, <tt>pnorm()</tt>, <tt>qnorm()</tt> and <tt>rnorm()</tt>.</p>
</div>
<div id="the-normal-distribution" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">The Normal Distribution<a href="#the-normal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The probably most important probability distribution considered here is the normal
distribution. This is not least due to the special role of the standard normal distribution and the Central Limit Theorem which is to be treated shortly. Normal distributions are symmetric and bell-shaped. A normal distribution is characterized by its mean <span class="math inline">\(\mu\)</span> and its standard deviation <span class="math inline">\(\sigma\)</span>, concisely expressed by
<span class="math inline">\(\mathcal{N}(\mu,\sigma^2)\)</span>. The normal distribution has the PDF</p>
<p><span class="math display">\[\begin{align}
f(x) = \frac{1}{\sqrt{2 \pi} \sigma} \exp{-(x - \mu)^2/(2 \sigma^2)}.
\end{align}\]</span></p>
<p>For the standard normal distribution we have <span class="math inline">\(\mu=0\)</span> and <span class="math inline">\(\sigma=1\)</span>. Standard normal variates are often denoted by <span class="math inline">\(Z\)</span>. Usually, the standard normal PDF is denoted by <span class="math inline">\(\phi\)</span> and the standard normal CDF is denoted by <span class="math inline">\(\Phi\)</span>. Hence,
<span class="math display">\[ \phi(c) = \Phi&#39;(c) \ \ , \ \ \Phi(c) = P(Z \leq c) \ \ , \ \ Z \sim \mathcal{N}(0,1).\]</span> Note that the notation X <span class="math inline">\(\sim\)</span> Y reads as “X is distributed as Y”. In <tt>R</tt>, we can conveniently obtain densities of normal distributions using the function <tt>dnorm()</tt>. Let us draw a plot of the standard normal density function using <tt>curve()</tt> together with <tt>dnorm()</tt>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># draw a plot of the N(0,1) PDF</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x),</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="fl">3.5</span>),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>, </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">&quot;Standard Normal Density Function&quot;</span>) </span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-37-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>We can obtain the density at different positions by passing a vector to <tt>dnorm()</tt>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute density at x=-1.96, x=0 and x=1.96</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dnorm</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.96</span>, <span class="dv">0</span>, <span class="fl">1.96</span>))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.05844094 0.39894228 0.05844094</span></span></code></pre></div>
<p>Similar to the PDF, we can plot the standard normal CDF using <tt>curve()</tt>. We could use <tt>dnorm()</tt> for this but it is much more convenient to rely on <tt>pnorm()</tt>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the standard normal CDF</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">pnorm</span>(x), </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="fl">3.5</span>), </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;Probability&quot;</span>, </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">&quot;Standard Normal Cumulative Distribution Function&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-39-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>We can also use <tt>R</tt> to calculate the probability of events associated with a standard normal variate.</p>
<p>Let us say we are interested in <span class="math inline">\(P(Z \leq 1.337)\)</span>. For some continuous random variable <span class="math inline">\(Z\)</span> on <span class="math inline">\([-\infty,\infty]\)</span> with density <span class="math inline">\(g(x)\)</span> we would have to determine <span class="math inline">\(G(x)\)</span>, the anti-derivative of <span class="math inline">\(g(x)\)</span> so that</p>
<p><span class="math display">\[ P(Z \leq 1.337 ) = G(1.337) = \int_{-\infty}^{1.337} g(x) \mathrm{d}x.  \]</span></p>
<p>If <span class="math inline">\(Z \sim \mathcal{N}(0,1)\)</span>, we have <span class="math inline">\(g(x)=\phi(x)\)</span>. There is no analytic solution to the integral above. Fortunately, <tt>R</tt> offers good approximations. The first approach makes use of the function <tt>integrate()</tt> which allows to solve one-dimensional integration problems using a numerical method. For this, we first define the function we want to compute the integral of as an <tt>R</tt> function <tt>f</tt>. In our example, <tt>f</tt> is the standard normal density function and hence takes a single argument <tt>x</tt>. Following the definition of <span class="math inline">\(\phi(x)\)</span> we define <tt>f</tt> as</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the standard normal PDF as an R function</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">/</span>(<span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Let us check if this function computes standard normal densities by passing a vector.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define a vector of reals</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>quants <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.96</span>, <span class="dv">0</span>, <span class="fl">1.96</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># compute densities</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(quants)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.05844094 0.39894228 0.05844094</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co"># compare to the results produced by &#39;dnorm()&#39;</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(quants) <span class="sc">==</span> <span class="fu">dnorm</span>(quants)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE TRUE TRUE</span></span></code></pre></div>
<p>The results produced by <tt>f()</tt> are indeed equivalent to those given by <tt>dnorm()</tt>.</p>
<p>Next, we call <tt>integrate()</tt> on <tt>f()</tt> and specify the arguments <tt>lower</tt> and <tt>upper</tt>, the lower and upper limits of integration.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># integrate f()</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>(f, </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">lower =</span> <span class="sc">-</span><span class="cn">Inf</span>, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">upper =</span> <span class="fl">1.337</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.9093887 with absolute error &lt; 1.7e-07</span></span></code></pre></div>
<p>We find that the probability of observing <span class="math inline">\(Z \leq 1.337\)</span> is about <span class="math inline">\(90.94\%\)</span>.</p>
<p>A second and much more convenient way is to use the function <tt>pnorm()</tt>, the standard normal cumulative distribution function.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the probability using pnorm()</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">1.337</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.9093887</span></span></code></pre></div>
<p>The result matches the outcome of the approach using <tt>integrate()</tt>.</p>
<p>Let us discuss some further examples:</p>
<p>A commonly known result is that <span class="math inline">\(95\%\)</span> probability mass of a standard normal lies in the interval <span class="math inline">\([-1.96, 1.96]\)</span>, that is, in a distance of about <span class="math inline">\(2\)</span> standard deviations to the mean. We can easily confirm this by calculating <span class="math display">\[ P(-1.96 \leq Z \leq 1.96) = 1-2\times P(Z \leq -1.96) \]</span> due to symmetry of the standard normal PDF. Thanks to <tt>R</tt>, we can abandon the table of the standard normal CDF found in many other textbooks and instead solve this fast by using <tt>pnorm()</tt>.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the probability</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="fu">pnorm</span>(<span class="sc">-</span><span class="fl">1.96</span>)) </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.9500042</span></span></code></pre></div>
<p>To make statements about the probability of observing outcomes of <span class="math inline">\(Y\)</span> in some specific range it is more convenient when we standardize first as shown in Key Concept 2.4.</p>
<div id="KC2.4" class="keyconcept">
<h3 class="right">
Key Concept 2.4
</h3>
<h3 class="left">
Computing Probabilities Involving Normal Random Variables
</h3>
<p>
<p>Suppose <span class="math inline">\(Y\)</span> is normally distributed with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>: <span class="math display">\[Y
\sim \mathcal{N}(\mu, \sigma^2)\]</span> Then <span class="math inline">\(Y\)</span> is standardized by subtracting its mean and
dividing by its standard deviation: <span class="math display">\[ Z = \frac{Y -\mu}{\sigma} \]</span> Let <span class="math inline">\(c_1\)</span>
and <span class="math inline">\(c_2\)</span> denote two numbers whereby <span class="math inline">\(c_1 &lt; c_2\)</span> and further <span class="math inline">\(d_1 = (c_1 - \mu) / \sigma\)</span> and <span class="math inline">\(d_2 = (c_2 - \mu)/\sigma\)</span>. Then</p>
<p><span class="math display">\[\begin{align*}
P(Y \leq c_2) =&amp; \, P(Z \leq d_2) = \Phi(d_2), \\
P(Y \geq c_1) =&amp; \, P(Z \geq d_1) = 1 - \Phi(d_1), \\
P(c_1 \leq Y \leq c_2) =&amp; \, P(d_1 \leq Z \leq d_2) = \Phi(d_2) - \Phi(d_1).
\end{align*}\]</span></p>
</p>
</div>
<p>Now consider a random variable <span class="math inline">\(Y\)</span> with <span class="math inline">\(Y \sim \mathcal{N}(5, 25)\)</span>. <tt>R</tt> functions that handle the normal distribution can perform the standardization. If we are interested in <span class="math inline">\(P(3 \leq Y \leq 4)\)</span> we can use <tt>pnorm()</tt> and adjust for a mean and/or a standard deviation that deviate from <span class="math inline">\(\mu=0\)</span> and <span class="math inline">\(\sigma = 1\)</span> by specifying the arguments <tt>mean</tt> and <tt>sd</tt> accordingly. <strong>Attention</strong>: the argument <tt>sd</tt> requires the standard deviation, not the variance!</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">4</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">5</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="dv">3</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">5</span>) </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.07616203</span></span></code></pre></div>
<p>An extension of the normal distribution in a univariate setting is the multivariate normal distribution. The joint PDF of two random normal variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is given by</p>
<p><span class="math display">\[\begin{align}
\begin{split}
g_{X,Y}(x,y) =&amp; \, \frac{1}{2\pi\sigma_X\sigma_Y\sqrt{1-\rho_{XY}^2}} \\
\cdot &amp; \, \exp \left\{ \frac{1}{-2(1-\rho_{XY}^2)} \left[ \left( \frac{x-\mu_x}{\sigma_X} \right)^2 - 2\rho_{XY}\left( \frac{x-\mu_X}{\sigma_X} \right)\left( \frac{y-\mu_Y}{\sigma_Y} \right) + \left( \frac{y-\mu_Y}{\sigma_Y} \right)^2 \right]  \right\}.
\end{split} (\#eq:bivnorm)
\end{align}\]</span></p>
<p>Equation @ref(eq:bivnorm) contains the bivariate normal PDF. It is somewhat hard to gain insights from this complicated expression. Instead, let us consider the special case where <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are uncorrelated standard normal random variables with densities <span class="math inline">\(f_X(x)\)</span> and <span class="math inline">\(f_Y(y)\)</span> with joint normal distribution. We then have the parameters <span class="math inline">\(\sigma_X = \sigma_Y = 1\)</span>, <span class="math inline">\(\mu_X=\mu_Y=0\)</span> (due to marginal standard normality) and <span class="math inline">\(\rho_{XY}=0\)</span> (due to independence). The joint density of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> then becomes</p>
<p><span class="math display">\[ g_{X,Y}(x,y) = f_X(x) f_Y(y) = \frac{1}{2\pi} \cdot \exp \left\{ -\frac{1}{2} \left[x^2 + y^2 \right]  \right\}, \tag{2.2}  \]</span></p>
<p>the PDF of the bivariate standard normal distribution. The widget below provides an interactive three-dimensional plot of (<a href="#mjx-eqn-2.2">2.2</a>).</p>
<center>
<iframe scrolling="no" seamless="seamless" style="border:none" src="https://plot.ly/~mca_unidue/22.embed?width=550&amp;height=550?showlink=false/800/1200" width="600" height="400">
</iframe>
</center>
<p>By moving the cursor over the plot you can see that the density is rotationally invariant, i.e., the density at <span class="math inline">\((a, b)\)</span> solely depends on the distance of <span class="math inline">\((a, b)\)</span> to the origin: geometrically, regions of equal density are edges of concentric circles in the XY-plane, centered at <span class="math inline">\((\mu_X = 0, \mu_Y = 0)\)</span>.</p>
<p>The normal distribution has some remarkable characteristics. For example, for two jointly normally distribued variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, the conditional expectation function is linear: one can show that <span class="math display">\[ E(Y\vert X) = E(Y) + \rho \frac{\sigma_Y}{\sigma_X} (X - E(X)). \]</span> The interactive widget below shows standard bivariate normally distributed sample data along with the conditional expectation function <span class="math inline">\(E(Y\vert X)\)</span> and the marginal densities of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. All elements adjust accordingly as you vary the parameters.</p>
<center>
<iframe height="880" width="770" frameborder="0" scrolling="no" src="bivariatenormalv4.html">
</iframe>
</center>
<p><a name="chisquare"></a></p>
</div>
<div id="the-chi-squared-distribution" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">The Chi-Squared Distribution<a href="#the-chi-squared-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The chi-squared distribution is another distribution relevant in econometrics. It is often needed when testing special types of hypotheses frequently encountered when dealing with regression models.</p>
<p>The sum of <span class="math inline">\(M\)</span> squared independent standard normal distributed random variables follows a chi-squared distribution with <span class="math inline">\(M\)</span> degrees of freedom:</p>
<p><span class="math display">\[\begin{align*}
Z_1^2 + \dots + Z_M^2 = \sum_{m=1}^M Z_m^2 \sim \chi^2_M \ \ \text{with} \ \ Z_m \overset{i.i.d.}{\sim} \mathcal{N}(0,1) (\#eq:chisq)
\end{align*}\]</span></p>
<p>A <span class="math inline">\(\chi^2\)</span> distributed random variable with <span class="math inline">\(M\)</span> degrees of freedom has expectation <span class="math inline">\(M\)</span>, mode at <span class="math inline">\(M-2\)</span> for <span class="math inline">\(M \geq 2\)</span> and variance <span class="math inline">\(2 \cdot M\)</span>. For example, for</p>
<p><span class="math display">\[ Z_1,Z_2,Z_3 \overset{i.i.d.}{\sim} \mathcal{N}(0,1) \]</span></p>
<p>it holds that</p>
<p><span class="math display">\[ Z_1^2+Z_2^2+Z_3^2 \sim \chi^2_3. \tag{2.3} \]</span>
Using the code below, we can display the PDF and the CDF of a <span class="math inline">\(\chi^2_3\)</span> random variable in a single plot. This is achieved by setting the argument <tt>add = TRUE</tt> in the second call of <tt>curve()</tt>. Further we adjust limits of both axes using <tt>xlim</tt> and <tt>ylim</tt> and choose different colors to make both functions better distinguishable. The plot is completed by adding a legend with help of <tt>legend()</tt>.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the PDF</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">3</span>), </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">&quot;p.d.f. and c.d.f of Chi-Squared Distribution, M = 3&quot;</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># add the CDF to the plot</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">pchisq</span>(x, <span class="at">df =</span> <span class="dv">3</span>), </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">add =</span> <span class="cn">TRUE</span>, </span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="co"># add a legend to the plot</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, </span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">&quot;PDF&quot;</span>, <span class="st">&quot;CDF&quot;</span>), </span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), </span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-50-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Since the outcomes of a <span class="math inline">\(\chi^2_M\)</span> distributed random variable are always positive, the support of the related PDF and CDF is <span class="math inline">\(\mathbb{R}_{\geq0}\)</span>.</p>
<p>As expectation and variance depend (solely!) on the degrees of freedom, the distribution’s shape changes drastically if we vary the number of squared standard normals that are summed up. This relation is often depicted by overlaying densities for different <span class="math inline">\(M\)</span>, see the <a href="https://en.wikipedia.org/wiki/Chi-squared_distribution">Wikipedia Article</a>.</p>
<p>We reproduce this here by plotting the density of the <span class="math inline">\(\chi_1^2\)</span> distribution on the interval <span class="math inline">\([0,15]\)</span> with <tt>curve()</tt>. In the next step, we loop over degrees of freedom <span class="math inline">\(M=2,...,7\)</span> and add a density curve for each <span class="math inline">\(M\)</span> to the plot. We also adjust the line color for each iteration of the loop by setting <tt>col = M</tt>. At last, we add a legend that displays degrees of freedom and the associated colors.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the density for M=1</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">1</span>), </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>), </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>, </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">&quot;Chi-Square Distributed Random Variables&quot;</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co"># add densities for M=2,...,7 to the plot using a &#39;for()&#39; loop </span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (M <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>) {</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">dchisq</span>(x, <span class="at">df =</span> M),</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>), </span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">add =</span> T, </span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> M)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="co"># add a legend</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, </span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>       <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>), </span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span> , </span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span>, </span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;D.F.&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-51-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Increasing the degrees of freedom shifts the distribution to the right (the mode becomes larger) and increases the dispersion (the distribution’s variance grows).</p>
</div>
<div id="thetdist" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">The Student t Distribution<a href="#thetdist" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a name="tdist"></a></p>
<p>Let <span class="math inline">\(Z\)</span> be a standard normal variate, <span class="math inline">\(W\)</span> a <span class="math inline">\(\chi^2_M\)</span> random variable and further assume that <span class="math inline">\(Z\)</span> and <span class="math inline">\(W\)</span> are independent. Then it holds that</p>
<p><span class="math display">\[ \frac{Z}{\sqrt{W/M}} =:X \sim t_M \]</span>
and <span class="math inline">\(X\)</span> follows a <em>Student <span class="math inline">\(t\)</span> distribution</em> (or simply <span class="math inline">\(t\)</span> distribution) with <span class="math inline">\(M\)</span> degrees of freedom.</p>
<p>Similar to the <span class="math inline">\(\chi^2_M\)</span> distribution, the shape of a <span class="math inline">\(t_M\)</span> distribution depends on <span class="math inline">\(M\)</span>. <span class="math inline">\(t\)</span> distributions are symmetric, bell-shaped and look similar to a normal distribution, especially when <span class="math inline">\(M\)</span> is large. This is not a coincidence: for a sufficiently large <span class="math inline">\(M\)</span>, the <span class="math inline">\(t_M\)</span> distribution can be approximated by the standard normal distribution. This approximation works reasonably well for <span class="math inline">\(M\geq 30\)</span>. As we will illustrate later by means of a small simulation study, the <span class="math inline">\(t_{\infty}\)</span> distribution <em>is</em> the standard normal distribution.</p>
<p>A <span class="math inline">\(t_M\)</span> distributed random variable <span class="math inline">\(X\)</span> has an expectation if <span class="math inline">\(M&gt;1\)</span> and it has a variance if <span class="math inline">\(M&gt;2\)</span>.</p>
<p><span class="math display">\[\begin{align}
  E(X) =&amp; 0, \ M&gt;1 \\
  \text{Var}(X) =&amp; \frac{M}{M-2}, \ M&gt;2
\end{align}\]</span></p>
<p>Let us plot some <span class="math inline">\(t\)</span> distributions with different <span class="math inline">\(M\)</span> and compare them to the standard normal distribution.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the standard normal density</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x), </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>), </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">lty =</span> <span class="dv">2</span>, </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>, </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">&quot;Densities of t Distributions&quot;</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the t density for M=2</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dt</span>(x, <span class="at">df =</span> <span class="dv">2</span>), </span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>), </span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="dv">2</span>, </span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">add =</span> T)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the t density for M=4</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dt</span>(x, <span class="at">df =</span> <span class="dv">4</span>), </span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>), </span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="dv">3</span>, </span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">add =</span> T)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the t density for M=25</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dt</span>(x, <span class="at">df =</span> <span class="dv">25</span>), </span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>), </span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="dv">4</span>, </span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">add =</span> T)</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="co"># add a legend</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, </span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">&quot;N(0, 1)&quot;</span>, <span class="st">&quot;M=2&quot;</span>, <span class="st">&quot;M=4&quot;</span>, <span class="st">&quot;M=25&quot;</span>), </span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, </span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-52-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The plot illustrates what has been said in the previous paragraph: as the degrees of freedom increase, the shape of the <span class="math inline">\(t\)</span> distribution comes closer to that of a standard normal bell curve. Already for <span class="math inline">\(M=25\)</span> we find little difference to the standard normal density. If <span class="math inline">\(M\)</span> is small, we find the distribution to have heavier tails than a standard normal, i.e., it has a “fatter” bell shape.</p>
</div>
<div id="the-f-distribution" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">The F Distribution<a href="#the-f-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another ratio of random variables important to econometricians is the ratio of two independent <span class="math inline">\(\chi^2\)</span> distributed random variables that are divided by their degrees of freedom <span class="math inline">\(M\)</span> and <span class="math inline">\(n\)</span>. The quantity</p>
<p><span class="math display">\[ \frac{W/M}{V/n} \sim F_{M,n} \ \ \text{with} \ \ W \sim \chi^2_M \ \ , \ \ V \sim \chi^2_n \]</span>
follows an <span class="math inline">\(F\)</span> distribution with numerator degrees of freedom <span class="math inline">\(M\)</span> and denominator degrees of freedom <span class="math inline">\(n\)</span>, denoted <span class="math inline">\(F_{M,n}\)</span>. The distribution was first derived by George Snedecor but was named in honor of <a href="https://en.wikipedia.org/wiki/Ronald_Fisher">Sir Ronald Fisher</a>.</p>
<p>By definition, the support of both PDF and CDF of an <span class="math inline">\(F_{M,n}\)</span> distributed random variable is <span class="math inline">\(\mathbb{R}_{\geq0}\)</span>.</p>
<p>Say we have an <span class="math inline">\(F\)</span> distributed random variable <span class="math inline">\(Y\)</span> with numerator degrees of freedom <span class="math inline">\(3\)</span> and denominator degrees of freedom <span class="math inline">\(14\)</span> and are interested in <span class="math inline">\(P(Y \geq 2)\)</span>. This can be computed with help of the function <tt>pf()</tt>. By setting the argument <tt>lower.tail</tt> to <tt>FALSE</tt> we ensure that <tt>R</tt> computes <span class="math inline">\(1- P(Y \leq 2)\)</span>, i.e,the probability mass in the tail right of <span class="math inline">\(2\)</span>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pf</span>(<span class="dv">2</span>, <span class="at">df1 =</span> <span class="dv">3</span>, <span class="at">df2 =</span> <span class="dv">14</span>, <span class="at">lower.tail =</span> F)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.1603538</span></span></code></pre></div>
<p>We can visualize this probability by drawing a line plot of the related density and adding a color shading with <tt>polygon()</tt>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define coordinate vectors for vertices of the polygon</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="fl">0.01</span>), <span class="dv">10</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">df</span>(<span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="fl">0.01</span>), <span class="dv">3</span>, <span class="dv">14</span>), <span class="dv">0</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co"># draw density of F_{3, 14}</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">df</span>(x ,<span class="dv">3</span> ,<span class="dv">14</span>), </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>), </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>,</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">&quot;Density Function&quot;</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="co"># draw the polygon</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(x, y, <span class="at">col =</span> <span class="st">&quot;orange&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-54-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The <span class="math inline">\(F\)</span> distribution is related to many other distributions. An important special case encountered in econometrics arises if the denominator degrees of freedom are large such that the <span class="math inline">\(F_{M,n}\)</span> distribution can be approximated by the <span class="math inline">\(F_{M,\infty}\)</span> distribution which turns out to be simply the distribution of a <span class="math inline">\(\chi^2_M\)</span> random variable divided by its degrees of freedom <span class="math inline">\(M\)</span>,</p>
<p><span class="math display">\[ W/M \sim F_{M,\infty} \ \ , \ \ W \sim \chi^2_M. \]</span></p>
<iframe src="DCL/playground.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
</div>
<div id="RSATDOSA" class="section level2 hasAnchor" number="2.2">
<h2 class="hasAnchor"><span class="header-section-number">2.2</span> Random Sampling and the Distribution of Sample Averages<a href="#RSATDOSA" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To clarify the basic idea of random sampling, let us jump back to the dice rolling example:</p>
<p>Suppose we are rolling the dice <span class="math inline">\(n\)</span> times. This means we are interested in the outcomes of random <span class="math inline">\(Y_i, \ i=1,...,n\)</span> which are characterized by the same distribution. Since these outcomes are selected randomly, they are <em>random variables</em> themselves and their realizations will differ each time we draw a sample, i.e., each time we roll the dice <span class="math inline">\(n\)</span> times. Furthermore, each observation is randomly drawn from the same population, that is, the numbers from <span class="math inline">\(1\)</span> to <span class="math inline">\(6\)</span>, and their individual distribution is the same. Hence <span class="math inline">\(Y_1,\dots,Y_n\)</span> are identically distributed.</p>
<p>Moreover, we know that the value of any of the <span class="math inline">\(Y_i\)</span> does not provide any information on the remainder of the outcomes In our example, rolling a six as the first observation in our sample does not alter the distributions of <span class="math inline">\(Y_2,\dots,Y_n\)</span>: all numbers are equally likely to occur. This means that all <span class="math inline">\(Y_i\)</span> are also independently distributed. Thus <span class="math inline">\(Y_1,\dots,Y_n\)</span> are independently and identically distributed (<em>i.i.d.</em>).
The dice example uses this most simple sampling scheme. That is why it is called <em>simple random sampling</em>. This concept is summarized in Key Concept 2.5.</p>
<div id="KC2.5" class="keyconcept">
<h3 class="right">
Key Concept 2.5
</h3>
<h3 class="left">
Simple Random Sampling and i.i.d. Random Variables
</h3>
<p>
In simple random sampling, <span class="math inline">\(n\)</span> objects are drawn at random from a population. Each object is equally likely to end up in the sample. We denote the value of the random variable <span class="math inline">\(Y\)</span> for the <span class="math inline">\(i^{th}\)</span> randomly drawn object as <span class="math inline">\(Y_i\)</span>. Since all objects are equally likely to be drawn and the distribution of <span class="math inline">\(Y_i\)</span> is the same for all <span class="math inline">\(i\)</span>, the <span class="math inline">\(Y_i, \dots, Y_n\)</span> are independently and identically distributed (i.i.d.). This means the distribution of <span class="math inline">\(Y_i\)</span> is the same for all <span class="math inline">\(i=1,\dots,n\)</span> and <span class="math inline">\(Y_1\)</span> is distributed independently of <span class="math inline">\(Y_2, \dots, Y_n\)</span> and <span class="math inline">\(Y_2\)</span> is distributed independently of <span class="math inline">\(Y_1, Y_3, \dots, Y_n\)</span> and so forth.
</p>
</div>
<p>What happens if we consider functions of the sample data? Consider the example of rolling a dice two times in a row once again. A sample now consists of two independent random draws from the set <span class="math inline">\(\{1,2,3,4,5,6\}\)</span>. It is apparent that any function of these two random variables, e.g. their sum, is also random. Convince yourself by executing the code below several times.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">2</span>, <span class="at">replace =</span> T))</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 7</span></span></code></pre></div>
<p>Clearly, this sum, let us call it <span class="math inline">\(S\)</span>, is a random variable as it depends on randomly drawn summands. For this example, we can completely enumerate all outcomes and hence write down the theoretical probability distribution of our function of the sample data <span class="math inline">\(S\)</span>:</p>
<p>We face <span class="math inline">\(6^2=36\)</span> possible pairs. Those pairs are</p>
<p><span class="math display">\[\begin{align*}
  &amp;(1,1)    (1,2)   (1,3)   (1,4)   (1,5)   (1,6) \\
  &amp;(2,1)    (2,2)   (2,3)   (2,4)   (2,5)   (2,6) \\
  &amp;(3,1)    (3,2)   (3,3)   (3,4)   (3,5)   (3,6) \\
  &amp;(4,1)    (4,2)   (4,3)   (4,4)   (4,5)   (4,6) \\
  &amp;(5,1)    (5,2)   (5,3)   (5,4)   (5,5)   (5,6) \\
  &amp;(6,1)    (6,2)   (6,3)   (6,4)   (6,5)   (6,6)
\end{align*}\]</span></p>
<p>Thus, possible outcomes for <span class="math inline">\(S\)</span> are</p>
<p><span class="math display">\[ \left\{ 2,3,4,5,6,7,8,9,10,11,12 \right\} . \]</span>
Enumeration of outcomes yields</p>
<p><span class="math display">\[\begin{align}
  P(S) =
  \begin{cases}
    1/36, \ &amp; S = 2 \\
    2/36, \ &amp; S = 3 \\
    3/36, \ &amp; S = 4 \\
    4/36, \ &amp; S = 5 \\
    5/36, \ &amp; S = 6 \\
    6/36, \ &amp; S = 7 \\
    5/36, \ &amp; S = 8 \\
    4/36, \ &amp; S = 9 \\
    3/36, \ &amp; S = 10 \\
    2/36, \ &amp; S = 11 \\
    1/36, \ &amp; S = 12
  \end{cases}
\end{align}\]</span></p>
<p>We can also compute <span class="math inline">\(E(S)\)</span> and <span class="math inline">\(\text{Var}(S)\)</span> as stated in Key Concept 2.1 and Key Concept 2.2.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vector of outcomes</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Vector of probabilities</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>PS <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">5</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">/</span> <span class="dv">36</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Expectation of S</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>ES <span class="ot">&lt;-</span> <span class="fu">sum</span>(S <span class="sc">*</span> PS)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>ES</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 7</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Variance of S</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>VarS <span class="ot">&lt;-</span> <span class="fu">sum</span>((S <span class="sc">-</span> <span class="fu">c</span>(ES))<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> PS)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>VarS</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 5.833333</span></span></code></pre></div>
<p>So the distribution of <span class="math inline">\(S\)</span> is known. It is also evident that its distribution differs considerably from the marginal distribution, i.e,the distribution of a single dice roll’s outcome, <span class="math inline">\(D\)</span> . Let us visualize this using bar plots.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># divide the plotting area into one row with two columns</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the distribution of S</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(PS, </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;S&quot;</span>, </span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Probability&quot;</span>, </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">space =</span> <span class="dv">0</span>, </span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Sum of Two Dice Rolls&quot;</span>)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the distribution of D </span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>probability <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="dv">6</span>)</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(probability) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(probability, </span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), </span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;D&quot;</span>, </span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">space =</span> <span class="dv">0</span>, </span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Outcome of a Single Dice Roll&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-60-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Many econometric procedures deal with averages of sampled data. It is typically assumed that observations are drawn randomly from a larger, unknown population. As demonstrated for the sample function <span class="math inline">\(S\)</span>, computing an average of a random sample has the effect that the average is a random variable itself. This random variable in turn has a probability distribution, called the sampling distribution. Knowledge about the sampling distribution of the average is therefore crucial for understanding the performance of econometric procedures.</p>
<p>The <em>sample average</em> of a sample of <span class="math inline">\(n\)</span> observations <span class="math inline">\(Y_1, \dots, Y_n\)</span> is</p>
<p><span class="math display">\[ \overline{Y} = \frac{1}{n} \sum_{i=1}^n Y_i = \frac{1}{n} (Y_1 + Y_2 + \cdots + Y_n). \]</span>
<span class="math inline">\(\overline{Y}\)</span> is also called the sample mean.</p>
<div id="mean-and-variance-of-the-sample-mean" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Mean and Variance of the Sample Mean<a href="#mean-and-variance-of-the-sample-mean" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>suppose that <span class="math inline">\(Y_1,\dots,Y_n\)</span> are i.i.d. and denote <span class="math inline">\(\mu_Y\)</span> and <span class="math inline">\(\sigma_Y^2\)</span> as the mean and the variance of the <span class="math inline">\(Y_i\)</span>. Then we have that</p>
<p><span class="math display">\[ E(\overline{Y}) = E\left(\frac{1}{n} \sum_{i=1}^n Y_i \right) = \frac{1}{n} E\left(\sum_{i=1}^n Y_i\right) = \frac{1}{n} \sum_{i=1}^n E\left(Y_i\right) = \frac{1}{n} \cdot n \cdot \mu_Y = \mu_Y    \]</span>
and</p>
<p><span class="math display">\[\begin{align*}
  \text{Var}(\overline{Y}) =&amp; \text{Var}\left(\frac{1}{n} \sum_{i=1}^n Y_i \right) \\
  =&amp; \frac{1}{n^2} \sum_{i=1}^n \text{Var}(Y_i) + \frac{1}{n^2} \sum_{i=1}^n \sum_{j=1, j\neq i}^n \text{cov}(Y_i,Y_j) \\
  =&amp; \frac{\sigma^2_Y}{n} \\
  =&amp; \sigma_{\overline{Y}}^2.
\end{align*}\]</span></p>
<p>The second summand vanishes since <span class="math inline">\(\text{cov}(Y_i,Y_j)=0\)</span> for <span class="math inline">\(i\neq j\)</span> due to independence. Consequently, the standard deviation of the sample mean is given by <span class="math display">\[\sigma_{\overline{Y}} = \frac{\sigma_Y}{\sqrt{n}}.\]</span></p>
<p>It is worthwhile to mention that these results hold irrespective of the underlying distribution of the <span class="math inline">\(Y_i\)</span>.</p>
<div id="the-sampling-distribution-of-overliney-when-y-is-normally-distributed" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">The Sampling Distribution of <span class="math inline">\(\overline{Y}\)</span> when <span class="math inline">\(Y\)</span> Is Normally Distributed<a href="#the-sampling-distribution-of-overliney-when-y-is-normally-distributed" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If the <span class="math inline">\(Y_1,\dots,Y_n\)</span> are i.i.d. draws from a normal distribution with mean <span class="math inline">\(\mu_Y\)</span> and variance <span class="math inline">\(\sigma_Y^2\)</span>, the following holds for their sample average <span class="math inline">\(\overline{Y}\)</span>:</p>
<p><span class="math display">\[ \overline{Y} \sim \mathcal{N}(\mu_Y, \sigma_Y^2/n) \tag{2.4} \]</span></p>
<p>For example, if a sample <span class="math inline">\(Y_i\)</span> with <span class="math inline">\(i=1,\dots,10\)</span> is drawn from a standard normal distribution with mean <span class="math inline">\(\mu_Y = 0\)</span> and variance <span class="math inline">\(\sigma_Y^2=1\)</span> we have</p>
<p><span class="math display">\[ \overline{Y} \sim \mathcal{N}(0,0.1).\]</span></p>
<p>We can use <tt>R</tt>’s random number generation facilities to verify this result. The basic idea is to simulate outcomes of the true distribution of <span class="math inline">\(\overline{Y}\)</span> by repeatedly drawing random samples of 10 observation from the <span class="math inline">\(\mathcal{N}(0,1)\)</span> distribution and computing their respective averages. If we do this for a large number of repetitions, the simulated data set of averages should quite accurately reflect the theoretical distribution of <span class="math inline">\(\overline{Y}\)</span> if the theoretical result holds.</p>
<p>The approach sketched above is an example of what is commonly known as <em>Monte Carlo Simulation</em> or <em>Monte Carlo Experiment</em>. To perform this simulation in <tt>R</tt>, we proceed as follows:</p>
<ol style="list-style-type: decimal">
<li><p>Choose a sample size <tt>n</tt> and the number of samples to be drawn, <tt>reps</tt>.</p></li>
<li><p>Use the function <tt>replicate()</tt> in conjunction with <tt>rnorm()</tt> to draw <tt>n</tt> observations from the standard normal distribution <tt>rep</tt> times.</p>
<p><strong>Note</strong>: the outcome of <tt>replicate()</tt> is a matrix with dimensions <tt>n</tt> <span class="math inline">\(\times\)</span> <tt>rep</tt>. It contains the drawn samples as <em>columns</em>.</p></li>
<li><p>Compute sample means using <tt>colMeans()</tt>. This function computes the mean of each column, i.e., of each sample and returns a vector.</p></li>
</ol>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set sample size and number of samples</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># perform random sampling</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">replicate</span>(reps, <span class="fu">rnorm</span>(n)) <span class="co"># 10 x 10000 sample matrix</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co"># compute sample means</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>sample.avgs <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(samples)</span></code></pre></div>
<p>We then end up with a vector of sample averages. You can check the vector property of <tt>sample.avgs</tt>:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check that &#39;sample.avgs&#39; is a vector</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.vector</span>(sample.avgs) </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print the first few entries to the console</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sample.avgs)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -0.1045919  0.2264301  0.5308715 -0.2243476  0.2186909  0.2564663</span></span></code></pre></div>
<p>A straightforward approach to examine the distribution of univariate numerical data is to plot it as a histogram and compare it to some known or assumed distribution. By default, <tt>hist()</tt> will give us a frequency histogram, i.e., a bar chart where observations are grouped into ranges, also called bins. The ordinate reports the number of observations falling into each of the bins. Instead, we want it to report density estimates for comparison purposes. This is achieved by setting the argument <tt>freq = FALSE</tt>. The number of bins is adjusted by the argument <tt>breaks</tt>.</p>
<p>Using <tt>curve()</tt>, we overlay the histogram with a red line, the theoretical density of a <span class="math inline">\(\mathcal{N}(0, 0.1)\)</span> random variable. Remember to use the argument <tt>add = TRUE</tt> to add the curve to the current plot. Otherwise <tt>R</tt> will open a new graphic device and discard the previous plot!<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the density histogram</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample.avgs, </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.4</span>), </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span> , </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">freq =</span> F, </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">20</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># overlay the theoretical distribution of sample averages on top of the histogram</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="at">sd =</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(n)), </span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="st">&quot;2&quot;</span>, </span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">add =</span> T)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-63-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The sampling distribution of <span class="math inline">\(\overline{Y}\)</span> is indeed very close to that of a <span class="math inline">\(\mathcal{N}(0, 0.1)\)</span> distribution so the Monte Carlo simulation supports the theoretical claim.</p>
<p>Let us discuss another example where using simple random sampling in a simulation setup helps to verify a well known result. As discussed before, the <a href="#chisquare">Chi-squared</a> distribution with <span class="math inline">\(M\)</span> degrees of freedom arises as the distribution of the sum of <span class="math inline">\(M\)</span> independent squared standard normal distributed random variables.</p>
<p>To visualize the claim stated in equation (<a href="#mjx-eqn-2.3">2.3</a>), we proceed similarly as in the example before:</p>
<ol style="list-style-type: decimal">
<li>Choose the degrees of freedom, <tt>DF</tt>, and the number of samples to be drawn <tt>reps</tt>.</li>
<li>Draw <tt>reps</tt> random samples of size <tt>DF</tt> from the standard normal distribution using <tt>replicate()</tt>.</li>
<li>For each sample, square the outcomes and sum them up column-wise. Store the results.</li>
</ol>
<p>Again, we produce a density estimate for the distribution underlying our simulated data using a density histogram and overlay it with a line graph of the theoretical density function of the <span class="math inline">\(\chi^2_3\)</span> distribution.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of repetitions</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set degrees of freedom of a chi-Square Distribution</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>DF <span class="ot">&lt;-</span> <span class="dv">3</span> </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co"># sample 10000 column vectors à 3 N(0,1) R.V.S</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">replicate</span>(reps, <span class="fu">rnorm</span>(DF)) </span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co"># column sums of squares</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">colSums</span>(Z<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram of column sums of squares</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X, </span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">freq =</span> F, </span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">40</span>, </span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>, </span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="co"># add theoretical density</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dchisq</span>(x, <span class="at">df =</span> DF), </span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, </span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">add =</span> T)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-64-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="large-sample-approximations-to-sampling-distributions" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Large Sample Approximations to Sampling Distributions<a href="#large-sample-approximations-to-sampling-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sampling distributions as considered in the last section play an important role in the development of econometric methods. There are two main approaches in characterizing sampling distributions: an “exact” approach and an “approximate” approach.</p>
<p>The exact approach aims to find a general formula for the sampling distribution that holds for any sample size <span class="math inline">\(n\)</span>. We call this the <em>exact distribution</em> or <em>finite-sample distribution</em>. In the previous examples of dice rolling and normal variates, we have dealt with functions of random variables whose sample distributions are <em>exactly known</em> in the sense that we can write them down as analytic expressions. However, this is not always possible. For <span class="math inline">\(\overline{Y}\)</span>, result (<a href="#mjx-eqn-2.4">2.4</a>) tells us that normality of the <span class="math inline">\(Y_i\)</span> implies normality of <span class="math inline">\(\overline{Y}\)</span> (we demonstrated this for the special case of <span class="math inline">\(Y_i \overset{i.i.d.}{\sim} \mathcal{N}(0,1)\)</span> with <span class="math inline">\(n=10\)</span> using a simulation study that involves simple random sampling). Unfortunately, the <em>exact</em> distribution of <span class="math inline">\(\overline{Y}\)</span> is generally unknown and often hard to derive (or even untraceable) if we drop the assumption that the <span class="math inline">\(Y_i\)</span> have a normal distribution.</p>
<p>Therefore, as can be guessed from its name, the “approximate” approach aims to find an approximation to the sampling distribution where it is required that the sample size <span class="math inline">\(n\)</span> is large. A distribution that is used as a large-sample approximation to the sampling distribution is also called the <em>asymptotic distribution</em>. This is due to the fact that the asymptotic distribution <em>is</em> the sampling distribution for <span class="math inline">\(n \rightarrow \infty\)</span>, i.e., the approximation becomes exact if the sample size goes to infinity. However, the difference between the sampling distribution and the asymptotic distribution is negligible for moderate or even small samples sizes so that approximations using the asymptotic distribution are useful.</p>
<p>In this section we will discuss two well known results that are used to approximate sampling distributions and thus constitute key tools in econometric theory: the <em>law of large numbers</em> and the <em>central limit theorem</em>. The law of large numbers states that in large samples, <span class="math inline">\(\overline{Y}\)</span> is close to <span class="math inline">\(\mu_Y\)</span> with high probability. The central limit theorem says that the sampling distribution of the standardized sample average, that is, <span class="math inline">\((\overline{Y} - \mu_Y)/\sigma_{\overline{Y}}\)</span> is asymptotically normally distributed. It is particularly interesting that both results do not depend on the distribution of <span class="math inline">\(Y\)</span>. In other words, being unable to describe the complicated sampling distribution of <span class="math inline">\(\overline{Y}\)</span> if <span class="math inline">\(Y\)</span> is not normal, approximations of the latter using the central limit theorem simplify the development and applicability of econometric procedures enormously. This is a key component underlying the theory of statistical inference for regression models. Both results are summarized in Key Concept 2.6 and Key Concept 2.7.</p>
<div id="KC2.6" class="keyconcept">
<h3 class="right">
Key Concept 2.6
</h3>
<h3 class="left">
Convergence in Probability, Consistency and the Law of Large Numbers
</h3>
<p>
<p>The sample average <span class="math inline">\(\overline{Y}\)</span> converges in probability to <span class="math inline">\(\mu_Y\)</span>: <span class="math inline">\(\overline{Y}\)</span> is <em>consistent</em> for <span class="math inline">\(\mu_Y\)</span> if the probability that <span class="math inline">\(\overline{Y}\)</span> is in the range <span class="math inline">\((\mu_Y - \epsilon)\)</span> to <span class="math inline">\((\mu_Y + \epsilon)\)</span> becomes arbitrary close to <span class="math inline">\(1\)</span> as <span class="math inline">\(n\)</span> increases for any constant <span class="math inline">\(\epsilon &gt; 0\)</span>. We write this as</p>
<p><span class="math display">\[ P(\mu_Y-\epsilon \leq \overline{Y} \leq \mu_Y + \epsilon) \rightarrow 1, \, \epsilon &gt; 0 \text{ as } n\rightarrow\infty. \]</span></p>
<p>Consider the independently and identically distributed random variables <span class="math inline">\(Y_i, i=1,\dots,n\)</span> with expectation <span class="math inline">\(E(Y_i)=\mu_Y\)</span> and variance <span class="math inline">\(\text{Var}(Y_i)=\sigma^2_Y\)</span>. Under the condition that <span class="math inline">\(\sigma^2_Y&lt; \infty\)</span>, that is, large outliers are unlikely, the law of large numbers thus states that</p>
<p><span class="math display">\[ \overline{Y} \xrightarrow[]{p} \mu_Y. \]</span></p>
The following application simulates a large number of coin tosses (you may set the number of trials using the slider) with a fair coin and computes the fraction of heads observed for each additional toss. The result is a random path that, as stated by the law of large numbers, shows a tendency to approach the value of <span class="math inline">\(0.5\)</span> as <span class="math inline">\(n\)</span> grows.
<iframe height="570" width="800" frameborder="0" scrolling="no" src="CoinTossingWLLN.html"></iframe>
</p>
</div>
<p>The core statement of the law of large numbers is that under quite general conditions, the probability of obtaining a sample average <span class="math inline">\(\overline{Y}\)</span> that is close to <span class="math inline">\(\mu_Y\)</span> is high if we have a large sample size.</p>
<p>Consider the example of repeatedly tossing a coin where <span class="math inline">\(Y_i\)</span> is the result of the <span class="math inline">\(i^{th}\)</span> coin toss. <span class="math inline">\(Y_i\)</span> is a Bernoulli distributed random variable with <span class="math inline">\(p\)</span> the probability of observing head
<span class="math display">\[ P(Y_i) = \begin{cases} p, &amp; Y_i = 1 \\ 1-p, &amp; Y_i = 0 \end{cases} \]</span>
where <span class="math inline">\(p = 0.5\)</span> as we assume a fair coin. It is straightforward to show that</p>
<p><span class="math display">\[ \mu_Y = p = 0.5. \]</span>
Let <span class="math inline">\(R_n\)</span> denote the proportion of heads in the first <span class="math inline">\(n\)</span> tosses,</p>
<p><span class="math display">\[ R_n = \frac{1}{n} \sum_{i=1}^n Y_i. \tag{2.5}\]</span></p>
<p>According to the law of large numbers, the observed proportion of heads converges in probability to <span class="math inline">\(\mu_Y = 0.5\)</span>, the probability of tossing head in a <em>single</em> coin toss, <span class="math display">\[ R_n \xrightarrow[]{p} \mu_Y=0.5 \ \ \text{as} \ \ n \rightarrow \infty.\]</span> This result is illustrated by the interactive application in Key Concept 2.6. We now show how to replicate this using <tt>R</tt>.</p>
<p>The procedure is as follows:</p>
<ol style="list-style-type: decimal">
<li>Sample <tt>N</tt> observations from the Bernoulli distribution, e.g., using <tt>sample()</tt>.</li>
<li>Calculate the proportion of heads <span class="math inline">\(R_n\)</span> as in (<a href="#mjx-eqn-2.5">2.5</a>). A way to achieve this is to call <tt>cumsum()</tt> on the vector of observations <tt>Y</tt> to obtain its cumulative sum and then divide by the respective number of observations.</li>
</ol>
<p>We continue by plotting the path and also add a dashed line for the benchmark probability <span class="math inline">\(p = 0.5\)</span>.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set number of coin tosses and simulate</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">30000</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, N, <span class="at">replace =</span> T)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate R_n for 1:N</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(Y)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> S<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the path.</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(R, </span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>), </span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;n&quot;</span>, </span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;R_n&quot;</span>,</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Converging Share of Heads in Repeated Coin Tossing&quot;</span>)</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a dashed line for R_n = 0.5</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>, N), </span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>), </span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>, </span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">lty =</span> <span class="dv">2</span>, </span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-67-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>There are several things to be said about this plot.</p>
<ul>
<li><p>The blue graph shows the observed proportion of heads when tossing a coin <span class="math inline">\(n\)</span> times.</p></li>
<li><p>Since the <span class="math inline">\(Y_i\)</span> are random variables, <span class="math inline">\(R_n\)</span> is a random variate, too. The path depicted is only one of many possible realizations of <span class="math inline">\(R_n\)</span> as it is determined by the <span class="math inline">\(30000\)</span> observations sampled from the Bernoulli distribution.</p></li>
<li><p>If the number of coin tosses <span class="math inline">\(n\)</span> is small, the proportion of heads may be anything but close to its theoretical value, <span class="math inline">\(\mu_Y = 0.5\)</span>. However, as more and more observation are included in the sample we find that the path stabilizes in the neighborhood of <span class="math inline">\(0.5\)</span>. The average of multiple trials shows a clear tendency to converge to its expected value as the sample size increases, just as claimed by the law of large numbers.</p></li>
</ul>
<div id="KC2.7" class="keyconcept">
<h3 class="right">
Key Concept 2.7
</h3>
<h3 class="left">
The Central Limit Theorem
</h3>
<p>
<p>Suppose that <span class="math inline">\(Y_1,\dots,Y_n\)</span> are independently and identically distributed random variables with expectation <span class="math inline">\(E(Y_i)=\mu_Y\)</span> and variance <span class="math inline">\(\text{Var}(Y_i)=\sigma^2_Y\)</span> where <span class="math inline">\(0&lt;\sigma^2_Y&lt;\infty\)</span>.<br>
The Central Limit Theorem (CLT) states that, if the sample size <span class="math inline">\(n\)</span> goes to infinity, the distribution of the standardized sample average
<span class="math display">\[ \frac{\overline{Y} - \mu_Y}{\sigma_{\overline{Y}}} = \frac{\overline{Y} - \mu_Y}{\sigma_Y/\sqrt{n}} \ \]</span>
becomes arbitrarily well approximated by the standard normal distribution.</p>
<p>The application below demonstrates the CLT for the sample average of normally distributed random variables with mean <span class="math inline">\(5\)</span> and variance <span class="math inline">\(25^2\)</span>. You may check the following properties:</p>
<ul>
<li>The distribution of the sample average is normal.</li>
<li>As the sample size increases, the distribution of <span class="math inline">\(\overline{Y}\)</span> tightens around the true mean of <span class="math inline">\(5\)</span>.</li>
<li>The distribution of the standardized sample average is close to the standard normal distribution for large <span class="math inline">\(n\)</span>.</li>
</ul>
<iframe height="620" width="800" frameborder="0" scrolling="no" src="normaldisthistWLLN.html">
</iframe>
</p>
</div>
<p>According to the CLT, the distribution of the sample mean <span class="math inline">\(\overline{Y}\)</span> of the Bernoulli distributed random variables <span class="math inline">\(Y_i\)</span>, <span class="math inline">\(i=1,...,n\)</span>, is well approximated by the normal distribution with parameters <span class="math inline">\(\mu_Y=p=0.5\)</span> and <span class="math inline">\(\sigma^2_{Y} = p(1-p)/n = 0.25/n\)</span> for large <span class="math inline">\(n\)</span>. Consequently, for the standardized sample mean we conclude that <span class="math display">\[ \frac{\overline{Y} - 0.5}{0.5/\sqrt{n}} \tag{2.6}\]</span> should be well approximated by the standard normal distribution <span class="math inline">\(\mathcal{N}(0,1)\)</span>. We employ another simulation study to demonstrate this graphically. The idea is as follows.</p>
<p>Draw a large number of random samples, <span class="math inline">\(10000\)</span> say, of size <span class="math inline">\(n\)</span> from the Bernoulli distribution and compute the sample averages. Standardize the averages as shown in (<a href="#mjx-eqn-2.6">2.6</a>). Next, visualize the distribution of the generated standardized sample averages by means of a histogram and compare to the standard normal distribution. Repeat this for different sample sizes <span class="math inline">\(n\)</span> to see how increasing the sample size <span class="math inline">\(n\)</span> impacts the simulated distribution of the averages.</p>
<p>In <tt>R</tt>, realize this as follows:</p>
<ol style="list-style-type: decimal">
<li><p>We start by defining that the next four subsequently generated figures shall be drawn in a <span class="math inline">\(2\times2\)</span> array such that they can be easily compared. This is done by calling <code>par(mfrow = c(2, 2))</code> before generating the figures.</p></li>
<li><p>We define the number of repetitions <tt>reps</tt> as <span class="math inline">\(10000\)</span> and create a vector of sample sizes named <tt>sample.sizes</tt>. We consider samples of sizes <span class="math inline">\(5\)</span>, <span class="math inline">\(20\)</span>, <span class="math inline">\(75\)</span>, and <span class="math inline">\(100\)</span>.</p></li>
<li><p>Next, we combine two <tt>for()</tt> loops to simulate the data and plot the distributions. The inner loop generates <span class="math inline">\(10000\)</span> random samples, each consisting of <tt>n</tt> observations that are drawn from the Bernoulli distribution, and computes the standardized averages. The outer loop executes the inner loop for the different sample sizes <tt>n</tt> and produces a plot for each iteration.</p></li>
</ol>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subdivide the plot panel into a 2-by-2 array</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set the number of repetitions and the sample sizes</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>sample.sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">20</span>, <span class="dv">75</span>, <span class="dv">100</span>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for reproducibility</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="co"># outer loop (loop over the sample sizes)</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> sample.sizes) {</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    samplemean <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, reps) <span class="co">#initialize the vector of sample means</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    stdsamplemean <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, reps) <span class="co">#initialize the vector of standardized sample means</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="co"># inner loop (loop over repetitions)   </span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>reps) {</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>      samplemean[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>      stdsamplemean[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(n)<span class="sc">*</span>(<span class="fu">mean</span>(x) <span class="sc">-</span> <span class="fl">0.5</span>)<span class="sc">/</span><span class="fl">0.5</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="co"># plot histogram and overlay the N(0,1) density in every iteration    </span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hist</span>(stdsamplemean, </span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">freq =</span> <span class="cn">FALSE</span>, </span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">breaks =</span> <span class="dv">40</span>,</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>), </span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>), </span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="fu">paste</span>(<span class="st">&quot;n =&quot;</span>, n), </span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">curve</span>(<span class="fu">dnorm</span>(x), </span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>, </span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>  }  </span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-70-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>We see that the simulated sampling distribution of the standardized average tends to deviate strongly from the standard normal distribution if the sample size is small, e.g., for <span class="math inline">\(n=5\)</span> and <span class="math inline">\(n=10\)</span>. However as <span class="math inline">\(n\)</span> grows, the histograms approach the standard normal distribution. The approximation works quite well, see <span class="math inline">\(n=100\)</span>.</p>
<iframe src="DCL/playground.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
</div>
<div id="exercises-2" class="section level2 hasAnchor" number="2.3">
<h2 class="hasAnchor"><span class="header-section-number">2.3</span> Exercises<a href="#exercises-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="sampling" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">1. Sampling<a href="#sampling" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Suppose you are the lottery fairy in a weekly lottery, where <span class="math inline">\(6\)</span> out of <span class="math inline">\(49\)</span> <em>unique</em> numbers are drawn.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Draw the winning numbers for this week.</li>
</ul>
<iframe src="DCL/ex2_1.html" frameborder="0" scrolling="no" style="width:100%;height:360px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>You may use the function <tt>sample()</tt> to draw random numbers, see <tt>?sample</tt>.</p></li>
<li><p>The set of elements to be sampled from here is <span class="math inline">\(\{1,...,49\}\)</span>.</p></li>
</ul>
</div>
<div id="probability-density-function" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">2. Probability Density Function<a href="#probability-density-function" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider a random variable <span class="math inline">\(X\)</span> with probability density function (PDF)</p>
<p><span class="math display">\[f_X(x)=\frac{x}{4}e^{-x^2/8},\quad x\geq 0.\]</span></p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Define the PDF from above as a function <tt>f()</tt>. <tt>exp(a)</tt> computes <span class="math inline">\(e^a\)</span>.</p></li>
<li><p>Check whether the function you have defined is indeed a PDF.</p></li>
</ul>
<iframe src="DCL/ex2_2.html" frameborder="0" scrolling="no" style="width:100%;height:360px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>Use <tt>function(x) {…}</tt> to define a function which takes the argument <tt>x</tt>.</p></li>
<li><p>In order for <tt>f()</tt> to be a PDF, its integral over the whole domain has to equal 1: <span class="math inline">\(\int_0^\infty f_X(x)\mathrm{d}x=1\)</span>.</p></li>
<li><p>The function <tt>integrate()</tt> performs integration. You have to specify the function to be integrated as well as lower and upper limits of integration. These may be set to <span class="math inline">\([-\infty,\infty]\)</span> by setting the corresponding arguments to <tt>-Inf</tt> and <tt>Inf</tt>. You can access the numerical value of the computed integral by appending <tt>$value</tt>. See `?integral for a detailed description of the function.</p></li>
</ul>
</div>
<div id="expected-value-and-variance" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">3. Expected Value and Variance<a href="#expected-value-and-variance" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this exercise you have to compute the expected value and the variance of the random variable <span class="math inline">\(X\)</span> considered in the previous exercise.</p>
<p>The PDF <tt>f()</tt> from the previous exercise is available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Define a suitable function <tt>ex()</tt> which integrates to the expected value of <span class="math inline">\(X\)</span>.</p></li>
<li><p>Compute the expected value of <span class="math inline">\(X\)</span>. Store the result in <tt>expected_value</tt>.</p></li>
<li><p>Define a suitable function <tt>ex2()</tt> which integrates to the expected value of <span class="math inline">\(X^2\)</span>.</p></li>
<li><p>Compute the variance of <span class="math inline">\(X\)</span>. Store the result in <tt>variance</tt>.</p></li>
</ul>
<iframe src="DCL/ex2_3.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>The expected value of <span class="math inline">\(X\)</span> is defined as <span class="math inline">\(E(X)=\int_0^\infty xf_X(x)dx\)</span>.</p></li>
<li><p>The value of an integral computed by <tt>integrate()</tt> can be obtained via <tt>$value</tt>.</p></li>
<li><p>The variance of <span class="math inline">\(X\)</span> is defined as <span class="math inline">\(Var(X)=E(X^2)-E(X)^2\)</span>, where <span class="math inline">\(E(X^2)=\int_0^\infty x^2f_X(x)\mathrm{d}x\)</span>.</p></li>
</ul>
</div>
<div id="standard-normal-distribution-i" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">4. Standard Normal Distribution I<a href="#standard-normal-distribution-i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let <span class="math inline">\(Z\sim\mathcal{N}(0, 1)\)</span>.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Compute <span class="math inline">\(\phi(3)\)</span>, that is, the value of the standard normal density at <span class="math inline">\(c=3\)</span>.</li>
</ul>
<iframe src="DCL/ex2_4.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li>Values of <span class="math inline">\(\phi(\cdot)\)</span> can be computed using <tt>dnorm()</tt>. Note that by default <tt>dnorm()</tt> uses <tt>mean = 0</tt> and <tt>sd = 1</tt> so there is no need to set the corresponding arguments when you wish to obtain density values of the standard normal distribution.</li>
</ul>
</div>
<div id="standard-normal-distribution-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">5. Standard Normal Distribution II<a href="#standard-normal-distribution-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let <span class="math inline">\(Z\sim\mathcal{N}(0, 1)\)</span>.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Compute <span class="math inline">\(P(|Z|\leq 1.64)\)</span> by using the function <tt>pnorm()</tt>.</li>
</ul>
<iframe src="DCL/ex2_5.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p><span class="math inline">\(P(|Z|\leq z) = P(-z \leq Z \leq z)\)</span>.</p></li>
<li><p>Probabilities of the form <span class="math inline">\(P(a \leq Z \leq b)\)</span> can be computed as <span class="math inline">\(P(Z\leq b)-P(Z\leq a)=F_Z(b)-F_Z(a)\)</span> with <span class="math inline">\(F_Z(\cdot)\)</span> the cumulative distribution function (CDF) of <span class="math inline">\(Z\)</span>. Alternatively, you may exploit the symmetry of the standard normal distribution.</p></li>
</ul>
</div>
<div id="normal-distribution-i" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">6. Normal Distribution I<a href="#normal-distribution-i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let <span class="math inline">\(Y\sim\mathcal{N}(5, 25)\)</span>.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Compute the 99% quantile of the given distribution, i.e., find <span class="math inline">\(y\)</span> such that <span class="math inline">\(\Phi(\frac{y-5}{5})=0.99\)</span>.</li>
</ul>
<iframe src="DCL/ex2_6.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>You can compute quantiles of the normal distribution by using the function <tt>qnorm()</tt>.</p></li>
<li><p>Besides the quantile to be computed you have to specify the mean and the standard deviation of the distribution. This is done via the arguments <tt>mean</tt> and <tt>sd</tt>. Note that <tt>sd</tt> sets the standard deviation, not the variance!</p></li>
<li><p><tt>sqrt(a)</tt> returns the square root of the numeric argument <tt>a</tt>.</p></li>
</ul>
</div>
<div id="normal-distribution-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">7. Normal Distribution II<a href="#normal-distribution-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let <span class="math inline">\(Y\sim\mathcal{N}(2, 12)\)</span>.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Generate <span class="math inline">\(10\)</span> random numbers from this distribution.</li>
</ul>
<iframe src="DCL/ex2_7.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>You can use <tt>rnorm()</tt> to draw random numbers from a normal distribution.</p></li>
<li><p>Besides the number of draws you have to specify the mean and the standard deviation of the distribution. This can be done via the arguments <tt>mean</tt> and <tt>sd</tt>. Note that <tt>sd</tt> requires the standard deviation, not the variance!</p></li>
</ul>
</div>
<div id="chi-squared-distribution-i" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">8. Chi-squared Distribution I<a href="#chi-squared-distribution-i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let <span class="math inline">\(W\sim\chi^2_{10}\)</span>.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Plot the corresponding PDF using <tt>curve()</tt>. Specify the range of x-values as <span class="math inline">\([0,25]\)</span> via the argument <tt>xlim</tt>.</li>
</ul>
<iframe src="DCL/ex2_8.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p><tt>curve()</tt> expects a function and its parameters as arguments (here <tt>dchisq()</tt> and the degrees of freedom <tt>df</tt>).</p></li>
<li><p>The range of x-values in <tt>xlim</tt> can be passed as a vector of interval bounds.</p></li>
</ul>
</div>
<div id="chi-squared-distribution-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">9. Chi-squared Distribution II<a href="#chi-squared-distribution-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> be two independent normally distributed random variables with <span class="math inline">\(\mu=0\)</span> and <span class="math inline">\(\sigma^2=15\)</span>.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Compute <span class="math inline">\(P(X_1^2+X_2^2&gt;10)\)</span>.</li>
</ul>
<iframe src="DCL/ex2_9.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li>Note that <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are not <span class="math inline">\(\mathcal{N}(0,1)\)</span> but <span class="math inline">\(\mathcal{N}(0,15)\)</span> distributed. Hence you have to scale appropriately. Afterwards you can use <tt>pchisq()</tt> to compute the probability.</li>
<li>The argument <tt>lower.tail</tt> may be helpful.</li>
</ul>
</div>
<div id="student-t-distribution-i" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">10. Student t Distribution I<a href="#student-t-distribution-i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let <span class="math inline">\(X\sim t_{10000}\)</span> and <span class="math inline">\(Z\sim\mathcal{N}(0,1)\)</span>.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Compute the <span class="math inline">\(95\%\)</span> quantile of both distributions. What do you notice?</li>
</ul>
<iframe src="DCL/ex2_10.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>You may use <tt>qt()</tt> and <tt>qnorm()</tt> to compute quantiles of the given distributions.</p></li>
<li><p>For the <span class="math inline">\(t\)</span> distribution you have to specify the degrees of freedom <tt>df</tt>.</p></li>
</ul>
</div>
<div id="student-t-distribution-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">11. Student t Distribution II<a href="#student-t-distribution-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let <span class="math inline">\(X\sim t_1\)</span>. Once the session has initialized you will see the plot of the corresponding probability density function (PDF).</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Generate <span class="math inline">\(1000\)</span> random numbers from this distribution and assign them to the variable <tt>x</tt>.</p></li>
<li><p>Compute the sample mean of <tt>x</tt>. Can you explain the result?</p></li>
</ul>
<iframe src="DCL/ex2_11.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>You can use <tt>rt()</tt> to draw random numbers from a t distribution.</p></li>
<li><p>Note that the t distribution is fully determined through the degree(s) of freedom. Specify them via the argument <tt>df</tt>.</p></li>
<li><p>To compute the sample mean of a vector you can use the function <tt>mean()</tt>.</p></li>
</ul>
</div>
<div id="f-distribution-i" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">12. F Distribution I<a href="#f-distribution-i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let <span class="math inline">\(Y\sim F(10, 4)\)</span>.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Plot the quantile function of the given distribution using the function <tt>curve()</tt>.</li>
</ul>
<iframe src="DCL/ex2_12.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><tt>curve()</tt> expects the function with their respective parameters (here: degrees of freedom <tt>df1</tt> and <tt>df2</tt>) as an argument.</li>
</ul>
</div>
<div id="f-distribution-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">13. F Distribution II<a href="#f-distribution-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let <span class="math inline">\(Y\sim F(4,5)\)</span>.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Compute <span class="math inline">\(P(1&lt;Y&lt;10)\)</span> by integration of the PDF.</li>
</ul>
<iframe src="DCL/ex2_13.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>Besides providing the function to be integrated, you have to specify lower and upper bounds of integration.</p></li>
<li><p>The additional parameters of the distribution (here <tt>df1</tt> and <tt>df2</tt>) also have to be passed <em>inside</em> the call of <tt>integrate()</tt>.</p></li>
<li><p>The value of the integral can be obtained via <tt>$value</tt>.</p></li>
</ul>
</div>
<!--chapter:end:02-ch2.Rmd-->
</div>
</div>
<div id="arosur" class="section level1 hasAnchor" number="3">
<h1 class="hasAnchor"><span class="header-section-number">3</span> A Review of Statistics using R<a href="#arosur" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This section reviews important statistical concepts:</p>
<ul>
<li><p>Estimation of unknown population parameters</p></li>
<li><p>Hypothesis testing</p></li>
<li><p>Confidence intervals</p></li>
</ul>
<p>These methods are heavily used in econometrics. We will discuss them in the simple context of inference about an unknown population mean and discuss several applications in <tt>R</tt>. These <tt>R</tt> applications rely on the following packages which are not part of the base version of <tt>R</tt>:</p>
<ul>
<li><p><tt>readxl</tt> - allows to import data from <em>Excel</em> to <tt>R</tt>.</p></li>
<li><p><tt>dplyr</tt> - provides a flexible grammar for data manipulation.</p></li>
<li><p><tt>MASS</tt> - a collection of functions for applied statistics.</p></li>
</ul>
<p>Make sure these are installed before you go ahead and try to replicate the examples. The safest way to do so is by checking whether the following code chunk executes without any errors.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span></code></pre></div>
<div id="estimation-of-the-population-mean" class="section level2 hasAnchor" number="3.1">
<h2 class="hasAnchor"><span class="header-section-number">3.1</span> Estimation of the Population Mean<a href="#estimation-of-the-population-mean" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="KC3.1" class="keyconcept">
<h3 class="right">
Key Concept 3.1
</h3>
<h3 class="left">
Estimators and Estimates
</h3>
<p><em>Estimators</em> are functions of sample data drawn from an unknown population. <em>Estimates</em> are numeric values computed by estimators based on the sample data. Estimators are random variables because they are functions of <em>random</em> data. Estimates are nonrandom numbers.</p>
</div>
<p>Think of some economic variable, for example hourly earnings of college graduates, denoted by <span class="math inline">\(Y\)</span>. Suppose we are interested in <span class="math inline">\(\mu_Y\)</span> the mean of <span class="math inline">\(Y\)</span>. In order to exactly calculate <span class="math inline">\(\mu_Y\)</span> we would have to interview every working graduate in the economy. We simply cannot do this due to time and cost constraints. However, we can draw a random sample of <span class="math inline">\(n\)</span> i.i.d. observations <span class="math inline">\(Y_1, \dots, Y_n\)</span> and estimate <span class="math inline">\(\mu_Y\)</span> using one of the simplest estimators in the sense of Key Concept 3.1 one can think of, that is,</p>
<p><span class="math display">\[ \overline{Y} = \frac{1}{n} \sum_{i=1}^n Y_i, \]</span></p>
<p>the sample mean of <span class="math inline">\(Y\)</span>. Then again, we could use an even simpler estimator for <span class="math inline">\(\mu_Y\)</span>: the very first observation in the sample, <span class="math inline">\(Y_1\)</span>. Is <span class="math inline">\(Y_1\)</span> a good estimator? For now, assume that</p>
<p><span class="math display">\[ Y \sim \chi_{12}^2 \]</span></p>
<p>which is not too unreasonable as hourly income is non-negative and we expect many hourly earnings to be in a range of <span class="math inline">\(5\)</span> Euro to <span class="math inline">\(15\)</span> Euro. Moreover, it is common for income distributions to be skewed to the right — a property of the <span class="math inline">\(\chi^2_{12}\)</span> distribution.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the chi_12^2 distribution</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dchisq</span>(x, <span class="at">df=</span><span class="dv">12</span>), </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">from =</span> <span class="dv">0</span>, </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">to =</span> <span class="dv">40</span>, </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;density&quot;</span>, </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;hourly earnings in Euro&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-88-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>We now draw a sample of <span class="math inline">\(n=100\)</span> observations and take the first observation <span class="math inline">\(Y_1\)</span> as an estimate for <span class="math inline">\(\mu_Y\)</span></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for reproducibility</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sample from the chi_12^2 distribution, use only the first observation</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>rsamp <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">df =</span> <span class="dv">12</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>rsamp[<span class="dv">1</span>]</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 8.257893</span></span></code></pre></div>
<p>The estimate <span class="math inline">\(8.26\)</span> is not too far away from <span class="math inline">\(\mu_Y = 12\)</span> but it is somewhat intuitive that we could do better: the estimator <span class="math inline">\(Y_1\)</span> discards a lot of information and its variance is the population variance:</p>
<p><span class="math display">\[ \text{Var}(Y_1) = \text{Var}(Y) = 2 \cdot 12 = 24 \]</span></p>
<p>This brings us to the following question: What is a <em>good</em> estimator of an unknown parameter in the first place? This question is tackled in Key Concepts 3.2 and 3.3.</p>
<div id="KC3.2" class="keyconcept">
<h3 class="right">
Key Concept 3.2
</h3>
<h3 class="left">
Bias, Consistency and Efficiency
</h3>
<p>Desirable characteristics of an estimator include unbiasedness, consistency and efficiency.</p>
<p><strong>Unbiasedness:</strong><br />
If the mean of the sampling distribution of some estimator <span class="math inline">\(\hat\mu_Y\)</span> for the population mean <span class="math inline">\(\mu_Y\)</span> equals <span class="math inline">\(\mu_Y\)</span>,
<span class="math display">\[ E(\hat\mu_Y) = \mu_Y, \]</span>
the estimator is unbiased for <span class="math inline">\(\mu_Y\)</span>. The <em>bias</em> of <span class="math inline">\(\hat\mu_Y\)</span> then is <span class="math inline">\(0\)</span>:</p>
<p><span class="math display">\[ E(\hat\mu_Y) - \mu_Y = 0\]</span></p>
<p><strong>Consistency:</strong></p>
<p>We want the uncertainty of the estimator <span class="math inline">\(\mu_Y\)</span> to decrease as the number of observations in the sample grows. More precisely, we want the probability that the estimate <span class="math inline">\(\hat\mu_Y\)</span> falls within a small interval around the true value <span class="math inline">\(\mu_Y\)</span> to get increasingly closer to <span class="math inline">\(1\)</span> as <span class="math inline">\(n\)</span> grows. We write this as</p>
<p><span class="math display">\[ \hat\mu_Y \xrightarrow{p} \mu_Y. \]</span></p>
<p><strong>Variance and efficiency:</strong></p>
<p>We want the estimator to be efficient. Suppose we have two estimators, <span class="math inline">\(\hat\mu_Y\)</span> and <span class="math inline">\(\overset{\sim}{\mu}_Y\)</span> and for some given sample size <span class="math inline">\(n\)</span> it holds that</p>
<p><span class="math display">\[ E(\hat\mu_Y) = E(\overset{\sim}{\mu}_Y) = \mu_Y \]</span>
but
<span class="math display">\[\text{Var}(\hat\mu_Y) &lt; \text{Var}(\overset{\sim}{\mu}_Y).\]</span></p>
<p>We then prefer to use <span class="math inline">\(\hat\mu_Y\)</span> as it has a lower variance than <span class="math inline">\(\overset{\sim}{\mu}_Y\)</span>, meaning that <span class="math inline">\(\hat\mu_Y\)</span> is more <em>efficient</em> in using the information provided by the observations in the sample.</p>
</div>
</div>
<div id="potsm" class="section level2 hasAnchor" number="3.2">
<h2 class="hasAnchor"><span class="header-section-number">3.2</span> Properties of the Sample Mean<a href="#potsm" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div class="rmdknit">
<p>A more precise way to express consistency of an estimator <span class="math inline">\(\hat\mu\)</span> for a parameter <span class="math inline">\(\mu\)</span> is</p>
<p><span class="math display">\[ P(|\hat{\mu} - \mu|&lt;\epsilon) \xrightarrow[n \rightarrow \infty]{p} 1 \quad \text{for any}\quad\epsilon&gt;0.\]</span></p>
This expression says that the probability of observing a deviation from the true value <span class="math inline">\(\mu\)</span> that is smaller than some arbitrary <span class="math inline">\(\epsilon &gt; 0\)</span> converges to <span class="math inline">\(1\)</span> as <span class="math inline">\(n\)</span> grows. Consistency does not require unbiasedness.
</div>
<p>To examine properties of the sample mean as an estimator for the corresponding population mean, consider the following <tt>R</tt> example.</p>
<p>We generate a population <tt>pop</tt> consisting of observations <span class="math inline">\(Y_i\)</span>, <span class="math inline">\(i=1,\dots,10000\)</span> that origin from a normal distribution with mean <span class="math inline">\(\mu = 10\)</span> and variance <span class="math inline">\(\sigma^2 = 1\)</span>.</p>
<p>To investigate the behavior of the estimator <span class="math inline">\(\hat{\mu} = \bar{Y}\)</span> we can draw random samples from this population and calculate <span class="math inline">\(\bar{Y}\)</span> for each of them. This is easily done by making use of the function <tt>replicate()</tt>. The argument <tt>expr</tt> is evaluated <tt>n</tt> times. In this case we draw samples of sizes <span class="math inline">\(n=5\)</span> and <span class="math inline">\(n=25\)</span>, compute the sample means and repeat this exactly <span class="math inline">\(N=25000\)</span> times.</p>
<p>For comparison purposes we store results for the estimator <span class="math inline">\(Y_1\)</span>, the first observation in a sample for a sample of size <span class="math inline">\(5\)</span>, separately.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate a fictious population</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="dv">10</span>, <span class="dv">1</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sample from the population and estimate the mean</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>est1 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">expr =</span> <span class="fu">mean</span>(<span class="fu">sample</span>(<span class="at">x =</span> pop, <span class="at">size =</span> <span class="dv">5</span>)), <span class="at">n =</span> <span class="dv">25000</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>est2 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">expr =</span> <span class="fu">mean</span>(<span class="fu">sample</span>(<span class="at">x =</span> pop, <span class="at">size =</span> <span class="dv">25</span>)), <span class="at">n =</span> <span class="dv">25000</span>)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>fo <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">expr =</span> <span class="fu">sample</span>(<span class="at">x =</span> pop, <span class="at">size =</span> <span class="dv">5</span>)[<span class="dv">1</span>], <span class="at">n =</span> <span class="dv">25000</span>)</span></code></pre></div>
<p>Check that <tt>est1</tt> and <tt>est2</tt> are vectors of length <span class="math inline">\(25000\)</span>:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check if object type is vector</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.vector</span>(est1)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">is.vector</span>(est2)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># check length</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(est1)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 25000</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(est2)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 25000</span></span></code></pre></div>
<p>The code chunk below produces a plot of the sampling distributions of the estimators <span class="math inline">\(\bar{Y}\)</span> and <span class="math inline">\(Y_1\)</span> on the basis of the <span class="math inline">\(25000\)</span> samples in each case. We also plot the density function of the <span class="math inline">\(\mathcal{N}(10,1)\)</span> distribution.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot density estimate Y_1</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(fo), </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;green&quot;</span>, </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;estimates&quot;</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">&quot;Sampling Distributions of Unbiased Estimators&quot;</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co"># add density estimate for the distribution of the sample mean with n=5 to the plot</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(est1), </span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="co"># add density estimate for the distribution of the sample mean with n=25 to the plot</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(est2), </span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;red2&quot;</span>, </span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="co"># add a vertical line at the true parameter</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">10</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a><span class="co"># add N(10,1) density to the plot</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">10</span>), </span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">add =</span> T)</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a><span class="co"># add a legend</span></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;N(10,1)&quot;</span>,</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">expression</span>(Y[<span class="dv">1</span>]),</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">expression</span>(<span class="fu">bar</span>(Y) <span class="sc">~</span> n <span class="sc">==</span> <span class="dv">5</span>),</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">expression</span>(<span class="fu">bar</span>(Y) <span class="sc">~</span> n <span class="sc">==</span> <span class="dv">25</span>)</span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>                  ), </span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;green&quot;</span>, <span class="st">&quot;steelblue&quot;</span>, <span class="st">&quot;red2&quot;</span>),</span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-94-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>First, <em>all</em> sampling distributions (represented by the solid lines) are centered around <span class="math inline">\(\mu = 10\)</span>. This is evidence for the <em>unbiasedness</em> of <span class="math inline">\(Y_1\)</span>, <span class="math inline">\(\overline{Y}_{5}\)</span> and <span class="math inline">\(\overline{Y}_{25}\)</span>. Of course, the theoretical density <span class="math inline">\(\mathcal{N}(10,1)\)</span> is centered at <span class="math inline">\(10\)</span>, too.</p>
<p>Next, have a look at the spread of the sampling distributions. Several things are noteworthy:</p>
<ul>
<li><p>The sampling distribution of <span class="math inline">\(Y_1\)</span> (green curve) tracks the density of the <span class="math inline">\(\mathcal{N}(10,1)\)</span> distribution (black dashed line) pretty closely. In fact, the sampling distribution of <span class="math inline">\(Y_1\)</span> is the <span class="math inline">\(\mathcal{N}(10,1)\)</span> distribution. This is less surprising if you keep in mind that the <span class="math inline">\(Y_1\)</span> estimator does nothing but reporting an observation that is randomly selected from a population with <span class="math inline">\(\mathcal{N}(10,1)\)</span> distribution. Hence, <span class="math inline">\(Y_1 \sim \mathcal{N}(10,1)\)</span>. Note that this result does not depend on the sample size <span class="math inline">\(n\)</span>: the sampling distribution of <span class="math inline">\(Y_1\)</span> <em>is always</em> the population distribution, no matter how large the sample is. <span class="math inline">\(Y_1\)</span> is a good a estimate of <span class="math inline">\(\mu_Y\)</span>, but we can do better.</p></li>
<li><p>Both sampling distributions of <span class="math inline">\(\overline{Y}\)</span> show less dispersion than the sampling distribution of <span class="math inline">\(Y_1\)</span>. This means that <span class="math inline">\(\overline{Y}\)</span> has a lower variance than <span class="math inline">\(Y_1\)</span>. In view of Key Concepts 3.2 and 3.3, we find that <span class="math inline">\(\overline{Y}\)</span> is a more efficient estimator than <span class="math inline">\(Y_1\)</span>. In fact, this holds for all <span class="math inline">\(n&gt;1\)</span>.</p></li>
<li><p><span class="math inline">\(\overline{Y}\)</span> shows a behavior illustrating consistency (see Key Concept 3.2). The blue and the red densities are much more concentrated around <span class="math inline">\(\mu=10\)</span> than the green one. As the number of observations is increased from <span class="math inline">\(1\)</span> to <span class="math inline">\(5\)</span>, the sampling distribution tightens around the true parameter. Increasing the sample size to <span class="math inline">\(25\)</span>, this effect becomes more apparent. This implies that the probability of obtaining estimates that are close to the true value increases with <span class="math inline">\(n\)</span>. This is also reflected by the estimated values of the density function close to 10: the larger the sample size, the larger the value of the density.</p></li>
</ul>
<p>We encourage you to go ahead and modify the code. Try out different values for the sample size and see how the sampling distribution of <span class="math inline">\(\overline{Y}\)</span> changes!</p>
<div id="overliney-is-the-least-squares-estimator-of-mu_y" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor"><span class="math inline">\(\overline{Y}\)</span> is the Least Squares Estimator of <span class="math inline">\(\mu_Y\)</span><a href="#overliney-is-the-least-squares-estimator-of-mu_y" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Assume you have some observations <span class="math inline">\(Y_1,\dots,Y_n\)</span> on <span class="math inline">\(Y \sim \mathcal{N}(10,1)\)</span> (which is unknown) and would like to find an estimator <span class="math inline">\(m\)</span> that predicts the observations as well as possible. By good we mean to choose <span class="math inline">\(m\)</span> such that the total squared deviation between the predicted value and the observed values is small. Mathematically, this means we want to find an <span class="math inline">\(m\)</span> that minimizes</p>
<p><span class="math display">\[\begin{equation}
  \sum_{i=1}^n (Y_i - m)^2. (\#eq:sqm)
\end{equation}\]</span></p>
<p>Think of <span class="math inline">\(Y_i - m\)</span> as the mistake made when predicting <span class="math inline">\(Y_i\)</span> by <span class="math inline">\(m\)</span>. We could also minimize the sum of absolute deviations from <span class="math inline">\(m\)</span> but minimizing the sum of squared deviations is mathematically more convenient (and will lead to a different result). That is why the estimator we are looking for is called the <em>least squares estimator</em>. <span class="math inline">\(m = \overline{Y}\)</span>, the sample mean, is this estimator.</p>
<p>We can show this by generating a random sample and plotting @ref(eq:sqm) as a function of <span class="math inline">\(m\)</span>.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the function and vectorize it</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>sqm <span class="ot">&lt;-</span> <span class="cf">function</span>(m) {</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">sum</span>((y<span class="sc">-</span>m)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>sqm <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(sqm)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co"># draw random sample and compute the mean</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">10</span>, <span class="dv">1</span>)</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 10.1364</span></span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the objective function</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">sqm</span>(x), </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">from =</span> <span class="sc">-</span><span class="dv">50</span>, </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">to =</span> <span class="dv">70</span>,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;m&quot;</span>,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;sqm(m)&quot;</span>)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co"># add vertical line at mean(y)</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(y), </span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">2</span>, </span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="co"># add annotation at mean(y)</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">mean</span>(y), </span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> <span class="dv">0</span>, </span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">paste</span>(<span class="fu">round</span>(<span class="fu">mean</span>(y), <span class="dv">2</span>)))</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-96-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Notice that @ref(eq:sqm) is a quadratic function so that there is only one minimum. The plot shows that this minimum lies exactly at the sample mean of the sample data.</p>

<div class="rmdknit">
<p>Some <tt>R</tt> functions can only interact with functions that take a vector as an input and evaluate the function body on every entry of the vector, for example <tt>curve()</tt>. We call such functions vectorized functions and it is often a good idea to write vectorized functions yourself, although this is cumbersome in some cases. Having a vectorized function in <tt>R</tt> is never a drawback since these functions work on both single values and vectors.</p>
<p>Let us look at the function <tt>sqm()</tt>, which is non-vectorized:</p>
<p><tt>
sqm &lt;- function(m) {<br />
     sum((y-m)^2) #body of the function<br />
}
</tt></p>
<p>Providing, e.g., <tt>c(1,2,3)</tt> as the argument <tt>m</tt> would cause an error since then the operation <tt>y-m</tt> is invalid: the vectors <tt>y</tt> and <tt>m</tt> are of incompatible dimensions. This is why we cannot use <tt>sqm()</tt> in conjunction with <tt>curve()</tt>.</p>
Here <tt>Vectorize()</tt> comes into play. It generates a vectorized version of a non-vectorized function.
</div>
</div>
<div id="why-random-sampling-is-important" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Why Random Sampling is Important<a href="#why-random-sampling-is-important" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>So far, we assumed (sometimes implicitly) that the observed data <span class="math inline">\(Y_1, \dots, Y_n\)</span> are the result of a sampling process that satisfies the assumption of simple random sampling. This assumption often is fulfilled when estimating a population mean using <span class="math inline">\(\overline{Y}\)</span>. If this is not the case, estimates may be biased.</p>
<p>Let us fall back to <tt>pop</tt>, the fictive population of <span class="math inline">\(10000\)</span> observations and compute the population mean <span class="math inline">\(\mu_{\texttt{pop}}\)</span>:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the population mean of pop</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pop)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 9.992604</span></span></code></pre></div>
<p>Next we sample <span class="math inline">\(10\)</span> observations from <tt>pop</tt> with <tt>sample()</tt> and estimate <span class="math inline">\(\mu_{\texttt{pop}}\)</span> using <span class="math inline">\(\overline{Y}\)</span> repeatedly. However, now we use a sampling scheme that deviates from simple random sampling: instead of ensuring that each member of the population has the same chance to end up in a sample, we assign a higher probability of being sampled to the <span class="math inline">\(2500\)</span> smallest observations of the population by setting the argument <tt>prob</tt> to a suitable vector of probability weights:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate outcomes for the sample mean when the i.i.d. assumption fails</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>est3 <span class="ot">&lt;-</span>  <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">25000</span>, </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">expr =</span> <span class="fu">mean</span>(<span class="fu">sample</span>(<span class="at">x =</span> <span class="fu">sort</span>(pop), </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">size =</span> <span class="dv">10</span>, </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">prob =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">4</span>, <span class="dv">2500</span>), <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">7500</span>)))))</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the sample mean of the outcomes</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(est3)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 9.444113</span></span></code></pre></div>
<p>Next we plot the sampling distribution of <span class="math inline">\(\overline{Y}\)</span> for this non-i.i.d. case and compare it to the sampling distribution when the i.i.d. assumption holds.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sampling distribution of sample mean, i.i.d. holds, n=25</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(est2), </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">11</span>),</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;Estimates&quot;</span>,</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">&quot;When the i.i.d. Assumption Fails&quot;</span>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="co"># sampling distribution of sample mean, i.i.d. fails, n=25</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(est3),</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;red2&quot;</span>,</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="co"># add a legend</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">bar</span>(Y)[n <span class="sc">==</span> <span class="dv">25</span>]<span class="sc">~</span><span class="st">&quot;, i.i.d. fails&quot;</span>),</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">expression</span>(<span class="fu">bar</span>(Y)[n <span class="sc">==</span> <span class="dv">25</span>]<span class="sc">~</span><span class="st">&quot;, i.i.d. holds&quot;</span>)</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>                  ), </span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red2&quot;</span>, <span class="st">&quot;steelblue&quot;</span>),</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-99-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Here, the failure of the i.i.d. assumption implies that, on average, we <em>underestimate</em> <span class="math inline">\(\mu_Y\)</span> using <span class="math inline">\(\overline{Y}\)</span>: the corresponding distribution of <span class="math inline">\(\overline{Y}\)</span> is shifted to the left. In other words, <span class="math inline">\(\overline{Y}\)</span> is a <em>biased</em> estimator for <span class="math inline">\(\mu_Y\)</span> if the i.i.d. assumption does not hold.</p>
</div>
</div>
<div id="hypothesis-tests-concerning-the-population-mean" class="section level2 hasAnchor" number="3.3">
<h2 class="hasAnchor"><span class="header-section-number">3.3</span> Hypothesis Tests Concerning the Population Mean<a href="#hypothesis-tests-concerning-the-population-mean" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this section we briefly review concepts in hypothesis testing and discuss how to conduct hypothesis tests in <tt>R</tt>. We focus on drawing inferences about an unknown population mean.</p>
<div id="about-hypotheses-and-hypothesis-testing" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">About Hypotheses and Hypothesis Testing<a href="#about-hypotheses-and-hypothesis-testing" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In a significance test we want to exploit the information contained in a sample as evidence in favor or against a hypothesis. Essentially, hypotheses are simple questions that can be answered by ‘yes’ or ‘no’. In a hypothesis test we typically deal with two different hypotheses:</p>
<ul>
<li><p>The <em>null hypothesis</em>, denoted <span class="math inline">\(H_0\)</span>, is the hypothesis we are interested in testing.</p></li>
<li><p>There must be an <em>alternative hypothesis</em>, denoted <span class="math inline">\(H_1\)</span>, the hypothesis that is thought to hold if the null hypothesis is rejected.</p></li>
</ul>
<p>The null hypothesis that the population mean of <span class="math inline">\(Y\)</span> equals the value <span class="math inline">\(\mu_{Y,0}\)</span> is written as</p>
<p><span class="math display">\[ H_0: E(Y) = \mu_{Y,0}. \]</span></p>
<p>Often the alternative hypothesis chosen is the most general one,</p>
<p><span class="math display">\[ H_1: E(Y) \neq \mu_{Y,0}, \]</span></p>
<p>meaning that <span class="math inline">\(E(Y)\)</span> may be anything but the value under the null hypothesis. This is called a <em>two-sided</em> alternative.</p>
<p>For the sake of brevity, we only consider two-sided alternatives in the subsequent sections of this chapter.</p>
</div>
<div id="the-p-value" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">The p-Value<a href="#the-p-value" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Assume that the null hypothesis is <em>true</em>. The <span class="math inline">\(p\)</span>-value is the probability of drawing data and observing a corresponding test statistic that is at least as adverse to what is stated under the null hypothesis as the test statistic actually computed using the sample data.</p>
<p>In the context of the population mean and the sample mean, this definition can be stated mathematically in the following way:</p>
<p><span class="math display">\[\begin{equation}
p \text{-value} = P_{H_0}\left[ \lvert \overline{Y} - \mu_{Y,0} \rvert &gt; \lvert \overline{Y}^{act} - \mu_{Y,0} \rvert \right] (\#eq:pvalue)
\end{equation}\]</span></p>
<p>In @ref(eq:pvalue), <span class="math inline">\(\overline{Y}^{act}\)</span> is the sample mean for the data at hand (a value). In order to compute the <span class="math inline">\(p\)</span>-value as in @ref(eq:pvalue), knowledge about the sampling distribution of <span class="math inline">\(\overline{Y}\)</span> (a random variable) when the null hypothesis is true (the <em>null distribution</em>) is required. However, in most cases the sampling distribution and thus the null distribution of <span class="math inline">\(\overline{Y}\)</span> are unknown. Fortunately, the CLT (see Key Concept 2.7) allows for the large-sample approximation <span class="math display">\[ \overline{Y} \approx \mathcal{N}(\mu_{Y,0}, \, \sigma^2_{\overline{Y}}) \ \ , \ \ \sigma^2_{\overline{Y}} = \frac{\sigma_Y^2}{n}, \]</span> assuming the null hypothesis <span class="math inline">\(H_0: E(Y) = \mu_{Y, 0}\)</span> is true. With some algebra it follows for lage <span class="math inline">\(n\)</span> that</p>
<p><span class="math display">\[ \frac{\overline{Y} - \mu_{Y,0}}{\sigma_Y/\sqrt{n}} \sim \mathcal{N}(0,1). \]</span></p>
<p>So in large samples, the <span class="math inline">\(p\)</span>-value can be computed <em>without</em> knowledge of the exact sampling distribution of <span class="math inline">\(\overline{Y}\)</span> using the above normal approximation.</p>
</div>
<div id="calculating-the-p-value-when-the-standard-deviation-is-known" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Calculating the p-Value when the Standard Deviation is Known<a href="#calculating-the-p-value-when-the-standard-deviation-is-known" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For now, let us assume that <span class="math inline">\(\sigma_{\overline{Y}}\)</span> is known. Then, we can rewrite @ref(eq:pvalue) as</p>
<p><span class="math display">\[\begin{align}
p \text{-value} =&amp; \, P_{H_0}\left[ \left\lvert \frac{\overline{Y} - \mu_{Y,0}}{\sigma_{\overline{Y}}} \right\rvert &gt; \left\lvert \frac{\overline{Y}^{act} - \mu_{Y,0}}{\sigma_{\overline{Y}}} \right\rvert \right] \\
=&amp; \, 2 \cdot \Phi \left[ - \left\lvert \frac{\overline{Y}^{act} - \mu_{Y,0}}{\sigma_{\overline{Y}}}  \right\rvert\right].  (\#eq:pvaluenorm1)
\end{align}\]</span></p>
<p>The <span class="math inline">\(p\)</span>-value is the area in the tails of the <span class="math inline">\(\mathcal{N}(0,1)\)</span> distribution that lies beyond</p>
<p><span class="math display">\[\begin{equation}
\pm \left\lvert \frac{\overline{Y}^{act} - \mu_{Y,0}}{\sigma_{\overline{Y}}} \right\rvert (\#eq:pvaluenorm2)
\end{equation}\]</span></p>
<p>We now use <tt>R</tt> to visualize what is stated in @ref(eq:pvaluenorm1) and @ref(eq:pvaluenorm2). The next code chunk replicates Figure 3.1 of the book.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the standard normal density on the interval [-4,4]</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x),</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">&quot;Calculating a p-Value&quot;</span>,</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">yaxs =</span> <span class="st">&quot;i&quot;</span>,</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;z&quot;</span>,</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">axes =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="co"># add x-axis</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, </span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">at =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="dv">0</span>, <span class="fl">1.5</span>), </span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">padj =</span> <span class="fl">0.75</span>,</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="sc">-</span><span class="fu">frac</span>(<span class="fu">bar</span>(Y)<span class="sc">^</span><span class="st">&quot;act&quot;</span><span class="sc">~-</span><span class="er">~</span><span class="fu">bar</span>(mu)[Y,<span class="dv">0</span>], sigma[<span class="fu">bar</span>(Y)])),</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>                <span class="dv">0</span>,</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>                <span class="fu">expression</span>(<span class="fu">frac</span>(<span class="fu">bar</span>(Y)<span class="sc">^</span><span class="st">&quot;act&quot;</span><span class="sc">~-</span><span class="er">~</span><span class="fu">bar</span>(mu)[Y,<span class="dv">0</span>], sigma[<span class="fu">bar</span>(Y)]))))</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a><span class="co"># shade p-value/2 region in left tail</span></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">0.01</span>), <span class="sc">-</span><span class="fl">1.5</span>),</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">0.01</span>)),<span class="dv">0</span>), </span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>)</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a><span class="co"># shade p-value/2 region in right tail</span></span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fu">seq</span>(<span class="fl">1.5</span>, <span class="dv">6</span>, <span class="fl">0.01</span>), <span class="dv">6</span>),</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="fl">1.5</span>, <span class="dv">6</span>, <span class="fl">0.01</span>)), <span class="dv">0</span>), </span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-100-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="SVSSDASE" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Sample Variance, Sample Standard Deviation and Standard Error<a href="#SVSSDASE" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If <span class="math inline">\(\sigma^2_Y\)</span> is unknown, it must be estimated. This can be done using the sample variance</p>
<p><span class="math display">\[\begin{equation}
s_Y^2 = \frac{1}{n-1} \sum_{i=1}^n (Y_i - \overline{Y})^2.
\end{equation}\]</span></p>
<p>Furthermore</p>
<p><span class="math display">\[\begin{equation}
s_Y = \sqrt{\frac{1}{n-1} \sum_{i=1}^n (Y_i - \overline{Y})^2}
\end{equation}\]</span></p>
<p>is a suitable estimator for the standard deviation of <span class="math inline">\(Y\)</span>. In <tt>R</tt>, <span class="math inline">\(s_Y\)</span> is implemented in the function <tt>sd()</tt>, see <code>?sd</code>.</p>
<p>Using <tt>R</tt> we can illustrate that <span class="math inline">\(s_Y\)</span> is a consistent estimator for <span class="math inline">\(\sigma_Y\)</span>, that is</p>
<p><span class="math display">\[ s_Y \overset{p}{\longrightarrow} \sigma_Y. \]</span></p>
<p>The idea here is to generate a large number of samples <span class="math inline">\(Y_1,\dots,Y_n\)</span> where, <span class="math inline">\(Y\sim \mathcal{N}(10, 9)\)</span> say, estimate <span class="math inline">\(\sigma_Y\)</span> using <span class="math inline">\(s_Y\)</span> and investigate how the distribution of <span class="math inline">\(s_Y\)</span> changes as <span class="math inline">\(n\)</span> gets larger.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vector of sample sizes</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10000</span>, <span class="dv">5000</span>, <span class="dv">2000</span>, <span class="dv">1000</span>, <span class="dv">500</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sample observations, estimate using &#39;sd()&#39; and plot the estimated distributions</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>sq_y <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">expr =</span> <span class="fu">sd</span>(<span class="fu">rnorm</span>(n[<span class="dv">1</span>], <span class="dv">10</span>, <span class="dv">3</span>)))</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(sq_y),</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">expression</span>(<span class="st">&quot;Sampling Distributions o&quot;</span> <span class="sc">~</span> s[Y]),</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(s[y]),</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  sq_y <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">expr =</span> <span class="fu">sd</span>(<span class="fu">rnorm</span>(n[i], <span class="dv">10</span>, <span class="dv">3</span>)))</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">density</span>(sq_y), </span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> i, </span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a><span class="co"># add a legend</span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">expression</span>(n <span class="sc">==</span> <span class="dv">10000</span>),</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">expression</span>(n <span class="sc">==</span> <span class="dv">5000</span>),</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">expression</span>(n <span class="sc">==</span> <span class="dv">2000</span>),</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">expression</span>(n <span class="sc">==</span> <span class="dv">1000</span>),</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">expression</span>(n <span class="sc">==</span> <span class="dv">500</span>)), </span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-101-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The plot shows that the distribution of <span class="math inline">\(s_Y\)</span> tightens around the true value <span class="math inline">\(\sigma_Y = 3\)</span> as <span class="math inline">\(n\)</span> increases.</p>
<p>The function that estimates the standard deviation of an estimator is called the <em>standard error of the estimator</em>. Key Concept 3.4 summarizes the terminology in the context of the sample mean.</p>
<div id="KC3.4" class="keyconcept">
<h3 class="right">
Key Concept 3.4
</h3>
<h3 class="left">
The Standard Error of <span class="math inline">\(\overline{Y}\)</span>
</h3>
<p>Take an i.i.d. sample <span class="math inline">\(Y_1, \dots, Y_n\)</span>. The mean of <span class="math inline">\(Y\)</span> is consistently estimated by <span class="math inline">\(\overline{Y}\)</span>, the sample mean of the <span class="math inline">\(Y_i\)</span>. Since <span class="math inline">\(\overline{Y}\)</span> is a random variable, it has a sampling distribution with variance <span class="math inline">\(\frac{\sigma_Y^2}{n}\)</span>.</p>
<p>The standard error of <span class="math inline">\(\overline{Y}\)</span>, denoted <span class="math inline">\(SE(\overline{Y})\)</span> is an estimator of the standard deviation of <span class="math inline">\(\overline{Y}\)</span>:</p>
<p><span class="math display">\[ SE(\overline{Y}) = \hat\sigma_{\overline{Y}} = \frac{s_Y}{\sqrt{n}} \]</span></p>
<p>The caret (^) over <span class="math inline">\(\sigma\)</span> indicates that <span class="math inline">\(\hat\sigma_{\overline{Y}}\)</span> is an estimator for <span class="math inline">\(\sigma_{\overline{Y}}\)</span>.</p>
</div>
<p>As an example to underpin Key Concept 3.4, consider a sample of <span class="math inline">\(n=100\)</span> i.i.d. observations of the Bernoulli distributed variable <span class="math inline">\(Y\)</span> with success probability <span class="math inline">\(p=0.1\)</span>. Thus <span class="math inline">\(E(Y)=p=0.1\)</span> and <span class="math inline">\(\text{Var}(Y)=p(1-p)\)</span>. <span class="math inline">\(E(Y)\)</span> can be estimated by <span class="math inline">\(\overline{Y}\)</span>, which then has variance</p>
<p><span class="math display">\[ \sigma^2_{\overline{Y}} = p(1-p)/n = 0.0009 \]</span></p>
<p>and standard deviation</p>
<p><span class="math display">\[ \sigma_{\overline{Y}} = \sqrt{p(1-p)/n} = 0.03. \]</span></p>
<p>In this case the standard error of <span class="math inline">\(\overline{Y}\)</span> can be estimated by</p>
<p><span class="math display">\[ SE(\overline{Y}) = \sqrt{\overline{Y}(1-\overline{Y})/n}. \]</span></p>
<p>Let us check whether <span class="math inline">\(\overline{Y}\)</span> and <span class="math inline">\(SE(\overline{Y})\)</span> estimate the respective true values, on average.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># draw 10000 samples of size 100 and estimate the mean of Y and</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the standard error of the sample mean</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>mean_estimates <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">10000</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>se_estimates <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">10000</span>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>) {</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, </span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">100</span>,  </span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.1</span>),</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">replace =</span> T)</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  mean_estimates[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(s)</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  se_estimates[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(s) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">mean</span>(s)) <span class="sc">/</span> <span class="dv">100</span>)</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(mean_estimates)</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.10047</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(se_estimates)</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.02961587</span></span></code></pre></div>
<p>Both estimators seem to be unbiased for the true parameters. In fact, this is true for the sample mean, but not for <span class="math inline">\(SE(\overline{Y})\)</span>. However, both estimators are <em>consistent</em> for the true parameters.</p>
</div>
<div id="calculating-the-p-value-when-the-standard-deviation-is-unknown" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Calculating the p-value When the Standard Deviation is Unknown<a href="#calculating-the-p-value-when-the-standard-deviation-is-unknown" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When <span class="math inline">\(\sigma_Y\)</span> is unknown, the <span class="math inline">\(p\)</span>-value for a hypothesis test concerning <span class="math inline">\(\mu_Y\)</span> using <span class="math inline">\(\overline{Y}\)</span> can be computed by replacing <span class="math inline">\(\sigma_{\overline{Y}}\)</span> in @ref(eq:pvaluenorm1) by the standard error <span class="math inline">\(SE(\overline{Y}) = \hat\sigma_{\overline{Y}}\)</span>. Then,</p>
<p><span class="math display">\[ p\text{-value} = 2\cdot\Phi\left(-\left\lvert \frac{\overline{Y}^{act}-\mu_{Y,0}}{SE(\overline{Y})} \right\rvert \right). \]</span></p>
<p>This is easily done in <tt>R</tt>:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sample and estimate, compute standard error</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>samplemean_act <span class="ot">&lt;-</span> <span class="fu">mean</span>(</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.1</span>), </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">replace =</span> T, </span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">size =</span> <span class="dv">100</span>))</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>SE_samplemean <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(samplemean_act <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> samplemean_act) <span class="sc">/</span> <span class="dv">100</span>)</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="co"># null hypothesis</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>mean_h0 <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the p-value</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>pvalue <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(<span class="sc">-</span> <span class="fu">abs</span>(samplemean_act <span class="sc">-</span> mean_h0) <span class="sc">/</span> SE_samplemean)</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>pvalue</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.7492705</span></span></code></pre></div>
<p>Later in the book, we will encounter more convenient approaches to obtain <span class="math inline">\(t\)</span>-statistics and <span class="math inline">\(p\)</span>-values using <tt>R</tt>.</p>
</div>
<div id="the-t-statistic" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">The t-statistic<a href="#the-t-statistic" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In hypothesis testing, the standardized sample average</p>
<p><span class="math display">\[\begin{equation}
t = \frac{\overline{Y} - \mu_{Y,0}}{SE(\overline{Y})} (\#eq:tstat)
\end{equation}\]</span></p>
<p>is called a <span class="math inline">\(t\)</span>-statistic. This <span class="math inline">\(t\)</span>-statistic plays an important role in testing hypotheses about <span class="math inline">\(\mu_Y\)</span>. It is a prominent example of a test statistic.</p>
<p>Implicitly, we already have computed a <span class="math inline">\(t\)</span>-statistic for <span class="math inline">\(\overline{Y}\)</span> in the previous code chunk.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute a t-statistic for the sample mean</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>tstatistic <span class="ot">&lt;-</span> (samplemean_act <span class="sc">-</span> mean_h0) <span class="sc">/</span> SE_samplemean</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>tstatistic</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.3196014</span></span></code></pre></div>
<p>Using <tt>R</tt> we can illustrate that if <span class="math inline">\(\mu_{Y,0}\)</span> equals the true value, that is, if the null hypothesis is true, @ref(eq:tstat) is approximately <span class="math inline">\(\mathcal{N}(0,1)\)</span> distributed when <span class="math inline">\(n\)</span> is large.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare empty vector for t-statistics</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>tstatistics <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">10000</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set sample size</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate 10000 t-statistics</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>) {</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, </span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> n,  </span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.1</span>),</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">replace =</span> T)</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>  tstatistics[i] <span class="ot">&lt;-</span> (<span class="fu">mean</span>(s)<span class="sc">-</span><span class="fl">0.1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">var</span>(s)<span class="sc">/</span>n)</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>In the simulation above we estimate the variance of the <span class="math inline">\(Y_i\)</span> using <tt>var(s)</tt>. This is more general then <tt>mean(s)*(1-mean(s))</tt> since the latter requires that the data are Bernoulli distributed and that we know this.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot density and compare to N(0,1) density</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(tstatistics),</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;t-statistic&quot;</span>,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Estimated Distribution of the t-statistic when n=300&quot;</span>,</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co"># N(0,1) density (dashed)</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x), </span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">add =</span> T, </span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">lty =</span> <span class="dv">2</span>, </span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-108-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Judging from the plot, the normal approximation works reasonably well for the chosen sample size. This normal approximation has already been used in the definition of the <span class="math inline">\(p\)</span>-value, see @ref(eq:tstat).</p>
</div>
<div id="hypothesis-testing-with-a-prespecified-significance-level" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Hypothesis Testing with a Prespecified Significance Level<a href="#hypothesis-testing-with-a-prespecified-significance-level" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="KC3.5" class="keyconcept">
<h3 class="right">
Key Concept 3.5
</h3>
<h3 class="left">
The Terminology of Hypothesis Testing
</h3>
<p>In hypothesis testing, two types of mistakes are possible:</p>
<ol style="list-style-type: decimal">
<li><p>The null hypothesis <em>is</em> rejected although it is true (type-I-error)</p></li>
<li><p>The null hypothesis <em>is not</em> rejected although it is false (type-II-error)</p></li>
</ol>
<p>The <strong>significance level</strong> of the test is the probability to commit a type-I-error we are willing to accept in advance. E.g., using a prespecified significance level of <span class="math inline">\(0.05\)</span>, we reject the null hypothesis if and only if the <span class="math inline">\(p\)</span>-value is less than <span class="math inline">\(0.05\)</span>. The significance level is chosen before the test is conducted.</p>
<p>An equivalent procedure is to reject the null hypothesis if the observed test statistic is, in absolute value terms, larger than the <strong>critical value</strong> of the test statistic. The critical value is determined by the significance level chosen and defines two disjoint sets of values which are called <strong>acceptance region</strong> and <strong>rejection region</strong>. The acceptance region contains all values of the test statistic for which the test does not reject while the rejection region contains all the values for which the test does reject.</p>
<p>The <strong><span class="math inline">\(p\)</span>-value</strong> is the probability that, in repeated sampling under the same conditions a test statistic is observed that provides just as much evidence against the null hypothesis as the test statistic actually observed.</p>
<p>The actual probability that the test rejects the true null hypothesis is called the <strong>size of the test</strong>. In an ideal setting, the size does equals the significance level.</p>
<p>The probability that the test correctly rejects a false null hypothesis is called <strong>power</strong>.</p>
</div>
<p>Reconsider the <tt>pvalue</tt> computed further above:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check whether p-value &lt; 0.05</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p>The condition is not fulfilled so we do not reject the null hypothesis correctly.</p>
<p>When working with a <span class="math inline">\(t\)</span>-statistic instead, it is equivalent to apply the following rule:</p>
<p><span class="math display">\[ \text{Reject } H_0 \text{ if } \lvert t^{act} \rvert &gt; 1.96 \]</span></p>
<p>We reject the null hypothesis at the significance level of <span class="math inline">\(5\%\)</span> if the computed <span class="math inline">\(t\)</span>-statistic lies beyond the critical value of 1.96 in absolute value terms. <span class="math inline">\(1.96\)</span> is the <span class="math inline">\(0.975\)</span>-quantile of the standard normal distribution.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check the critical value</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.975</span>)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.959964</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check whether the null is rejected using the t-statistic computed further above</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abs</span>(tstatistic) <span class="sc">&gt;</span> <span class="fl">1.96</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p>Just like using the <span class="math inline">\(p\)</span>-value, we cannot reject the null hypothesis using the corresponding <span class="math inline">\(t\)</span>-statistic. Key Concept 3.6 summarizes the procedure of performing a two-sided hypothesis test about the population mean <span class="math inline">\(E(Y)\)</span>.</p>
<div id="KC3.6" class="keyconcept">
<h3 class="right">
Key Concept 3.6
</h3>
<h3 class="left">
Testing the Hypothesis <span class="math inline">\(E(Y) = \mu_{Y,0}\)</span> Against the Alternative <span class="math inline">\(E(Y) \neq \mu_{Y,0}\)</span>
</h3>
<ol style="list-style-type: decimal">
<li><p>Estimate <span class="math inline">\(\mu_{Y}\)</span> using <span class="math inline">\(\overline{Y}\)</span> and compute the <span class="math inline">\(SE(\overline{Y})\)</span>, standard error of <span class="math inline">\(\overline{Y}\)</span>.</p></li>
<li><p>Compute the <span class="math inline">\(t\)</span>-statistic.</p></li>
<li><p>Compute the <span class="math inline">\(p\)</span>-value and reject the null hypothesis at the <span class="math inline">\(5\%\)</span> level of significance if the <span class="math inline">\(p\)</span>-value is smaller than <span class="math inline">\(0.05\)</span> or, equivalently, if
<span class="math display">\[ \left\lvert t^{act} \right\rvert &gt; 1.96. \]</span></p></li>
</ol>
</div>
</div>
<div id="one-sided-alternatives" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">One-sided Alternatives<a href="#one-sided-alternatives" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sometimes we are interested in testing if the mean is bigger or smaller than some value hypothesized under the null. To stick to the book, take the presumed wage gap between well and less educated working individuals. Since we anticipate that such a differential exists, a relevant alternative (to the null hypothesis that there is no wage differential) is that well educated individuals earn more, i.e., that the average hourly wage for this group, <span class="math inline">\(\mu_Y\)</span> is <em>bigger</em> than <span class="math inline">\(\mu_{Y,0}\)</span>, the average wage of less educated workers which we assume to be known here for simplicity (Section @ref{cmfdp} discusses how to test the equivalence of to unknown population means).</p>
<p>This is an example of a <em>right-sided test</em> and the hypotheses pair is chosen to be</p>
<p><span class="math display">\[ H_0: \mu_Y = \mu_{Y,0} \ \ \text{vs} \ \ H_1: \mu_Y &gt; \mu_{Y,0}. \]</span></p>
<p>We reject the null hypothesis if the computed test-statistic is larger than the critical value <span class="math inline">\(1.64\)</span>, the <span class="math inline">\(0.95\)</span>-quantile of the <span class="math inline">\(\mathcal{N}(0,1)\)</span> distribution. This ensures that <span class="math inline">\(1-0.95=5\%\)</span> probability mass remains in the area to the right of the critical value. As before, we can visualize this in <tt>R</tt> using the function <tt>polygon()</tt>.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the standard normal density on the domain [-4,4]</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x),</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">&quot;Rejection Region of a Right-Sided Test&quot;</span>,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">yaxs =</span> <span class="st">&quot;i&quot;</span>,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;t-statistic&quot;</span>,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">axes =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="co"># add the x-axis</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, </span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">at =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="fl">1.64</span>, <span class="dv">4</span>), </span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">padj =</span> <span class="fl">0.5</span>,</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;&quot;</span>, <span class="dv">0</span>, <span class="fu">expression</span>(Phi<span class="sc">^-</span><span class="dv">1</span><span class="sc">~</span>(.<span class="dv">95</span>)<span class="sc">==</span><span class="fl">1.64</span>), <span class="st">&quot;&quot;</span>))</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a><span class="co"># shade the rejection region in the left tail</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">1.64</span>, <span class="fu">seq</span>(<span class="fl">1.64</span>, <span class="dv">4</span>, <span class="fl">0.01</span>), <span class="dv">4</span>),</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="fl">1.64</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)), <span class="dv">0</span>), </span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-115-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Analogously, for the left-sided test we have <span class="math display">\[H_0: \mu_Y = \mu_{Y,0} \ \ \text{vs.} \ \ H_1: \mu_Y &lt; \mu_{Y,0}.\]</span> The null is rejected if the observed test statistic falls short of the critical value which, for a test at the <span class="math inline">\(0.05\)</span> level of significance, is given by <span class="math inline">\(-1.64\)</span>, the <span class="math inline">\(0.05\)</span>-quantile of the <span class="math inline">\(\mathcal{N}(0,1)\)</span> distribution. <span class="math inline">\(5\%\)</span> probability mass lies to the left of the critical value.</p>
<p>It is straightforward to adapt the code chunk above to the case of a left-sided test. We only have to adjust the color shading and the tick marks.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the the standard normal density on the domain [-4,4]</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x),</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">&quot;Rejection Region of a Left-Sided Test&quot;</span>,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">yaxs =</span> <span class="st">&quot;i&quot;</span>,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;t-statistic&quot;</span>,</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">axes =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="co"># add x-axis</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, </span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">at =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="fl">1.64</span>, <span class="dv">4</span>), </span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">padj =</span> <span class="fl">0.5</span>,</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;&quot;</span>, <span class="dv">0</span>, <span class="fu">expression</span>(Phi<span class="sc">^-</span><span class="dv">1</span><span class="sc">~</span>(.<span class="dv">05</span>)<span class="sc">==-</span><span class="fl">1.64</span>), <span class="st">&quot;&quot;</span>))</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a><span class="co"># shade rejection region in right tail</span></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="fl">1.64</span>, <span class="fl">0.01</span>), <span class="sc">-</span><span class="fl">1.64</span>),</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="fl">1.64</span>, <span class="fl">0.01</span>)), <span class="dv">0</span>), </span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-116-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="confidence-intervals-for-the-population-mean" class="section level2 hasAnchor" number="3.4">
<h2 class="hasAnchor"><span class="header-section-number">3.4</span> Confidence Intervals for the Population Mean<a href="#confidence-intervals-for-the-population-mean" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As stressed before, we will never estimate the <em>exact</em> value of the population mean of <span class="math inline">\(Y\)</span> using a random sample. However, we can compute confidence intervals for the population mean. In general, a confidence interval for an unknown parameter is a recipe that, in repeated samples, yields intervals that contain the true parameter with a prespecified probability, the <em>confidence level</em>. Confidence intervals are computed using the information available in the sample. Since this information is the result of a random process, confidence intervals are random variables themselves.</p>
<p>Key Concept 3.7 shows how to compute confidence intervals for the unknown population mean <span class="math inline">\(E(Y)\)</span>.</p>
<div id="KC3.7" class="keyconcept">
<h3 class="right">
Key Concept 3.7
</h3>
<h3 class="left">
Confidence Intervals for the Population Mean
</h3>
<p>A <span class="math inline">\(95\%\)</span> confidence interval for <span class="math inline">\(\mu_Y\)</span> is a random variable that contains the true <span class="math inline">\(\mu_Y\)</span> in <span class="math inline">\(95\%\)</span> of all possible random samples. When <span class="math inline">\(n\)</span> is large we can use the normal approximation. Then, <span class="math inline">\(99\%\)</span>, <span class="math inline">\(95\%\)</span>, <span class="math inline">\(90\%\)</span> confidence intervals are</p>
<p><span class="math display">\[\begin{align}
&amp;99\%\text{ confidence interval for } \mu_Y = \left[ \overline{Y} \pm 2.58 \times SE(\overline{Y}) \right], \\
&amp;95\%\text{ confidence interval for } \mu_Y = \left[\overline{Y} \pm 1.96 \times SE(\overline{Y}) \right], \\
&amp;90\%\text{ confidence interval for } \mu_Y = \left[ \overline{Y} \pm 1.64 \times SE(\overline{Y}) \right].
\end{align}\]</span></p>
<p>These confidence intervals are sets of null hypotheses we cannot reject in a two-sided hypothesis test at the given level of confidence.</p>
<p>Now consider the following statements.</p>
<ol style="list-style-type: decimal">
<li><p>In repeated sampling, the interval
<span class="math display">\[ \left[ \overline{Y} \pm 1.96 \times SE(\overline{Y}) \right] \]</span>
covers the true value of <span class="math inline">\(\mu_Y\)</span> with a probability of <span class="math inline">\(95\%\)</span>.</p></li>
<li><p>We have computed <span class="math inline">\(\overline{Y} = 5.1\)</span> and <span class="math inline">\(SE(\overline{Y})=2.5\)</span> so the interval
<span class="math display">\[ \left[ 5.1  \pm 1.96 \times 2.5 \right] = \left[0.2,10\right] \]</span> covers the true value of <span class="math inline">\(\mu_Y\)</span> with a probability of <span class="math inline">\(95\%\)</span>.</p></li>
</ol>
<p>While 1. is right (this is in line with the definition above), 2. is wrong and none of your lecturers wants to read such a sentence in a term paper, written exam or similar, believe us.
The difference is that, while 1. is the definition of a random variable, 2. is one possible <em>outcome</em> of this random variable so there is no meaning in making any probabilistic statement about it. Either the computed interval does cover <span class="math inline">\(\mu_Y\)</span> <em>or</em> it does not!</p>
</div>
<p>In <tt>R</tt>, testing of hypotheses about the mean of a population on the basis of a random sample is very easy due to functions like <tt>t.test()</tt> from the <tt>stats</tt> package. It produces an object of type <tt>list</tt>. Luckily, one of the most simple ways to use <tt>t.test()</tt> is when you want to obtain a <span class="math inline">\(95\%\)</span> confidence interval for some population mean. We start by generating some random data and calling <tt>t.test()</tt> in conjunction with <tt>ls()</tt> to obtain a breakdown of the output components.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co"># generate some sample data</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>sampledata <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">10</span>, <span class="dv">10</span>)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="co"># check the type of the outcome produced by t.test</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="fu">t.test</span>(sampledata))</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;list&quot;</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="co"># display the list elements produced by t.test</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>(<span class="fu">t.test</span>(sampledata))</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;alternative&quot; &quot;conf.int&quot;    &quot;data.name&quot;   &quot;estimate&quot;    &quot;method&quot;     </span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6] &quot;null.value&quot;  &quot;p.value&quot;     &quot;parameter&quot;   &quot;statistic&quot;   &quot;stderr&quot;</span></span></code></pre></div>
<p>Though we find that many items are reported, at the moment we are only interested in computing a <span class="math inline">\(95\%\)</span> confidence set for the mean.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sampledata)<span class="sc">$</span><span class="st">&quot;conf.int&quot;</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]  9.306651 12.871096</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;conf.level&quot;)</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.95</span></span></code></pre></div>
<p>This tells us that the <span class="math inline">\(95\%\)</span> confidence interval is</p>
<p><span class="math display">\[ \left[9.31, 12.87\right]. \]</span></p>
<p>In this example, the computed interval obviously does cover the true <span class="math inline">\(\mu_Y\)</span> which we know to be <span class="math inline">\(10\)</span>.</p>
<p>Let us have a look at the whole standard output produced by <tt>t.test()</tt>.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sampledata)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  One Sample t-test</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  sampledata</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t = 12.346, df = 99, p-value &lt; 2.2e-16</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true mean is not equal to 0</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   9.306651 12.871096</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mean of x </span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  11.08887</span></span></code></pre></div>
<p>We see that <tt>t.test()</tt> does not only compute a <span class="math inline">\(95\%\)</span> confidence interval but automatically conducts a two-sided significance test of the hypothesis <span class="math inline">\(H_0: \mu_Y = 0\)</span> at the level of <span class="math inline">\(5\%\)</span> and reports relevant parameters thereof: the alternative hypothesis, the estimated mean, the resulting <span class="math inline">\(t\)</span>-statistic, the degrees of freedom of the underlying <span class="math inline">\(t\)</span> distribution (<tt>t.test()</tt> does use perform the normal approximation) and the corresponding <span class="math inline">\(p\)</span>-value. This is very convenient!</p>
<p>In this example, we come to the conclusion that the population mean <em>is</em> significantly different from <span class="math inline">\(0\)</span> (which is correct) at the level of <span class="math inline">\(5\%\)</span>, since <span class="math inline">\(\mu_Y = 0\)</span> is not an element of the <span class="math inline">\(95\%\)</span> confidence interval</p>
<p><span class="math display">\[ 0 \not\in \left[9.31,12.87\right]. \]</span>
We come to an equivalent result when using the <span class="math inline">\(p\)</span>-value rejection rule since</p>
<p><span class="math display">\[ p\text{-value} = 2.2\cdot 10^{-16} \ll 0.05. \]</span></p>
</div>
<div id="cmfdp" class="section level2 hasAnchor" number="3.5">
<h2 class="hasAnchor"><span class="header-section-number">3.5</span> Comparing Means from Different Populations<a href="#cmfdp" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Suppose you are interested in the means of two different populations, denote them <span class="math inline">\(\mu_1\)</span> and <span class="math inline">\(\mu_2\)</span>. More specifically, you are interested whether these population means are different from each other and plan to use a hypothesis test to verify this on the basis of independent sample data from both populations. A suitable pair of hypotheses is</p>
<p><span class="math display">\[\begin{equation}
H_0: \mu_1 - \mu_2 = d_0 \ \ \text{vs.} \ \ H_1: \mu_1 - \mu_2 \neq d_0 (\#eq:hypmeans)
\end{equation}\]</span></p>
<p>where <span class="math inline">\(d_0\)</span> denotes the hypothesized difference in means (so <span class="math inline">\(d_0=0\)</span> when the means are equal, under the null hypothesis). The book teaches us that <span class="math inline">\(H_0\)</span> can be tested with the <span class="math inline">\(t\)</span>-statistic</p>
<p><span class="math display">\[\begin{equation}
t=\frac{(\overline{Y}_1 - \overline{Y}_2) - d_0}{SE(\overline{Y}_1 - \overline{Y}_2)} (\#eq:tstatmeans)
\end{equation}\]</span></p>
<p>where</p>
<p><span class="math display">\[\begin{equation}
SE(\overline{Y}_1 - \overline{Y}_2) = \sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}.
\end{equation}\]</span></p>
<p>This is called a two sample <span class="math inline">\(t\)</span>-test. For large <span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_2\)</span>, @ref(eq:tstatmeans) is standard normal under the null hypothesis. Analogously to the simple <span class="math inline">\(t\)</span>-test we can compute confidence intervals for the true difference in population means:</p>
<p><span class="math display">\[ (\overline{Y}_1 - \overline{Y}_2) \pm 1.96 \times SE(\overline{Y}_1 - \overline{Y}_2) \]</span></p>
<p>is a <span class="math inline">\(95\%\)</span> confidence interval for <span class="math inline">\(d\)</span>. <br> In <tt>R</tt>, hypotheses as in @ref(eq:hypmeans) can be tested with <tt>t.test()</tt>, too. Note that <tt>t.test()</tt> chooses <span class="math inline">\(d_0 = 0\)</span> by default. This can be changed by setting the argument <tt>mu</tt> accordingly.</p>
<p>The subsequent code chunk demonstrates how to perform a two sample <span class="math inline">\(t\)</span>-test in <tt>R</tt> using simulated data.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set random seed</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="co"># draw data from two different populations with equal mean</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>sample_pop1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">10</span>, <span class="dv">10</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>sample_pop2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">10</span>, <span class="dv">20</span>)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="co"># perform a two sample t-test</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sample_pop1, sample_pop2)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Welch Two Sample t-test</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  sample_pop1 and sample_pop2</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t = 0.872, df = 140.52, p-value = 0.3847</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  -2.338012  6.028083</span></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mean of x mean of y </span></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11.088874  9.243838</span></span></code></pre></div>
<p>We find that the two sample <span class="math inline">\(t\)</span>-test does not reject the (true) null hypothesis that <span class="math inline">\(d_0 = 0\)</span>.</p>
</div>
<div id="aattggoe" class="section level2 hasAnchor" number="3.6">
<h2 class="hasAnchor"><span class="header-section-number">3.6</span> An Application to the Gender Gap of Earnings<a href="#aattggoe" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section discusses how to reproduce the results presented in the box <em>The Gender Gap of Earnings of College Graduates in the United States</em> of the book.</p>
<p>In order to reproduce Table 3.1 of the book you need to download the replication data which are hosted by Pearson and can be downloaded <a href="https://wps.pearsoned.com/wps/media/objects/11422/11696965/datasets3e/datasets/cps_ch3.xlsx">here</a>. This file contains data that range from <span class="math inline">\(1992\)</span> to <span class="math inline">\(2008\)</span> and earnings are reported in prices of <span class="math inline">\(2008\)</span>.</p>
<p>There are several ways to import the <tt>.xlsx</tt>-files into <tt>R</tt>. Our suggestion is the function <tt>read_excel()</tt> from the <tt>readxl</tt> package <span class="citation">(<a href="#ref-R-readxl" role="doc-biblioref">Wickham and Bryan 2023</a>)</span>. The package is not part of <tt>R</tt>’s base version and has to be installed manually.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the &#39;readxl&#39; package</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span></code></pre></div>
<p>You are now ready to import the dataset. Make sure you use the correct path to import the downloaded file! In our example, the file is saved in a subfolder of the working directory named <tt>data</tt>. If you are not sure what your current working directory is, use <tt>getwd()</tt>, see also <tt>?getwd</tt>. This will give you the path that points to the place <tt>R</tt> is currently looking for files to work with.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import the data into R</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>cps <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="at">path =</span> <span class="st">&quot;data/cps_ch3.xlsx&quot;</span>)</span></code></pre></div>
<p>Next, install and load the package <tt>dyplr</tt> <span class="citation">(<a href="#ref-R-dplyr" role="doc-biblioref">Wickham et al. 2023</a>)</span>. This package provides some handy functions that simplify data wrangling a lot. It makes use of the <tt>%&gt;%</tt> operator.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the &#39;dplyr&#39; package</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<p>First, get an overview over the dataset. Next, use <tt>%&gt;%</tt> and some functions from the <tt>dplyr</tt> package to group the observations by gender and year and compute descriptive statistics for both groups.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get an overview of the data structure</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cps)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 3</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   a_sex  year ahe08</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     1  1992  17.2</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     1  1992  15.3</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3     1  1992  22.9</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4     2  1992  13.3</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5     1  1992  22.1</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6     2  1992  12.2</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a><span class="co"># group data by gender and year and compute the mean, standard deviation</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a><span class="co"># and number of observations for each group</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>avgs <span class="ot">&lt;-</span> cps <span class="sc">%&gt;%</span> </span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(a_sex, year) <span class="sc">%&gt;%</span> </span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">summarise</span>(<span class="fu">mean</span>(ahe08), </span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">sd</span>(ahe08), </span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">n</span>())</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a><span class="co"># print the results to the console</span></span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(avgs)</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 10 × 5</span></span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Groups:   a_sex [2]</span></span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    a_sex  year `mean(ahe08)` `sd(ahe08)` `n()`</span></span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;       &lt;dbl&gt; &lt;int&gt;</span></span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1     1  1992          23.3       10.2   1594</span></span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2     1  1996          22.5       10.1   1379</span></span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3     1  2000          24.9       11.6   1303</span></span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4     1  2004          25.1       12.0   1894</span></span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5     1  2008          25.0       11.8   1838</span></span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6     2  1992          20.0        7.87  1368</span></span>
<span id="cb75-33"><a href="#cb75-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7     2  1996          19.0        7.95  1230</span></span>
<span id="cb75-34"><a href="#cb75-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8     2  2000          20.7        9.36  1181</span></span>
<span id="cb75-35"><a href="#cb75-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9     2  2004          21.0        9.36  1735</span></span>
<span id="cb75-36"><a href="#cb75-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10     2  2008          20.9        9.66  1871</span></span></code></pre></div>
<p>With the pipe operator <tt>%&gt;%</tt> we simply chain different <tt>R</tt> functions that produce compatible input and output. In the code above, we take the dataset <tt>cps</tt> and use it as an input for the function <tt>group_by()</tt>. The output of <tt>group_by</tt> is subsequently used as an input for <tt>summarise()</tt> and so forth.</p>
<p>Now that we have computed the statistics of interest for both genders, we can investigate how the gap in earnings between both groups evolves over time.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># split the dataset by gender</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>male <span class="ot">&lt;-</span> avgs <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(a_sex <span class="sc">==</span> <span class="dv">1</span>) </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>female <span class="ot">&lt;-</span> avgs <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(a_sex <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="co"># rename columns of both splits</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(male)   <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Sex&quot;</span>, <span class="st">&quot;Year&quot;</span>, <span class="st">&quot;Y_bar_m&quot;</span>, <span class="st">&quot;s_m&quot;</span>, <span class="st">&quot;n_m&quot;</span>)</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(female) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Sex&quot;</span>, <span class="st">&quot;Year&quot;</span>, <span class="st">&quot;Y_bar_f&quot;</span>, <span class="st">&quot;s_f&quot;</span>, <span class="st">&quot;n_f&quot;</span>)</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate gender gaps, compute standard errors and confidence intervals for all dates</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>gap <span class="ot">&lt;-</span> male<span class="sc">$</span>Y_bar_m <span class="sc">-</span> female<span class="sc">$</span>Y_bar_f</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>gap_se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(male<span class="sc">$</span>s_m<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> male<span class="sc">$</span>n_m <span class="sc">+</span> female<span class="sc">$</span>s_f<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> female<span class="sc">$</span>n_f)</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>gap_ci_l <span class="ot">&lt;-</span> gap <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> gap_se</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>gap_ci_u <span class="ot">&lt;-</span> gap <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> gap_se</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">cbind</span>(male[,<span class="sc">-</span><span class="dv">1</span>], female[,<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)], gap, gap_se, gap_ci_l, gap_ci_u)</span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a><span class="co"># print the results to the console</span></span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Year Y_bar_m  s_m  n_m Y_bar_f  s_f  n_f  gap gap_se gap_ci_l gap_ci_u</span></span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 1992    23.3 10.2 1594    20.0 7.87 1368 3.23  0.332     2.58     3.88</span></span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 1996    22.5 10.1 1379    19.0 7.95 1230 3.49  0.354     2.80     4.19</span></span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 2000    24.9 11.6 1303    20.7 9.36 1181 4.14  0.421     3.32     4.97</span></span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 2004    25.1 12.0 1894    21.0 9.36 1735 4.10  0.356     3.40     4.80</span></span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 2008    25.0 11.8 1838    20.9 9.66 1871 4.10  0.354     3.41     4.80</span></span></code></pre></div>
<p>We observe virtually the same results as the ones presented in the book. The computed statistics suggest that there <em>is</em> a gender gap in earnings. Note that we can reject the null hypothesis that the gap is zero for all periods. Further, estimates of the gap and bounds of the <span class="math inline">\(95\%\)</span> confidence intervals indicate that the gap has been quite stable in the recent past.</p>
</div>
<div id="scatterplots-sample-covariance-and-sample-correlation" class="section level2 hasAnchor" number="3.7">
<h2 class="hasAnchor"><span class="header-section-number">3.7</span> Scatterplots, Sample Covariance and Sample Correlation<a href="#scatterplots-sample-covariance-and-sample-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A scatter plot represents two dimensional data, for example <span class="math inline">\(n\)</span> observation on <span class="math inline">\(X_i\)</span> and <span class="math inline">\(Y_i\)</span>, by points in a coordinate system. It is very easy to generate scatter plots using the <tt>plot()</tt> function in <tt>R</tt>. Let us generate some artificial data on age and earnings of workers and plot it.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set random seed</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co"># generate dataset</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">100</span>, </span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">min =</span> <span class="dv">18</span>, </span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="dv">70</span>)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> X <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n=</span><span class="dv">100</span>, <span class="dv">50</span>, <span class="dv">15</span>)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="co"># plot observations</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X, </span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>     Y, </span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;p&quot;</span>,</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;A Scatterplot of X and Y&quot;</span>,</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Age&quot;</span>,</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Earnings&quot;</span>,</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-128-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The plot shows positive correlation between age and earnings. This is in line with the notion that older workers earn more than those who joined the working population recently.</p>
<div id="sample-covariance-and-correlation" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Sample Covariance and Correlation<a href="#sample-covariance-and-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>By now you should be familiar with the concepts of variance and covariance. If not, we recommend you to work your way through Chapter 2 of the book.</p>
<p>Just like the variance, covariance and correlation of two variables are properties that relate to the (unknown) joint probability distribution of these variables. We can estimate covariance and correlation by means of suitable estimators using a sample <span class="math inline">\((X_i,Y_i)\)</span>, <span class="math inline">\(i=1,\dots,n\)</span>.</p>
<p>The sample covariance</p>
<p><span class="math display">\[ s_{XY} = \frac{1}{n-1} \sum_{i=1}^n (X_i - \overline{X})(Y_i - \overline{Y}) \]</span></p>
<p>is an estimator for the population variance of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> whereas the sample correlation</p>
<p><span class="math display">\[ r_{XY} = \frac{s_{XY}}{s_Xs_Y} \]</span>
can be used to estimate the population correlation, a standardized measure for the strength of the linear relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. See Chapter 3.7 in the book for a more detailed treatment of these estimators.</p>
<p>As for variance and standard deviation, these estimators are implemented as <tt>R</tt> functions in the <tt>stats</tt> package. We can use them to estimate population covariance and population correlation of the artificial data on age and earnings.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute sample covariance of X and Y</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(X, Y)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 213.934</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="co"># compute sample correlation between X and Y</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(X, Y)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.706372</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="co"># an equivalent way to compute the sample correlation</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(X, Y) <span class="sc">/</span> (<span class="fu">sd</span>(X) <span class="sc">*</span> <span class="fu">sd</span>(Y))</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.706372</span></span></code></pre></div>
<p>The estimates indicate that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are moderately correlated.</p>
<p>The next code chunk uses the function <tt>mvnorm()</tt> from package <tt>MASS</tt> <span class="citation">(<a href="#ref-R-MASS" role="doc-biblioref">Ripley 2023</a>)</span> to generate bivariate sample data with different degrees of correlation.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co"># set random seed</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co"># positive correlation (0.81)</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>example1 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">100</span>,</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Sigma =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">ncol =</span> <span class="dv">2</span>),</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">empirical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="co"># negative correlation (-0.81)</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>example2 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">100</span>,</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Sigma =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>), <span class="at">ncol =</span> <span class="dv">2</span>),</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">empirical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a><span class="co"># no correlation </span></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>example3 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">100</span>,</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Sigma =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">2</span>),</span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">empirical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a><span class="co"># no correlation (quadratic relationship)</span></span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="fl">0.01</span>)</span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="sc">-</span> X<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(X))</span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a>example4 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X, Y)</span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a><span class="co"># divide plot area as 2-by-2 array</span></span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a><span class="co"># plot datasets</span></span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(example1, <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>, </span>
<span id="cb79-35"><a href="#cb79-35" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Correlation = 0.81&quot;</span>)</span>
<span id="cb79-36"><a href="#cb79-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-37"><a href="#cb79-37" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(example2, <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>, </span>
<span id="cb79-38"><a href="#cb79-38" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Correlation = -0.81&quot;</span>)</span>
<span id="cb79-39"><a href="#cb79-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-40"><a href="#cb79-40" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(example3, <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>, </span>
<span id="cb79-41"><a href="#cb79-41" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Correlation = 0&quot;</span>)</span>
<span id="cb79-42"><a href="#cb79-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-43"><a href="#cb79-43" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(example4, <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>, </span>
<span id="cb79-44"><a href="#cb79-44" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Correlation = 0&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-130-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="exercises-3" class="section level2 hasAnchor" number="3.8">
<h2 class="hasAnchor"><span class="header-section-number">3.8</span> Exercises<a href="#exercises-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="biased" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">1. Biased …<a href="#biased" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider the following alternative estimator for <span class="math inline">\(\mu_Y\)</span>, the mean of the <span class="math inline">\(Y_i\)</span></p>
<p><span class="math display">\[\widetilde{Y}=\frac{1}{n-1}\sum\limits_{i=1}^n Y_i\]</span></p>
<p>In this exercise we will illustrate that this estimator is a biased estimator for <span class="math inline">\(\mu_Y\)</span>.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Define a function <tt>Y_tilde</tt> that implements the estimator above.</p></li>
<li><p>Randomly draw 5 observations from the <span class="math inline">\(\mathcal{N}(10, 25)\)</span> distribution and compute an estimate using <tt>Y_tilde()</tt>. Repeat this procedure 10000 times and store the results in <tt>est_biased</tt>.</p></li>
<li><p>Plot a histogram of <tt>est_biased</tt>.</p></li>
<li><p>Add a red vertical line at <span class="math inline">\(\mu=10\)</span> using the function <tt>abline()</tt>.</p></li>
</ul>
<iframe src="DCL/ex3_1.html" frameborder="0" scrolling="no" style="width:100%;height:400px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>To compute the sum of a vector you can use <tt>sum()</tt>, to get the length of a vector you can use <tt>length()</tt>.</p></li>
<li><p>Use the function <tt>replicate()</tt> to compute repeatedly estimates of random samples. With the arguments <tt>expr</tt> and <tt>n</tt> you can specify the operation and how often it has to be replicated.</p></li>
<li><p>A histogram can be plotted with the function <tt>hist()</tt>.</p></li>
<li><p>The point on the x-axis as well as the color for the vertical line can be specified via the arguments <tt>v</tt> and <tt>col</tt>.</p></li>
</ul>
</div>
<div id="but-consistent-estimator" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">2. … but consistent estimator<a href="#but-consistent-estimator" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider again the estimator from the previous exercise. It is available in your environment as the function <tt>Y_tilde()</tt>. You are requested to do the same procedure as in the previous exercise. This time, however, increase the number of observations to draw from 5 to 1000.</p>
<p>What do you notice? What can you say about this estimator?</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Randomly draw 1000 observations from the <span class="math inline">\(\mathcal{N}(10, 25)\)</span> distribution and compute an estimate of the mean using <tt>Y_tilde()</tt>. Repeat this procedure 10000 times and store the results in <tt>est_consistent</tt>.</p></li>
<li><p>Plot a histogram of <tt>est_consistent</tt>.</p></li>
<li><p>Add a red vertical line at <span class="math inline">\(\mu=10\)</span> using the function <tt>abline()</tt>.</p></li>
</ul>
<iframe src="DCL/ex3_2.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>Use the function <tt>replicate()</tt> to compute estimates of repeatedly drawn random samples. Using the arguments <tt>expr</tt> and <tt>n</tt> you may specify the operation and how often it will be replicated.</p></li>
<li><p>A histogram can be plotted with the function <tt>hist()</tt>.</p></li>
<li><p>The position on the x-axis as well as the color for the vertical line can be specified via the arguments <tt>v</tt> and <tt>col</tt>.</p></li>
</ul>
</div>
<div id="efficiency-of-an-estimator" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">3. Efficiency of an Estimator<a href="#efficiency-of-an-estimator" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this exercise we want to illustrate the result that the sample mean</p>
<p><span class="math display">\[\hat{\mu}_Y=\sum\limits_{i=1}^{n}a_iY_i\]</span> with the equal weighting scheme <span class="math inline">\(a_i=\frac{1}{n}\)</span> for <span class="math inline">\(i=1,...,n\)</span> is the best linear unbiased estimator (BLUE) of <span class="math inline">\(\mu_Y\)</span>.</p>
<p>As an alternative, consider the estimator</p>
<p><span class="math display">\[\tilde{\mu}_Y=\sum\limits_{i=1}^{n}b_iY_i\]</span></p>
<p>where <span class="math inline">\(b_i\)</span> gives the first <span class="math inline">\(\frac{n}{2}\)</span> observations a higher weighting than the second <span class="math inline">\(\frac{n}{2}\)</span> observations (we assume that <span class="math inline">\(n\)</span> is even for simplicity).</p>
<p>The vector of weights <tt>w</tt> has been defined already and is available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Verify that <span class="math inline">\(\tilde{\mu}\)</span> is an unbiased estimator of <span class="math inline">\(\mu_Y\)</span>, the mean of the <span class="math inline">\(Y_i\)</span>.</p></li>
<li><p>Implement the alternative estimator of <span class="math inline">\(\mu_Y\)</span> as a function <tt>mu_tilde()</tt>.</p></li>
<li><p>Randomly draw 100 observations from the <span class="math inline">\(\mathcal{N}(5, 10)\)</span> distribution and compute estimates with both estimators. Repeat this procedure 10000 times and store the results in <tt>est_bar</tt> and <tt>est_tilde</tt>.</p></li>
<li><p>Compute the sample variances of <tt>est_bar</tt> and <tt>est_tilde</tt>. What can you say about both estimators?</p></li>
</ul>
<iframe src="DCL/ex3_3.html" frameborder="0" scrolling="no" style="width:100%;height:420px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>In order for <span class="math inline">\(\tilde{\mu}\)</span> to be an unbiased estimator all weights have to sum up to 1.</p></li>
<li><p>Use the function <tt>replicate()</tt> to compute estimates of repeatedly drawn samples. With the arguments <tt>expr</tt> and <tt>n</tt> you can specify the operation and how often it is replicated.</p></li>
<li><p>You may use <tt>var()</tt> the compute the sample variance.</p></li>
</ul>
</div>
<div id="hypothesis-test-t-statistic" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">4. Hypothesis Test — <span class="math inline">\(t\)</span>-statistic<a href="#hypothesis-test-t-statistic" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider the CPS dataset from Chapter @ref(aattggoe) again. The dataset <tt>cps</tt> is available in your working environment.</p>
<p>We suppose that the average hourly earnings (in prices of 2012) <tt>ahe12</tt> exceed 23.50 <span class="math inline">\(\$/h\)</span> and wish to test this hypothesis at a significance level of <span class="math inline">\(\alpha=0.05\)</span>. Please do the following:</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Compute the test statistic by hand and assign it to <tt>tstat</tt>.</p></li>
<li><p>Use <tt>tstat</tt> to accept or reject the null hypothesis. Please do so using the normal approximation.</p></li>
</ul>
<iframe src="DCL/ex3_4.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>We test <span class="math inline">\(H_0:\mu_{Y_{ahe}}\leq 23.5\)</span> vs. <span class="math inline">\(H_1:\mu_{Y_{ahe}}&gt;23.5\)</span>. That is, we conduct a right-sided test.</p></li>
<li><p>The <span class="math inline">\(t\)</span>-statistic is defined as <span class="math inline">\(\frac{\bar{Y}-\mu_{Y,0}}{s_{Y}/\sqrt{n}}\)</span> where <span class="math inline">\(s_Y\)</span> denotes the sample variance.</p></li>
<li><p>To decide whether the null hypothesis is accepted or rejected you can compare the <span class="math inline">\(t\)</span>-statistic with the respective quantile of the standard normal distribution. Use logical operators.</p></li>
</ul>
</div>
<div id="hypothesis-test-p-value" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">5. Hypothesis Test — <span class="math inline">\(p\)</span>-value<a href="#hypothesis-test-p-value" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Reconsider the test situation from the previous exercise. The dataset <tt>cps</tt> as well as the vector <tt>tstat</tt> are available in your working environment.</p>
<p>Instead of using the <span class="math inline">\(t\)</span>-statistic as decision criterion you may also use the <span class="math inline">\(p\)</span>-value. Now please do the following:</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Compute the <span class="math inline">\(p\)</span>-value by hand and assign it to <tt>pval</tt>.</p></li>
<li><p>Use <tt>pval</tt> to accept or reject the null hypothesis.</p></li>
</ul>
<iframe src="DCL/ex3_5.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>The <span class="math inline">\(p\)</span>-value for a right-sided test can be computed as <span class="math inline">\(p=P(t&gt;t^{act}|H_0)\)</span>.</p></li>
<li><p>We reject the null if <span class="math inline">\(p&lt;\alpha\)</span>. Use logical operators to check for this.</p></li>
</ul>
</div>
<div id="hypothesis-test-one-sample-t-test" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">6. Hypothesis Test — One Sample <span class="math inline">\(t\)</span>-test<a href="#hypothesis-test-one-sample-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the last two exercises we discussed two ways of conducting a hypothesis test. These approaches are somewhat cumbersome to apply by hand which is why <tt>R</tt> provides the function <tt>t.test()</tt>. It does most of the work automatically. <tt>t.test()</tt> provides <span class="math inline">\(t\)</span>-statistics, <span class="math inline">\(p\)</span>-values and even confidence intervals (more on the latter in later exercises). Note that <tt>t.test()</tt> uses the <span class="math inline">\(t\)</span>-distribution instead of the normal distribution which becomes important when the sample size is small.</p>
<p>The dataset <tt>cps</tt> and the variable <tt>pval</tt> from Exercise 3.4 are available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Conduct the hypothesis test from previous exercises using the function <tt>t.test()</tt>.</p></li>
<li><p>Extract the <span class="math inline">\(t\)</span>-statistic and the <span class="math inline">\(p\)</span>-value from the list created by <tt>t.test()</tt>. Assign them to the variables <tt>tstat</tt> and <tt>pvalue</tt>.</p></li>
<li><p>Verify that using the normal approximation here is valid as well by computing the difference between both <span class="math inline">\(p\)</span>-values.</p></li>
</ul>
<iframe src="DCL/ex3_6.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>The type of the test as well as the null hypothesis can be specified via the arguments <tt>alternative</tt> and <tt>mu</tt>.</p></li>
<li><p>The <span class="math inline">\(t\)</span>-statistic and the <span class="math inline">\(p\)</span>-value can be obtained via <tt>$statistic</tt> and <tt>$p.value</tt>, respectively.</p></li>
</ul>
</div>
<div id="hypothesis-test-two-sample-t-test" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">7. Hypothesis Test — Two Sample <span class="math inline">\(t\)</span>-test<a href="#hypothesis-test-two-sample-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider the annual maximum sea levels at Port Pirie (Southern Australia) and Fremantle (Western Australia) for the last 30 years.</p>
<p>The observations are made available as vectors <tt>portpirie</tt> and <tt>fremantle</tt> in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Test whether there is a significant difference in the annual maximum sea levels at a significance level of <span class="math inline">\(\alpha=0.05\)</span>.</li>
</ul>
<iframe src="DCL/ex3_7.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>We test <span class="math inline">\(H_0:\mu_{P}-\mu_{F}=0\)</span> vs. <span class="math inline">\(H_1:\mu_{P}-\mu_{F}\ne 0\)</span>. That is, we conduct a two sample <span class="math inline">\(t\)</span>-test.</p></li>
<li><p>For a two sample <span class="math inline">\(t\)</span>-test the function <tt>t.test()</tt> expects two vectors containing the data.</p></li>
</ul>
</div>
<div id="confidence-interval" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">8. Confidence Interval<a href="#confidence-interval" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Reconsider the test situation concerning the annual maximum sea levels at Port Pirie and Fremantle.</p>
<p>The variables <tt>portpirie</tt> and <tt>fremantle</tt> are again available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Construct a <span class="math inline">\(95\%\)</span>-confidence interval for the difference in the sea levels using <tt>t.test()</tt>.</li>
</ul>
<iframe src="DCL/ex3_8.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hint:</strong></p>
<ul>
<li>The function <tt>t.test()</tt> computes a <span class="math inline">\(95\%\)</span> confidence interval by default. This is accessible via <tt>$conf.int</tt>.</li>
</ul>
</div>
<div id="covariance-and-correlation-i" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">9. (Co)variance and Correlation I<a href="#covariance-and-correlation-i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider a random sample <span class="math inline">\((X_i, Y_i)\)</span> for <span class="math inline">\(i=1,...,100\)</span>.</p>
<p>The respective vectors <tt>X</tt> and <tt>Y</tt> are available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Compute the variance of <span class="math inline">\(X\)</span> using the function <tt>cov()</tt>.</p></li>
<li><p>Compute the covariance of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p></li>
<li><p>Compute the correlation between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p></li>
</ul>
<iframe src="DCL/ex3_9.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>The variance is a special case of the covariance.</p></li>
<li><p><tt>cov()</tt> as well as <tt>cor()</tt> expect a vector for each variable.</p></li>
</ul>
</div>
<div id="covariance-and-correlation-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">10. (Co)variance and Correlation II<a href="#covariance-and-correlation-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this exercise we want to examine the limitations of the correlation as a dependency measure.</p>
<p>Once the session has initialized you will see the plot of 100 realizations from two random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p>
<p>The respective observations are available in the vectors <tt>X</tt> and <tt>Y</tt> in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Compute the correlation between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. Interpret your result critically.</li>
</ul>
<iframe src="DCL/ex3_10.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hint:</strong></p>
<ul>
<li><tt>cor()</tt> expects a vector for each variable.</li>
</ul>
</div>
<!--chapter:end:03-ch3.Rmd-->
</div>
</div>
<div id="lrwor" class="section level1 hasAnchor" number="4">
<h1 class="hasAnchor"><span class="header-section-number">4</span> Linear Regression with One Regressor<a href="#lrwor" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter introduces the basics in linear regression and shows how to perform regression analysis in <tt>R</tt>. In linear regression, the aim is to model the relationship between a dependent variable <span class="math inline">\(Y\)</span> and one or more explanatory variables denoted by <span class="math inline">\(X_1, X_2, \dots, X_k\)</span>. Following the book we will focus on the concept of simple linear regression throughout the whole chapter. In simple linear regression, there is just one explanatory variable <span class="math inline">\(X_1\)</span>. <br>
If, for example, a school cuts its class sizes by hiring new teachers, that is, the school lowers <span class="math inline">\(X_1\)</span>, the student-teacher ratios of its classes, how would this affect <span class="math inline">\(Y\)</span>, the performance of the students involved in a standardized test? With linear regression we can not only examine whether the student-teacher ratio <em>does have</em> an impact on the test results but we can also learn about the <em>direction</em> and the <em>strength</em> of this effect.</p>
<p>The following packages are needed for reproducing the code presented in this chapter:</p>
<ul>
<li><p><tt>AER</tt> - accompanies the Book <em>Applied Econometrics with R</em> <span class="citation">C. Kleiber and Zeileis (<a href="#ref-kleiber2008" role="doc-biblioref">2008</a>)</span> and provides useful functions and data sets.</p></li>
<li><p><tt>MASS</tt> - a collection of functions for applied statistics.</p></li>
</ul>
<p>Make sure these are installed before you go ahead and try to replicate the examples. The safest way to do so is by checking whether the following code chunk executes without any errors.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code></pre></div>
<div id="simple-linear-regression" class="section level2 hasAnchor" number="4.1">
<h2 class="hasAnchor"><span class="header-section-number">4.1</span> Simple Linear Regression<a href="#simple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To start with an easy example, consider the following combinations of average test score and the average student-teacher ratio in some fictional school districts.</p>
<p>To work with these data in <tt>R</tt> we begin by generating two vectors: one for the student-teacher ratios (<tt>STR</tt>) and one for test scores (<tt>TestScore</tt>), both containing the data from the table above.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>STR <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">17</span>, <span class="dv">19</span>, <span class="dv">20</span>, <span class="dv">22</span>, <span class="fl">23.5</span>, <span class="dv">25</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>TestScore <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">680</span>, <span class="dv">640</span>, <span class="dv">670</span>, <span class="dv">660</span>, <span class="dv">630</span>, <span class="dv">660</span>, <span class="dv">635</span>) </span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Print out sample data</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>STR</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 15.0 17.0 19.0 20.0 22.0 23.5 25.0</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>TestScore</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 680 640 670 660 630 660 635</span></span></code></pre></div>
<p>To build simple linear regression model, we hypothesize that the relationship between dependent and independent variable is linear, formally: <span class="math display">\[ Y = b \cdot X + a. \]</span> For now, let us suppose that the function which relates test score and student-teacher ratio
to each other is <span class="math display">\[TestScore = 713 - 3 \times STR.\]</span></p>
<p>It is always a good idea to visualize the data you work with. Here, it is suitable to use <tt>plot()</tt> to produce a scatterplot with <tt>STR</tt> on the <span class="math inline">\(x\)</span>-axis and <tt>TestScore</tt> on the <span class="math inline">\(y\)</span>-axis. Just call <code>plot(y_variable ~ x_variable)</code> whereby <tt>y_variable</tt> and <tt>x_variable</tt> are placeholders for the vectors of observations we want to plot. Furthermore, we might want to add a systematic relationship to the plot. To draw a straight line, <tt>R</tt> provides the function <tt>abline()</tt>. We just have to call this function with arguments <tt>a</tt> (representing the intercept)
and <tt>b</tt> (representing the slope) after executing <tt>plot()</tt> in order to add the line to our plot.</p>
<p>The following code reproduces Figure 4.1 from the textbook.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a scatterplot of the data</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(TestScore <span class="sc">~</span> STR)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co"># add the systematic relationship to the plot</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">713</span>, <span class="at">b =</span> <span class="sc">-</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-144-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>We find that the line does not touch any of the points although we claimed that it represents the systematic relationship. The reason for this is randomness. Most of the time there are additional influences which imply that there is no bivariate relationship between the two variables.</p>
<p>In order to account for these differences between observed data and the systematic relationship, we extend our model from above by an <em>error term</em> <span class="math inline">\(u\)</span> which captures additional random effects. Put differently, <span class="math inline">\(u\)</span> accounts for all the differences between the regression line and the actual observed data. Beside pure randomness, these deviations could also arise from measurement errors or, as will be discussed later, could be the consequence of leaving out other factors that are relevant in explaining the dependent variable.</p>
<p>Which other factors are plausible in our example? For one thing, the test scores might be driven by the teachers’ quality and the background of the students. It is also possible that in some classes, the students were lucky on the test days and thus achieved higher scores. For now, we will summarize such influences by an additive component:</p>
<p><span class="math display">\[ TestScore = \beta_0 + \beta_1 \times STR + \text{other factors} \]</span></p>
<p>Of course this idea is very general as it can be easily extended to other situations that can be described with a linear model. The basic linear regression model we will work with hence is</p>
<p><span class="math display">\[ Y_i = \beta_0 + \beta_1 X_i + u_i. \]</span></p>
<p>Key Concept 4.1 summarizes the terminology of the simple linear regression model.</p>
<div id="KC4.1" class="keyconcept">
<h3 class="right">
Key Concept 4.1
</h3>
<h3 class="left">
Terminology for the Linear Regression Model with a Single Regressor
</h3>
<p>
<p>The linear regression model is</p>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1 X_i + u_i\]</span></p>
<p>where</p>
<ul>
<li>the index <span class="math inline">\(i\)</span> runs over the observations, <span class="math inline">\(i=1,\dots,n\)</span></li>
<li><span class="math inline">\(Y_i\)</span> is the <em>dependent variable</em>, the <em>regressand</em>, or simply the <em>left-hand variable</em></li>
<li><span class="math inline">\(X_i\)</span> is the <em>independent variable</em>, the <em>regressor</em>, or simply the <em>right-hand variable</em></li>
<li><span class="math inline">\(Y = \beta_0 + \beta_1 X\)</span> is the <em>population regression line</em> also called the <em>population regression function</em></li>
<li><span class="math inline">\(\beta_0\)</span> is the <em>intercept</em> of the population regression line</li>
<li><span class="math inline">\(\beta_1\)</span> is the <em>slope</em> of the population regression line</li>
<li><span class="math inline">\(u_i\)</span> is the <em>error term</em>.</li>
</ul>
</p>
</div>
</div>
<div id="estimating-the-coefficients-of-the-linear-regression-model" class="section level2 hasAnchor" number="4.2">
<h2 class="hasAnchor"><span class="header-section-number">4.2</span> Estimating the Coefficients of the Linear Regression Model<a href="#estimating-the-coefficients-of-the-linear-regression-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In practice, the intercept <span class="math inline">\(\beta_0\)</span> and slope <span class="math inline">\(\beta_1\)</span> of the population regression line are unknown. Therefore, we must employ data to estimate both unknown parameters. In the following, a real world example will be used to demonstrate how this is achieved. We want to relate test scores to student-teacher ratios measured in Californian schools. The test score is the district-wide average of reading and math scores for fifth graders. Again, the class size is measured as the number of students divided by the number of teachers (the student-teacher ratio). As for the data, the California School data set (<tt>CASchools</tt>) comes with an <tt>R</tt> package called <tt>AER</tt>, an acronym for <a href="https://cran.r-project.org/web/packages/AER/AER.pdf">Applied Econometrics with R</a> <span class="citation">(<a href="#ref-R-AER" role="doc-biblioref">Christian Kleiber and Zeileis 2022</a>)</span>. After installing the package with <tt>install.packages(“AER”)</tt> and attaching it with <tt>library(AER)</tt> the data set can be loaded using the function <tt>data()</tt>.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="do">## # install the AER package (once)</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="do">## install.packages(&quot;AER&quot;)</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="do">## # load the AER package</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="co"># load the the data set in the workspace</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(CASchools)</span></code></pre></div>
<p>Once a package has been installed it is available for use at further occasions when invoked with <tt>library()</tt> — there is no need to run <tt>install.packages()</tt> again!</p>
<p>It is interesting to know what kind of object we are dealing with.
<tt>class()</tt> returns the class of an object. Depending on the class of an object some functions (for example <tt>plot()</tt> and <tt>summary()</tt>) behave differently.</p>
<p>Let us check the class of the object <tt>CASchools</tt>.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(CASchools)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;data.frame&quot;</span></span></code></pre></div>
<p>It turns out that <tt>CASchools</tt> is of class <tt>data.frame</tt> which is a convenient format to work with, especially for performing regression analysis.</p>
<p>With help of <tt>head()</tt> we get a first overview of our data. This function shows only the first 6 rows of the data set which prevents an overcrowded console output.</p>

<div class="rmdnote">
Press <tt>ctrl + L</tt> to clear the console. This command deletes any code that has been typed in and executed by you or printed to the console by <tt>R</tt> functions. The good news is that anything else is left untouched. You neither loose defined variables etc. nor the code history. It is still possible to recall previously executed <tt>R</tt> commands using the up and down keys. If you are working in <em>RStudio</em>, press <tt>ctrl + Up</tt> on your keyboard (<tt>CMD + Up</tt> on a Mac) to review a list of previously entered commands.
</div>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(CASchools)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   district                          school  county grades students teachers</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    75119              Sunol Glen Unified Alameda  KK-08      195    10.90</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    61499            Manzanita Elementary   Butte  KK-08      240    11.15</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3    61549     Thermalito Union Elementary   Butte  KK-08     1550    82.90</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4    61457 Golden Feather Union Elementary   Butte  KK-08      243    14.00</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5    61523        Palermo Union Elementary   Butte  KK-08     1335    71.50</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6    62042         Burrel Union Elementary  Fresno  KK-08      137     6.40</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   calworks   lunch computer expenditure    income   english  read  math</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   0.5102  2.0408       67    6384.911 22.690001  0.000000 691.6 690.0</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  15.4167 47.9167      101    5099.381  9.824000  4.583333 660.5 661.9</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  55.0323 76.3226      169    5501.955  8.978000 30.000002 636.3 650.9</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  36.4754 77.0492       85    7101.831  8.978000  0.000000 651.9 643.5</span></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  33.1086 78.4270      171    5235.988  9.080333 13.857677 641.8 639.9</span></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  12.3188 86.9565       25    5580.147 10.415000 12.408759 605.7 605.4</span></span></code></pre></div>
<p>We find that the data set consists of plenty of variables and that most of them are numeric.</p>
<p>By the way: an alternative to <tt>class()</tt> and <tt>head()</tt> is <tt>str()</tt> which is deduced from ‘structure’ and gives a comprehensive overview of the object. Try!</p>
<p>Turning back to <tt>CASchools</tt>, the two variables we are interested in (i.e., average test score and the student-teacher ratio) are <em>not</em> included. However, it is possible to calculate both from the provided data. To obtain the student-teacher ratios, we simply divide the number of students by the number of teachers. The average test score is the arithmetic mean of the test score for reading and the score of the math test. The next code chunk shows how the two variables can be constructed as vectors and how they are appended to <tt>CASchools</tt>.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute STR and append it to CASchools</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>CASchools<span class="sc">$</span>STR <span class="ot">&lt;-</span> CASchools<span class="sc">$</span>students<span class="sc">/</span>CASchools<span class="sc">$</span>teachers </span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="co"># compute TestScore and append it to CASchools</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>CASchools<span class="sc">$</span>score <span class="ot">&lt;-</span> (CASchools<span class="sc">$</span>read <span class="sc">+</span> CASchools<span class="sc">$</span>math)<span class="sc">/</span><span class="dv">2</span>     </span></code></pre></div>
<p>If we ran <tt>head(CASchools)</tt> again we would find the two variables of interest as additional columns named <tt>STR</tt> and <tt>score</tt> (check this!).</p>
<p>Table 4.1 from the textbook summarizes the distribution of test scores and student-teacher ratios. There are several functions which can be used to produce similar results, e.g.,</p>
<ul>
<li><p><tt>mean()</tt> (computes the arithmetic mean of the provided numbers),</p></li>
<li><p><tt>sd()</tt> (computes the sample standard deviation),</p></li>
<li><p><tt>quantile()</tt> (returns a vector of the specified sample quantiles for the data).</p></li>
</ul>
<p>The next code chunk shows how to achieve this. First, we compute summary statistics on the columns <tt>STR</tt> and <tt>score</tt> of <tt>CASchools</tt>. In order to get nice output we gather the measures in a <tt>data.frame</tt> named <tt>DistributionSummary</tt>.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute sample averages of STR and score</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>avg_STR <span class="ot">&lt;-</span> <span class="fu">mean</span>(CASchools<span class="sc">$</span>STR) </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>avg_score <span class="ot">&lt;-</span> <span class="fu">mean</span>(CASchools<span class="sc">$</span>score)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="co"># compute sample standard deviations of STR and score</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>sd_STR <span class="ot">&lt;-</span> <span class="fu">sd</span>(CASchools<span class="sc">$</span>STR) </span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>sd_score <span class="ot">&lt;-</span> <span class="fu">sd</span>(CASchools<span class="sc">$</span>score)</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="co"># set up a vector of percentiles and compute the quantiles </span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>quantiles <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.25</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>, <span class="fl">0.75</span>, <span class="fl">0.9</span>)</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>quant_STR <span class="ot">&lt;-</span> <span class="fu">quantile</span>(CASchools<span class="sc">$</span>STR, quantiles)</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>quant_score <span class="ot">&lt;-</span> <span class="fu">quantile</span>(CASchools<span class="sc">$</span>score, quantiles)</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a><span class="co"># gather everything in a data.frame </span></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>DistributionSummary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Average =</span> <span class="fu">c</span>(avg_STR, avg_score), </span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">StandardDeviation =</span> <span class="fu">c</span>(sd_STR, sd_score), </span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">quantile =</span> <span class="fu">rbind</span>(quant_STR, quant_score))</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a><span class="co"># print the summary to the console</span></span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>DistributionSummary</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Average StandardDeviation quantile.10. quantile.25. quantile.40.</span></span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; quant_STR    19.64043          1.891812      17.3486     18.58236     19.26618</span></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; quant_score 654.15655         19.053347     630.3950    640.05000    649.06999</span></span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             quantile.50. quantile.60. quantile.75. quantile.90.</span></span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; quant_STR       19.72321      20.0783     20.87181     21.86741</span></span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; quant_score    654.45000     659.4000    666.66249    678.85999</span></span></code></pre></div>
<p>As for the sample data, we use <tt>plot()</tt>. This allows us to detect characteristics of our data, such as outliers which are harder to discover by looking at mere numbers. This time we add some additional arguments to the call of <tt>plot()</tt>.</p>
<p>The first argument in our call of <tt>plot()</tt>, <tt>score ~ STR</tt>, is again a formula that states variables on the y- and the x-axis. However, this time the two variables are not saved in separate vectors but are columns of <tt>CASchools</tt>. Therefore, <tt>R</tt> would not find them without the argument <tt>data</tt> being correctly specified. <tt>data</tt> must be in accordance with the name of the <tt>data.frame</tt> to which the variables belong to, in this case <tt>CASchools</tt>. Further arguments are used to change the appearance of the plot: while <tt>main</tt> adds a title, <tt>xlab</tt> and <tt>ylab</tt> add custom labels to both axes.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(score <span class="sc">~</span> STR, </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> CASchools,</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Scatterplot of TestScore and STR&quot;</span>, </span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;STR (X)&quot;</span>,</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Test Score (Y)&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-151-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The plot (Figure 4.2 in the book) shows the scatterplot of all observations on the student-teacher ratio and test score. We see that the points are strongly scattered, and that the variables are negatively correlated. That is, we expect to observe lower test scores in bigger classes.</p>
<p>The function <tt>cor()</tt> (see <tt>?cor</tt> for further info) can be used to compute the correlation between two <em>numeric</em> vectors.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(CASchools<span class="sc">$</span>STR, CASchools<span class="sc">$</span>score)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -0.2263627</span></span></code></pre></div>
<p>As the scatterplot already suggests, the correlation is negative but rather weak.</p>
<p>The task we are now facing is to find a line which best fits the data. Of course we could simply stick with graphical inspection and correlation analysis and then select the best fitting line by eyeballing. However, this would be rather subjective: different observers would draw different regression lines. On this account, we are interested in techniques that are less arbitrary. Such a technique is given by ordinary least squares (OLS) estimation.</p>
<div id="the-ordinary-least-squares-estimator" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">The Ordinary Least Squares Estimator<a href="#the-ordinary-least-squares-estimator" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The OLS estimator chooses the regression coefficients such that the estimated regression line is as “close” as possible to the observed data points. Here, closeness is measured by the sum of the squared mistakes made in predicting <span class="math inline">\(Y\)</span> given <span class="math inline">\(X\)</span>. Let <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> be some estimators of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>. Then the sum of squared estimation mistakes can be expressed as</p>
<p><span class="math display">\[ \sum^n_{i = 1} (Y_i - b_0 - b_1 X_i)^2. \]</span></p>
<p>The OLS estimator in the simple regression model is the pair of estimators for intercept and slope which minimizes the expression above. The derivation of the OLS estimators for both parameters are presented in Appendix 4.1 of the book. The results are summarized in Key Concept 4.2.</p>
<div id="KC4.2" class="keyconcept">
<h3 class="right">
Key Concept 4.2
</h3>
<h3 class="left">
The OLS Estimator, Predicted Values, and Residuals
</h3>
<p>
<p>The OLS estimators of the slope <span class="math inline">\(\beta_1\)</span> and the intercept <span class="math inline">\(\beta_0\)</span> in the simple linear regression model are
<span class="math display">\[\begin{align}
  \hat\beta_1 &amp; = \frac{ \sum_{i = 1}^n (X_i - \overline{X})(Y_i - \overline{Y}) } { \sum_{i=1}^n (X_i - \overline{X})^2},  \\
  \\
  \hat\beta_0 &amp; =  \overline{Y} - \hat\beta_1 \overline{X}.
\end{align}\]</span>
The OLS predicted values <span class="math inline">\(\widehat{Y}_i\)</span> and residuals <span class="math inline">\(\hat{u}_i\)</span> are
<span class="math display">\[\begin{align}
  \widehat{Y}_i &amp; =  \hat\beta_0 + \hat\beta_1 X_i,\\
  \\
  \hat{u}_i &amp; =  Y_i - \widehat{Y}_i.
\end{align}\]</span></p>
The estimated intercept <span class="math inline">\(\hat{\beta}_0\)</span>, the slope parameter <span class="math inline">\(\hat{\beta}_1\)</span> and the residuals <span class="math inline">\(\left(\hat{u}_i\right)\)</span> are computed from a sample of <span class="math inline">\(n\)</span> observations of <span class="math inline">\(X_i\)</span> and <span class="math inline">\(Y_i\)</span>, <span class="math inline">\(i\)</span>, <span class="math inline">\(...\)</span>, <span class="math inline">\(n\)</span>. These are <em>estimates</em> of the unknown population intercept <span class="math inline">\(\left(\beta_0 \right)\)</span>, slope <span class="math inline">\(\left(\beta_1\right)\)</span>, and error term <span class="math inline">\((u_i)\)</span>.
</p>
<p>The formulas presented above may not be very intuitive at first glance. The following interactive application aims to help you understand the mechanics of OLS. You can add observations by clicking into the coordinate system where the data are represented by points. Once two or more observations are available, the application computes a regression line using OLS and some statistics which are displayed in the right panel. The results are updated as you add further observations to the left panel. A double-click resets the application, i.e., all data are removed.</p>
<iframe height="410" width="900" frameborder="0" scrolling="no" src="SimpleRegression.html">
</iframe>
</div>
<p>There are many possible ways to compute <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span> in <tt>R</tt>. For example, we could implement the formulas presented in Key Concept 4.2 with two of <tt>R</tt>’s most basic functions: <tt>mean()</tt> and <tt>sum()</tt>. Before doing so we <em>attach</em> the <tt>CASchools</tt> dataset.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(CASchools) <span class="co"># allows to use the variables contained in CASchools directly</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="co"># compute beta_1_hat</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span> <span class="fu">sum</span>((STR <span class="sc">-</span> <span class="fu">mean</span>(STR)) <span class="sc">*</span> (score <span class="sc">-</span> <span class="fu">mean</span>(score))) <span class="sc">/</span> <span class="fu">sum</span>((STR <span class="sc">-</span> <span class="fu">mean</span>(STR))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="co"># compute beta_0_hat</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>beta_0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(score) <span class="sc">-</span> beta_1 <span class="sc">*</span> <span class="fu">mean</span>(STR)</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print the results to the console</span></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>beta_1</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -2.279808</span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>beta_0</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 698.9329</span></span></code></pre></div>

<div class="rmdknit">
<p>Calling <tt>attach(CASchools)</tt> enables us to adress a variable contained in <tt>CASchools</tt> by its name: it is no longer necessary to use the <tt>$</tt> operator in conjunction with the dataset: <tt>R</tt> may evaluate the variable name directly.</p>
<tt>R</tt> uses the object in the user environment if this object shares the name of variable contained in an attached database. However, it is a better practice to always use distinctive names in order to avoid such (seemingly) ambivalences!
</div>
<p><br></p>
<p><strong>Notice that we adress variables contained in the attached dataset <tt>CASchools</tt> directly for the rest of this chapter!</strong></p>
<p>Of course, there are even more manual ways to perform these tasks. With OLS being one of the most widely-used estimation techniques, <tt>R</tt> of course already contains a built-in function named <tt>lm()</tt> (<strong>l</strong>inear <strong>m</strong>odel) which can be used to carry out regression analysis.</p>
<p>The first argument of the function to be specified is, similar to <tt>plot()</tt>, the regression formula with the basic syntax <tt>y ~ x</tt> where <tt>y</tt> is the dependent variable and <tt>x</tt> the explanatory variable. The argument <tt>data</tt> determines the data set to be used in the regression. We now revisit the example from the book where the relationship between the test scores and the class sizes is analyzed. The following code uses <tt>lm()</tt> to replicate the results presented in figure 4.3 of the book.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model and assign the result to linear_model</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>linear_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> STR, <span class="at">data =</span> CASchools)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print the standard output of the estimated lm object to the console </span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>linear_model</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = score ~ STR, data = CASchools)</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)          STR  </span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      698.93        -2.28</span></span></code></pre></div>
<p>Let us add the estimated regression line to the plot. This time we also enlarge the ranges of both axes by setting the arguments <tt>xlim</tt> and <tt>ylim</tt>.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the data</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(score <span class="sc">~</span> STR, </span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> CASchools,</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Scatterplot of TestScore and STR&quot;</span>, </span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;STR (X)&quot;</span>,</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Test Score (Y)&quot;</span>,</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">30</span>),</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">600</span>, <span class="dv">720</span>))</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a><span class="co"># add the regression line</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(linear_model) </span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-157-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Did you notice that this time, we did not pass the intercept and slope parameters to <tt>abline</tt>? If you call <tt>abline()</tt> on an object of class <tt>lm</tt> which only contains a single regressor, <tt>R</tt> draws the regression line automatically!</p>
</div>
</div>
<div id="measures-of-fit" class="section level2 hasAnchor" number="4.3">
<h2 class="hasAnchor"><span class="header-section-number">4.3</span> Measures of Fit<a href="#measures-of-fit" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>After fitting a linear regression model, a natural question is how well the model describes the data. Visually, this amounts to assessing whether the observations are tightly clustered around the regression line. Both the <em>coefficient of determination</em> and the <em>standard error of the regression</em> measure how well the OLS Regression line fits the data.</p>
<div id="the-coefficient-of-determination" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">The Coefficient of Determination<a href="#the-coefficient-of-determination" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math inline">\(R^2\)</span>, the <em>coefficient of determination</em>, is the fraction of the sample variance of <span class="math inline">\(Y_i\)</span> that is explained by <span class="math inline">\(X_i\)</span>. Mathematically, the <span class="math inline">\(R^2\)</span> can be written as the ratio of the explained sum of squares to the total sum of squares. The <em>explained sum of squares</em> (<span class="math inline">\(ESS\)</span>) is the sum of squared deviations of the predicted values <span class="math inline">\(\hat{Y_i}\)</span>, from the average of the <span class="math inline">\(Y_i\)</span>. The <em>total sum of squares</em> (<span class="math inline">\(TSS\)</span>) is the sum of squared deviations of the <span class="math inline">\(Y_i\)</span> from their average. Thus we have</p>
<p><span class="math display">\[\begin{align}
  ESS &amp; =  \sum_{i = 1}^n \left( \hat{Y_i} - \overline{Y} \right)^2,   \\
  TSS &amp; =  \sum_{i = 1}^n \left( Y_i - \overline{Y} \right)^2,   \\
  R^2 &amp; = \frac{ESS}{TSS}.
\end{align}\]</span></p>
<p>Since <span class="math inline">\(TSS = ESS + SSR\)</span> we can also write</p>
<p><span class="math display">\[ R^2 = 1- \frac{SSR}{TSS} \]</span></p>
<p>where <span class="math inline">\(SSR\)</span> is the sum of squared residuals, a measure for the errors made when predicting the <span class="math inline">\(Y\)</span> by <span class="math inline">\(X\)</span>. The <span class="math inline">\(SSR\)</span> is defined as</p>
<p><span class="math display">\[ SSR = \sum_{i=1}^n \hat{u}_i^2. \]</span></p>
<p><span class="math inline">\(R^2\)</span> lies between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>. It is easy to see that a perfect fit, i.e., no errors made when fitting the regression line, implies <span class="math inline">\(R^2 = 1\)</span> since then we have <span class="math inline">\(SSR=0\)</span>. On the contrary, if our estimated regression line does not explain any variation in the <span class="math inline">\(Y_i\)</span>, we have <span class="math inline">\(ESS=0\)</span> and consequently <span class="math inline">\(R^2=0\)</span>.</p>
</div>
<div id="the-standard-error-of-the-regression" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">The Standard Error of the Regression<a href="#the-standard-error-of-the-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <em>Standard Error of the Regression</em> (<span class="math inline">\(SER\)</span>) is an estimator of the standard deviation of the residuals <span class="math inline">\(\hat{u}_i\)</span>. As such it measures the magnitude of a typical deviation from the regression line, i.e., the magnitude of a typical residual.</p>
<p><span class="math display">\[ SER = s_{\hat{u}} = \sqrt{s_{\hat{u}}^2} \ \ \ \text{where} \ \ \ s_{\hat{u} }^2 = \frac{1}{n-2} \sum_{i = 1}^n \hat{u}^2_i = \frac{SSR}{n - 2} \]</span></p>
<p>Remember that the <span class="math inline">\(u_i\)</span> are <em>unobserved</em>. This is why we use their estimated counterparts, the residuals <span class="math inline">\(\hat{u}_i\)</span>, instead. See Chapter 4.3 of the book for a more detailed comment on the <span class="math inline">\(SER\)</span>.</p>
</div>
<div id="application-to-the-test-score-data" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Application to the Test Score Data<a href="#application-to-the-test-score-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Both measures of fit can be obtained by using the function <tt>summary()</tt> with an <tt>lm</tt> object provided as the only argument. While the function <tt>lm()</tt> only prints out the estimated coefficients to the console, <tt>summary()</tt> provides additional predefined information such as the regression’s <span class="math inline">\(R^2\)</span> and the <span class="math inline">\(SER\)</span>.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>mod_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(linear_model)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>mod_summary</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = score ~ STR, data = CASchools)</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -47.727 -14.251   0.483  12.822  48.540 </span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 698.9329     9.4675  73.825  &lt; 2e-16 ***</span></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; STR          -2.2798     0.4798  -4.751 2.78e-06 ***</span></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 18.58 on 418 degrees of freedom</span></span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.05124,    Adjusted R-squared:  0.04897 </span></span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 22.58 on 1 and 418 DF,  p-value: 2.783e-06</span></span></code></pre></div>
<p>The <span class="math inline">\(R^2\)</span> in the output is called <em>Multiple R-squared</em> and has a value of <span class="math inline">\(0.051\)</span>. Hence, <span class="math inline">\(5.1 \%\)</span> of the variance of the dependent variable <span class="math inline">\(score\)</span> is explained by the explanatory variable <span class="math inline">\(STR\)</span>. That is, the regression explains little of the variance in <span class="math inline">\(score\)</span>, and much of the variation in test scores remains unexplained (cf. Figure 4.3 of the book).</p>
<p>The <span class="math inline">\(SER\)</span> is called <em>Residual standard error</em> and equals <span class="math inline">\(18.58\)</span>. The unit of the <span class="math inline">\(SER\)</span> is the same as the unit of the dependent variable. That is, on average the deviation of the actual achieved test score and the regression line is <span class="math inline">\(18.58\)</span> points.</p>
<p>Now, let us check whether <tt>summary()</tt> uses the same definitions for <span class="math inline">\(R^2\)</span> and <span class="math inline">\(SER\)</span> as we do when computing them manually.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute R^2 manually</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> <span class="fu">sum</span>(mod_summary<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>TSS <span class="ot">&lt;-</span> <span class="fu">sum</span>((score <span class="sc">-</span> <span class="fu">mean</span>(score))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>R2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> SSR<span class="sc">/</span>TSS</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print the value to the console</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>R2</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.05124009</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a><span class="co"># compute SER manually</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(CASchools)</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>SER <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(SSR <span class="sc">/</span> (n<span class="dv">-2</span>))</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a><span class="co"># print the value to the console</span></span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>SER</span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 18.58097</span></span></code></pre></div>
<p>We find that the results coincide. Note that the values provided by <tt>summary()</tt> are rounded to two decimal places.</p>
</div>
</div>
<div id="tlsa" class="section level2 hasAnchor" number="4.4">
<h2 class="hasAnchor"><span class="header-section-number">4.4</span> The Least Squares Assumptions<a href="#tlsa" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>OLS performs well under a quite broad variety of different circumstances. However, there are some assumptions which need to be satisfied in order to ensure that the estimates are normally distributed in large samples (we discuss this in Chapter @ref(tsdotoe).</p>
<div id="KC4.3" class="keyconcept">
<h3 class="right">
Key Concept 4.3
</h3>
<h3 class="left">
The Least Squares Assumptions
</h3>
<p>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1 X_i + u_i \text{, } i = 1,\dots,n\]</span>
where</p>
<ol style="list-style-type: decimal">
<li>The error term <span class="math inline">\(u_i\)</span> has conditional mean zero given <span class="math inline">\(X_i\)</span>: <span class="math inline">\(E(u_i|X_i) = 0\)</span>.</li>
<li><span class="math inline">\((X_i,Y_i), i = 1,\dots,n\)</span> are independent and identically distributed (i.i.d.) draws from their joint distribution.</li>
<li>Large outliers are unlikely: <span class="math inline">\(X_i\)</span> and <span class="math inline">\(Y_i\)</span> have nonzero finite fourth moments.</li>
</ol>
</p>
</div>
<div id="assumption-1-the-error-term-has-conditional-mean-of-zero" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Assumption 1: The Error Term has Conditional Mean of Zero<a href="#assumption-1-the-error-term-has-conditional-mean-of-zero" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This means that no matter which value we choose for <span class="math inline">\(X\)</span>, the error term <span class="math inline">\(u\)</span> must not show any systematic pattern and must have a mean of <span class="math inline">\(0\)</span>.
Consider the case that, unconditionally, <span class="math inline">\(E(u) = 0\)</span>, but for low and high values of <span class="math inline">\(X\)</span>, the error term tends to be positive and for midrange values of
<span class="math inline">\(X\)</span> the error tends to be negative. We can use R to construct such an example. To do so we generate our own data using <tt>R</tt>’s built-in random number generators.</p>
<p>We will use the following functions:</p>
<ul>
<li><tt>runif()</tt> - generates uniformly distributed random numbers</li>
<li><tt>rnorm()</tt> - generates normally distributed random numbers</li>
<li><tt>predict()</tt> - does predictions based on the results of model fitting functions like <tt>lm()</tt></li>
<li><tt>lines()</tt> - adds line segments to an existing plot</li>
</ul>
<p>We start by creating a vector containing values that are uniformly distributed on the interval <span class="math inline">\([-5,5]\)</span>. This can be done with the function <tt>runif()</tt>. We also need to simulate the error term. For this we generate normally distributed random numbers with a mean equal to <span class="math inline">\(0\)</span> and a variance of <span class="math inline">\(1\)</span> using <tt>rnorm()</tt>. The <span class="math inline">\(Y\)</span> values are obtained as a quadratic function of the <span class="math inline">\(X\)</span> values and the error.</p>
<p>After generating the data we estimate both a simple regression model and a quadratic model that also includes the regressor <span class="math inline">\(X^2\)</span> (this is a multiple regression model, see Chapter @ref(rmwmr)). Finally, we plot the simulated data and add the estimated regression line of a simple regression model as well as the predictions made with a quadratic model to compare the fit graphically.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a seed to make the results reproducible</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">321</span>)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate the data </span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">50</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">max =</span> <span class="dv">5</span>)</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">1</span>)  </span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="co"># the true relation  </span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> X<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> X <span class="sc">+</span> u                </span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate a simple regression model </span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>mod_simple <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X)</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a><span class="co"># predict using a quadratic model </span></span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="fu">lm</span>(Y <span class="sc">~</span> X <span class="sc">+</span> <span class="fu">I</span>(X<span class="sc">^</span><span class="dv">2</span>)), <span class="fu">data.frame</span>(<span class="at">X =</span> <span class="fu">sort</span>(X)))</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the results</span></span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Y <span class="sc">~</span> X)</span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(mod_simple, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">sort</span>(X), prediction)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-162-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The plot shows what is meant by <span class="math inline">\(E(u_i|X_i) = 0\)</span> and why it does not hold for the linear model:</p>
<p>Using the quadratic model (represented by the black curve) we see that there are no systematic deviations of the observation from the predicted relation. It is credible that the assumption is not violated when such a model is employed. However, using a simple linear regression model we see that the assumption is probably violated as <span class="math inline">\(E(u_i|X_i)\)</span> varies with the <span class="math inline">\(X_i\)</span>.</p>
</div>
<div id="assumption-2-independently-and-identically-distributed-data" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Assumption 2: Independently and Identically Distributed Data<a href="#assumption-2-independently-and-identically-distributed-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Most sampling schemes used when collecting data from populations produce i.i.d.-samples. For example, we could use <tt>R</tt>’s random number generator to randomly select student IDs from a university’s enrollment list and record age <span class="math inline">\(X\)</span> and earnings <span class="math inline">\(Y\)</span> of the corresponding students. This is a typical example of simple random sampling and ensures that all the <span class="math inline">\((X_i, Y_i)\)</span> are drawn randomly from the same population.</p>
<p>A prominent example where the i.i.d. assumption is not fulfilled is time series data where we have observations on the same unit over time. For example, take <span class="math inline">\(X\)</span> as the number of workers in a production company over time. Due to business transformations, the company cuts jobs periodically by a specific share but there are also some non-deterministic influences that relate to economics, politics etc. Using <tt>R</tt> we can easily simulate such a process and plot it.</p>
<p>We start the series with a total of 5000 workers and simulate the reduction of employment with an autoregressive process that exhibits a downward movement in the long-run and has normally distributed errors:<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
<p><span class="math display">\[ employment_t = -5 + 0.98 \cdot employment_{t-1} + u_t \]</span></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co"># generate a date vector</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>Date <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">&quot;1951/1/1&quot;</span>), <span class="fu">as.Date</span>(<span class="st">&quot;2000/1/1&quot;</span>), <span class="st">&quot;years&quot;</span>)</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize the employment vector</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5000</span>, <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Date)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a><span class="co"># generate time series observations with random influences</span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(Date)) {</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>    X[i] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">50</span> <span class="sc">+</span> <span class="fl">0.98</span> <span class="sc">*</span> X[i<span class="dv">-1</span>] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">200</span>)</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the results</span></span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> Date, </span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> X, </span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Workers&quot;</span>, </span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Time&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-163-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>It is evident that the observations on the number of employees cannot be independent in this example: the level of today’s employment is correlated with tomorrows employment level. Thus, the i.i.d. assumption is violated.</p>
</div>
<div id="assumption-3-large-outliers-are-unlikely" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Assumption 3: Large Outliers are Unlikely<a href="#assumption-3-large-outliers-are-unlikely" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It is easy to come up with situations where extreme observations, i.e., observations that deviate considerably from the usual range of the data, may occur. Such observations are called outliers. Technically speaking, assumption 3 requires that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> have a finite kurtosis.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a></p>
<p>Common cases where we want to exclude or (if possible) correct such outliers is when they are apparently typos, conversion errors or measurement errors. Even if it seems like extreme observations have been recorded correctly, it is advisable to exclude them before estimating a model since OLS suffers from <em>sensitivity to outliers</em>.</p>
<p>What does this mean? One can show that extreme observations receive heavy weighting in the estimation of the unknown regression coefficients when using OLS. Therefore, outliers can lead to strongly distorted estimates of regression coefficients. To get a better impression of this issue, consider the following application where we have placed some sample data on <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> which are highly correlated. The relation between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> seems to be explained pretty well by the plotted regression line: all of the white data points lie close to the red regression line and we have <span class="math inline">\(R^2=0.92\)</span>.</p>
<p>Now go ahead and add a further observation at, say, <span class="math inline">\((18,2)\)</span>. This observations clearly is an outlier. The result is quite striking: the estimated regression line differs greatly from the one we adjudged to fit the data well. The slope is heavily downward biased and <span class="math inline">\(R^2\)</span> decreased to a mere <span class="math inline">\(29\%\)</span>! <br>
Double-click inside the coordinate system to reset the app. Feel free to experiment. Choose different coordinates for the outlier or add additional ones.</p>
<iframe height="410" width="900" frameborder="0" scrolling="no" src="Outlier.html">
</iframe>
<p>The following code roughly reproduces what is shown in figure 4.5 in the book. As done above we use sample data generated using <tt>R</tt>’s random number functions <tt>rnorm()</tt> and <tt>runif()</tt>. We estimate two simple regression models, one based on the original data set and another using a modified set where one observation is change to be an outlier and then plot the results. In order to understand the complete code you should be familiar with the function <tt>sort()</tt> which sorts the entries of a numeric vector in ascending order.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="co"># generate the data</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">runif</span>(<span class="dv">10</span>, <span class="at">min =</span> <span class="dv">30</span>, <span class="at">max =</span> <span class="dv">70</span>))</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span> , <span class="at">mean =</span> <span class="dv">200</span>, <span class="at">sd =</span> <span class="dv">50</span>)</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>Y[<span class="dv">9</span>] <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model with outlier</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X)</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model without outlier</span></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>fitWithoutOutlier <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y[<span class="sc">-</span><span class="dv">9</span>] <span class="sc">~</span> X[<span class="sc">-</span><span class="dv">9</span>])</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the results</span></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Y <span class="sc">~</span> X)</span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fit)</span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fitWithoutOutlier, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-164-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="tsdotoe" class="section level2 hasAnchor" number="4.5">
<h2 class="hasAnchor"><span class="header-section-number">4.5</span> The Sampling Distribution of the OLS Estimator<a href="#tsdotoe" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Because <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span> are computed from a sample, the estimators themselves are random variables with a probability distribution — the so-called sampling distribution of the estimators — which describes the values they could take on over different samples. Although the sampling distribution of <span class="math inline">\(\hat\beta_0\)</span> and <span class="math inline">\(\hat\beta_1\)</span> can be complicated when the sample size is small and generally changes with the number of observations, <span class="math inline">\(n\)</span>, it is possible, provided the assumptions discussed in the book are valid, to make certain statements about it that hold for all <span class="math inline">\(n\)</span>. In particular
<span class="math display">\[ E(\hat{\beta}_0) = \beta_0 \ \ \text{and} \ \  E(\hat{\beta}_1) = \beta_1,\]</span>
that is, <span class="math inline">\(\hat\beta_0\)</span> and <span class="math inline">\(\hat\beta_1\)</span> are unbiased estimators of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, the true parameters. If the sample is sufficiently large, by the central limit theorem the <em>joint</em> sampling distribution of the estimators is well approximated by the bivariate normal distribution (<a href="#mjx-eqn-2.1">2.1</a>). This implies that the marginal distributions are also normal in large samples. Core facts on the large-sample distributions of <span class="math inline">\(\hat\beta_0\)</span> and <span class="math inline">\(\hat\beta_1\)</span> are presented in Key Concept 4.4.</p>
<div id="KC4.4" class="keyconcept">
<h3 class="right">
Key Concept 4.4
</h3>
<h3 class="left">
Large Sample Distribution of <span class="math inline">\(\hat\beta_0\)</span> and <span class="math inline">\(\hat\beta_1\)</span>
</h3>
<p>
<p>If the least squares assumptions in Key Concept 4.3 hold, then in large samples <span class="math inline">\(\hat\beta_0\)</span> and <span class="math inline">\(\hat\beta_1\)</span> have a joint normal sampling distribution. The large sample normal distribution of <span class="math inline">\(\hat\beta_1\)</span> is <span class="math inline">\(\mathcal{N}(\beta_1, \sigma^2_{\hat\beta_1})\)</span>, where the variance of the distribution, <span class="math inline">\(\sigma^2_{\hat\beta_1}\)</span>, is</p>
<p><span class="math display">\[\begin{align}
\sigma^2_{\hat\beta_1} = \frac{1}{n} \frac{Var \left[ \left(X_i - \mu_X \right) u_i  \right]}  {\left[  Var \left(X_i \right)  \right]^2}. (\#eq:olsvar1)
\end{align}\]</span></p>
<p>The large sample normal distribution of <span class="math inline">\(\hat\beta_0\)</span> is <span class="math inline">\(\mathcal{N}(\beta_0, \sigma^2_{\hat\beta_0})\)</span> with</p>
<p><span class="math display">\[\begin{align}
\sigma^2_{\hat\beta_0} =  \frac{1}{n} \frac{Var \left( H_i u_i \right)}{ \left[  E \left(H_i^2  \right)  \right]^2 } \ , \ \text{where} \ \ H_i = 1 - \left[ \frac{\mu_X} {E \left( X_i^2\right)} \right] X_i. (\#eq:olsvar2)
\end{align}\]</span></p>
<p>The interactive simulation below continuously generates random samples <span class="math inline">\((X_i,Y_i)\)</span> of <span class="math inline">\(200\)</span> observations where <span class="math inline">\(E(Y\vert X) = 100 + 3X\)</span>, estimates a simple regression model, stores the estimate of the slope <span class="math inline">\(\beta_1\)</span> and visualizes the distribution of the <span class="math inline">\(\widehat{\beta}_1\)</span>s observed so far using a histogram. The idea here is that for a large number of <span class="math inline">\(\widehat{\beta}_1\)</span>s, the histogram gives a good approximation of the sampling distribution of the estimator. By decreasing the time between two sampling iterations, it becomes clear that the shape of the histogram approaches the characteristic bell shape of a normal distribution centered at the true slope of <span class="math inline">\(3\)</span>.</p>
<iframe height="470" width="700" frameborder="0" scrolling="no" src="SmallSampleDIstReg.html">
</iframe>
<p>(Double-click on the histogram to restart the simulation.)</p>
</p>
</div>
<div id="simulation-study-1" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Simulation Study 1<a href="#simulation-study-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Whether the statements of Key Concept 4.4 really hold can also be verified using <tt>R</tt>. For this we first we build our own population of <span class="math inline">\(100000\)</span> observations in total. To do this we need values for the independent variable <span class="math inline">\(X\)</span>, for the error term <span class="math inline">\(u\)</span>, and for the parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>. With these combined in a simple regression model, we compute the dependent variable <span class="math inline">\(Y\)</span>. <br> In our example we generate the numbers <span class="math inline">\(X_i\)</span>, <span class="math inline">\(i = 1\)</span>, … ,<span class="math inline">\(100000\)</span> by drawing a random sample from a uniform distribution on the interval <span class="math inline">\([0,20]\)</span>. The realizations of the error terms <span class="math inline">\(u_i\)</span> are drawn from a standard normal distribution with parameters <span class="math inline">\(\mu = 0\)</span> and <span class="math inline">\(\sigma^2 = 100\)</span> (note that <tt>rnorm()</tt> requires <span class="math inline">\(\sigma\)</span> as input for the argument <tt>sd</tt>, see <tt>?rnorm</tt>). Furthermore we chose <span class="math inline">\(\beta_0 = -2\)</span> and <span class="math inline">\(\beta_1 = 3.5\)</span> so the true model is</p>
<p><span class="math display">\[ Y_i = -2 + 3.5 \cdot X_i. \]</span></p>
<p>Finally, we store the results in a data.frame.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate data</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">20</span>)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="co"># population regression</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">+</span> <span class="fl">3.5</span> <span class="sc">*</span> X <span class="sc">+</span> u</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>population <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X, Y)</span></code></pre></div>
<p>From now on we will consider the previously generated data as the true population (which of course would be <em>unknown</em> in a real world application, otherwise there would be no reason to draw a random sample in the first place). The knowledge about the true population and the true relationship between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span> can be used to verify the statements made in Key Concept 4.4.</p>
<p>First, let us calculate the true variances <span class="math inline">\(\sigma^2_{\hat{\beta}_0}\)</span> and <span class="math inline">\(\sigma^2_{\hat{\beta}_1}\)</span> for a randomly drawn sample of size <span class="math inline">\(n = 100\)</span>.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set sample size</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the variance of beta_hat_0</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>H_i <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">mean</span>(X) <span class="sc">/</span> <span class="fu">mean</span>(X<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> X</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>var_b0 <span class="ot">&lt;-</span> <span class="fu">var</span>(H_i <span class="sc">*</span> u) <span class="sc">/</span> (n <span class="sc">*</span> <span class="fu">mean</span>(H_i<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the variance of hat_beta_1</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>var_b1 <span class="ot">&lt;-</span> <span class="fu">var</span>( ( X <span class="sc">-</span> <span class="fu">mean</span>(X) ) <span class="sc">*</span> u ) <span class="sc">/</span> (<span class="dv">100</span> <span class="sc">*</span> <span class="fu">var</span>(X)<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print variances to the console</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>var_b0</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 4.045066</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>var_b1</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.03018694</span></span></code></pre></div>
<p>Now let us assume that we do not know the true values of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> and that it is not possible to observe the whole population. However, we can observe a random sample of <span class="math inline">\(n\)</span> observations. Then, it would not be possible to compute the true parameters but we could obtain estimates of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> from the sample data using OLS. However, we know that these estimates are outcomes of random variables themselves since the observations are randomly sampled from the population. Key Concept 4.4 describes their distributions for large <span class="math inline">\(n\)</span>. When drawing a single sample of size <span class="math inline">\(n\)</span> it is not possible to make any statement about these distributions. Things change if we repeat the sampling scheme many times and compute the estimates for each sample: using this procedure we simulate outcomes of the respective distributions.</p>
<p>To achieve this in R, we employ the following approach:</p>
<ul>
<li>We assign the number of repetitions, say <span class="math inline">\(10000\)</span>, to <tt>reps</tt> and then initialize a matrix <tt>fit</tt> were the estimates obtained in each sampling iteration shall be stored row-wise. Thus <tt>fit</tt> has to be a matrix of dimensions <tt>reps</tt><span class="math inline">\(\times2\)</span>.</li>
<li>In the next step we draw <tt>reps</tt> random samples of size <tt>n</tt> from the population and obtain the OLS estimates for each sample. The results are stored as row entries in the outcome matrix <tt>fit</tt>. This is done using a <tt>for()</tt> loop.</li>
<li>At last, we estimate variances of both estimators using the sampled outcomes and plot histograms of the latter. We also add a plot of the density functions belonging to the distributions that follow from Key Concept 4.4. The function <tt>bquote()</tt> is used to obtain math expressions in the titles and labels of both plots. See <tt>?bquote</tt>.</li>
</ul>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set repetitions and sample size</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize the matrix of outcomes</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> reps)</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="co"># loop sampling and estimation of the coefficients</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>reps){</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a> sample <span class="ot">&lt;-</span> population[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N, n), ]</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a> fit[i, ] <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> sample)<span class="sc">$</span>coefficients</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a><span class="co"># compute variance estimates using outcomes</span></span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(fit[, <span class="dv">1</span>])</span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 4.186832</span></span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(fit[, <span class="dv">2</span>])</span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.03096199</span></span></code></pre></div>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># divide plotting area as 1-by-2 array</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot histograms of beta_0 estimates</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fit[, <span class="dv">1</span>],</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.main =</span> <span class="dv">1</span>,</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">bquote</span>(The <span class="sc">~</span> Distribution  <span class="sc">~</span> of <span class="sc">~</span> <span class="dv">10000</span> <span class="sc">~</span> beta[<span class="dv">0</span>] <span class="sc">~</span> Estimates), </span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">bquote</span>(<span class="fu">hat</span>(beta)[<span class="dv">0</span>]), </span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">freq =</span> F)</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a><span class="co"># add true distribution to plot</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, </span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>            <span class="sc">-</span><span class="dv">2</span>, </span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">sqrt</span>(var_b0)), </span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">add =</span> T, </span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a><span class="co"># plot histograms of beta_hat_1 </span></span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fit[, <span class="dv">2</span>],</span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.main =</span> <span class="dv">1</span>,</span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">bquote</span>(The <span class="sc">~</span> Distribution  <span class="sc">~</span> of <span class="sc">~</span> <span class="dv">10000</span> <span class="sc">~</span> beta[<span class="dv">1</span>] <span class="sc">~</span> Estimates), </span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">bquote</span>(<span class="fu">hat</span>(beta)[<span class="dv">1</span>]), </span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">freq =</span> F)</span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a><span class="co"># add true distribution to plot</span></span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, </span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a>            <span class="fl">3.5</span>, </span>
<span id="cb102-28"><a href="#cb102-28" aria-hidden="true" tabindex="-1"></a>            <span class="fu">sqrt</span>(var_b1)), </span>
<span id="cb102-29"><a href="#cb102-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">add =</span> T, </span>
<span id="cb102-30"><a href="#cb102-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-171-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Our variance estimates support the statements made in Key Concept 4.4, coming close to the theoretical values. The histograms suggest that the distributions of the estimators can be well approximated by the respective theoretical normal distributions stated in Key Concept 4.4.</p>
</div>
<div id="simulation-study-2" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Simulation Study 2<a href="#simulation-study-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A further result implied by Key Concept 4.4 is that both estimators are consistent, i.e., they converge in probability to the true parameters we are interested in. This is because they are asymptotically unbiased and their variances converge to <span class="math inline">\(0\)</span> as <span class="math inline">\(n\)</span> increases. We can check this by repeating the simulation above for a sequence of increasing sample sizes. This means we no longer assign the sample size but a <em>vector</em> of sample sizes: <tt>n &lt;- c(…)</tt>. <br>
Let us look at the distributions of <span class="math inline">\(\beta_1\)</span>. The idea here is to add an additional call of <tt>for()</tt> to the code. This is done in order to loop over the vector of sample sizes <tt>n</tt>. For each of the sample sizes we carry out the same simulation as before but plot a density estimate for the outcomes of each iteration over <tt>n</tt>. Notice that we have to change <tt>n</tt> to <tt>n[j]</tt> in the inner loop to ensure that the <tt>j</tt><span class="math inline">\(^{th}\)</span> element of <tt>n</tt> is used. In the simulation, we use sample sizes of <span class="math inline">\(100, 250, 1000\)</span> and <span class="math inline">\(3000\)</span>. Consequently we have a total of four distinct simulations using different sample sizes.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for reproducibility</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set repetitions and the vector of sample sizes</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">250</span>, <span class="dv">1000</span>, <span class="dv">3000</span>)</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize the matrix of outcomes</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> reps)</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="co"># divide the plot panel in a 2-by-2 array</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a><span class="co"># loop sampling and plotting</span></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a><span class="co"># outer loop over n</span></span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># inner loop: sampling and estimating of the coefficients</span></span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>reps){</span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a>    sample <span class="ot">&lt;-</span> population[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N, n[j]), ]</span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a>    fit[i, ] <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> sample)<span class="sc">$</span>coefficients</span>
<span id="cb103-24"><a href="#cb103-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-25"><a href="#cb103-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb103-26"><a href="#cb103-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-27"><a href="#cb103-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># draw density estimates</span></span>
<span id="cb103-28"><a href="#cb103-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">density</span>(fit[ ,<span class="dv">2</span>]), <span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">2.5</span>, <span class="fl">4.5</span>), </span>
<span id="cb103-29"><a href="#cb103-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> j, </span>
<span id="cb103-30"><a href="#cb103-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;n=&quot;</span>, n[j]), </span>
<span id="cb103-31"><a href="#cb103-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="fu">bquote</span>(<span class="fu">hat</span>(beta)[<span class="dv">1</span>]))</span>
<span id="cb103-32"><a href="#cb103-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-33"><a href="#cb103-33" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-172-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>We find that, as <span class="math inline">\(n\)</span> increases, the distribution of <span class="math inline">\(\hat\beta_1\)</span> concentrates around its mean, i.e., its variance decreases. Put differently, the likelihood of observing estimates close to the true value of <span class="math inline">\(\beta_1 = 3.5\)</span> grows as we increase the sample size. The same behavior can be observed if we analyze the distribution of <span class="math inline">\(\hat\beta_0\)</span> instead.</p>
</div>
<div id="simulation-study-3" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Simulation Study 3<a href="#simulation-study-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Furthermore, (4.1) reveals that the variance of the OLS estimator for <span class="math inline">\(\beta_1\)</span> decreases as the variance of the <span class="math inline">\(X_i\)</span> increases. In other words, as we increase the amount of information provided by the regressor, that is, increasing <span class="math inline">\(Var(X)\)</span>, which is used to estimate <span class="math inline">\(\beta_1\)</span>, we become more confident that the estimate is close to the true value (i.e., <span class="math inline">\(Var(\hat\beta_1)\)</span> decreases).<br>
We can visualize this by reproducing Figure 4.6 from the book. To do this, we sample observations <span class="math inline">\((X_i,Y_i)\)</span>, <span class="math inline">\(i=1,\dots,100\)</span> from a bivariate normal distribution with</p>
<p><span class="math display">\[E(X)=E(Y)=5,\]</span>
<span class="math display">\[Var(X)=Var(Y)=5\]</span>
and
<span class="math display">\[Cov(X,Y)=4.\]</span></p>
<p>Formally, this is written down as</p>
<p><span class="math display">\[\begin{equation}
  \begin{pmatrix}
    X \\
    Y \\
  \end{pmatrix}
  \overset{i.i.d.}{\sim} \ \mathcal{N}
  \left[
    \begin{pmatrix}
      5 \\
      5 \\
    \end{pmatrix}, \
    \begin{pmatrix}
      5 &amp; 4 \\
      4 &amp; 5 \\
    \end{pmatrix}
  \right]. \tag{4.3}
\end{equation}\]</span>g{4.3}
\end{equation}</p>
<p>To carry out the random sampling, we make use of the function <tt>mvrnorm()</tt> from the package <tt>MASS</tt> <span class="citation">(<a href="#ref-R-MASS" role="doc-biblioref">Ripley 2023</a>)</span> which allows to draw random samples from multivariate normal distributions, see <code>?mvtnorm</code>. Next, we use <tt>subset()</tt> to split the sample into two subsets such that the first set, <tt>set1</tt>, consists of observations that fulfill the condition <span class="math inline">\(\lvert X - \overline{X} \rvert &gt; 1\)</span> and the second set, <tt>set2</tt>, includes the remainder of the sample. We then plot both sets and use different colors to distinguish the observations.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the MASS package</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for reproducibility</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate bivarite normal data</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>bvndata <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">100</span>, </span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>), </span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">Sigma =</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>), <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>))) </span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a><span class="co"># assign column names / convert to data.frame</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(bvndata) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>bvndata <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(bvndata)</span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a><span class="co"># subset the data</span></span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>set1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(bvndata, <span class="fu">abs</span>(<span class="fu">mean</span>(X) <span class="sc">-</span> X) <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>set2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(bvndata, <span class="fu">abs</span>(<span class="fu">mean</span>(X) <span class="sc">-</span> X) <span class="sc">&lt;=</span> <span class="dv">1</span>)</span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a><span class="co"># plot both data sets</span></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(set1, </span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>, </span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>, </span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(set2, </span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb104-28"><a href="#cb104-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">19</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-173-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>It is clear that observations that are close to the sample average of the <span class="math inline">\(X_i\)</span> have less variance than those that are farther away. Now, if we were to draw a line as accurately as possible through either of the two sets it is intuitive that choosing the observations indicated by the black dots, i.e., using the set of observations which has larger variance than the blue ones, would result in a more precise line. Now, let us use OLS to estimate slope and intercept for both sets of observations. We then plot the observations along with both regression lines.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate both regression lines</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>lm.set1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> set1)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>lm.set2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> set2)</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot observations</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(set1, <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(set2, <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="co"># add both lines to the plot</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(lm.set1, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>)</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(lm.set2, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-174-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Evidently, the green regression line does far better in describing data sampled from the bivariate normal distribution stated in (<a href="#mjx-eqn-4.3">4.3</a>) than the red line. This is a nice example for demonstrating why we are interested in a high variance of the regressor <span class="math inline">\(X\)</span>: more variance in the <span class="math inline">\(X_i\)</span> means more information from which the precision of the estimation benefits.</p>
</div>
</div>
<div id="exercises-4" class="section level2 hasAnchor" number="4.6">
<h2 class="hasAnchor"><span class="header-section-number">4.6</span> Exercises<a href="#exercises-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="class-sizes-and-test-scores" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">1. Class Sizes and Test Scores<a href="#class-sizes-and-test-scores" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A researcher wants to analyze the relationship between class size (measured by the student-teacher ratio) and the average test score. Therefore he measures both variables in <span class="math inline">\(10\)</span> different classes and ends up with the following results.</p>


  <table>
      <tr>
        <td><b>Class Size</b></td>
        <td>23</td>
        <td>19</td>
        <td>30</td>
        <td>22</td>
        <td>23</td>
        <td>29</td>
        <td>35</td>
        <td>36</td>
        <td>33</td>
        <td>25</td>
      </tr>
      <tr>
        <td><b>Test Score</b></td>
        <td>430</td>
        <td>430</td>
        <td>333</td>
        <td>410</td>
        <td>390</td>
        <td>377</td>
        <td>325</td>
        <td>310</td>
        <td>328</td>
        <td>375</td>
      </tr>
    </table>


<p><strong>Instructions:</strong></p>
<ul>
<li><p>Create the vectors <tt>cs</tt> (the class size) and <tt>ts</tt> (the test score), containing the observations above.</p></li>
<li><p>Draw a scatterplot of the results using <tt>plot()</tt>.</p></li>
</ul>
<iframe src="DCL/ex4_1.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="mean-variance-covariance-and-correlation" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">2. Mean, Variance, Covariance and Correlation<a href="#mean-variance-covariance-and-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The vectors <tt>cs</tt> and <tt>ts</tt> are available in the working environment (you can check this: type their names into the console and press enter).</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Compute the mean, the sample variance and the sample standard deviation of <tt>ts</tt>.</p></li>
<li><p>Compute the covariance and the correlation coefficient for <tt>ts</tt> and <tt>cs</tt>.</p></li>
</ul>
<iframe src="DCL/ex4_2.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hint:</strong> Use the <tt>R</tt> functions presented in this chapter: <tt>mean()</tt>, <tt>sd()</tt>, <tt>cov()</tt>, <tt>cor()</tt> and <tt>var()</tt>.</p>
</div>
<div id="simple-linear-regression-1" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">3. Simple Linear Regression<a href="#simple-linear-regression-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The vectors <tt>cs</tt> and <tt>ts</tt> are available in the working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>The function <tt>lm()</tt> is part of the package <tt>AER</tt>. Attach the package using <tt>library()</tt>.</p></li>
<li><p>Use <tt>lm()</tt> to estimate the regression model <span class="math display">\[TestScore_i = \beta_0 + \beta_1 STR_i + u_i.\]</span> Assign the result to <tt>mod</tt>.</p></li>
<li><p>Obtain a statistical summary of the model.</p></li>
</ul>
<iframe src="DCL/ex4_3.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="the-model-object" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">4. The Model Object<a href="#the-model-object" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let us see how an object of class <tt>lm</tt> is structured.</p>
<p>The vectors <tt>cs</tt> and <tt>ts</tt> as well as the model object <tt>mod</tt> from the previous exercise are available in your workspace.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Use <tt>class()</tt> to learn about the class of the object <tt>mod</tt>.</li>
<li><tt>mod</tt> is an object of type <tt>list</tt> with named entries. Check this using the function <tt>is.list()</tt>.</li>
<li>See what information you can obtain from <tt>mod</tt> using <tt>names()</tt>.</li>
<li>Read out an arbitrary entry of the object <tt>mod</tt> using the <tt>$</tt> operator.</li>
</ul>
<iframe src="DCL/ex4_4.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="plotting-the-regression-line" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">5. Plotting the Regression Line<a href="#plotting-the-regression-line" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You are provided with the code for the scatterplot in <tt>script.R</tt></p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Add the regression line to the scatterplot from a few exercises before.</p></li>
<li><p>The object <tt>mod</tt> is available in your working environment.</p></li>
</ul>
<iframe src="DCL/ex4_5.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hint:</strong> Use the function <tt>abline()</tt>.</p>
</div>
<div id="summary-of-a-model-object" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">6. Summary of a Model Object<a href="#summary-of-a-model-object" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now read out and store some of the information that is contained in the output of <tt>summary()</tt>.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Assign the output of <tt>summary(mod)</tt> to the variable <tt>s</tt>.</p></li>
<li><p>Check entry names of the object <tt>s</tt>.</p></li>
<li><p>Create a new variable <tt>R2</tt> and assign the <span class="math inline">\(R^2\)</span> of the regression.</p></li>
</ul>
<p>The object <tt>mod</tt> is available in your working environment.</p>
<iframe src="DCL/ex4_6.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="estimated-coefficients" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">7. Estimated Coefficients<a href="#estimated-coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The function <tt>summary()</tt> also provides information on the statistical significance of the estimated coefficients.</p>
<p><strong>Instructions:</strong></p>
<p>Extract the named <span class="math inline">\(2\times4\)</span> matrix with estimated coefficients, standard errors, <span class="math inline">\(t\)</span>-statistics and corresponding <span class="math inline">\(p\)</span>-values from the model summary <tt>s</tt>. Save this matrix in an object named <tt>coefs</tt>.</p>
<p>The objects <tt>mod</tt> and <tt>s</tt> are available in your working environment.</p>
<iframe src="DCL/ex4_7.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="dropping-the-intercept" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">8. Dropping the Intercept<a href="#dropping-the-intercept" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>So far, we have estimated regression models consisting of an intercept and a single regressor. In this exercise you will learn how to specify and how to estimate regression a model without intercept.</p>
<p>Note that excluding the intercept from a regression model might be a dodgy practice in some applications as this imposes the conditional expectation function of the dependent variable to be zero if the regressor is zero.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Figure out how the <tt>formula</tt> argument must be specified for a regression of <tt>ts</tt> solely on <tt>cs</tt>, i.e., a regression without intercept. Google is your friend!</p></li>
<li><p>Estimate the regression model without intercept and store the result in <tt>mod_ni</tt>.</p></li>
</ul>
<p>The vectors <tt>cs</tt>, <tt>ts</tt> and the model object <tt>mod</tt> from previous exercises are available in the working environment.</p>
<iframe src="DCL/ex4_8.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="regression-output-no-constant-case" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">9. Regression Output: No Constant Case<a href="#regression-output-no-constant-case" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In Exercise 8 you have estimated a model without intercept. The estimated regression function is</p>
<p><span class="math display">\[\widehat{TestScore} = \underset{(1.36)}{12.65} \times STR.\]</span></p>
<p><strong>Instructions:</strong></p>
<p>Convince yourself that everything is as stated above: extract the coefficient matrix from the summary of <tt>mod_ni</tt> and store it in a variable named <tt>coef</tt>.</p>
<p>The vectors <tt>cs</tt>, <tt>ts</tt> as well as the model object <tt>mod_ni</tt> from the previous exercise are available in your working environment.</p>
<iframe src="DCL/ex4_9.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hint:</strong> An entry of a named list can be accessed using the <tt>$</tt> operator.</p>
</div>
<div id="regression-output-no-constant-case-ctd." class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">10. Regression Output: No Constant Case — Ctd.<a href="#regression-output-no-constant-case-ctd." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In Exercises 8 and 9 you have dealt with a model without intercept. The estimated regression function was</p>
<p><span class="math display">\[\widehat{TestScore_i} = \underset{(1.36)}{12.65} \times STR_i.\]</span></p>
<p>The coefficient matrix <tt>coef</tt> from Exercise 9 contains the estimated coefficient on <span class="math inline">\(STR\)</span>, its standard error, the <span class="math inline">\(t\)</span>-statistic of the significance test and the corresponding <span class="math inline">\(p\)</span>-value.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Print the contents of <tt>coef</tt> to the console.</li>
<li>Convince yourself that the reported <span class="math inline">\(t\)</span>-statistic is correct: use the entries of <tt>coef</tt> to compute the <span class="math inline">\(t\)</span>-statistic and save it to <tt>t_stat</tt>.</li>
</ul>
<p>The matrix <tt>coef</tt> from the previous exercise is available in your working environment.</p>
<iframe src="DCL/ex4_10.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p><tt>X[a,b]</tt> returns the <tt>[a,b]</tt> element of the matrix <tt>X</tt>.</p></li>
<li><p>The <span class="math inline">\(t\)</span>-statistic for a test of the hypothesis <span class="math inline">\(H_0: \beta_1 = 0\)</span> is computed as <span class="math display">\[t = \frac{\hat{\beta}_1}{SE(\hat{\beta}_1)}.\]</span></p></li>
</ul>
</div>
<div id="two-regressions-one-plot" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">11. Two Regressions, One Plot<a href="#two-regressions-one-plot" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The two estimated regression models from the previous exercises are</p>
<p><span class="math display">\[\widehat{TestScore_i} = \underset{(1.36)}{12.65} \times STR_i\]</span></p>
<p>and</p>
<p><span class="math display">\[\widehat{TestScore_i} = \underset{(23.96)}{567.4272} \underset{(0.85)}{-7.1501} \times STR_i.\]</span></p>
<p>You are provided with the code line <tt>plot(cs, ts)</tt> which creates a scatterplot of <tt>ts</tt> and <tt>cs</tt>. Note that this line must be executed before calling <tt>abline()</tt>! You may color the regression lines by using, e.g., <tt>col = “red”</tt> or <tt>col = “blue”</tt> as an additional argument to <tt>abline()</tt> for better distinguishability.</p>
<p>The vectors <tt>cs</tt> and <tt>ts</tt> as well as the list objects <tt>mod</tt> and <tt>mod_ni</tt> from previous exercises are available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<p>Generate a scatterplot of <tt>ts</tt> and <tt>cs</tt> and add the estimated regression lines of <tt>mod</tt> and <tt>mod_ni</tt>.</p>
<iframe src="DCL/ex4_11.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="tss-and-ssr" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">12. <span class="math inline">\(TSS\)</span> and <span class="math inline">\(SSR\)</span><a href="#tss-and-ssr" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If graphical inspection does not help, researchers resort to analytic techniques in order to detect if a model fits the data at hand good or better than another model.</p>
<p>Let us go back to the simple regression model including an intercept. The estimated regression line for <tt>mod</tt> was</p>
<p><span class="math display">\[\widehat{TestScore_i} = 567.43 - 7.15 \times STR_i, \, R^2 = 0.8976, \, SER=15.19.\]</span></p>
<p>You can check this as <tt>mod</tt> and the vectors <tt>cs</tt> and <tt>ts</tt> are available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Compute <span class="math inline">\(SSR\)</span>, the sum of squared residuals, and save it to <tt>ssr</tt>.</li>
<li>Compute <span class="math inline">\(TSS\)</span>, the total sum of squares, and save it to <tt>tss</tt>.</li>
</ul>
<iframe src="DCL/ex4_12.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="the-r2-of-a-regression-model" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">13. The <span class="math inline">\(R^2\)</span> of a Regression Model<a href="#the-r2-of-a-regression-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <span class="math inline">\(R^2\)</span> of the regression saved in <tt>mod</tt> is <span class="math inline">\(0.8976\)</span>. You can check this by executing <tt>summary(mod)$r.squared</tt> in the console below.</p>
<p>Remember the formula of <span class="math inline">\(R^2\)</span>:</p>
<p><span class="math display">\[R^2 = \frac{ESS}{TSS} = 1 - \frac{SSR}{TSS}\]</span></p>
<p>The objects <tt>mod</tt>, <tt>tss</tt> and <tt>ssr</tt> from the previous exercise are available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Use <tt>ssr</tt> and <tt>tss</tt> to compute <span class="math inline">\(R^2\)</span> manually. <em>Round</em> the result to <em>four</em> decimal places and save it to <tt>R2</tt>.</li>
<li>Use the logical operator <tt>==</tt> to check whether your result matches the value mentioned above.</li>
</ul>
<iframe src="DCL/ex4_13.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<p>You may round numeric values using the function <tt>round()</tt>.</p>
</div>
<div id="the-standard-error-of-the-regression-1" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">14. The Standard Error of The Regression<a href="#the-standard-error-of-the-regression-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The standard error of the Regression in the simple regression model is <span class="math display">\[SER = \frac{1}{n-2} \sum_{i=1}^n \widehat{u}_i^2 =\sqrt{\frac{SSR}{n-2}}.\]</span> <span class="math inline">\(SER\)</span> measures the size of an average residual which is an estimate of the magnitude of a typical regression error.</p>
<p>The model object <tt>mod</tt> and the vectors <tt>cs</tt> and </tt>ts</tt> are available in your workspace.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Use <tt>summary()</tt> to obtain the <span class="math inline">\(SER\)</span> for the regression of <tt>ts</tt> on <tt>cs</tt> saved in the model object <tt>mod</tt>. Save the result in the variable <tt>SER</tt>.</p></li>
<li><p>Use <tt>SER</tt> to compute the <span class="math inline">\(SSR\)</span> and store it in <tt>SSR</tt>.</p></li>
<li><p>Check that <tt>SSR</tt> is indeed the <span class="math inline">\(SSR\)</span> by comparing <tt>SSR</tt> to the result of <tt>sum(mod$residuals^2)</tt></p></li>
</ul>
<iframe src="DCL/ex4_14.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="the-estimated-covariance-matrix" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">15. The Estimated Covariance Matrix<a href="#the-estimated-covariance-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As has been discussed in Chapter @ref(tlsa), the OLS estimators <span class="math inline">\(\widehat{\beta}_0\)</span> and <span class="math inline">\(\widehat{\beta}_1\)</span> are functions of the random error term. Therefore, they are random variables themselves. For two or more random variables, their covariances and variances are summarized by a <em>variance-covariance matrix</em> (which is often simply called the <em>covariance matrix</em>). Taking the square root of the diagonal elements of the estimated covariance matrix obtains <span class="math inline">\(SE(\widehat\beta_0)\)</span> and <span class="math inline">\(SE(\widehat\beta_1)\)</span>, the standard errors of <span class="math inline">\(\widehat{\beta}_0\)</span> and <span class="math inline">\(\widehat{\beta}_1\)</span>.</p>
<p><tt>summary()</tt> computes an estimate of this matrix. The respective entry in the output of summary (remember that <tt>summary()</tt> produces a list) is called <tt>cov.unscaled</tt>. The model object <tt>mod</tt> is available in your workspace.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Use <tt>summary()</tt> to obtain the covariance matrix estimate for the regression of test scores on student-teacher ratios stored in the model object <tt>mod</tt>. Save the result to <tt>cov_matrix</tt>.</p></li>
<li><p>Obtain the diagonal elements of <tt>cov_matrix</tt>, compute their square root and assign the result to the variable <tt>SEs</tt>.</p></li>
</ul>
<iframe src="DCL/ex4_15.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hint:</strong> <tt>diag(A)</tt> returns a vector containing the diagonal elements of the matrix <tt>A</tt>.</p>
</div>
<!--chapter:end:04-ch4.Rmd-->
</div>
</div>
<div id="htaciitslrm" class="section level1 hasAnchor" number="5">
<h1 class="hasAnchor"><span class="header-section-number">5</span> Hypothesis Tests and Confidence Intervals in the Simple Linear Regression Model<a href="#htaciitslrm" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter, continues our treatment of the simple linear regression model. The following subsections discuss how we may use our knowledge about the sampling distribution of the OLS estimator in order to make statements regarding its uncertainty.</p>
<p>These subsections cover the following topics:</p>
<ul>
<li><p>Testing Hypotheses regarding regression coefficients.</p></li>
<li><p>Confidence intervals for regression coefficients.</p></li>
<li><p>Regression when <span class="math inline">\(X\)</span> is a dummy variable.</p></li>
<li><p>Heteroskedasticity and Homoskedasticity.</p></li>
</ul>
<p>The packages <tt>AER</tt> <span class="citation">(<a href="#ref-R-AER" role="doc-biblioref">Christian Kleiber and Zeileis 2022</a>)</span> and <tt>scales</tt> <span class="citation">(<a href="#ref-R-scales" role="doc-biblioref">Wickham and Seidel 2022</a>)</span> are required for reproduction of the code chunks presented throughout this chapter. The package <tt>scales</tt> provides additional generic plot scaling methods. Make sure both packages are installed before you proceed. The safest way to do so is by checking whether the following code chunk executes without any errors.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span></code></pre></div>
<div id="testing-two-sided-hypotheses-concerning-the-slope-coefficient" class="section level2 hasAnchor" number="5.1">
<h2 class="hasAnchor"><span class="header-section-number">5.1</span> Testing Two-Sided Hypotheses Concerning the Slope Coefficient<a href="#testing-two-sided-hypotheses-concerning-the-slope-coefficient" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Using the fact that <span class="math inline">\(\hat{\beta}_1\)</span> is approximately normally distributed in large samples (see <a href="#tsdotoe">Key Concept 4.4</a>), testing hypotheses about the true value <span class="math inline">\(\beta_1\)</span> can be done as in Chapter @ref(potsm).</p>
<div id="KC5.1" class="keyconcept">
<h3 class="right">
Key Concept 5.1
</h3>
<h3 class="left">
General Form of the <span class="math inline">\(t\)</span>-Statistic
</h3>
<p>Remember from Chapter @ref(arosur) that a general <span class="math inline">\(t\)</span>-statistic has the form
<span class="math display">\[ t = \frac{\text{estimated value} - \text{hypothesized value}}{\text{standard error of the estimator}}.\]</span></p>
</div>
<div id="KC5.2" class="keyconcept">
<h3 class="right">
Key Concept 5.2
</h3>
<h3 class="left">
Testing Hypotheses regarding <span class="math inline">\(\beta_1\)</span>
</h3>
<p>For testing the hypothesis <span class="math inline">\(H_0: \beta_1 = \beta_{1,0}\)</span>, we need to perform the following steps:</p>
<ol style="list-style-type: decimal">
<li>Compute the standard error of <span class="math inline">\(\hat{\beta}_1\)</span>, <span class="math inline">\(SE(\hat{\beta}_1)\)</span></li>
</ol>
<p><span class="math display">\[ SE(\hat{\beta}_1) = \sqrt{ \hat{\sigma}^2_{\hat{\beta}_1} } \ \ , \ \
  \hat{\sigma}^2_{\hat{\beta}_1} = \frac{1}{n} \times \frac{\frac{1}{n-2} \sum_{i=1}^n (X_i - \overline{X})^2 \hat{u_i}^2 }{ \left[ \frac{1}{n} \sum_{i=1}^n (X_i - \overline{X})^2 \right]^2}.
\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li>Compute the <span class="math inline">\(t\)</span>-statistic</li>
</ol>
<p><span class="math display">\[ t = \frac{\hat{\beta}_1 - \beta_{1,0}}{ SE(\hat{\beta}_1) }. \]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Given a two sided alternative (<span class="math inline">\(H_1:\beta_1 \neq \beta_{1,0}\)</span>) we reject at the <span class="math inline">\(5\%\)</span> level if <span class="math inline">\(|t^{act}| &gt; 1.96\)</span> or, equivalently, if the <span class="math inline">\(p\)</span>-value is less than <span class="math inline">\(0.05\)</span>.<br><br />
Recall the definition of the <span class="math inline">\(p\)</span>-value:</li>
</ol>
<p><span class="math display">\[\begin{align*}
    p \text{-value} =&amp; \, \text{Pr}_{H_0} \left[ \left| \frac{ \hat{\beta}_1 - \beta_{1,0} }{ SE(\hat{\beta}_1) } \right| &gt; \left|        \frac{ \hat{\beta}_1^{act} - \beta_{1,0} }{ SE(\hat{\beta}_1) } \right| \right] \\
    =&amp; \, \text{Pr}_{H_0} (|t| &gt; |t^{act}|) \\
    \approx&amp; \, 2 \cdot \Phi(-|t^{act}|)
  \end{align*}\]</span></p>
<p>       The last transformation is due to the normal approximation for large samples.</p>
</div>
<p>Consider again the OLS regression stored in <tt>linear_model</tt> from Chapter @ref(lrwor) that gave us the regression line</p>
<p><span class="math display">\[ \widehat{TestScore} \ = \underset{(9.47)}{698.9} - \underset{(0.49)}{2.28} \times STR \ , \ R^2=0.051 \ , \ SER=18.6. \]</span></p>
<p>Copy and execute the following code chunk if the above model object is not available in your working environment.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the `CASchools` dataset</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(CASchools)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="co"># add student-teacher ratio</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>CASchools<span class="sc">$</span>STR <span class="ot">&lt;-</span> CASchools<span class="sc">$</span>students<span class="sc">/</span>CASchools<span class="sc">$</span>teachers</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="co"># add average test-score</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>CASchools<span class="sc">$</span>score <span class="ot">&lt;-</span> (CASchools<span class="sc">$</span>read <span class="sc">+</span> CASchools<span class="sc">$</span>math)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model</span></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>linear_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> STR, <span class="at">data =</span> CASchools)          </span></code></pre></div>
<p>For testing a hypothesis concerning the slope parameter (the coefficient on <span class="math inline">\(STR\)</span>), we need <span class="math inline">\(SE(\hat{\beta}_1)\)</span>, the standard error of the respective point estimator. As is common in the literature, standard errors are presented in parentheses below the point estimates.</p>
<p>Key Concept 5.1 reveals that it is rather cumbersome to compute the standard error and thereby the <span class="math inline">\(t\)</span>-statistic by hand. The question you should be asking yourself right now is: can we obtain these values with minimum effort using <tt>R</tt>? Yes, we can. Let us first use <tt>summary()</tt> to get a summary on the estimated coefficients in <tt>linear_model</tt>.</p>
<p><strong>Note</strong>: Throughout the textbook, robust standard errors are reported. We consider it instructive keep things simple at the beginning and thus start out with simple examples that do not allow for robust inference. Standard errors that are robust to heteroskedasticity are introduced in Chapter @ref(hah) where we also demonstrate how they can be computed using <tt>R</tt>. A discussion of heteroskedasticity-autocorrelation robust standard errors takes place in Chapter @ref(eodce).</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print the summary of the coefficients to the console</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(linear_model)<span class="sc">$</span>coefficients</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error   t value      Pr(&gt;|t|)</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 698.932949  9.4674911 73.824516 6.569846e-242</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; STR          -2.279808  0.4798255 -4.751327  2.783308e-06</span></span></code></pre></div>
<p>The second column of the coefficients’ summary, reports <span class="math inline">\(SE(\hat\beta_0)\)</span> and <span class="math inline">\(SE(\hat\beta_1)\)</span>. Also, in the third column <tt>t value</tt>, we find <span class="math inline">\(t\)</span>-statistics <span class="math inline">\(t^{act}\)</span> suitable for tests of the separate hypotheses <span class="math inline">\(H_0: \beta_0=0\)</span> and <span class="math inline">\(H_0: \beta_1=0\)</span>. Furthermore, the output provides us with <span class="math inline">\(p\)</span>-values corresponding to both tests against the two-sided alternatives <span class="math inline">\(H_1:\beta_0\neq0\)</span> respectively <span class="math inline">\(H_1:\beta_1\neq0\)</span> in the fourth column of the table.</p>
<p>Let us have a closer look at the test of</p>
<p><span class="math display">\[H_0: \beta_1=0 \ \ \ vs. \ \ \ H_1: \beta_1 \neq 0.\]</span></p>
<p>We have <span class="math display">\[ t^{act} = \frac{-2.279808 - 0}{0.4798255} \approx - 4.75. \]</span></p>
<p>What does this tell us about the significance of the estimated coefficient? We reject the null hypothesis at the <span class="math inline">\(5\%\)</span> level of significance since <span class="math inline">\(|t^{act}| &gt; 1.96\)</span>. That is, the observed test statistic falls into the rejection region as <span class="math inline">\(p\text{-value} = 2.78\cdot 10^{-6} &lt; 0.05\)</span>. We conclude that the coefficient is significantly different from zero. In other words, we reject the hypothesis that the class size <em>has no influence</em> on the students test scores at the <span class="math inline">\(5\%\)</span> level.</p>
<p>Note that although the difference is negligible in the present case as we will see later, <tt>summary()</tt> does not perform the normal approximation but calculates <span class="math inline">\(p\)</span>-values using the <span class="math inline">\(t\)</span>-distribution instead. Generally, the degrees of freedom of the assumed <span class="math inline">\(t\)</span>-distribution are determined in the following manner:</p>
<p><span class="math display">\[ \text{DF} = n - k - 1 \]</span></p>
<p>where <span class="math inline">\(n\)</span> is the number of observations used to estimate the model and <span class="math inline">\(k\)</span> is the number of regressors, excluding the intercept. In our case, we have <span class="math inline">\(n=420\)</span> observations and the only regressor is <span class="math inline">\(STR\)</span> so <span class="math inline">\(k=1\)</span>. The simplest way to determine the model degrees of freedom is</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># determine residual degrees of freedom</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>linear_model<span class="sc">$</span>df.residual</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 418</span></span></code></pre></div>
<p>Hence, for the assumed sampling distribution of <span class="math inline">\(\hat\beta_1\)</span> we have</p>
<p><span class="math display">\[\hat\beta_1 \sim t_{418}\]</span>
such that the <span class="math inline">\(p\)</span>-value for a two-sided significance test can be obtained by executing the following code:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="sc">-</span><span class="fl">4.751327</span>, <span class="at">df =</span> <span class="dv">418</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2.78331e-06</span></span></code></pre></div>
<p>The result is very close to the value provided by <tt>summary()</tt>. However since <span class="math inline">\(n\)</span> is sufficiently large one could just as well use the standard normal density to compute the <span class="math inline">\(p\)</span>-value:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fl">4.751327</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2.02086e-06</span></span></code></pre></div>
<p>The difference is indeed negligible. These findings tell us that, if <span class="math inline">\(H_0: \beta_1 = 0\)</span> is true and we were to repeat the whole process of gathering observations and estimating the model, observing a <span class="math inline">\(\hat\beta_1 \geq |-2.28|\)</span> is very unlikely!</p>
<p>Using <tt>R</tt> we may visualize how such a statement is made when using the normal approximation. This reflects the principles depicted in figure 5.1 in the book. Do not let the following code chunk deter you: the code is somewhat longer than the usual examples and looks unappealing but there is a lot of repetition since color shadings and annotations are added on both tails of the normal distribution. We recommend to execute the code step by step in order to see how the graph is augmented with the annotations.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the standard normal on the support [-6,6]</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="fl">0.01</span>)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> t, </span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> <span class="fu">dnorm</span>(t, <span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">yaxs =</span> <span class="st">&quot;i&quot;</span>, </span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">axes =</span> F, </span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">expression</span>(<span class="st">&quot;Calculating the p-value of a Two-sided Test when&quot;</span> <span class="sc">~</span> t<span class="sc">^</span>act <span class="sc">~</span> <span class="st">&quot;=-4.75&quot;</span>), </span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab =</span> <span class="fl">0.7</span>,</span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.main =</span> <span class="dv">1</span>)</span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>tact <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">4.75</span></span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="fl">1.96</span>, <span class="fl">1.96</span>, <span class="sc">-</span>tact, tact), <span class="at">cex.axis =</span> <span class="fl">0.7</span>)</span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Shade the critical regions using polygon():</span></span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true" tabindex="-1"></a><span class="co"># critical region in left tail</span></span>
<span id="cb112-24"><a href="#cb112-24" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="sc">-</span><span class="fl">1.96</span>, <span class="fl">0.01</span>), <span class="sc">-</span><span class="fl">1.96</span>),</span>
<span id="cb112-25"><a href="#cb112-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="sc">-</span><span class="fl">1.96</span>, <span class="fl">0.01</span>)), <span class="dv">0</span>), </span>
<span id="cb112-26"><a href="#cb112-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&#39;orange&#39;</span>)</span>
<span id="cb112-27"><a href="#cb112-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-28"><a href="#cb112-28" aria-hidden="true" tabindex="-1"></a><span class="co"># critical region in right tail</span></span>
<span id="cb112-29"><a href="#cb112-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-30"><a href="#cb112-30" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">1.96</span>, <span class="fu">seq</span>(<span class="fl">1.96</span>, <span class="dv">6</span>, <span class="fl">0.01</span>), <span class="dv">6</span>),</span>
<span id="cb112-31"><a href="#cb112-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="fl">1.96</span>, <span class="dv">6</span>, <span class="fl">0.01</span>)), <span class="dv">0</span>), </span>
<span id="cb112-32"><a href="#cb112-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&#39;orange&#39;</span>)</span>
<span id="cb112-33"><a href="#cb112-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-34"><a href="#cb112-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Add arrows and texts indicating critical regions and the p-value</span></span>
<span id="cb112-35"><a href="#cb112-35" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="fl">0.2</span>, <span class="sc">-</span><span class="fl">2.5</span>, <span class="fl">0.02</span>, <span class="at">length =</span> <span class="fl">0.1</span>)</span>
<span id="cb112-36"><a href="#cb112-36" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="fl">3.5</span>, <span class="fl">0.2</span>, <span class="fl">2.5</span>, <span class="fl">0.02</span>, <span class="at">length =</span> <span class="fl">0.1</span>)</span>
<span id="cb112-37"><a href="#cb112-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-38"><a href="#cb112-38" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="fl">0.16</span>, <span class="sc">-</span><span class="fl">4.75</span>, <span class="dv">0</span>, <span class="at">length =</span> <span class="fl">0.1</span>)</span>
<span id="cb112-39"><a href="#cb112-39" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="dv">5</span>, <span class="fl">0.16</span>, <span class="fl">4.75</span>, <span class="dv">0</span>, <span class="at">length =</span> <span class="fl">0.1</span>)</span>
<span id="cb112-40"><a href="#cb112-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-41"><a href="#cb112-41" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="fl">0.22</span>, </span>
<span id="cb112-42"><a href="#cb112-42" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">expression</span>(<span class="st">&quot;0.025&quot;</span><span class="sc">~</span><span class="st">&quot;=&quot;</span><span class="sc">~</span><span class="fu">over</span>(alpha, <span class="dv">2</span>)),</span>
<span id="cb112-43"><a href="#cb112-43" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb112-44"><a href="#cb112-44" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">3.5</span>, <span class="fl">0.22</span>, </span>
<span id="cb112-45"><a href="#cb112-45" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">expression</span>(<span class="st">&quot;0.025&quot;</span><span class="sc">~</span><span class="st">&quot;=&quot;</span><span class="sc">~</span><span class="fu">over</span>(alpha, <span class="dv">2</span>)),</span>
<span id="cb112-46"><a href="#cb112-46" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb112-47"><a href="#cb112-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-48"><a href="#cb112-48" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="fl">0.18</span>, </span>
<span id="cb112-49"><a href="#cb112-49" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;-|&quot;</span>,t[act],<span class="st">&quot;|&quot;</span>)), </span>
<span id="cb112-50"><a href="#cb112-50" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb112-51"><a href="#cb112-51" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">5</span>, <span class="fl">0.18</span>, </span>
<span id="cb112-52"><a href="#cb112-52" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;|&quot;</span>,t[act],<span class="st">&quot;|&quot;</span>)), </span>
<span id="cb112-53"><a href="#cb112-53" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb112-54"><a href="#cb112-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-55"><a href="#cb112-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Add ticks indicating critical values at the 0.05-level, t^act and -t^act </span></span>
<span id="cb112-56"><a href="#cb112-56" aria-hidden="true" tabindex="-1"></a><span class="fu">rug</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.96</span>, <span class="fl">1.96</span>), <span class="at">ticksize  =</span> <span class="fl">0.145</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb112-57"><a href="#cb112-57" aria-hidden="true" tabindex="-1"></a><span class="fu">rug</span>(<span class="fu">c</span>(<span class="sc">-</span>tact, tact), <span class="at">ticksize  =</span> <span class="sc">-</span><span class="fl">0.0451</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-200-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The <span class="math inline">\(p\)</span>-Value is the area under the curve to left of <span class="math inline">\(-4.75\)</span> plus the area under the curve to the right of <span class="math inline">\(4.75\)</span>. As we already know from the calculations above, this value is very small.</p>
</div>
<div id="cifrc" class="section level2 hasAnchor" number="5.2">
<h2 class="hasAnchor"><span class="header-section-number">5.2</span> Confidence Intervals for Regression Coefficients<a href="#cifrc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As we already know, estimates of the regression coefficients <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are subject to sampling uncertainty, see Chapter @ref(lrwor). Therefore, we will <em>never</em> exactly estimate the true value of these parameters from sample data in an empirical application. However, we may construct confidence intervals for the intercept and the slope parameter.</p>
<p>A <span class="math inline">\(95\%\)</span> confidence interval for <span class="math inline">\(\beta_i\)</span> has two equivalent definitions:</p>
<ul>
<li>The interval is the set of values for which a hypothesis test to the level of <span class="math inline">\(5\%\)</span> cannot be rejected.</li>
<li>The interval has a probability of <span class="math inline">\(95\%\)</span> to contain the true value of <span class="math inline">\(\beta_i\)</span>. So in <span class="math inline">\(95\%\)</span> of all samples that could be drawn, the confidence interval will cover the true value of <span class="math inline">\(\beta_i\)</span>.</li>
</ul>
<p>We also say that the interval has a confidence level of <span class="math inline">\(95\%\)</span>. The idea of the confidence interval is summarized in Key Concept 5.3.</p>
<div id="KC5.3" class="keyconcept">
<h3 class="right">
Key Concept 5.3
</h3>
<h3 class="left">
A Confidence Interval for <span class="math inline">\(\beta_i\)</span>
</h3>
<p>Imagine you could draw all possible random samples of given size. The interval that contains the true value <span class="math inline">\(\beta_i\)</span> in <span class="math inline">\(95\%\)</span> of all samples is given by the expression</p>
<p><span class="math display">\[ \text{CI}_{0.95}^{\beta_i} = \left[ \hat{\beta}_i - 1.96 \times SE(\hat{\beta}_i) \, , \, \hat{\beta}_i + 1.96 \times SE(\hat{\beta}_i) \right]. \]</span></p>
<p>Equivalently, this interval can be seen as the set of null hypotheses for which a <span class="math inline">\(5\%\)</span> two-sided hypothesis test does not reject.</p>
</div>
<div id="simulation-study-confidence-intervals" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Simulation Study: Confidence Intervals<a href="#simulation-study-confidence-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To get a better understanding of confidence intervals we conduct another simulation study. For now, assume that we have the following sample of <span class="math inline">\(n=100\)</span> observations on a single variable <span class="math inline">\(Y\)</span> where</p>
<p><span class="math display">\[ Y_i \overset{i.i.d}{\sim} \mathcal{N}(5,25), \ i = 1, \dots, 100.\]</span></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for reproducibility</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="co"># generate and plot the sample data</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">100</span>, </span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">mean =</span> <span class="dv">5</span>, </span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Y, </span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, </span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-203-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>We assume that the data is generated by the model</p>
<p><span class="math display">\[ Y_i = \mu + \epsilon_i \]</span></p>
<p>where <span class="math inline">\(\mu\)</span> is an unknown constant and we know that <span class="math inline">\(\epsilon_i \overset{i.i.d.}{\sim} \mathcal{N}(0,25)\)</span>. In this model, the OLS estimator for <span class="math inline">\(\mu\)</span> is given by <span class="math display">\[ \hat\mu = \overline{Y} = \frac{1}{n} \sum_{i=1}^n Y_i, \]</span> i.e., the sample average of the <span class="math inline">\(Y_i\)</span>. It further holds that</p>
<p><span class="math display">\[ SE(\hat\mu) = \frac{\sigma_{\epsilon}}{\sqrt{n}} = \frac{5}{\sqrt{100}} \]</span></p>
<p>(see Chapter <a href="#SVSSDASE">2</a>) A large-sample <span class="math inline">\(95\%\)</span> confidence interval for <span class="math inline">\(\mu\)</span> is then given by</p>
<p><span class="math display">\[\begin{equation}
CI^{\mu}_{0.95} = \left[\hat\mu - 1.96 \times \frac{5}{\sqrt{100}} \ , \ \hat\mu + 1.96 \times \frac{5}{\sqrt{100}}  \right]. (\#eq:KI)
\end{equation}\]</span></p>
<p>It is fairly easy to compute this interval in <tt>R</tt> by hand. The following code chunk generates a named vector containing the interval bounds:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">CIlower =</span> <span class="fu">mean</span>(Y) <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="dv">5</span> <span class="sc">/</span> <span class="dv">10</span>, <span class="at">CIupper =</span> <span class="fu">mean</span>(Y) <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="dv">5</span> <span class="sc">/</span> <span class="dv">10</span>)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       CIlower  CIupper</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 4.502625 6.462625</span></span></code></pre></div>
<p>Knowing that <span class="math inline">\(\mu = 5\)</span> we see that, for our example data, the confidence interval covers true value.</p>
<p>As opposed to real world examples, we can use <tt>R</tt> to get a better understanding of confidence intervals by repeatedly sampling data, estimating <span class="math inline">\(\mu\)</span> and computing the confidence interval for <span class="math inline">\(\mu\)</span> as in @ref(eq:KI).</p>
<p>The procedure is as follows:</p>
<ul>
<li>We initialize the vectors <tt>lower</tt> and <tt>upper</tt> in which the simulated interval limits are to be saved. We want to simulate <span class="math inline">\(10000\)</span> intervals so both vectors are set to have this length.</li>
<li>We use a <tt>for()</tt> loop to sample <span class="math inline">\(100\)</span> observations from the <span class="math inline">\(\mathcal{N}(5,25)\)</span> distribution and compute <span class="math inline">\(\hat\mu\)</span> as well as the boundaries of the confidence interval in every iteration of the loop.</li>
<li>At last we join <tt>lower</tt> and <tt>upper</tt> in a matrix.</li>
</ul>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize vectors of lower and upper interval boundaries</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">10000</span>)</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">10000</span>)</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="co"># loop sampling / estimation / CI</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>) {</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>  lower[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Y) <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="dv">5</span> <span class="sc">/</span> <span class="dv">10</span></span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>  upper[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Y) <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="dv">5</span> <span class="sc">/</span> <span class="dv">10</span></span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a><span class="co"># join vectors of interval bounds in a matrix</span></span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>CIs <span class="ot">&lt;-</span> <span class="fu">cbind</span>(lower, upper)</span></code></pre></div>
<p>According to Key Concept 5.3 we expect that the fraction of the <span class="math inline">\(10000\)</span> simulated intervals saved in the matrix <tt>CIs</tt> that contain the true value <span class="math inline">\(\mu=5\)</span> should be roughly <span class="math inline">\(95\%\)</span>. We can easily check this using logical operators.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(CIs[, <span class="dv">1</span>] <span class="sc">&lt;=</span> <span class="dv">5</span> <span class="sc">&amp;</span> <span class="dv">5</span> <span class="sc">&lt;=</span> CIs[, <span class="dv">2</span>])</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.9487</span></span></code></pre></div>
<p>The simulation shows that the fraction of intervals covering <span class="math inline">\(\mu=5\)</span>, i.e., those intervals for which <span class="math inline">\(H_0: \mu = 5\)</span> cannot be rejected is close to the theoretical value of <span class="math inline">\(95\%\)</span>.</p>
<p>Let us draw a plot of the first <span class="math inline">\(100\)</span> simulated confidence intervals and indicate those which <em>do not</em> cover the true value of <span class="math inline">\(\mu\)</span>. We do this via horizontal lines representing the confidence intervals on top of each other.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># identify intervals not covering mu</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (4 intervals out of 100)</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>ID <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="sc">!</span>(CIs[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">1</span>] <span class="sc">&lt;=</span> <span class="dv">5</span> <span class="sc">&amp;</span> <span class="dv">5</span> <span class="sc">&lt;=</span> CIs[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">2</span>]))</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize the plot</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span>, </span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>), </span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">100</span>), </span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Sample&quot;</span>, </span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(mu), </span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Confidence Intervals&quot;</span>)</span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a><span class="co"># set up color vector</span></span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">gray</span>(<span class="fl">0.6</span>), <span class="dv">100</span>)</span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a>colors[ID] <span class="ot">&lt;-</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a><span class="co"># draw reference line at mu=5</span></span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">5</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a><span class="co"># add horizontal bars representing the CIs</span></span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb117-23"><a href="#cb117-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">c</span>(CIs[j, <span class="dv">1</span>], CIs[j, <span class="dv">2</span>]), </span>
<span id="cb117-24"><a href="#cb117-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(j, j), </span>
<span id="cb117-25"><a href="#cb117-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> colors[j], </span>
<span id="cb117-26"><a href="#cb117-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb117-27"><a href="#cb117-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb117-28"><a href="#cb117-28" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-207-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>For the first <span class="math inline">\(100\)</span> samples, the true null hypothesis is rejected in four cases so these intervals do not cover <span class="math inline">\(\mu=5\)</span>. We have indicated the intervals which lead to a rejection of the null red.</p>
<p>Let us now come back to the example of test scores and class sizes. The regression model from Chapter @ref(lrwor) is stored in <tt>linear_model</tt>. An easy way to get <span class="math inline">\(95\%\)</span> confidence intervals for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, the coefficients on <tt>(intercept)</tt> and <tt>STR</tt>, is to use the function <tt>confint()</tt>. We only have to provide a fitted model object as an input to this function. The confidence level is set to <span class="math inline">\(95\%\)</span> by default but can be modified by setting the argument <tt>level</tt>, see <tt>?confint</tt>.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute 95% confidence interval for coefficients in &#39;linear_model&#39;</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(linear_model)</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 2.5 %     97.5 %</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 680.32312 717.542775</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; STR          -3.22298  -1.336636</span></span></code></pre></div>
<p>Let us check if the calculation is done as we expect it to be for <span class="math inline">\(\beta_1\)</span>, the coefficient on <tt>STR</tt>.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute 95% confidence interval for coefficients in &#39;linear_model&#39; by hand</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>lm_summ <span class="ot">&lt;-</span> <span class="fu">summary</span>(linear_model)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;lower&quot;</span> <span class="ot">=</span> lm_summ<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> lm_summ<span class="sc">$</span>df[<span class="dv">2</span>]) <span class="sc">*</span> lm_summ<span class="sc">$</span>coef[<span class="dv">2</span>, <span class="dv">2</span>],</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;upper&quot;</span> <span class="ot">=</span> lm_summ<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> lm_summ<span class="sc">$</span>df[<span class="dv">2</span>]) <span class="sc">*</span> lm_summ<span class="sc">$</span>coef[<span class="dv">2</span>, <span class="dv">2</span>])</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     lower     upper </span></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -3.222980 -1.336636</span></span></code></pre></div>
<p>The upper and the lower bounds coincide. We have used the <span class="math inline">\(0.975\)</span>-quantile of the <span class="math inline">\(t_{418}\)</span> distribution to get the exact result reported by <tt>confint</tt>. Obviously, this interval <em>does not</em> contain the value zero which, as we have already seen in the previous section, leads to the rejection of the null hypothesis <span class="math inline">\(\beta_{1,0} = 0\)</span>.</p>
</div>
</div>
<div id="rwxiabv" class="section level2 hasAnchor" number="5.3">
<h2 class="hasAnchor"><span class="header-section-number">5.3</span> Regression when X is a Binary Variable<a href="#rwxiabv" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Instead of using a continuous regressor <span class="math inline">\(X\)</span>, we might be interested in running the regression</p>
<p><span class="math display">\[ Y_i = \beta_0 + \beta_1 D_i + u_i \tag{5.2} \]</span></p>
<p>where <span class="math inline">\(D_i\)</span> is a binary variable, a so-called <em>dummy variable</em>. For example, we may define <span class="math inline">\(D_i\)</span> as follows:</p>
<p><span class="math display">\[ D_i = \begin{cases}
        1 \ \ \text{if $STR$ in $i^{th}$ school district &lt; 20} \\
        0 \ \ \text{if $STR$ in $i^{th}$ school district $\geq$ 20} \\
      \end{cases} \tag{5.3} \]</span></p>
<p>The regression model now is</p>
<p><span class="math display">\[ TestScore_i = \beta_0 + \beta_1 D_i + u_i. \tag{5.4} \]</span></p>
<p>Let us see how these data look like in a scatter plot:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the dummy variable as defined above</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>CASchools<span class="sc">$</span>D <span class="ot">&lt;-</span> CASchools<span class="sc">$</span>STR <span class="sc">&lt;</span> <span class="dv">20</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the data</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(CASchools<span class="sc">$</span>D, CASchools<span class="sc">$</span>score,            <span class="co"># provide the data to be plotted</span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,                                <span class="co"># use filled circles as plot symbols</span></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.5</span>,                               <span class="co"># set size of plot symbols to 0.5</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;Steelblue&quot;</span>,                       <span class="co"># set the symbols&#39; color to &quot;Steelblue&quot;</span></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(D[i]),                 <span class="co"># Set title and axis names</span></span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Test Score&quot;</span>,</span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Dummy Regression&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-211-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>With <span class="math inline">\(D\)</span> as the regressor, it is not useful to think of <span class="math inline">\(\beta_1\)</span> as a slope parameter since <span class="math inline">\(D_i \in \{0,1\}\)</span>, i.e., we only observe two discrete values instead of a continuum of regressor values. There is no continuous line depicting the conditional expectation function <span class="math inline">\(E(TestScore_i | D_i)\)</span> since this function is solely defined for <span class="math inline">\(x\)</span>-positions <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>.</p>
<p>Therefore, the interpretation of the coefficients in this regression model is as follows:</p>
<ul>
<li><p><span class="math inline">\(E(Y_i | D_i = 0) = \beta_0\)</span>, so <span class="math inline">\(\beta_0\)</span> is the expected test score in districts where <span class="math inline">\(D_i=0\)</span> where <span class="math inline">\(STR\)</span> is above <span class="math inline">\(20\)</span>.</p></li>
<li><p><span class="math inline">\(E(Y_i | D_i = 1) = \beta_0 + \beta_1\)</span> or, using the result above, <span class="math inline">\(\beta_1 = E(Y_i | D_i = 1) - E(Y_i | D_i = 0)\)</span>. Thus, <span class="math inline">\(\beta_1\)</span> is <em>the difference in group-specific expectations</em>, i.e., the difference in expected test score between districts with <span class="math inline">\(STR &lt; 20\)</span> and those with <span class="math inline">\(STR \geq 20\)</span>.</p></li>
</ul>
<p>We will now use <tt>R</tt> to estimate the dummy regression model as defined by the equations (<a href="#mjx-eqn-5.2">5.2</a>) and (<a href="#mjx-eqn-5.3">5.3</a>) .</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the dummy regression model</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>dummy_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> D, <span class="at">data =</span> CASchools)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dummy_model)</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = score ~ D, data = CASchools)</span></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -50.496 -14.029  -0.346  12.884  49.504 </span></span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  650.077      1.393 466.666  &lt; 2e-16 ***</span></span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DTRUE          7.169      1.847   3.882  0.00012 ***</span></span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb121-18"><a href="#cb121-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb121-19"><a href="#cb121-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 18.74 on 418 degrees of freedom</span></span>
<span id="cb121-20"><a href="#cb121-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.0348, Adjusted R-squared:  0.0325 </span></span>
<span id="cb121-21"><a href="#cb121-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 15.07 on 1 and 418 DF,  p-value: 0.0001202</span></span></code></pre></div>

<div class="rmdnote">
<tt>summary()</tt> reports the <span class="math inline">\(p\)</span>-value of the test that the coefficient on <tt>(Intercept)</tt> is zero to to be <tt>&lt; 2e-16</tt>. This scientific notation states that the <span class="math inline">\(p\)</span>-value is smaller than <span class="math inline">\(\frac{2}{10^{16}}\)</span>, so a very small number. The reason for this is that computers cannot handle arbitrary small numbers. In fact, <span class="math inline">\(\frac{2}{10^{16}}\)</span> is the smallest possble number <tt>R</tt> can work with.
</div>
<p>The vector <tt>CASchools$D</tt> has the type <tt>logical</tt> (to see this, use <tt>typeof(CASchools$D)</tt>) which is shown in the output of <tt>summary(dummy_model)</tt>: the label <tt>DTRUE</tt> states that all entries <tt>TRUE</tt> are coded as <tt>1</tt> and all entries <tt>FALSE</tt> are coded as <tt>0</tt>. Thus, the interpretation of the coefficient <tt>DTRUE</tt> is as stated above for <span class="math inline">\(\beta_1\)</span>.</p>
<p>One can see that the expected test score in districts with <span class="math inline">\(STR &lt; 20\)</span> (<span class="math inline">\(D_i = 1\)</span>) is predicted to be <span class="math inline">\(650.1 + 7.17 = 657.27\)</span> while districts with <span class="math inline">\(STR \geq 20\)</span> (<span class="math inline">\(D_i = 0\)</span>) are expected to have an average test score of only <span class="math inline">\(650.1\)</span>.</p>
<p>Group specific predictions can be added to the plot by execution of the following code chunk.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add group specific predictions to the plot</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> CASchools<span class="sc">$</span>D, </span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">predict</span>(dummy_model), </span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">20</span>)</span></code></pre></div>
<p>Here we use the function <tt>predict()</tt> to obtain estimates of the group specific means. The red dots represent these sample group averages. Accordingly, <span class="math inline">\(\hat{\beta}_1 = 7.17\)</span> can be seen as the difference in group averages.</p>
<p><tt>summary(dummy_model)</tt> also answers the question whether there is a statistically significant difference in group means. This in turn would support the hypothesis that students perform differently when they are taught in small classes. We can assess this by a two-tailed test of the hypothesis <span class="math inline">\(H_0: \beta_1 = 0\)</span>. Conveniently, the <span class="math inline">\(t\)</span>-statistic and the corresponding <span class="math inline">\(p\)</span>-value for this test are computed by <tt>summary()</tt>.</p>
<p>Since <tt>t value</tt> <span class="math inline">\(= 3.88 &gt; 1.96\)</span> we reject the null hypothesis at the <span class="math inline">\(5\%\)</span> level of significance. The same conclusion results when using the <span class="math inline">\(p\)</span>-value, which reports significance up to the <span class="math inline">\(0.00012\%\)</span> level.</p>
<p>As done with <tt>linear_model</tt>, we may alternatively use the function <tt>confint()</tt> to compute a <span class="math inline">\(95\%\)</span> confidence interval for the true difference in means and see if the hypothesized value is an element of this confidence set.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># confidence intervals for coefficients in the dummy regression model</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(dummy_model)</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  2.5 %    97.5 %</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 647.338594 652.81500</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DTRUE         3.539562  10.79931</span></span></code></pre></div>
<p>We reject the hypothesis that there is no difference between group means at the <span class="math inline">\(5\%\)</span> significance level since <span class="math inline">\(\beta_{1,0} = 0\)</span> lies outside of <span class="math inline">\([3.54, 10.8]\)</span>, the <span class="math inline">\(95\%\)</span> confidence interval for the coefficient on <span class="math inline">\(D\)</span>.</p>
</div>
<div id="hah" class="section level2 hasAnchor" number="5.4">
<h2 class="hasAnchor"><span class="header-section-number">5.4</span> Heteroskedasticity and Homoskedasticity<a href="#hah" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>All inference made in the previous chapters relies on the assumption that the error variance does not vary as regressor values change. But this will often not be the case in empirical applications.</p>
<div id="KC5.4" class="keyconcept">
<h3 class="right">
Key Concept 5.4
</h3>
<h3 class="left">
Heteroskedasticity and Homoskedasticity
</h3>
<ul>
<li><p>The error term of our regression model is homoskedastic if the variance of the conditional distribution of <span class="math inline">\(u_i\)</span> given <span class="math inline">\(X_i\)</span>, <span class="math inline">\(Var(u_i|X_i=x)\)</span>, is constant <em>for all</em> observations in our sample:
<span class="math display">\[ \text{Var}(u_i|X_i=x) = \sigma^2 \ \forall \ i=1,\dots,n. \]</span></p></li>
<li><p>If instead there is dependence of the conditional variance of <span class="math inline">\(u_i\)</span> on <span class="math inline">\(X_i\)</span>, the error term is said to be heteroskedastic. We then write
<span class="math display">\[ \text{Var}(u_i|X_i=x) = \sigma_i^2 \ \forall \ i=1,\dots,n. \]</span></p></li>
<li><p>Homoskedasticity is a <em>special case</em> of heteroskedasticity.</p></li>
</ul>
</div>
<p>For a better understanding of heteroskedasticity, we generate some bivariate heteroskedastic data, estimate a linear regression model and then use box plots to depict the conditional distributions of the residuals.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load scales package for adjusting color opacities</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="co"># generate some heteroskedastic data:</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for reproducibility</span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) </span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a><span class="co"># set up vector of x coordinates</span></span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>), <span class="at">each =</span> <span class="dv">25</span>)</span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize vector of errors</span></span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a><span class="co"># sample 100 errors such that the variance increases with x</span></span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>e[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a>e[<span class="dv">26</span><span class="sc">:</span><span class="dv">50</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">15</span>)</span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a>e[<span class="dv">51</span><span class="sc">:</span><span class="dv">75</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a>e[<span class="dv">76</span><span class="sc">:</span><span class="dv">100</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">25</span>)</span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a><span class="co"># set up y</span></span>
<span id="cb124-22"><a href="#cb124-22" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">720</span> <span class="sc">-</span> <span class="fl">3.3</span> <span class="sc">*</span> x <span class="sc">+</span> e</span>
<span id="cb124-23"><a href="#cb124-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-24"><a href="#cb124-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate the model </span></span>
<span id="cb124-25"><a href="#cb124-25" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb124-26"><a href="#cb124-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-27"><a href="#cb124-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the data</span></span>
<span id="cb124-28"><a href="#cb124-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> x, </span>
<span id="cb124-29"><a href="#cb124-29" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> y, </span>
<span id="cb124-30"><a href="#cb124-30" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;An Example of Heteroskedasticity&quot;</span>,</span>
<span id="cb124-31"><a href="#cb124-31" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Student-Teacher Ratio&quot;</span>,</span>
<span id="cb124-32"><a href="#cb124-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Test Score&quot;</span>,</span>
<span id="cb124-33"><a href="#cb124-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.5</span>, </span>
<span id="cb124-34"><a href="#cb124-34" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, </span>
<span id="cb124-35"><a href="#cb124-35" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">27</span>), </span>
<span id="cb124-36"><a href="#cb124-36" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">600</span>, <span class="dv">710</span>))</span>
<span id="cb124-37"><a href="#cb124-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-38"><a href="#cb124-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the regression line to the plot</span></span>
<span id="cb124-39"><a href="#cb124-39" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(mod, <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb124-40"><a href="#cb124-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-41"><a href="#cb124-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Add boxplots to the plot</span></span>
<span id="cb124-42"><a href="#cb124-42" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, </span>
<span id="cb124-43"><a href="#cb124-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">add =</span> <span class="cn">TRUE</span>, </span>
<span id="cb124-44"><a href="#cb124-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>), </span>
<span id="cb124-45"><a href="#cb124-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">&quot;gray&quot;</span>, <span class="fl">0.4</span>), </span>
<span id="cb124-46"><a href="#cb124-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-217-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>We have used the <tt>formula</tt> argument <tt>y ~ x</tt> in <tt>boxplot()</tt> to specify that we want to split up the vector <tt>y</tt> into groups according to <tt>x</tt>. <tt>boxplot(y ~ x)</tt> generates a boxplot for each of the groups in <tt>y</tt> defined by <tt>x</tt>.</p>
<p>For this artificial data it is clear that the conditional error variances differ. Specifically, we observe that the variance in test scores (and therefore the variance of the errors committed) <em>increases</em> with the student teacher ratio.</p>
<div id="a-real-world-example-for-heteroskedasticity" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">A Real-World Example for Heteroskedasticity<a href="#a-real-world-example-for-heteroskedasticity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Think about the economic value of education: if there were no expected economic value-added to receiving university education, you probably would not be reading this script right now. A starting point to empirically verify such a relation is to have data on working individuals. More precisely, we need data on wages and education of workers in order to estimate a model like</p>
<p><span class="math display">\[ wage_i = \beta_0 + \beta_1 \cdot education_i + u_i. \]</span></p>
<p>What can be presumed about this relation? It is likely that, on average, higher educated workers earn more than workers with less education, so we expect to estimate an upward sloping regression line. Also, it seems plausible that earnings of better educated workers have a higher dispersion than those of low-skilled workers: solid education is not a guarantee for a high salary so even highly qualified workers take on low-income jobs. However, they are more likely to meet the requirements for the well-paid jobs than workers with less education for whom opportunities in the labor market are much more limited.</p>
<p>To verify this empirically we may use real data on hourly earnings and the number of years of education of employees. Such data can be found in <tt>CPSSWEducation</tt>. This data set is part of the package <tt>AER</tt> and comes from the Current Population Survey (CPS) which is conducted periodically by the <a href="http://www.bls.gov/">Bureau of Labor Statistics</a> in the United States.</p>
<p>The subsequent code chunks demonstrate how to import the data into <tt>R</tt> and how to produce a plot in the fashion of Figure 5.3 in the book.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load package and attach data</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;CPSSWEducation&quot;</span>)</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(CPSSWEducation)</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="co"># get an overview</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(CPSSWEducation)</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       age          gender        earnings        education    </span></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :29.0   female:1202   Min.   : 2.137   Min.   : 6.00  </span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:29.0   male  :1748   1st Qu.:10.577   1st Qu.:12.00  </span></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median :29.0                 Median :14.615   Median :13.00  </span></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   :29.5                 Mean   :16.743   Mean   :13.55  </span></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:30.0                 3rd Qu.:20.192   3rd Qu.:16.00  </span></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   :30.0                 Max.   :97.500   Max.   :18.00</span></span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate a simple regression model</span></span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a>labor_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(earnings <span class="sc">~</span> education)</span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a><span class="co"># plot observations and add the regression line</span></span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(education, </span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a>     earnings, </span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">150</span>))</span>
<span id="cb125-23"><a href="#cb125-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-24"><a href="#cb125-24" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(labor_model, </span>
<span id="cb125-25"><a href="#cb125-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb125-26"><a href="#cb125-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-218-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The plot reveals that the mean of the distribution of earnings increases with the level of education. This is also supported by a formal analysis: the estimated regression model stored in <tt>labor_mod</tt> shows that there is a positive relation between years of education and earnings.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print the contents of labor_model to the console</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>labor_model</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = earnings ~ education)</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)    education  </span></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      -3.134        1.467</span></span></code></pre></div>
<p>The estimated regression equation states that, on average, an additional year of education increases a worker’s hourly earnings by about <span class="math inline">\(\$ 1.47\)</span>. Once more we use <tt>confint()</tt> to obtain a <span class="math inline">\(95\%\)</span> confidence interval for both regression coefficients.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute a 95% confidence interval for the coefficients in the model</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(labor_model)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 2.5 %    97.5 %</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -5.015248 -1.253495</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; education    1.330098  1.603753</span></span></code></pre></div>
<p>Since the interval is <span class="math inline">\([1.33, 1.60]\)</span> we can reject the hypothesis that the coefficient on <tt>education</tt> is zero at the <span class="math inline">\(5\%\)</span> level.</p>
<p>Furthermore, the plot indicates that there is heteroskedasticity: if we assume the regression line to be a reasonably good representation of the conditional mean function <span class="math inline">\(E(earnings_i\vert education_i)\)</span>, the dispersion of hourly earnings around that function clearly increases with the level of education, i.e., the variance of the distribution of earnings increases. In other words: the variance of the errors (the errors made in explaining earnings by education) increases with education so that the regression errors are heteroskedastic.</p>
<p>This example makes a case that the assumption of homoskedasticity is doubtful in economic applications. Should we care about heteroskedasticity? Yes, we should. As explained in the next section, heteroskedasticity can have serious negative consequences in hypothesis testing, if we ignore it.</p>
</div>
<div id="should-we-care-about-heteroskedasticity" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Should We Care About Heteroskedasticity?<a href="#should-we-care-about-heteroskedasticity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To answer the question whether we should worry about heteroskedasticity being present, consider the variance of <span class="math inline">\(\hat\beta_1\)</span> under the assumption of homoskedasticity. In this case we have</p>
<p><span class="math display">\[ \sigma^2_{\hat\beta_1} = \frac{\sigma^2_u}{n \cdot \sigma^2_X} \tag{5.5} \]</span></p>
<p>which is a simplified version of the general equation (<a href="#mjx-eqn-4.1">4.1</a>) presented in Key Concept 4.4. See Appendix 5.1 of the book for details on the derivation. <tt>summary()</tt> estimates (<a href="#mjx-eqn-5.5">5.5</a>) by</p>
<p><span class="math display">\[ \overset{\sim}{\sigma}^2_{\hat\beta_1} = \frac{SER^2}{\sum_{i=1}^n (X_i - \overline{X})^2} \ \ \text{where} \ \ SER=\frac{1}{n-2} \sum_{i=1}^n \hat u_i^2. \]</span></p>
<p>Thus <tt>summary()</tt> estimates the <em>homoskedasticity-only</em> standard error</p>
<p><span class="math display">\[ \sqrt{ \overset{\sim}{\sigma}^2_{\hat\beta_1} } = \sqrt{ \frac{SER^2}{\sum_{i=1}^n(X_i - \overline{X})^2} }. \]</span></p>
<p>This is in fact an estimator for the standard deviation of the estimator <span class="math inline">\(\hat{\beta}_1\)</span> that is <em>inconsistent</em> for the true value <span class="math inline">\(\sigma^2_{\hat\beta_1}\)</span> when there is heteroskedasticity. The implication is that <span class="math inline">\(t\)</span>-statistics computed in the manner of Key Concept 5.1 do not follow a standard normal distribution, even in large samples. This issue may invalidate inference when using the previously treated tools for hypothesis testing: we should be cautious when making statements about the significance of regression coefficients on the basis of <span class="math inline">\(t\)</span>-statistics as computed by <tt>summary()</tt> or confidence intervals produced by <tt>confint()</tt> if it is doubtful for the assumption of homoskedasticity to hold!</p>
<p>We will now use <tt>R</tt> to compute the homoskedasticity-only standard error for <span class="math inline">\(\hat{\beta}_1\)</span> in the test score regression model <tt>labor_model</tt> by hand and see that it matches the value produced by <tt>summary()</tt>.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store model summary in &#39;model&#39;</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">summary</span>(labor_model)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the standard error of the regression from model summary</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>SER <span class="ot">&lt;-</span> model<span class="sc">$</span>sigma</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the variation in &#39;education&#39;</span></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>V <span class="ot">&lt;-</span> (<span class="fu">nrow</span>(CPSSWEducation)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">*</span> <span class="fu">var</span>(education)</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the standard error of the slope parameter&#39;s estimator and print it</span></span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>SE.beta_1.hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(SER<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>V)</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>SE.beta_1.hat</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.06978281</span></span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Use logical operators to see if the value computed by hand matches the one provided </span></span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a><span class="co"># in mod$coefficients. Round estimates to four decimal places</span></span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(model<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="dv">2</span>], <span class="dv">4</span>) <span class="sc">==</span> <span class="fu">round</span>(SE.beta_1.hat, <span class="dv">4</span>)</span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Indeed, the estimated values are equal.</p>
</div>
<div id="computation-of-heteroskedasticity-robust-standard-errors" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Computation of Heteroskedasticity-Robust Standard Errors<a href="#computation-of-heteroskedasticity-robust-standard-errors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consistent estimation of <span class="math inline">\(\sigma_{\hat{\beta}_1}\)</span> under heteroskedasticity is granted when the following <em>robust</em> estimator is used.</p>
<p><span class="math display">\[ SE(\hat{\beta}_1) = \sqrt{ \frac{1}{n} \cdot \frac{ \frac{1}{n} \sum_{i=1}^n (X_i - \overline{X})^2 \hat{u}_i^2 }{ \left[ \frac{1}{n} \sum_{i=1}^n (X_i - \overline{X})^2  \right]^2} } \tag{5.6} \]</span></p>
<p>Standard error estimates computed this way are also referred to as <a href="https://en.wikipedia.org/wiki/Heteroscedasticity-consistent_standard_errors">Eicker-Huber-White standard errors</a>, the most frequently cited paper on this is <span class="citation">White (<a href="#ref-white1980" role="doc-biblioref">1980</a>)</span>.</p>
<p>It can be quite cumbersome to do this calculation by hand. Luckily certain R functions exist, serving that purpose. A convenient one named <tt>vcovHC()</tt> is part of the package <tt>sandwich</tt>.<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a> This function can compute a variety of standard errors. The one brought forward in (<a href="#mjx-eqn-5.6">5.6</a>) is computed when the argument <tt>type</tt> is set to <tt>“HC0”</tt>. Most of the examples presented in the book rely on a slightly different formula which is the default in the statistics package <em>STATA</em>:</p>
<p><span class="math display">\[\begin{align}
SE(\hat{\beta}_1)_{HC1} = \sqrt{ \frac{1}{n} \cdot \frac{ \frac{1}{n-2} \sum_{i=1}^n (X_i - \overline{X})^2 \hat{u}_i^2 }{ \left[ \frac{1}{n} \sum_{i=1}^n (X_i - \overline{X})^2  \right]^2}} (\#eq:hc1)
\end{align}\]</span></p>
<p>The difference is that we multiply by <span class="math inline">\(\frac{1}{n-2}\)</span> in the numerator of @ref(eq:hc1). This is a degrees of freedom correction and was considered by <span class="citation">MacKinnon and White (<a href="#ref-mackinnon1985" role="doc-biblioref">1985</a>)</span>. To get <tt>vcovHC()</tt> to use @ref(eq:hc1), we have to set <tt>type = “HC1”</tt>.</p>
<p>Let us now compute robust standard error estimates for the coefficients in <tt>linear_model</tt>.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute heteroskedasticity-robust standard errors</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>vcov <span class="ot">&lt;-</span> <span class="fu">vcovHC</span>(linear_model, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>vcov</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             (Intercept)        STR</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  107.419993 -5.3639114</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; STR           -5.363911  0.2698692</span></span></code></pre></div>
<p>The output of <tt>vcovHC()</tt> is the variance-covariance matrix of coefficient estimates. We are interested in the square root of the diagonal elements of this matrix, i.e., the standard error estimates.</p>

<div class="rmdknit">
<p>When we have k &gt; 1 regressors, writing down the equations for a regression model becomes very messy. A more convinient way to denote and estimate so-called multiple regression models (see Chapter @ref(rmwmr)) is by using matrix algebra. This is why functions like <tt>vcovHC()</tt> produce matrices. In the simple linear regression model, the variances and covariances of the estimators can be gathered in the symmetric variance-covariance matrix</p>
<p><span class="math display">\[\begin{equation}
\text{Var}
  \begin{pmatrix}
    \hat\beta_0 \\
    \hat\beta_1
  \end{pmatrix} =
\begin{pmatrix}
  \text{Var}(\hat\beta_0) &amp; \text{Cov}(\hat\beta_0,\hat\beta_1) \\
\text{Cov}(\hat\beta_0,\hat\beta_1) &amp; \text{Var}(\hat\beta_1)
\end{pmatrix},
\end{equation}\]</span></p>
<p>so <tt>vcovHC()</tt> gives us <span class="math inline">\(\widehat{\text{Var}}(\hat\beta_0)\)</span>, <span class="math inline">\(\widehat{\text{Var}}(\hat\beta_1)\)</span> and <span class="math inline">\(\widehat{\text{Cov}}(\hat\beta_0,\hat\beta_1)\)</span>, but most of the time we are interested in the diagonal elements of the estimated matrix.</p>
</div>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the square root of the diagonal elements in vcov</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>robust_se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(vcov))</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>robust_se</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)         STR </span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  10.3643617   0.5194893</span></span></code></pre></div>
<p>Now assume we want to generate a coefficient summary as provided by <tt>summary()</tt> but with <em>robust</em> standard errors of the coefficient estimators, robust <span class="math inline">\(t\)</span>-statistics and corresponding <span class="math inline">\(p\)</span>-values for the regression model <tt>linear_model</tt>. This can be done using <tt>coeftest()</tt> from the package <tt>lmtest</tt>, see <code>?coeftest</code>. Further we specify in the argument <tt>vcov.</tt> that <tt>vcov</tt>, the Eicker-Huber-White estimate of the variance matrix we have computed before, should be used.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we invoke the function `coeftest()` on our model</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(linear_model, <span class="at">vcov. =</span> vcov)</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 698.93295   10.36436 67.4362 &lt; 2.2e-16 ***</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; STR          -2.27981    0.51949 -4.3886 1.447e-05 ***</span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>We see that the values reported in the column <tt>Std. Error</tt> are equal those from <tt>sqrt(diag(vcov))</tt>.</p>
<p>How severe are the implications of using homoskedasticity-only standard errors in the presence of heteroskedasticity? The answer is: it depends. As mentioned above we face the risk of drawing wrong conclusions when conducting significance tests. <br> Let us illustrate this by generating another example of a heteroskedastic data set and using it to estimate a simple regression model. We take</p>
<p><span class="math display">\[ Y_i = \beta_1 \cdot X_i + u_i \ \ , \ \ u_i \overset{i.i.d.}{\sim} \mathcal{N}(0,0.36 \cdot X_i^2)  \]</span></p>
<p>with <span class="math inline">\(\beta_1=1\)</span> as the data generating process. Clearly, the assumption of homoskedasticity is violated here since the variance of the errors is a nonlinear, increasing function of <span class="math inline">\(X_i\)</span> but the errors have zero mean and are i.i.d. such that the assumptions made in Key Concept 4.3 are not violated. As before, we are interested in estimating <span class="math inline">\(\beta_1\)</span>.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">905</span>)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="co"># generate heteroskedastic data </span></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">500</span></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">500</span>, <span class="at">mean =</span> X, <span class="at">sd =</span> <span class="fl">0.6</span> <span class="sc">*</span> X)</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate a simple regression model</span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X)</span></code></pre></div>
<p>We plot the data and add the regression line.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the data</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y, </span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, </span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a><span class="co"># add the regression line to the plot</span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(reg, </span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>, </span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-226-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The plot shows that the data are heteroskedastic as the variance of <span class="math inline">\(Y\)</span> grows with <span class="math inline">\(X\)</span>. We next conduct a significance test of the (true) null hypothesis <span class="math inline">\(H_0: \beta_1 = 1\)</span> twice, once using the homoskedasticity-only standard error formula and once with the robust version (<a href="#mjx-eqn-5.6">5.6</a>). An easy way to do this in <tt>R</tt> is the function <tt>linearHypothesis()</tt> from the package <tt>car</tt>, see <code>?linearHypothesis</code>. It allows to test linear hypotheses about parameters in linear models in a similar way as done with a <span class="math inline">\(t\)</span>-statistic and offers various robust covariance matrix estimators. We test by comparing the tests’ <span class="math inline">\(p\)</span>-values to the significance level of <span class="math inline">\(5\%\)</span>.</p>

<div class="rmdknit">
<p><tt>linearHypothesis()</tt> computes a test statistic that follows an <span class="math inline">\(F\)</span>-distribution under the null hypothesis. We will not focus on the details of the underlying theory. In general, the idea of the <span class="math inline">\(F\)</span>-test is to compare the fit of different models. When testing a hypothesis about a <em>single</em> coefficient using an <span class="math inline">\(F\)</span>-test, one can show that the test statistic is simply the square of the corresponding <span class="math inline">\(t\)</span>-statistic:</p>
<p><span class="math display">\[F = t^2 = \left(\frac{\hat\beta_i - \beta_{i,0}}{SE(\hat\beta_i)}\right)^2 \sim F_{1,n-k-1}\]</span></p>
In <tt>linearHypothesis()</tt>, there are different ways to specify the hypothesis to be tested, e.g., using a vector of the type <tt>character</tt> (as done in the next code chunk), see <tt>?linearHypothesis</tt> for alternatives. The function returns an object of class <tt>anova</tt> which contains further information on the test that can be accessed using the <tt>$</tt> operator.
</div>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test hypthesis using the default standard error formula</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(reg, <span class="at">hypothesis.matrix =</span> <span class="st">&quot;X = 1&quot;</span>)<span class="sc">$</span><span class="st">&#39;Pr(&gt;F)&#39;</span>[<span class="dv">2</span>] <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a><span class="co"># test hypothesis using the robust standard error formula</span></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(reg, <span class="at">hypothesis.matrix =</span> <span class="st">&quot;X = 1&quot;</span>, <span class="at">white.adjust =</span> <span class="st">&quot;hc1&quot;</span>)<span class="sc">$</span><span class="st">&#39;Pr(&gt;F)&#39;</span>[<span class="dv">2</span>] <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p>This is a good example of what can go wrong if we ignore heteroskedasticity: for the data set at hand the default method rejects the null hypothesis <span class="math inline">\(\beta_1 = 1\)</span> although it is true. When using the robust standard error formula the test does not reject the null. Of course, we could think this might just be a coincidence and both tests do equally well in maintaining the type I error rate of <span class="math inline">\(5\%\)</span>. This can be further investigated by computing <em>Monte Carlo</em> estimates of the rejection frequencies of both tests on the basis of a large number of random samples. We proceed as follows:</p>
<ul>
<li>initialize vectors <tt>t</tt> and <tt>t.rob</tt>.</li>
<li>Using a <tt>for()</tt> loop, we generate <span class="math inline">\(10000\)</span> heteroskedastic random samples of size <span class="math inline">\(1000\)</span>, estimate the regression model and check whether the tests falsely reject the null at the level of <span class="math inline">\(5\%\)</span> using comparison operators. The results are stored in the respective vectors <tt>t</tt> and <tt>t.rob</tt>.</li>
<li>After the simulation, we compute the fraction of false rejections for both tests.</li>
</ul>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize vectors t and t.rob</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>t.rob <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a><span class="co"># loop sampling and estimation</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>) {</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sample data</span></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mean =</span> X, <span class="at">sd =</span> <span class="fl">0.6</span> <span class="sc">*</span> X)</span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># estimate regression model</span></span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>  reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X)</span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># homoskedasdicity-only significance test</span></span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a>  t[i] <span class="ot">&lt;-</span> <span class="fu">linearHypothesis</span>(reg, <span class="st">&quot;X = 1&quot;</span>)<span class="sc">$</span><span class="st">&#39;Pr(&gt;F)&#39;</span>[<span class="dv">2</span>] <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># robust significance test</span></span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a>  t.rob[i] <span class="ot">&lt;-</span> <span class="fu">linearHypothesis</span>(reg, <span class="st">&quot;X = 1&quot;</span>, <span class="at">white.adjust =</span> <span class="st">&quot;hc1&quot;</span>)<span class="sc">$</span><span class="st">&#39;Pr(&gt;F)&#39;</span>[<span class="dv">2</span>] <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-22"><a href="#cb135-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb135-23"><a href="#cb135-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-24"><a href="#cb135-24" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the fraction of false rejections</span></span>
<span id="cb135-25"><a href="#cb135-25" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cbind</span>(<span class="at">t =</span> <span class="fu">mean</span>(t), <span class="at">t.rob =</span> <span class="fu">mean</span>(t.rob)), <span class="dv">3</span>)</span>
<span id="cb135-26"><a href="#cb135-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          t t.rob</span></span>
<span id="cb135-27"><a href="#cb135-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 0.073  0.05</span></span></code></pre></div>
<p>These results reveal the increased risk of falsely rejecting the null using the homoskedasticity-only standard error for the testing problem at hand: with the common standard error, <span class="math inline">\(7.28\%\)</span> of all tests falsely reject the null hypothesis. In contrast, with the robust test statistic we are closer to the nominal level of <span class="math inline">\(5\%\)</span>.</p>
</div>
</div>
<div id="the-gauss-markov-theorem" class="section level2 hasAnchor" number="5.5">
<h2 class="hasAnchor"><span class="header-section-number">5.5</span> The Gauss-Markov Theorem<a href="#the-gauss-markov-theorem" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When estimating regression models, we know that the results of the estimation procedure are random. However, when using unbiased estimators, at least on average, we estimate the true parameter. When comparing different unbiased estimators, it is therefore interesting to know which one has the highest precision: being aware that the likelihood of estimating the <em>exact</em> value of the parameter of interest is <span class="math inline">\(0\)</span> in an empirical application, we want to make sure that the likelihood of obtaining an estimate very close to the true value is as high as possible. This means we want to use the estimator with the lowest variance of all unbiased estimators, provided we care about unbiasedness. The Gauss-Markov theorem states that, in the class of conditionally unbiased linear estimators, the OLS estimator has this property under certain conditions.</p>
<div id="KC5.5" class="keyconcept">
<h3 class="right">
Key Concept 5.5
</h3>
<h3 class="left">
The Gauss-Markov Theorem for <span class="math inline">\(\hat{\beta}_1\)</span>
</h3>
<p>Suppose that the assumptions made in Key Concept 4.3 hold <em>and</em> that the errors are <em>homoskedastic</em>. The OLS estimator is the best (in the sense of smallest variance) linear conditionally unbiased estimator (BLUE) in this setting.</p>
<p>Let us have a closer look at what this means:</p>
<ul>
<li><p>Estimators of <span class="math inline">\(\beta_1\)</span> that are linear functions of the <span class="math inline">\(Y_1, \dots, Y_n\)</span> and that are unbiased conditionally on the regressor <span class="math inline">\(X_1, \dots, X_n\)</span> can be written as <span class="math display">\[ \overset{\sim}{\beta}_1 = \sum_{i=1}^n a_i Y_i \]</span> where the <span class="math inline">\(a_i\)</span> are weights that are allowed to depend on the <span class="math inline">\(X_i\)</span> but <em>not</em> on the <span class="math inline">\(Y_i\)</span>.</p></li>
<li><p>We already know that <span class="math inline">\(\overset{\sim}{\beta}_1\)</span> has a sampling distribution: <span class="math inline">\(\overset{\sim}{\beta}_1\)</span> is a linear function of the <span class="math inline">\(Y_i\)</span> which are random variables. If now <span class="math display">\[ E(\overset{\sim}{\beta}_1 | X_1, \dots, X_n) = \beta_1, \]</span> <span class="math inline">\(\overset{\sim}{\beta}_1\)</span> is a linear unbiased estimator of <span class="math inline">\(\beta_1\)</span>, conditionally on the <span class="math inline">\(X_1, \dots, X_n\)</span>.</p></li>
<li><p>We may ask if <span class="math inline">\(\overset{\sim}{\beta}_1\)</span> is also the <em>best</em> estimator in this class, i.e., the most efficient one of all linear conditionally unbiased estimators where “most efficient” means smallest variance. The weights <span class="math inline">\(a_i\)</span> play an important role here and it turns out that OLS uses just the right weights to have the BLUE property.</p></li>
</ul>
</div>
<div id="simulation-study-blue-estimator" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Simulation Study: BLUE Estimator<a href="#simulation-study-blue-estimator" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider the case of a regression of <span class="math inline">\(Y_i,\dots,Y_n\)</span> only on a constant. Here, the <span class="math inline">\(Y_i\)</span> are assumed to be a random sample from a population with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>. The OLS estimator in this model is simply the sample mean, see Chapter @ref(potsm).</p>
<p><span class="math display">\[\begin{equation}
\hat{\beta}_1 = \sum_{i=1}^n \underbrace{\frac{1}{n}}_{=a_i} Y_i (\#eq:bluemean)
\end{equation}\]</span></p>
<p>Clearly, each observation is weighted by</p>
<p><span class="math display">\[a_i = \frac{1}{n}.\]</span></p>
<p>and we also know that <span class="math inline">\(\text{Var}(\hat{\beta}_1)=\frac{\sigma^2}{n}\)</span>.</p>
<p>We now use <tt>R</tt> to conduct a simulation study that demonstrates what happens to the variance of @ref(eq:bluemean) if different weights <span class="math display">\[ w_i = \frac{1 \pm \epsilon}{n} \]</span> are assigned to either half of the sample <span class="math inline">\(Y_1, \dots, Y_n\)</span> instead of using <span class="math inline">\(\frac{1}{n}\)</span>, the OLS weights.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set sample size and number of repetitions</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span>      </span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a><span class="co"># choose epsilon and create a vector of weights as defined above</span></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>((<span class="dv">1</span> <span class="sc">+</span> epsilon) <span class="sc">/</span> n, n <span class="sc">/</span> <span class="dv">2</span>), </span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>       <span class="fu">rep</span>((<span class="dv">1</span> <span class="sc">-</span> epsilon) <span class="sc">/</span> n, n <span class="sc">/</span> <span class="dv">2</span>) )</span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a><span class="co"># draw a random sample y_1,...,y_n from the standard normal distribution, </span></span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a><span class="co"># use both estimators 1e5 times and store the result in the vectors &#39;ols&#39; and </span></span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a><span class="co"># &#39;weightedestimator&#39;</span></span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>ols <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, reps)</span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a>weightedestimator <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, reps)</span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>reps) {</span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a>  ols[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a>  weightedestimator[i] <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(w, y)</span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb136-23"><a href="#cb136-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb136-24"><a href="#cb136-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-25"><a href="#cb136-25" aria-hidden="true" tabindex="-1"></a><span class="co"># plot kernel density estimates of the estimators&#39; distributions: </span></span>
<span id="cb136-26"><a href="#cb136-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-27"><a href="#cb136-27" aria-hidden="true" tabindex="-1"></a><span class="co"># OLS</span></span>
<span id="cb136-28"><a href="#cb136-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(ols), </span>
<span id="cb136-29"><a href="#cb136-29" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>, </span>
<span id="cb136-30"><a href="#cb136-30" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">3</span>, </span>
<span id="cb136-31"><a href="#cb136-31" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Density of OLS and Weighted Estimator&quot;</span>,</span>
<span id="cb136-32"><a href="#cb136-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Estimates&quot;</span>)</span>
<span id="cb136-33"><a href="#cb136-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-34"><a href="#cb136-34" aria-hidden="true" tabindex="-1"></a><span class="co"># weighted</span></span>
<span id="cb136-35"><a href="#cb136-35" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(weightedestimator), </span>
<span id="cb136-36"><a href="#cb136-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb136-37"><a href="#cb136-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">3</span>) </span>
<span id="cb136-38"><a href="#cb136-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-39"><a href="#cb136-39" aria-hidden="true" tabindex="-1"></a><span class="co"># add a dashed line at 0 and add a legend to the plot</span></span>
<span id="cb136-40"><a href="#cb136-40" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb136-41"><a href="#cb136-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-42"><a href="#cb136-42" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topright&#39;</span>, </span>
<span id="cb136-43"><a href="#cb136-43" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">&quot;OLS&quot;</span>, <span class="st">&quot;Weighted&quot;</span>), </span>
<span id="cb136-44"><a href="#cb136-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;purple&quot;</span>, <span class="st">&quot;steelblue&quot;</span>), </span>
<span id="cb136-45"><a href="#cb136-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-231-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>What conclusion can we draw from the result?</p>
<ul>
<li>Both estimators seem to be unbiased: the means of their estimated distributions are zero.</li>
<li>The estimator using weights that deviate from those implied by OLS is less efficient than the OLS estimator: there is higher dispersion when weights are <span class="math inline">\(w_i = \frac{1 \pm 0.8}{100}\)</span> instead of <span class="math inline">\(w_i=\frac{1}{100}\)</span> as required by the OLS solution.</li>
</ul>
<p>Hence, the simulation results support the Gauss-Markov Theorem.</p>
</div>
</div>
<div id="using-the-t-statistic-in-regression-when-the-sample-size-is-small" class="section level2 hasAnchor" number="5.6">
<h2 class="hasAnchor"><span class="header-section-number">5.6</span> Using the t-Statistic in Regression When the Sample Size Is Small<a href="#using-the-t-statistic-in-regression-when-the-sample-size-is-small" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The three OLS assumptions discussed in Chapter @ref(lrwor) (see Key Concept 4.3) are the foundation for the results on the large sample distribution of the OLS estimators in the simple regression model. What can be said about the distribution of the estimators and their <span class="math inline">\(t\)</span>-statistics when the sample size is small and the population distribution of the data is unknown? Provided that the three least squares assumptions hold and the errors are normally distributed and homoskedastic (we refer to these conditions as the homoskedastic normal regression assumptions), we have normally distributed estimators and <span class="math inline">\(t\)</span>-distributed test statistics in small samples.</p>
<p>Recall the <a href="#thetdist">definition</a> of a <span class="math inline">\(t\)</span>-distributed variable</p>
<p><span class="math display">\[ \frac{Z}{\sqrt{W/M}} \sim t_M\]</span></p>
<p>where <span class="math inline">\(Z\)</span> is a standard normal random variable, <span class="math inline">\(W\)</span> is <span class="math inline">\(\chi^2\)</span> distributed with <span class="math inline">\(M\)</span> degrees of freedom and <span class="math inline">\(Z\)</span> and <span class="math inline">\(W\)</span> are independent. See section 5.6 in the book for a more detailed discussion of the small sample distribution of <span class="math inline">\(t\)</span>-statistics in regression methods.</p>
<p>Let us simulate the distribution of regression <span class="math inline">\(t\)</span>-statistics based on a large number of small random samples, say <span class="math inline">\(n=20\)</span>, and compare the simulated distributions to the theoretical distributions which should be <span class="math inline">\(t_{18}\)</span>, the <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(18\)</span> degrees of freedom (recall that <span class="math inline">\(\text{DF}=n-k-1\)</span>).</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize two vectors</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>beta_0 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="co"># loop sampling / estimation / t statistics</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>) {</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">20</span>)</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> X)</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>  reg <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(Y <span class="sc">~</span> X))</span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>  beta_0[i] <span class="ot">&lt;-</span> (reg<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">-</span> <span class="dv">0</span>)<span class="sc">/</span>(reg<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>  beta_1[i] <span class="ot">&lt;-</span> (reg<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="dv">1</span>] <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>(reg<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="dv">2</span>])</span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the distributions and compare with t_18 density:</span></span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a><span class="co"># divide plotting area</span></span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb137-20"><a href="#cb137-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-21"><a href="#cb137-21" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the simulated density of beta_0</span></span>
<span id="cb137-22"><a href="#cb137-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(beta_0), </span>
<span id="cb137-23"><a href="#cb137-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span> , </span>
<span id="cb137-24"><a href="#cb137-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(beta)[<span class="dv">0</span>]), </span>
<span id="cb137-25"><a href="#cb137-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>))</span>
<span id="cb137-26"><a href="#cb137-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-27"><a href="#cb137-27" aria-hidden="true" tabindex="-1"></a><span class="co"># add the t_18 density to the plot</span></span>
<span id="cb137-28"><a href="#cb137-28" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dt</span>(x, <span class="at">df =</span> <span class="dv">18</span>), </span>
<span id="cb137-29"><a href="#cb137-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">add =</span> T, </span>
<span id="cb137-30"><a href="#cb137-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb137-31"><a href="#cb137-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb137-32"><a href="#cb137-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb137-33"><a href="#cb137-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-34"><a href="#cb137-34" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the simulated density of beta_1</span></span>
<span id="cb137-35"><a href="#cb137-35" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(beta_1), </span>
<span id="cb137-36"><a href="#cb137-36" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb137-37"><a href="#cb137-37" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(beta)[<span class="dv">1</span>]), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb137-38"><a href="#cb137-38" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb137-39"><a href="#cb137-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-40"><a href="#cb137-40" aria-hidden="true" tabindex="-1"></a><span class="co"># add the t_18 density to the plot</span></span>
<span id="cb137-41"><a href="#cb137-41" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dt</span>(x, <span class="at">df =</span> <span class="dv">18</span>), </span>
<span id="cb137-42"><a href="#cb137-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">add =</span> T, </span>
<span id="cb137-43"><a href="#cb137-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb137-44"><a href="#cb137-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb137-45"><a href="#cb137-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">lty =</span> <span class="dv">2</span>) </span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-232-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The outcomes are consistent with our expectations: the empirical distributions of both estimators seem to track the theoretical <span class="math inline">\(t_{18}\)</span> distribution quite closely.</p>
</div>
<div id="exercises-5" class="section level2 hasAnchor" number="5.7">
<h2 class="hasAnchor"><span class="header-section-number">5.7</span> Exercises<a href="#exercises-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="testing-two-null-hypotheses-separately" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">1. Testing Two Null Hypotheses Separately<a href="#testing-two-null-hypotheses-separately" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider the estimated regression model</p>
<p><span class="math display">\[ \widehat{TestScore} = \underset{(23.96)}{567.43} - \underset{(0.85)}{7.15} \times STR, \, R^2 = 0.8976, \, SER=15.19 \]</span></p>
<p>with standard errors in parentheses.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Compute the <span class="math inline">\(p\)</span>-value for a <span class="math inline">\(t\)</span>-test of the hypothesis that the intercept is zero against the two-sided alternative that it is non-zero. Save the result to <tt>p_int</tt></li>
<li>Compute the <span class="math inline">\(p\)</span>-value for a <span class="math inline">\(t\)</span>-test of the hypothesis that the coefficient of <tt>STR</tt> is zero against the two-sided alternative that it is non-zero. Save the result to <tt>p_STR</tt></li>
</ul>
<iframe src="DCL/ex5_1.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hint:</strong></p>
<p>Both hypotheses can be tested individually using a two-sided test. Use <tt>pnorm()</tt> to obtain cumulated probabilities for standard normally distributed outcomes.</p>
</div>
<div id="two-null-hypotheses-you-cannot-reject-can-you" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">2. Two Null Hypotheses You Cannot Reject, Can You?<a href="#two-null-hypotheses-you-cannot-reject-can-you" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider again the estimated regression model</p>
<p><span class="math display">\[\widehat{TestScore} = \underset{(23.96)}{567.43} - \underset{(0.85)}{7.15} \times STR, \, R^2 = 0.8976, \,SER=15.19\]</span></p>
<p>Can you reject the null hypotheses discussed in the previous code exercise using individual <span class="math inline">\(t\)</span>-tests at the <span class="math inline">\(5\%\)</span> significance level?</p>
<p>The variables <tt>t_int</tt> and <tt>t_STR</tt> are the <span class="math inline">\(t\)</span>-statistics. Both are available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Gather <tt>t_int</tt> and <tt>t_STR</tt> in a vector <tt>test</tt> and use logical operators to check whether the corresponding rejection rule applies.</li>
</ul>
<iframe src="DCL/ex5_2.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li>Both tests are two-sided <span class="math inline">\(t\)</span>-tests. Key Concept 5.2 recaps how a two-sided <span class="math inline">\(t\)</span>-test is conducted.</li>
<li>Use <tt>qnorm()</tt> to obtain standard normal critical values.</li>
</ul>
</div>
<div id="confidence-intervals" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">3. Confidence Intervals<a href="#confidence-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><tt>mod</tt>, the object of class <tt>lm</tt> which contains the estimated regression model <span class="math display">\[\widehat{TestScore} = \underset{(23.96)}{567.43} - \underset{(0.85)}{7.15} \times STR, \, R^2 = 0.8976, \,SER=15.19\]</span> is available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<p>Compute <span class="math inline">\(90\%\)</span> confidence intervals for both coefficients.</p>
<iframe src="DCL/ex5_3.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hint:</strong></p>
<p>Use the function <tt>confint()</tt>, see <tt>?confint</tt>. The argument <tt>level</tt> sets the confidence level to be used.</p>
</div>
<div id="a-confidence-interval-for-the-mean-i" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">4. A Confidence Interval for the Mean I<a href="#a-confidence-interval-for-the-mean-i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider the regression model <span class="math display">\[Y_i = \beta_1 + u_i\]</span> where <span class="math inline">\(Y_i \sim \mathcal{N}(\mu, \sigma^2)\)</span>. Following the discussion preceding equation @ref(eq:KI), a <span class="math inline">\(95\%\)</span> confidence interval for the mean of the <span class="math inline">\(Y_i\)</span> can be computed as</p>
<p><span class="math display">\[CI^{\mu}_{0.95} = \left[\hat\mu - 1.96 \times \frac{\sigma}{\sqrt{n}}; \, \hat\mu + 1.96 \times \frac{\sigma}{\sqrt{n}} \right].\]</span></p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Sample <span class="math inline">\(n=100\)</span> observations from a normal distribution with variance <span class="math inline">\(100\)</span> and mean <span class="math inline">\(10\)</span>.</li>
<li>Use the sample to estimate <span class="math inline">\(\beta_1\)</span>. Save the estimate in <tt>mu_hat</tt>.</li>
<li>Assume that <span class="math inline">\(\sigma^2 = 100\)</span> is known. Replace the <tt>NA</tt>s in the code below to obtain a <span class="math inline">\(95\%\)</span> confidence interval for the mean of the <span class="math inline">\(Y_i\)</span>.</li>
</ul>
<iframe src="DCL/ex5_4.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hint:</strong></p>
<p>Use the function <tt>confint()</tt>, see <tt>?confint</tt>. The argument <tt>level</tt> sets the confidence level.</p>
</div>
<div id="a-confidence-interval-for-the-mean-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">5. A Confidence Interval for the Mean II<a href="#a-confidence-interval-for-the-mean-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For historical reasons, some <tt>R</tt> functions which we use to obtain inference on model parameters, among them <tt>confint()</tt> and <tt>summary()</tt>, rely on the <span class="math inline">\(t\)</span>-distribution instead of using the large-sample normal approximation. This is why for small sample sizes (and hence small degrees of freedom), <span class="math inline">\(p\)</span>-values and confidence intervals reported by these functions deviate from those computed using critical values or cumulative probabilities of the standard normal distribution.</p>
<p>The <span class="math inline">\(95\%\)</span> confidence interval for the mean in the previous exercise is <span class="math inline">\([9.13, 13.05]\)</span>.</p>
<p><strong>Instructions:</strong></p>
<p>100 observations sampled from a normal distribution with <span class="math inline">\(\mu=10\)</span> and <span class="math inline">\(\sigma^2=100\)</span> have been assigned to the vector <tt>s</tt> which is available in your environment.</p>
<p>Set up a suitable regression model to estimate the mean of the observations in <tt>s</tt>. Then use <tt>confint()</tt> to compute a <span class="math inline">\(95\%\)</span> confidence interval for the mean.</p>
<p>(Check that the result is different from the interval reported above.)</p>
<iframe src="DCL/ex5_5.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="regression-on-a-dummy-variable-i" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">6. Regression on a Dummy Variable I<a href="#regression-on-a-dummy-variable-i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Chapter @ref(rwxiabv) discusses regression when <span class="math inline">\(X\)</span> is a dummy variable. We have used a <tt>for()</tt> loop to generate a binary variable indicating whether a schooling district in the <tt>CASchools</tt> data set has a student-teacher ratio below <span class="math inline">\(20\)</span>. Though it is instructive to use a loop for this, there are alternate ways to achieve the same with fewer lines of code.</p>
<p>A <tt>data.frame</tt> <tt>DF</tt> with <span class="math inline">\(100\)</span> observations of a variable <tt>X</tt> is available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Use <tt>ifelse()</tt> to generate a binary vector <tt>dummy</tt> indicating whether the observations in <tt>X</tt> are <em>positive</em>.</p></li>
<li><p>Append <tt>dummy</tt> to the <tt>data.frame</tt> <tt>DF</tt>.</p></li>
</ul>
<iframe src="DCL/ex5_6.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="regression-on-a-dummy-variable-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">7. Regression on a Dummy Variable II<a href="#regression-on-a-dummy-variable-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A <tt>data.frame</tt> <tt>DF</tt> with 100 observations on <tt>Y</tt> and the binary variable <tt>D</tt> from the previous exercise is available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Compute the group-specific sample means of the observations in <tt>Y</tt>: save the mean of observations in <tt>Y</tt> where <tt>dummy == 1</tt> to <tt>mu_Y_D1</tt> and assign the mean of those observations with <tt>D == 0</tt> to <tt>mu_Y_D0</tt>.</p></li>
<li><p>Use <tt>lm()</tt> to regress <tt>Y</tt> on <tt>D</tt>, i.e., estimate the coefficients in the model <span class="math display">\[Y_i = \beta_0 + \beta_1 \times D_i + u_i.\]</span></p></li>
</ul>
<p>Also check that the estimates of the coefficients <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> reflect specific sample means. Can you tell which (no code submission needed)?</p>
<iframe src="DCL/ex5_7.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="regression-on-a-dummy-variable-iii" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">8. Regression on a Dummy Variable III<a href="#regression-on-a-dummy-variable-iii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this exercise, you have to visualize some of the results from the dummy regression model <span class="math display">\[\widehat{Y}_i = -0.66 + 1.43 \times D_i\]</span> estimated in the previous exercise.</p>
<p>A <tt>data.frame</tt> <tt>DF</tt> with 100 observations on <tt>X</tt> and the binary variable <tt>dummy</tt> as well as the model object <tt>dummy_mod</tt> from the previous exercise are available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Start by drawing a visually appealing plot of the observations on <span class="math inline">\(Y\)</span> and <span class="math inline">\(D\)</span> based on the code chunk provided in <tt>Script.R</tt>. Replace the <tt>???</tt> by the correct expressions!</p></li>
<li><p>Add the regression line to the plot.</p></li>
</ul>
<iframe src="DCL/ex5_8.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="gender-wage-gap-i" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">9. Gender Wage Gap I<a href="#gender-wage-gap-i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The cross-section data set <tt>CPS1985</tt> is a subsample from the May 1985 <em>Current Population Survey</em> conducted by the <em>US Census Bureau</em> which contains observations on, among others things, wage and the gender of employees.</p>
<p><tt>CPS1985</tt> is part of the package <tt>AER</tt>.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Attach the package <tt>AER</tt> and load the data set <tt>CPS1985</tt>.</p></li>
<li><p>Estimate the dummy regression model <span class="math display">\[wage_i = \beta_0 + \beta_1 \cdot female_i + u_i\]</span> where</p>
<p><span class="math display">\[\begin{align*}
    female_i =
    \begin{cases}
      1, &amp; \text{if employee} \, i \, \text{is female,} \\
      0, &amp; \text{if employee} \, i \,  \text{is male.}
    \end{cases}
  \end{align*}\]</span></p>
<p>Save the result in <tt>wage_mod</tt>.</p></li>
</ul>
<iframe src="DCL/ex5_9.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="gender-wage-gap-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">10. Gender Wage Gap II<a href="#gender-wage-gap-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The wage regression from the previous exercise yields <span class="math display">\[\widehat{wage}_i = 9.995 - 2.116 \cdot female_i.\]</span></p>
<p>The model object <tt>dummy_mod</tt> is available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Test the hypothesis that the coefficient on <span class="math inline">\(female_i\)</span> is zero against the alternative that it is non-zero. The null hypothesis implies that there is no gender wage gap. Use the heteroskedasticity-robust estimator proposed by <span class="citation">White (<a href="#ref-white1980" role="doc-biblioref">1980</a>)</span>.</li>
</ul>
<iframe src="DCL/ex5_10.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p><tt>vcovHC()</tt> computes heteroskedasticity-robust estimates of the covariance matrix of the coefficient estimators for the model supplied. The estimator proposed by <span class="citation">White (<a href="#ref-white1980" role="doc-biblioref">1980</a>)</span> is computed if you set <tt>type = “HC0”</tt>.</p></li>
<li><p>The function <tt>coeftest()</tt> performs significance tests for the coefficients in model objects. A covariance matrix can be supplied using the argument <tt>vcov.</tt>.</p></li>
</ul>
</div>
<div id="computation-of-heteroskedasticity-robust-standard-errors-1" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">11. Computation of Heteroskedasticity-Robust Standard Errors<a href="#computation-of-heteroskedasticity-robust-standard-errors-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the simple regression model, the covariance matrix of the coefficient estimators is denoted</p>
<p><span class="math display">\[\begin{equation}
\text{Var}
  \begin{pmatrix}
    \hat\beta_0 \
    \hat\beta_1
  \end{pmatrix} =
\begin{pmatrix}
  \text{Var}(\hat\beta_0) &amp; \text{Cov}(\hat\beta_0,\hat\beta_1) \\
\text{Cov}(\hat\beta_0,\hat\beta_1) &amp; \text{Var}(\hat\beta_1)
\end{pmatrix}
\end{equation}\]</span>\end{equation}</p>
<p>The function <tt>vcovHC</tt> can be used to obtain estimates of this matrix for a model object of interest.</p>
<p><tt>dummy_mod</tt>, a model object containing the wage regression dealt with in Exercises 9 and 10 is available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Compute robust standard errors of the type <tt>HC1</tt> for the coefficients estimators in the model object <tt>dummy_mod</tt>. Store the standard errors in a vector named <tt>rob_SEs</tt>.</li>
</ul>
<iframe src="DCL/ex5_11.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints</strong></p>
<ul>
<li>The standard errors we seek can be obtained by taking the square root of the diagonal elements of the estimated covariance matrix.</li>
<li><tt>diag(A)</tt> returns the diagonal elements of the matrix <tt>A</tt>.</li>
</ul>
</div>
<div id="robust-confidence-intervals" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">12. Robust Confidence Intervals<a href="#robust-confidence-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The function <tt>confint()</tt> computes confidence intervals for regression models using homoskedasticity-only standard errors so this function is not an option when there is heteroskedasticity.</p>
<p>The function <tt>Rob_CI()</tt> in <tt>script.R</tt> is meant to compute and report heteroskedasticity-robust confidence intervals for both model coefficients in a simple regression model.</p>
<p><tt>gender_mod</tt>, a model object containing the wage regression dealt with in the previous exercises is available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Complete the code of <tt>Rob_CI()</tt> given in <tt>Script.R</tt> such that lower and upper bounds of <span class="math inline">\(95\%\)</span> robust confidence intervals are returned. Use standard errors of the type <tt>HC1</tt>.</p></li>
<li><p>Use the function <tt>Rob_CI()</tt> to obtain <span class="math inline">\(95\%\)</span> confidence intervals for the model coefficients in <tt>dummy_mod</tt>.</p></li>
</ul>
<iframe src="DCL/ex5_12.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="a-small-simulation-study-i" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">13. A Small Simulation Study — I<a href="#a-small-simulation-study-i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider the data generating process (DGP)
<span class="math display">\[\begin{align}
  X_i \sim&amp; \, \mathcal{U}[2,10], \notag \\
  e_i \sim&amp; \, \mathcal{N}(0, X_i), \notag \\
  Y_i =&amp; \, \beta_1 X_i + e_i, (\#eq:asss)  
\end{align}\]</span>
where <span class="math inline">\(\mathcal{U}[2,10]\)</span> denotes the uniform distribution on the interval <span class="math inline">\([2,10]\)</span> and <span class="math inline">\(\beta_1=2\)</span>.</p>
<p>Notice that the errors <span class="math inline">\(e_i\)</span> are heteroskedastic since the variance of the <span class="math inline">\(e_i\)</span> is a function of <span class="math inline">\(X_i\)</span>.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Write a function <tt>DGP_OLS</tt> that generates a sample <span class="math inline">\((X_i,Y_i)\)</span>, <span class="math inline">\(i=1,…,100\)</span> using the DGP above and returns the OLS estimate of <span class="math inline">\(\beta_1\)</span> based on this sample.</li>
</ul>
<iframe src="DCL/ex5_13.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hint:</strong></p>
<p><tt>runif()</tt> can be used to obtain random samples from a uniform distribution, see <tt>?runif</tt>.</p>
</div>
<div id="a-small-simulation-study-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">14. A Small Simulation Study — II<a href="#a-small-simulation-study-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The function <tt>DGP_OLS()</tt> from the previous exercise is available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Use <tt>replicate()</tt> to generate a sample of <span class="math inline">\(1000\)</span> OLS estimates <span class="math inline">\(\widehat{\beta}_1\)</span> using the function <tt>DGP_OLS</tt>. Store the estimates in a vector named <tt>estimates</tt>.</p></li>
<li><p>Next, estimate the variance of <span class="math inline">\(\widehat{\beta}_1\)</span> in @ref(eq:asss): compute the sample variance of the <span class="math inline">\(1000\)</span> OLS estimates in <tt>estimates</tt>. Store the result in <tt>est_var_OLS</tt>.</p></li>
</ul>
<iframe src="DCL/ex5_14.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="a-small-simulation-study-iii" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">15. A Small Simulation Study — III<a href="#a-small-simulation-study-iii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>According to the the Gauss-Markov theorem, the OLS estimator in linear regression models is no longer the most efficient estimator among the conditionally unbiased linear estimators when there is heteroskedasticity. In other words, the OLS estimator loses the BLUE property when the assumption of homoskedasticity is violated.</p>
<p>It turns out that OLS applied to the weighted observations <span class="math inline">\((w_i X_i, w_i Y_i)\)</span> where <span class="math inline">\(w_i=\frac{1}{\sigma_i}\)</span> is the BLUE estimator under heteroskedasticity. This estimator is called the <em>weighted least squares</em> (WLS) estimator. Thus, when there is heteroskedasticity, the WLS estimator has lower variance than OLS.</p>
<p>The function <tt>DGP_OLS()</tt> and the estimated variance <tt>est_var_OLS</tt> from the previous exercises are available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Write a function <tt>DGP_WLS()</tt> that generates <span class="math inline">\(100\)</span> samples using the DGP introduced in Exercise 13 and returns the WLS estimate of <span class="math inline">\(\beta_1\)</span>. Treat <span class="math inline">\(\sigma_i\)</span> as known, i.e., set <span class="math inline">\(w_i=\frac{1}{\sqrt{X_i}}\)</span>.</p></li>
<li><p>Repeat exercise 14 using <tt>DGP_WLS()</tt>. Store the variance estimate in <tt>est_var_GLS</tt>.</p></li>
<li><p>Compare the estimated variances <tt>est_var_OLS</tt> and <tt>est_var_GLS</tt> using logical operators (<tt>&lt;</tt> or <tt>&gt;</tt>).</p></li>
</ul>
<iframe src="DCL/ex5_15.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p><tt>DGP_WLS()</tt> can be obtained using a modified code of <tt>DGP_OLS()</tt>.</p></li>
<li><p>Remember that functions are objects and you may print the code of a function to the console.</p></li>
</ul>
</div>
<!--chapter:end:05-ch5.Rmd-->
</div>
</div>
<div id="rmwmr" class="section level1 hasAnchor" number="6">
<h1 class="hasAnchor"><span class="header-section-number">6</span> Regression Models with Multiple Regressors<a href="#rmwmr" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In what follows we introduce linear regression models that use more than just one explanatory variable and discuss important key concepts in multiple regression. As we broaden our scope beyond the relationship of only two variables (the dependent variable and a single regressor) some potential new issues arise such as <em>multicollinearity</em> and <em>omitted variable bias</em> (OVB). In particular, this chapter deals with omitted variables and its implication for causal interpretation of OLS-estimated coefficients.</p>
<p>Naturally, we will discuss estimation of multiple regression models using <tt>R</tt>. We will also illustrate the importance of thoughtful usage of multiple regression models via simulation studies that demonstrate the consequences of using highly correlated regressors or misspecified models.</p>
<p>The packages <tt>AER</tt> <span class="citation">(<a href="#ref-R-AER" role="doc-biblioref">Christian Kleiber and Zeileis 2022</a>)</span> and <tt>MASS</tt> <span class="citation">(<a href="#ref-R-MASS" role="doc-biblioref">Ripley 2023</a>)</span> are needed for reproducing the code presented in this chapter. Make sure that the following code chunk executes without any errors.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code></pre></div>
<div id="omitted-variable-bias" class="section level2 hasAnchor" number="6.1">
<h2 class="hasAnchor"><span class="header-section-number">6.1</span> Omitted Variable Bias<a href="#omitted-variable-bias" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The previous analysis of the relationship between test score and class size discussed in Chapters @ref(lrwor) and @ref(htaciitslrm) has a major flaw: we ignored other determinants of the dependent variable (test score) that correlate with the regressor (class size). Remember that influences on the dependent variable which are not captured by the model are collected in the error term, which we so far assumed to be uncorrelated with the regressor. However, this assumption is violated if we exclude determinants of the dependent variable which vary with the regressor. This might induce an estimation bias, i.e., the mean of the OLS estimator’s sampling distribution is no longer equals the true mean. In our example we therefore wrongly estimate the causal effect on test scores of a unit change in the student-teacher ratio, on average. This issue is called <em>omitted variable bias</em> (OVB) and is summarized by Key Concept 6.1.</p>
<div id="KC6.1" class="keyconcept">
<h3 class="right">
Key Concept 6.1
</h3>
<h3 class="left">
Omitted Variable Bias in Regression with a Single Regressor
</h3>
<p>Omitted variable bias is the bias in the OLS estimator that arises when the regressor, <span class="math inline">\(X\)</span>, is <em>correlated</em> with an omitted variable. For omitted variable bias to occur, two conditions must be fulfilled:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(X\)</span> is correlated with the omitted variable.</li>
<li>The omitted variable is a determinant of the dependent variable <span class="math inline">\(Y\)</span>.</li>
</ol>
<p>Together, 1. and 2. result in a violation of the first OLS assumption <span class="math inline">\(E(u_i\vert X_i) = 0\)</span>. Formally, the resulting bias can be expressed as</p>
<p><span class="math display">\[ \hat\beta_1 \xrightarrow[]{p} \beta_1 + \rho_{Xu} \frac{\sigma_u}{\sigma_X}. \tag{6.1} \]</span>
See Appendix 6.1 of the book for a detailed derivation. (<a href="#mjx-eqn-6.1">6.1</a>) states that OVB is a problem that cannot be solved by increasing the number of observations used to estimate <span class="math inline">\(\beta_1\)</span>, as <span class="math inline">\(\hat\beta_1\)</span> is inconsistent: OVB prevents the estimator from converging in probability to the true parameter value. Strength and direction of the bias are determined by <span class="math inline">\(\rho_{Xu}\)</span>, the correlation between the error term and the regressor.</p>
</div>
<p>In the example of test score and class size, it is easy to come up with variables that may cause such a bias, if omitted from the model. As mentioned in the book, a highly relevant variable could be the percentage of English learners in the school district: it is plausible that the ability to speak, read and write English is an important factor for successful learning. Therefore, students that are still learning English are likely to perform worse in tests than native speakers. Also, it is conceivable that the share of English learning students is bigger in school districts where class sizes are relatively large: think of poor urban districts where a lot of immigrants live. <br></p>
<p>Let us think about a possible bias induced by omitting the share of English learning students (<span class="math inline">\(PctEL\)</span>) in view of (6.1). When the estimated regression model does not include <span class="math inline">\(PctEL\)</span> as a regressor although the true data generating process (DGP) is</p>
<p><span class="math display">\[ TestScore = \beta_0 + \beta_1 \times STR + \beta_2 \times PctEL \tag{6.2}\]</span></p>
<p>where <span class="math inline">\(STR\)</span> and <span class="math inline">\(PctEL\)</span> are correlated, we have</p>
<p><span class="math display">\[\rho_{STR,PctEL}\neq0.\]</span></p>
<p>Let us investigate this using <tt>R</tt>. After defining our variables we may compute the correlation between <span class="math inline">\(STR\)</span> and <span class="math inline">\(PctEL\)</span> as well as the correlation between <span class="math inline">\(STR\)</span> and <span class="math inline">\(TestScore\)</span>.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the AER package</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="co"># load the data set</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(CASchools)   </span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a><span class="co"># define variables</span></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>CASchools<span class="sc">$</span>STR <span class="ot">&lt;-</span> CASchools<span class="sc">$</span>students<span class="sc">/</span>CASchools<span class="sc">$</span>teachers       </span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>CASchools<span class="sc">$</span>score <span class="ot">&lt;-</span> (CASchools<span class="sc">$</span>read <span class="sc">+</span> CASchools<span class="sc">$</span>math)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a><span class="co"># compute correlations</span></span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(CASchools<span class="sc">$</span>STR, CASchools<span class="sc">$</span>score)</span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -0.2263627</span></span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(CASchools<span class="sc">$</span>STR, CASchools<span class="sc">$</span>english)</span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.1876424</span></span></code></pre></div>
<p>The fact that <span class="math inline">\(\widehat{\rho}_{STR, Testscore} = -0.2264\)</span> is cause for concern that omitting <span class="math inline">\(PctEL\)</span> leads to a negatively biased estimate <span class="math inline">\(\hat\beta_1\)</span> since this indicates that <span class="math inline">\(\rho_{Xu} &lt; 0\)</span>. As a consequence we expect <span class="math inline">\(\hat\beta_1\)</span>, the coefficient on <span class="math inline">\(STR\)</span>, to be too large in absolute value. Put differently, the OLS estimate of <span class="math inline">\(\hat\beta_1\)</span> suggests that small classes improve test scores, but that the effect of small classes is overestimated as it captures the effect of having fewer English learners, too.</p>
<p>What happens to the magnitude of <span class="math inline">\(\hat\beta_1\)</span> if we add the variable <span class="math inline">\(PctEL\)</span> to the regression, that is, if we estimate the model
<span class="math display">\[ TestScore = \beta_0 + \beta_1 \times STR + \beta_2 \times PctEL + u \]</span></p>
<p>instead? And what do we expect about the sign of <span class="math inline">\(\hat\beta_2\)</span>, the estimated coefficient on <span class="math inline">\(PctEL\)</span>? Following the reasoning above we should still end up with a negative but larger coefficient estimate <span class="math inline">\(\hat\beta_1\)</span> than before and a negative estimate <span class="math inline">\(\hat\beta_2\)</span>.</p>
<p>Let us estimate both regression models and compare. Performing a multiple regression in <tt>R</tt> is straightforward. One can simply add additional variables to the right hand side of the <code>formula</code> argument of the function <tt>lm()</tt> by using their names and the <tt>+</tt> operator.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate both regression models</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> STR, <span class="at">data =</span> CASchools) </span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>mult.mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> STR <span class="sc">+</span> english, <span class="at">data =</span> CASchools)</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print the results to the console</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>mod</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = score ~ STR, data = CASchools)</span></span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)          STR  </span></span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      698.93        -2.28</span></span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a>mult.mod</span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = score ~ STR + english, data = CASchools)</span></span>
<span id="cb140-18"><a href="#cb140-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb140-19"><a href="#cb140-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb140-20"><a href="#cb140-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)          STR      english  </span></span>
<span id="cb140-21"><a href="#cb140-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    686.0322      -1.1013      -0.6498</span></span></code></pre></div>
<p>We find the outcomes to be consistent with our expectations.</p>
<p>The following section discusses some theory on multiple regression models.</p>
</div>
<div id="tmrm" class="section level2 hasAnchor" number="6.2">
<h2 class="hasAnchor"><span class="header-section-number">6.2</span> The Multiple Regression Model<a href="#tmrm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The multiple regression model extends the basic concept of the simple regression model discussed in Chapters @ref(lrwor) and @ref(htaciitslrm). A multiple regression model enables us to estimate the effect on <span class="math inline">\(Y_i\)</span> of changing a regressor <span class="math inline">\(X_{1i}\)</span> if the remaining regressors <span class="math inline">\(X_{2i},X_{3i}\dots,X_{ki}\)</span> <em>do not vary</em>. In fact we already have performed estimation of the multiple regression model (<a href="#mjx-eqn-6.2">6.2</a>) using <tt>R</tt> in the previous section. The interpretation of the coefficient on student-teacher ratio is the effect on test scores of a one unit change student-teacher ratio if the percentage of English learners is kept constant.</p>
<p>Just like in the simple regression model, we assume the true relationship between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X_{1i},X_{2i}\dots\dots,X_{ki}\)</span> to be linear. On average, this relation is given by the population regression function</p>
<p><span class="math display">\[ E(Y_i\vert X_{1i}=x_1, X_{2i}=x_2,  X_{3i}=x_3,\dots, X_{ki}=x_k) = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_3 + \dots + \beta_k x_k. \tag{6.3} \]</span></p>
<p>As in the simple regression model, the relation <span class="math display">\[Y_i = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + \beta_3 X_{3i} + \dots + \beta_k X_{ki}\]</span> does not hold exactly since there are disturbing influences to the dependent variable <span class="math inline">\(Y\)</span> we cannot observe as explanatory variables. Therefore we add an error term <span class="math inline">\(u\)</span> which represents deviations of the observations from the population regression line to (<a href="#mjx-eqn-6.3">6.3</a>). This yields the population multiple regression model <span class="math display">\[ Y_i = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + \beta_3 X_{3i} + \dots + \beta_k X_{ki} + u_i, \ i=1,\dots,n. \tag{6.4} \]</span></p>
<p>Key Concept 6.2 summarizes the core concepts of the multiple regression model.</p>
<div id="KC6.2" class="keyconcept">
<h3 class="right">
Key Concept 6.2
</h3>
<h3 class="left">
The Multiple Regression Model
</h3>
<p>The multiple regression model is</p>
<p><span class="math display">\[ Y_i = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + \beta_3 X_{3i} + \dots + \beta_k X_{ki} + u_i \ \ , \ \ i=1,\dots,n.  \]</span></p>
<p>The designations are similar to those in the simple regression model:</p>
<ul>
<li><span class="math inline">\(Y_i\)</span> is the <span class="math inline">\(i^{th}\)</span> observation in the dependent variable. Observations on the <span class="math inline">\(k\)</span> regressors are denoted by <span class="math inline">\(X_{1i},X_{2i},\dots,X_{ki}\)</span> and <span class="math inline">\(u_i\)</span> is the error term.</li>
<li>The average relationship between <span class="math inline">\(Y\)</span> and the regressors is given by the population regression line
<span class="math display">\[ E(Y_i\vert X_{1i}=x_1, X_{2i}=x_2,  X_{3i}=x_3,\dots, X_{ki}=x_k) = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_3 + \dots + \beta_k x_k. \]</span></li>
<li><span class="math inline">\(\beta_0\)</span> is the intercept; it is the expected value of <span class="math inline">\(Y\)</span> when all <span class="math inline">\(X\)</span>s equal <span class="math inline">\(0\)</span>. <span class="math inline">\(\beta_j \ , \ j=1,\dots,k\)</span> are the coefficients on <span class="math inline">\(X_j \ , \ j=1,\dots,k\)</span>. <span class="math inline">\(\beta_1\)</span> measures the expected change in <span class="math inline">\(Y_i\)</span> that results from a one unit change in <span class="math inline">\(X_{1i}\)</span> while holding all other regressors constant.</li>
</ul>
</div>
<p>How can we estimate the coefficients of the multiple regression model (<a href="#mjx-eqn-6.4">6.4</a>)? We will not go too much into detail on this issue as our focus is on using <tt>R</tt>. However, it should be pointed out that, similarly to the simple regression model, the coefficients of the multiple regression model can be estimated using OLS. As in the simple model, we seek to minimize the sum of squared mistakes by choosing estimates <span class="math inline">\(b_0,b_1,\dots,b_k\)</span> for the coefficients <span class="math inline">\(\beta_0,\beta_1,\dots,\beta_k\)</span> such that</p>
<p><span class="math display">\[\sum_{i=1}^n (Y_i - b_0 - b_1 X_{1i} - b_2 X_{2i} - \dots -  b_k X_{ki})^2 \tag{6.5}\]</span></p>
<p>is minimized. Note that (<a href="#mjx-eqn-6.5">6.5</a>) is simply an extension of <span class="math inline">\(SSR\)</span> in the case with just one regressor and a constant. The estimators that minimize (<a href="#mjx-eqn-6.5">6.5</a>) are hence denoted <span class="math inline">\(\hat\beta_0,\hat\beta_1,\dots,\hat\beta_k\)</span> and, as in the simple regression model, we call them the ordinary least squares estimators of <span class="math inline">\(\beta_0,\beta_1,\dots,\beta_k\)</span>. For the predicted value of <span class="math inline">\(Y_i\)</span> given the regressors and the estimates <span class="math inline">\(\hat\beta_0,\hat\beta_1,\dots,\hat\beta_k\)</span> we have</p>
<p><span class="math display">\[ \hat{Y}_i = \hat\beta_0 + \hat\beta_1 X_{1i} + \dots +\hat\beta_k X_{ki}. \]</span>
The difference between <span class="math inline">\(Y_i\)</span> and its predicted value <span class="math inline">\(\hat{Y}_i\)</span> is called the OLS residual of observation <span class="math inline">\(i\)</span>: <span class="math inline">\(\hat{u} = Y_i - \hat{Y}_i\)</span>.</p>
<p>For further information regarding the theory behind multiple regression, see Chapter 18.1 of the book which inter alia presents a derivation of the OLS estimator in the multiple regression model using matrix notation.</p>
<p>Now let us jump back to the example of test scores and class sizes. The estimated model object is <code>mult.mod</code>. As for simple regression models we can use <tt>summary()</tt> to obtain information on estimated coefficients and model statistics.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mult.mod)<span class="sc">$</span>coef</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                Estimate Std. Error    t value      Pr(&gt;|t|)</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 686.0322445 7.41131160  92.565565 3.871327e-280</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; STR          -1.1012956 0.38027827  -2.896026  3.978059e-03</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; english      -0.6497768 0.03934254 -16.515882  1.657448e-47</span></span></code></pre></div>
<p>So the estimated multiple regression model is</p>
<p><span class="math display">\[ \widehat{TestScore} = 686.03 - 1.10 \times STR - 0.65 \times PctEL \tag{6.6}.  \]</span></p>
<p>Unlike in the simple regression model where the data can be represented by points in the two-dimensional coordinate system, we now have three dimensions. Hence observations can be represented by points in three-dimensional space. Therefore (<a href="#mjx-eqn-6.6">6.6</a>) is now longer a regression line but a <em>regression plane</em>. This idea extends to higher dimensions when we further expand the number of regressors <span class="math inline">\(k\)</span>. We then say that the regression model can be represented by a hyperplane in the <span class="math inline">\(k+1\)</span> dimensional space. It is already hard to imagine such a space if <span class="math inline">\(k=3\)</span> and we best stick with the general idea that, in the multiple regression model, the dependent variable is explained by a <em>linear combination of the regressors</em>. However, in the present case we are able to visualize the situation. The following figure is an interactive 3D visualization of the data and the estimated regression plane (<a href="#mjx-eqn-6.6">6.6</a>).</p>
<center>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-c06bba767a7c38b8d4bb" style="width:80%;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-c06bba767a7c38b8d4bb">{"x":{"visdat":{"cf592ad3beb":["function () ","plotlyVisDat"],"cf593b38c2ac":["function () ","data"]},"cur_data":"cf593b38c2ac","attrs":{"cf592ad3beb":{"x":[14,14.4916666666667,14.9833333333333,15.475,15.9666666666667,16.4583333333333,16.95,17.4416666666667,17.9333333333333,18.425,18.9166666666667,19.4083333333333,19.9,20.3916666666667,20.8833333333333,21.375,21.8666666666667,22.3583333333333,22.85,23.3416666666667,23.8333333333333,24.325,24.8166666666667,25.3083333333333,25.8],"y":[0,3.5641549428304,7.12830988566081,10.6924648284912,14.2566197713216,17.820774714152,21.3849296569824,24.9490845998128,28.5132395426432,32.0773944854736,35.641549428304,39.2057043711344,42.7698593139648,46.3340142567952,49.8981691996257,53.4623241424561,57.0264790852865,60.5906340281169,64.1547889709473,67.7189439137777,71.2830988566081,74.8472537994385,78.4114087422689,81.9755636850993,85.5397186279297],"z":[[670.614105498156,670.072635138979,669.531164779801,668.989694420623,668.448224061446,667.906753702268,667.36528334309,666.823812983912,666.282342624735,665.740872265557,665.199401906379,664.657931547202,664.116461188024,663.574990828846,663.033520469668,662.492050110491,661.950579751313,661.409109392135,660.867639032958,660.32616867378,659.784698314602,659.243227955425,658.701757596247,658.160287237069,657.618816877891],[668.298200193628,667.75672983445,667.215259475273,666.673789116095,666.132318756917,665.590848397739,665.049378038562,664.507907679384,663.966437320206,663.424966961029,662.883496601851,662.342026242673,661.800555883496,661.259085524318,660.71761516514,660.176144805962,659.634674446785,659.093204087607,658.551733728429,658.010263369252,657.468793010074,656.927322650896,656.385852291718,655.844381932541,655.302911573363],[665.9822948891,665.440824529922,664.899354170744,664.357883811567,663.816413452389,663.274943093211,662.733472734034,662.192002374856,661.650532015678,661.1090616565,660.567591297323,660.026120938145,659.484650578967,658.94318021979,658.401709860612,657.860239501434,657.318769142257,656.777298783079,656.235828423901,655.694358064723,655.152887705546,654.611417346368,654.06994698719,653.528476628013,652.987006268835],[663.666389584572,663.124919225394,662.583448866216,662.041978507038,661.500508147861,660.959037788683,660.417567429505,659.876097070328,659.33462671115,658.793156351972,658.251685992794,657.710215633617,657.168745274439,656.627274915261,656.085804556084,655.544334196906,655.002863837728,654.461393478551,653.919923119373,653.378452760195,652.836982401017,652.29551204184,651.754041682662,651.212571323484,650.671100964307],[661.350484280043,660.809013920866,660.267543561688,659.72607320251,659.184602843333,658.643132484155,658.101662124977,657.560191765799,657.018721406622,656.477251047444,655.935780688266,655.394310329089,654.852839969911,654.311369610733,653.769899251555,653.228428892378,652.6869585332,652.145488174022,651.604017814845,651.062547455667,650.521077096489,649.979606737312,649.438136378134,648.896666018956,648.355195659778],[659.034578975515,658.493108616337,657.95163825716,657.410167897982,656.868697538804,656.327227179626,655.785756820449,655.244286461271,654.702816102093,654.161345742916,653.619875383738,653.07840502456,652.536934665383,651.995464306205,651.453993947027,650.912523587849,650.371053228672,649.829582869494,649.288112510316,648.746642151139,648.205171791961,647.663701432783,647.122231073605,646.580760714428,646.03929035525],[656.718673670987,656.177203311809,655.635732952631,655.094262593454,654.552792234276,654.011321875098,653.46985151592,652.928381156743,652.386910797565,651.845440438387,651.30397007921,650.762499720032,650.221029360854,649.679559001676,649.138088642499,648.596618283321,648.055147924143,647.513677564966,646.972207205788,646.43073684661,645.889266487433,645.347796128255,644.806325769077,644.264855409899,643.723385050722],[654.402768366459,653.861298007281,653.319827648103,652.778357288925,652.236886929748,651.69541657057,651.153946211392,650.612475852215,650.071005493037,649.529535133859,648.988064774681,648.446594415504,647.905124056326,647.363653697148,646.822183337971,646.280712978793,645.739242619615,645.197772260438,644.65630190126,644.114831542082,643.573361182904,643.031890823727,642.490420464549,641.948950105371,641.407479746194],[652.08686306193,651.545392702752,651.003922343575,650.462451984397,649.920981625219,649.379511266042,648.838040906864,648.296570547686,647.755100188509,647.213629829331,646.672159470153,646.130689110975,645.589218751798,645.04774839262,644.506278033442,643.964807674265,643.423337315087,642.881866955909,642.340396596731,641.798926237554,641.257455878376,640.715985519198,640.174515160021,639.633044800843,639.091574441665],[649.770957757402,649.229487398224,648.688017039047,648.146546679869,647.605076320691,647.063605961513,646.522135602336,645.980665243158,645.43919488398,644.897724524803,644.356254165625,643.814783806447,643.27331344727,642.731843088092,642.190372728914,641.648902369736,641.107432010559,640.565961651381,640.024491292203,639.483020933026,638.941550573848,638.40008021467,637.858609855492,637.317139496315,636.775669137137],[647.455052452874,646.913582093696,646.372111734518,645.830641375341,645.289171016163,644.747700656985,644.206230297807,643.66475993863,643.123289579452,642.581819220274,642.040348861097,641.498878501919,640.957408142741,640.415937783563,639.874467424386,639.332997065208,638.79152670603,638.250056346853,637.708585987675,637.167115628497,636.62564526932,636.084174910142,635.542704550964,635.001234191786,634.459763832609],[645.139147148345,644.597676789168,644.05620642999,643.514736070812,642.973265711635,642.431795352457,641.890324993279,641.348854634101,640.807384274924,640.265913915746,639.724443556568,639.182973197391,638.641502838213,638.100032479035,637.558562119857,637.01709176068,636.475621401502,635.934151042324,635.392680683147,634.851210323969,634.309739964791,633.768269605614,633.226799246436,632.685328887258,632.14385852808],[642.823241843817,642.281771484639,641.740301125462,641.198830766284,640.657360407106,640.115890047929,639.574419688751,639.032949329573,638.491478970396,637.950008611218,637.40853825204,636.867067892862,636.325597533685,635.784127174507,635.242656815329,634.701186456152,634.159716096974,633.618245737796,633.076775378618,632.535305019441,631.993834660263,631.452364301085,630.910893941908,630.36942358273,629.827953223552],[640.507336539289,639.965866180111,639.424395820933,638.882925461756,638.341455102578,637.7999847434,637.258514384223,636.717044025045,636.175573665867,635.634103306689,635.092632947512,634.551162588334,634.009692229156,633.468221869979,632.926751510801,632.385281151623,631.843810792446,631.302340433268,630.76087007409,630.219399714912,629.677929355735,629.136458996557,628.594988637379,628.053518278202,627.512047919024],[638.191431234761,637.649960875583,637.108490516405,636.567020157227,636.02554979805,635.484079438872,634.942609079694,634.401138720517,633.859668361339,633.318198002161,632.776727642984,632.235257283806,631.693786924628,631.15231656545,630.610846206273,630.069375847095,629.527905487917,628.98643512874,628.444964769562,627.903494410384,627.362024051207,626.820553692029,626.279083332851,625.737612973673,625.196142614496],[635.875525930232,635.334055571055,634.792585211877,634.251114852699,633.709644493522,633.168174134344,632.626703775166,632.085233415988,631.543763056811,631.002292697633,630.460822338455,629.919351979278,629.3778816201,628.836411260922,628.294940901744,627.753470542567,627.212000183389,626.670529824211,626.129059465034,625.587589105856,625.046118746678,624.504648387501,623.963178028323,623.421707669145,622.880237309967],[633.559620625704,633.018150266526,632.476679907349,631.935209548171,631.393739188993,630.852268829815,630.310798470638,629.76932811146,629.227857752282,628.686387393105,628.144917033927,627.603446674749,627.061976315572,626.520505956394,625.979035597216,625.437565238038,624.896094878861,624.354624519683,623.813154160505,623.271683801328,622.73021344215,622.188743082972,621.647272723794,621.105802364617,620.564332005439],[631.243715321176,630.702244961998,630.16077460282,629.619304243643,629.077833884465,628.536363525287,627.99489316611,627.453422806932,626.911952447754,626.370482088576,625.829011729399,625.287541370221,624.746071011043,624.204600651866,623.663130292688,623.12165993351,622.580189574333,622.038719215155,621.497248855977,620.955778496799,620.414308137622,619.872837778444,619.331367419266,618.789897060089,618.248426700911],[628.927810016648,628.38633965747,627.844869298292,627.303398939114,626.761928579937,626.220458220759,625.678987861581,625.137517502404,624.596047143226,624.054576784048,623.51310642487,622.971636065693,622.430165706515,621.888695347337,621.34722498816,620.805754628982,620.264284269804,619.722813910627,619.181343551449,618.639873192271,618.098402833093,617.556932473916,617.015462114738,616.47399175556,615.932521396383],[626.611904712119,626.070434352941,625.528963993764,624.987493634586,624.446023275408,623.904552916231,623.363082557053,622.821612197875,622.280141838698,621.73867147952,621.197201120342,620.655730761164,620.114260401987,619.572790042809,619.031319683631,618.489849324454,617.948378965276,617.406908606098,616.865438246921,616.323967887743,615.782497528565,615.241027169388,614.69955681021,614.158086451032,613.616616091854],[624.295999407591,623.754529048413,623.213058689236,622.671588330058,622.13011797088,621.588647611702,621.047177252525,620.505706893347,619.964236534169,619.422766174992,618.881295815814,618.339825456636,617.798355097459,617.256884738281,616.715414379103,616.173944019925,615.632473660748,615.09100330157,614.549532942392,614.008062583215,613.466592224037,612.925121864859,612.383651505681,611.842181146504,611.300710787326],[621.980094103063,621.438623743885,620.897153384707,620.35568302553,619.814212666352,619.272742307174,618.731271947996,618.189801588819,617.648331229641,617.106860870463,616.565390511286,616.023920152108,615.48244979293,614.940979433752,614.399509074575,613.858038715397,613.316568356219,612.775097997042,612.233627637864,611.692157278686,611.150686919509,610.609216560331,610.067746201153,609.526275841975,608.984805482798],[619.664188798534,619.122718439357,618.581248080179,618.039777721001,617.498307361824,616.956837002646,616.415366643468,615.87389628429,615.332425925113,614.790955565935,614.249485206757,613.70801484758,613.166544488402,612.625074129224,612.083603770047,611.542133410869,611.000663051691,610.459192692514,609.917722333336,609.376251974158,608.83478161498,608.293311255803,607.751840896625,607.210370537447,606.668900178269],[617.348283494006,616.806813134828,616.265342775651,615.723872416473,615.182402057295,614.640931698118,614.09946133894,613.557990979762,613.016520620585,612.475050261407,611.933579902229,611.392109543051,610.850639183874,610.309168824696,609.767698465518,609.22622810634,608.684757747163,608.143287387985,607.601817028807,607.06034666963,606.518876310452,605.977405951274,605.435935592097,604.894465232919,604.352994873741],[615.032378189478,614.4909078303,613.949437471123,613.407967111945,612.866496752767,612.325026393589,611.783556034412,611.242085675234,610.700615316056,610.159144956879,609.617674597701,609.076204238523,608.534733879345,607.993263520168,607.45179316099,606.910322801812,606.368852442635,605.827382083457,605.285911724279,604.744441365102,604.202971005924,603.661500646746,603.120030287568,602.578559928391,602.037089569213]],"opacity":0.9,"name":"Reg.Plane","colors":"red","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface"},"cf593b38c2ac":{"x":[17.8899088829779,21.5246644135433,18.6972252288335,17.3571428571429,18.6713286713287,21.406249681022,19.5,20.8941176470588,19.9473684210526,20.8055555555556,21.2380952380952,21,20.6,20.0082168014375,18.0277777777778,20.2519611642598,16.9778699413794,16.5098039215686,22.7040227954819,19.9111111111111,18.3333333333333,22.6190476190476,19.448275862069,25.0526315789474,20.6754385964912,18.6823529411765,22.8455293273174,19.2666666666667,19.25,20.5454545454545,20.6069651741294,21.0726817042607,21.5358144363179,19.904,21.1940684544254,21.8653548739123,18.3296457083095,16.2285714285714,19.1785714285714,20.2773673693064,22.9861365135517,20.4444444444444,19.8208464129607,23.205223880597,19.2669683257919,23.3018867924528,21.1882860271413,20.8717948717949,19.0174947515745,21.9193802349385,20.1012373453318,21.4765100671141,20.0657888748265,20.3750946304228,22.446482206684,22.8952380952381,20.4979697160857,19.9999997290939,22.2565805492426,21.5643629196127,19.4773712501098,17.6700201456427,21.9475616151023,21.7833935018051,19.14,18.1104972375691,20.6824250654847,22.6236080178174,21.7864987387076,18.5829312134509,21.5454545454545,21.1528918488938,16.6333333333333,21.1443830899838,19.7818181818182,18.9837288944761,17.6676680724533,17.754991247092,15.2727272727273,14,20.5961335276821,16.3116883116883,21.1279620853081,17.4880123598627,17.8867924528302,19.3067588435028,20.8923076923077,21.2868392089495,20.1955990220049,24.95,18.1304347826087,20,18.7295084895385,18.25,18.9925686639621,19.8876413018577,19.3789473684211,20.4625850340136,22.2915734818168,20.7047392724654,19.0600525989991,20.2324702908189,19.6901229507238,20.3625387030444,19.7542237411884,19.3797669431263,22.9235094024774,19.3733975555516,19.1551557767,21.3,18.3035717402794,21.0792562824344,18.791208003486,19.6266181276984,19.590164240699,20.8718719045074,21.1150007392067,20.0845208845209,19.9104890079458,17.8128519025892,18.1333333333333,19.2222109626064,18.6607146035044,19.6,19.2838427947598,22.8181818181818,18.8092193175492,21.3736332119715,20.0204081632653,21.4986149584488,15.4285714285714,22.4,20.1270869566436,19.0379746835443,17.3421579447488,17.0186331371371,20.8,21.1538461538462,18.4583333333333,19.1408207270671,19.4076576857931,19.5689648737097,21.5012000186184,17.5294117647059,16.4301713487041,19.7965402233519,17.1861336595179,17.6158935947066,20.1253715192381,22.1666666666667,19.9615384615385,19.0394513640815,15.2243595327852,21.1447499009334,19.6438998246679,21.0486891385768,20.1754385964912,21.3913043478261,20.0083249004548,20.2913719276809,17.6666666666667,18.2205506816453,20.2710018717861,20.1989464047365,21.3842445345418,20.9736842105263,20,17.1532849103452,22.3497705836374,22.1700710363591,18.1818181818182,18.9571428571429,19.7453305580818,16.4262295081967,16.6253976791474,16.38176709392,20.0741582358159,17.9954440870962,19.3913043478261,16.4285717083483,16.7294869588045,24.4134521894715,18.2641509433962,18.9550418244691,21.0389615601121,20.7407407407407,18.1,19.8461538461538,21.6,22.4424209045409,23.0143764873862,17.7489176651741,18.2866407796733,19.2654419132432,22.6666666666667,19.2941176470588,17.3636363636364,19.8214290624205,20.4337797063172,21.0372093023256,19.9246234975196,19.0098568462085,23.8222222222222,19.3690847073363,19.8285714285714,15.2588552686217,17.1612903225806,21.8133333333333,19.0747133426306,25.7851231540294,18.212614444761,18.166064157175,16.972972972973,21.5008728866294,20.6,16.9902909475106,20.7795456185188,15.5124660296439,19.8850574712644,21.3988234659086,20.497512048797,19.3637581871342,17.659575184744,21.0179561441264,19.0556494863121,22.5384615384615,21.1078711835393,20.0513538034642,14.2017629244119,18.4768683274021,18.6354166666667,20.9459459459459,21.0854825556009,18.6928802180985,20.8680790498909,19.8255776972916,19.75,19.5,18.3908050008928,18.7867641789278,19.7701804862839,19.3333333333333,21.4639175257732,23.0849235566616,21.0629924423187,18.6868694069167,20.7702354006901,19.3055560669781,20.1328025598196,20.6696349496271,22.2815533980583,20.6002719936284,20.8273387010791,19.2249242350677,17.654770182971,17,16.4977277151551,19.7826084222295,22.3021585029028,17.7307692307692,20.4483612471435,20.3716944004797,20.1647869771202,21.6153779636056,20.5614288634761,19.9555109812711,21.183870895869,18.8104238242347,20.5783834180104,18.3246072688457,18.8206265775451,20.8163265306122,20,19.6818181818182,19.3901773923638,20.9273188292824,19.9443667533701,20.7910936237841,19.2035394988686,19.0243905162187,17.620578201782,20.2371534527511,19.2937402041726,18.8299814558293,20.3394923570245,19.2289969016058,17.8913043478261,19.5188096275881,19.0845072985972,19.9354838709677,18.8732569838045,20.1417852051784,23.5563711810368,21.4647887323944,19.1910112359551,20.1307996029783,25.8,18.7777401224092,19.1098147138764,19.7010865991333,18.6159420289855,20.9972114934227,20,20.9832509897728,21.6426229508197,20.0296731370496,19.8113968408637,18,19.3581078586307,20.1791214452076,21.1198631939305,23.3897364771151,22.1818181818182,19.9428279074446,17.7882555232377,14.7058821982578,19.040767037723,20.8919540229885,19.8385070816457,19.5219120539036,20.6862176489988,18.1818181818182,18.8922429984947,24.8888888888889,18.5806451612903,18.04,17.7339901477833,21.4545454545455,19.9234247876565,20.3394199785177,22.5460750853242,21.1034424809305,18.1974254885637,20.1076808229449,19.1598356162563,19.5454548278788,20.8888888888889,18.3915018503307,19.1799030878106,19.3977064458372,21.6782728550361,19.2888888888889,20.3492739161628,20.9641618174683,19.4603902706826,19.2857151615377,20.9197933397877,20.9002141266009,20.5957446808511,19.375,19.9512232540535,18.8497340903631,18.1178712480167,19.1834085642053,22,21.5841576006235,20.3888888888889,16.2931029124719,18.2777821171534,19.3747164524626,18.9090909090909,16.406926135985,15.5913975296964,18.7069414043726,18.3298532783061,17.9023506490849,18.9115648712309,20.3249661880789,20.0245691799889,24,17.6078431372549,19.3485337211153,19.6784651300815,18.7286056582498,15.8823532381685,20.0549127852273,17.9882527208952,16.9662928620368,19.2393743182499,19.1958581618667,19.5990618887251,20.5434782608696,18.5884843645164,15.6041861492374,15.2930401861936,17.6553674218923,17.5797611320959,22.3333333333333,18.75,18.1024099158844,20.2564097610765,18.8020749650075,18.7723051893905,20.405210291402,18.6507930861339,20.7070715049617,22,17.6997754983767,21.4832888462028,16.7010312562339,19.5756726978814,17.258064516129,17.3752559601841,17.3493114406599,16.2622843263867,17.7004542663956,20.1288155606007,18.2653941392753,14.5421361585846,19.1526116141991,17.3657415845815,15.1389850328556,17.8426602888311,15.407041884931,18.8653402295668,16.4741337274612,17.8626250782683,21.8858564937366,20.2,19.0364022585948],"y":[0,4.58333349227905,30.0000019073486,0,13.8576774597168,12.4087591171265,68.7179489135742,46.9594612121582,30.0791568756104,40.2759208679199,52.9147987365723,54.6099319458008,42.7184448242188,20.5338802337646,80.1232604980469,49.413143157959,85.5397186279297,58.9073638916016,77.0058135986328,49.8139877319336,40.6818199157715,16.2105255126953,45.0748634338379,39.0756301879883,76.6652526855469,40.4911842346191,73.7202301025391,70.0115356445312,55.962215423584,11.0619468688965,80.4200897216797,63.1303558349609,65.1218566894531,53.4164009094238,49.823070526123,35.4653701782227,56.1255264282227,32.3943672180176,65.5121002197266,53.0554428100586,49.6425323486328,45.1086959838867,30.3204593658447,52.2431259155273,36.8013153076172,30.2833995819092,49.8645668029785,13.7592134475708,28.8637046813965,52.8047866821289,44.0850601196289,35.25,37.4944610595703,50.3905906677246,31.0725784301758,18.2612323760986,34.7002067565918,33.288948059082,33.4877090454102,38.1587524414062,36.9294624328613,32.9894905090332,58.2166557312012,17.0036468505859,17.6593532562256,7.32153749465942,31.1981563568115,16.6174449920654,58.0810356140137,55.8925437927246,5.48523235321045,14.4291934967041,22.8456916809082,38.7833366394043,64.2463226318359,25.225564956665,5.38243627548218,6.07902765274048,0,0,34.8891792297363,13.0573244094849,36.0251235961914,34.6534652709961,28.6919822692871,1.79533219337463,30.6332855224609,59.0334548950195,13.5593223571777,5.01001977920532,0.95923262834549,0.666666686534882,38.512035369873,0,17.1739139556885,9.88700580596924,19.3916358947754,36.4893608093262,39.3999977111816,28.6776218414307,13.6986303329468,11.3498363494873,3.44262313842773,15.4302673339844,17.973783493042,22.7177333831787,18.4362449645996,16.1717147827148,2.02212882041931,9.62441349029541,41.4634132385254,9.89903450012207,16.0818710327148,43.4949378967285,8.78661060333252,39.0243873596191,53.8903045654297,41.1332931518555,1.38328528404236,35.4430389404297,8.63970565795898,15.3497743606567,19.8564586639404,3.06122446060181,9.87318801879883,16.0956172943115,43.4989776611328,45.0379524230957,18.1957187652588,15.4876947402954,0.92592591047287,7.5892858505249,29.0858383178711,0.132978722453117,50.8576316833496,11.4963502883911,13.4615392684937,4.72727251052856,21.444694519043,12.3536806106567,30.1488838195801,15.8590297698975,43.75,0,0,16.6522121429443,3.22033905982971,0,48.5245895385742,0.751879692077637,1.92678236961365,13.5135126113892,0,16.7146053314209,5.94353628158569,36.1743774414062,44.971866607666,16.6666679382324,15.1872396469116,34.3377990722656,0,13.0673999786377,4.27807474136353,39.5946311950684,21.6683731079102,3.2622332572937,7.85714292526245,39.5744667053223,10.1278028488159,27.5217914581299,14,8.84200000762939,6.40584659576416,2.39520978927612,5.95744705200195,8.17391300201416,15.4589366912842,0,0,0,31.8245830535889,12.8009166717529,0,3.84615397453308,2.46913576126099,10.7142858505249,0,1.93798446655273,4.62962961196899,5.25059652328491,27.5403823852539,14.9825782775879,47.8793754577637,0,1.76470601558685,0,0,7.28910732269287,17.028003692627,10.4355516433716,2.26986122131348,28.2479133605957,8.76865673065186,7.49185657501221,9.79827117919922,12.5,0,31.2041549682617,1.36919319629669,9.61538505554199,0,24.2572898864746,9.55414009094238,5.92532444000244,0.970873773097992,18.2857131958008,4.9843487739563,4.28571462631226,3.35260105133057,32.7074966430664,9.46601963043213,6.26078748703003,13.2530126571655,3.16913533210754,16.9911499023438,0.853242337703705,6.64956569671631,0.116414435207844,0,6.93374443054199,9.55841255187988,0.903225779533386,1.15830111503601,40.1080169677734,16.6632118225098,21.955358505249,8.86075973510742,0.854700922966003,0,3.91389417648315,11.9494590759277,3.99274039268494,22.9394817352295,2.48563003540039,9.87149524688721,0.54054057598114,8.95663166046143,6.47481966018677,20.7254314422607,0.187265917658806,13.9869289398193,8.74172115325928,20.0345420837402,1.38339924812317,2.06270623207092,28.5714302062988,0.169491529464722,13.7362642288208,0,0.216919749975204,3.12103939056396,47.3684234619141,22.7096786499023,29.1207408905029,4.43262434005737,4.81421661376953,5.24920463562012,1.89944136142731,8.66293334960938,10.4761905670166,1.24223601818085,0,9.375,1.38568139076233,35.3421211242676,9.64071846008301,2.23152017593384,0.366403609514236,0.576036870479584,0,0.851581513881683,5.52455377578735,0,0,2.43722319602966,20.766773223877,2.18712043762207,13.6261758804321,13.2841329574585,1.94174754619598,23.0615653991699,0.621118009090424,3.25551223754883,0,2.22482442855835,18.5583763122559,6.20155048370361,18.4574813842773,32.0725517272949,3.96551704406738,15.3367071151733,27.6652278900146,12.537314414978,12.6801748275757,6.90804433822632,14.9629621505737,11.2693252563477,9.72222232818604,3.31588125228882,0.693481266498566,5.14112901687622,4.96916532516479,6.96721315383911,7.99606513977051,0.48192772269249,2.5,3.84131002426147,1.32042253017426,4.91228055953979,0,0.222386956214905,0,17.8540592193604,4.4642858505249,9.54861164093018,3.99113082885742,20.6666660308838,7.6271185874939,27.4536724090576,10.8576259613037,5.02573394775391,14.2361688613892,0.235849052667618,2.0706889629364,8.55614948272705,0,4.78723430633545,3.96039605140686,1.57935285568237,3.5939085483551,8.72622680664062,0,0.264061272144318,1.44792151451111,0.147492617368698,0,3.70500636100769,0.268528461456299,0,4.51612901687622,2.44479489326477,0,0,5.40540552139282,0,6.42201805114746,6.53950929641724,14.2857151031494,3.67879748344421,0.502176105976105,0,22.6912937164307,0,0.141643062233925,2.73348522186279,1.68350172042847,0,0.143609374761581,0,11.0465116500854,0,0,0.0633312240242958,0,0,15.0598974227905,1.47959184646606,2.64900660514832,1.47991538047791,4.46989297866821,0.326441794633865,2.53968262672424,0.54200541973114,11.5853662490845,11.3772449493408,0,1.37488543987274,2.2388060092926,5.33333349227905,2.77315592765808,0,17.7257518768311,0,0,0.425531893968582,6.06707334518433,10.1275911331177,3.37552738189697,8.6485424041748,12.3456792831421,1.58959531784058,1.4953271150589,10.3855228424072,6.13402032852173,2.2662889957428,2.47863245010376,0.893629252910614,2.42165231704712,3.76569032669067,1.96286475658417,0.578034639358521,2.80728387832642,1.36363637447357,1.16448330879211,2.05040574073792,5.99593496322632,4.72610092163086,24.2630386352539,2.97029709815979,5.00562429428101],"z":[690.799987792969,661.200012207031,643.600006103516,647.700012207031,640.850006103516,605.550018310547,606.75,609,612.5,612.650024414062,615.75,616.299987792969,616.299987792969,616.299987792969,616.450012207031,617.350006103516,618.050018310547,618.300018310547,619.799987792969,620.299987792969,620.5,621.400024414062,621.75,622.050018310547,622.600006103516,623.100006103516,623.200012207031,623.450012207031,623.599975585938,624.150024414062,624.550018310547,624.950012207031,625.299987792969,625.849975585938,626.100006103516,626.800018310547,626.899993896484,627.100006103516,627.25,627.299987792969,628.25,628.399993896484,628.550018310547,628.649993896484,628.75,629.800018310547,630.350006103516,630.400024414062,630.549987792969,630.549987792969,631.050018310547,631.399993896484,631.850006103516,631.899993896484,631.950012207031,632,632.200012207031,632.25,632.449981689453,632.850006103516,632.950012207031,633.049987792969,633.149993896484,633.650024414062,633.899993896484,634,634.050018310547,634.100006103516,634.100006103516,634.149993896484,634.199981689453,634.399993896484,634.549987792969,634.700012207031,634.899993896484,634.949981689453,635.049987792969,635.199981689453,635.450012207031,635.599975585938,635.600006103516,635.75,635.950012207031,636.100006103516,636.5,636.600006103516,636.699981689453,636.900024414062,636.950012207031,637,637.100006103516,637.350006103516,637.650024414062,637.949981689453,637.950012207031,638,638.200012207031,638.300018310547,638.300018310547,638.349975585938,638.549987792969,638.700012207031,639.25,639.300018310547,639.350006103516,639.5,639.75,639.799987792969,639.850006103516,639.899993896484,640.100006103516,640.150024414062,640.5,640.75,640.900024414062,641.100006103516,641.449981689453,641.449981689453,641.549987792969,641.800018310547,642.199981689453,642.200012207031,642.399993896484,642.75,643.049987792969,643.199981689453,643.25,643.400024414062,643.399993896484,643.5,643.5,643.699981689453,643.700012207031,644.199981689453,644.200012207031,644.399993896484,644.450012207031,644.450012207031,644.5,644.549987792969,644.699981689453,644.950012207031,645.100006103516,645.25,645.549987792969,645.550018310547,645.600006103516,645.75,645.75,646,646.200012207031,646.350006103516,646.399993896484,646.5,646.549987792969,646.700012207031,646.899993896484,646.949981689453,647.049987792969,647.25,647.299987792969,647.600006103516,647.599975585938,648,648.200012207031,648.25,648.349975585938,648.700012207031,648.949981689453,649.149993896484,649.300018310547,649.5,649.699981689453,649.849975585938,650.449981689453,650.549987792969,650.600006103516,650.649993896484,650.899993896484,650.899993896484,651.149993896484,651.200012207031,651.350006103516,651.399993896484,651.450012207031,651.800018310547,651.850006103516,651.899993896484,652,652.100006103516,652.099975585938,652.299987792969,652.300018310547,652.350006103516,652.399993896484,652.399993896484,652.5,652.850006103516,653.099975585938,653.399993896484,653.5,653.549987792969,653.550018310547,653.699981689453,653.799987792969,653.850006103516,653.949981689453,654.100006103516,654.199981689453,654.199981689453,654.299987792969,654.600006103516,654.850006103516,654.850006103516,654.899993896484,655.049987792969,655.050018310547,655.050018310547,655.199981689453,655.300018310547,655.350006103516,655.349975585938,655.399993896484,655.549987792969,655.699981689453,655.799987792969,655.850006103516,656.399993896484,656.5,656.550018310547,656.650024414062,656.700012207031,656.800018310547,656.800018310547,657,657,657.149993896484,657.400024414062,657.5,657.550018310547,657.649993896484,657.75,657.799987792969,657.899993896484,658,658.350006103516,658.600006103516,658.799987792969,659.050018310547,659.149993896484,659.350006103516,659.399993896484,659.399993896484,659.799987792969,659.900024414062,660.050018310547,660.099975585938,660.199981689453,660.299987792969,660.75,660.949981689453,661.349975585938,661.450012207031,661.599975585938,661.600006103516,661.849975585938,661.850006103516,661.850006103516,661.899993896484,661.899993896484,661.950012207031,662.399993896484,662.400024414062,662.450012207031,662.5,662.550018310547,662.550018310547,662.649993896484,662.700012207031,662.75,662.899993896484,663.350006103516,663.449981689453,663.5,663.850006103516,663.850006103516,663.899993896484,664,664,664.149993896484,664.149993896484,664.299987792969,664.400024414062,664.449981689453,664.700012207031,664.75,664.949981689453,664.950012207031,665.100006103516,665.200012207031,665.350006103516,665.650024414062,665.899993896484,665.950012207031,666,666.050018310547,666.100006103516,666.150024414062,666.149993896484,666.449981689453,666.550018310547,666.600006103516,666.649993896484,666.649993896484,666.699981689453,666.850006103516,666.850006103516,667.149993896484,667.199981689453,667.450012207031,667.450012207031,667.600006103516,668,668.100006103516,668.399993896484,668.600006103516,668.649993896484,668.799987792969,668.899993896484,668.950012207031,669.099975585938,669.300018310547,669.300018310547,669.350006103516,669.349975585938,669.799987792969,669.850006103516,669.950012207031,670,670.699981689453,671.25,671.299987792969,671.600006103516,671.600006103516,671.649993896484,671.699981689453,671.75,671.899993896484,671.899993896484,671.949981689453,672.049987792969,672.050018310547,672.299987792969,672.349975585938,672.450012207031,672.550018310547,672.699981689453,673.049987792969,673.25,673.299987792969,673.549987792969,673.549987792969,673.899993896484,674.25,675.399993896484,675.700012207031,676.149993896484,676.549987792969,676.600006103516,676.850006103516,676.949981689453,677.25,677.950012207031,678.050018310547,678.399993896484,678.799987792969,679.399993896484,679.5,679.649993896484,679.75,679.800018310547,680.050018310547,680.450012207031,681.299987792969,681.299987792969,681.600006103516,681.899993896484,682.149993896484,682.450012207031,682.549987792969,682.649993896484,683.350006103516,683.399993896484,684.300018310547,684.350006103516,684.800018310547,684.950012207031,686.050018310547,686.699981689453,687.549987792969,689.099975585938,691.049987792969,691.350006103516,691.899993896484,693.950012207031,694.25,694.800018310547,695.199981689453,695.299987792969,696.550018310547,698.199981689453,698.25,698.449981689453,699.100006103516,700.300018310547,704.300018310547,706.75,645,672.200012207031,655.75],"opacity":0.9,"name":"CASchools","colors":"red","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","marker":{"color":["#71008D","#FF0000","#FF0000","#AA0055","#AA0055","#0000FF","#C60038","#8D0071","#5500AA","#8D0071","#C60038","#C60038","#AA0055","#3800C6","#FF0000","#C60038","#E2001C","#C60038","#E2001C","#C60038","#AA0055","#71008D","#C60038","#C60038","#E2001C","#AA0055","#C60038","#FF0000","#FF0000","#5500AA","#C60038","#FF0000","#E2001C","#FF0000","#FF0000","#C60038","#FF0000","#8D0071","#FF0000","#FF0000","#FF0000","#E2001C","#AA0055","#FF0000","#C60038","#C60038","#FF0000","#8D0071","#AA0055","#FF0000","#FF0000","#E2001C","#E2001C","#FF0000","#E2001C","#AA0055","#E2001C","#C60038","#E2001C","#FF0000","#E2001C","#C60038","#E2001C","#AA0055","#8D0071","#71008D","#E2001C","#AA0055","#E2001C","#FF0000","#71008D","#AA0055","#AA0055","#FF0000","#C60038","#C60038","#71008D","#71008D","#5500AA","#3800C6","#E2001C","#8D0071","#FF0000","#E2001C","#C60038","#71008D","#E2001C","#C60038","#AA0055","#AA0055","#71008D","#71008D","#FF0000","#71008D","#AA0055","#8D0071","#C60038","#FF0000","#FF0000","#E2001C","#AA0055","#AA0055","#8D0071","#C60038","#C60038","#C60038","#E2001C","#C60038","#8D0071","#AA0055","#FF0000","#AA0055","#C60038","#FF0000","#AA0055","#FF0000","#C60038","#FF0000","#8D0071","#FF0000","#AA0055","#C60038","#C60038","#8D0071","#AA0055","#E2001C","#E2001C","#C60038","#E2001C","#E2001C","#71008D","#C60038","#FF0000","#8D0071","#C60038","#AA0055","#C60038","#AA0055","#E2001C","#C60038","#FF0000","#E2001C","#C60038","#8D0071","#8D0071","#E2001C","#AA0055","#8D0071","#C60038","#AA0055","#AA0055","#C60038","#8D0071","#E2001C","#C60038","#E2001C","#C60038","#FF0000","#E2001C","#E2001C","#AA0055","#C60038","#C60038","#C60038","#FF0000","#C60038","#C60038","#E2001C","#E2001C","#E2001C","#E2001C","#C60038","#C60038","#AA0055","#C60038","#C60038","#FF0000","#AA0055","#C60038","#AA0055","#FF0000","#FF0000","#C60038","#C60038","#E2001C","#FF0000","#C60038","#C60038","#E2001C","#E2001C","#E2001C","#FF0000","#AA0055","#C60038","#E2001C","#C60038","#C60038","#E2001C","#FF0000","#FF0000","#E2001C","#E2001C","#FF0000","#E2001C","#FF0000","#E2001C","#C60038","#C60038","#C60038","#FF0000","#C60038","#FF0000","#E2001C","#FF0000","#E2001C","#FF0000","#FF0000","#C60038","#E2001C","#C60038","#FF0000","#E2001C","#FF0000","#E2001C","#FF0000","#FF0000","#FF0000","#E2001C","#C60038","#FF0000","#FF0000","#E2001C","#E2001C","#AA0055","#FF0000","#E2001C","#FF0000","#E2001C","#E2001C","#E2001C","#FF0000","#FF0000","#C60038","#FF0000","#FF0000","#E2001C","#FF0000","#FF0000","#E2001C","#FF0000","#E2001C","#FF0000","#E2001C","#FF0000","#E2001C","#C60038","#E2001C","#FF0000","#FF0000","#E2001C","#FF0000","#71008D","#C60038","#AA0055","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#8D0071","#E2001C","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#C60038","#FF0000","#E2001C","#E2001C","#FF0000","#C60038","#FF0000","#E2001C","#FF0000","#FF0000","#C60038","#C60038","#C60038","#8D0071","#FF0000","#E2001C","#8D0071","#C60038","#C60038","#E2001C","#C60038","#E2001C","#E2001C","#FF0000","#FF0000","#E2001C","#E2001C","#E2001C","#E2001C","#FF0000","#FF0000","#FF0000","#E2001C","#E2001C","#FF0000","#FF0000","#FF0000","#C60038","#C60038","#E2001C","#E2001C","#AA0055","#C60038","#8D0071","#C60038","#C60038","#AA0055","#FF0000","#E2001C","#C60038","#E2001C","#C60038","#E2001C","#E2001C","#E2001C","#AA0055","#E2001C","#E2001C","#E2001C","#E2001C","#E2001C","#C60038","#E2001C","#E2001C","#C60038","#E2001C","#E2001C","#E2001C","#C60038","#C60038","#C60038","#C60038","#C60038","#E2001C","#E2001C","#E2001C","#8D0071","#E2001C","#E2001C","#C60038","#C60038","#C60038","#C60038","#C60038","#8D0071","#C60038","#C60038","#C60038","#C60038","#C60038","#71008D","#C60038","#C60038","#AA0055","#AA0055","#AA0055","#AA0055","#AA0055","#8D0071","#AA0055","#AA0055","#AA0055","#8D0071","#8D0071","#AA0055","#AA0055","#5500AA","#AA0055","#8D0071","#AA0055","#71008D","#5500AA","#8D0071","#5500AA","#71008D","#71008D","#71008D","#5500AA","#71008D","#71008D","#71008D","#5500AA","#5500AA","#71008D","#5500AA","#5500AA","#5500AA","#5500AA","#5500AA","#3800C6","#1C00E2","#1C00E2","#FF0000","#C60038","#E2001C"],"opacity":0.85,"symbol":105,"size":4},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":5,"r":10},"scene":{"xaxis":{"title":"STR"},"yaxis":{"title":"PctEL"},"zaxis":{"title":"TestScore"},"aspectmode":"manual","aspectratio":{"x":1,"y":1.3,"z":1},"camera":{"eye":{"x":-2,"y":-0.1,"z":0.05},"center":{"x":0,"y":0,"z":0}}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"showLink":false,"displayModeBar":false},"data":[{"colorbar":{"title":"","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(255,0,0,1)"],["0.0416666666666665","rgba(255,0,0,1)"],["0.083333333333333","rgba(255,0,0,1)"],["0.125","rgba(255,0,0,1)"],["0.166666666666666","rgba(255,0,0,1)"],["0.208333333333333","rgba(255,0,0,1)"],["0.250000000000001","rgba(255,0,0,1)"],["0.291666666666667","rgba(255,0,0,1)"],["0.333333333333334","rgba(255,0,0,1)"],["0.375","rgba(255,0,0,1)"],["0.416666666666667","rgba(255,0,0,1)"],["0.458333333333333","rgba(255,0,0,1)"],["0.5","rgba(255,0,0,1)"],["0.541666666666667","rgba(255,0,0,1)"],["0.583333333333333","rgba(255,0,0,1)"],["0.625","rgba(255,0,0,1)"],["0.666666666666666","rgba(255,0,0,1)"],["0.708333333333333","rgba(255,0,0,1)"],["0.749999999999999","rgba(255,0,0,1)"],["0.791666666666667","rgba(255,0,0,1)"],["0.833333333333334","rgba(255,0,0,1)"],["0.875","rgba(255,0,0,1)"],["0.916666666666667","rgba(255,0,0,1)"],["0.958333333333333","rgba(255,0,0,1)"],["1","rgba(255,0,0,1)"]],"showscale":false,"x":[14,14.4916666666667,14.9833333333333,15.475,15.9666666666667,16.4583333333333,16.95,17.4416666666667,17.9333333333333,18.425,18.9166666666667,19.4083333333333,19.9,20.3916666666667,20.8833333333333,21.375,21.8666666666667,22.3583333333333,22.85,23.3416666666667,23.8333333333333,24.325,24.8166666666667,25.3083333333333,25.8],"y":[0,3.5641549428304,7.12830988566081,10.6924648284912,14.2566197713216,17.820774714152,21.3849296569824,24.9490845998128,28.5132395426432,32.0773944854736,35.641549428304,39.2057043711344,42.7698593139648,46.3340142567952,49.8981691996257,53.4623241424561,57.0264790852865,60.5906340281169,64.1547889709473,67.7189439137777,71.2830988566081,74.8472537994385,78.4114087422689,81.9755636850993,85.5397186279297],"z":[[670.614105498156,670.072635138979,669.531164779801,668.989694420623,668.448224061446,667.906753702268,667.36528334309,666.823812983912,666.282342624735,665.740872265557,665.199401906379,664.657931547202,664.116461188024,663.574990828846,663.033520469668,662.492050110491,661.950579751313,661.409109392135,660.867639032958,660.32616867378,659.784698314602,659.243227955425,658.701757596247,658.160287237069,657.618816877891],[668.298200193628,667.75672983445,667.215259475273,666.673789116095,666.132318756917,665.590848397739,665.049378038562,664.507907679384,663.966437320206,663.424966961029,662.883496601851,662.342026242673,661.800555883496,661.259085524318,660.71761516514,660.176144805962,659.634674446785,659.093204087607,658.551733728429,658.010263369252,657.468793010074,656.927322650896,656.385852291718,655.844381932541,655.302911573363],[665.9822948891,665.440824529922,664.899354170744,664.357883811567,663.816413452389,663.274943093211,662.733472734034,662.192002374856,661.650532015678,661.1090616565,660.567591297323,660.026120938145,659.484650578967,658.94318021979,658.401709860612,657.860239501434,657.318769142257,656.777298783079,656.235828423901,655.694358064723,655.152887705546,654.611417346368,654.06994698719,653.528476628013,652.987006268835],[663.666389584572,663.124919225394,662.583448866216,662.041978507038,661.500508147861,660.959037788683,660.417567429505,659.876097070328,659.33462671115,658.793156351972,658.251685992794,657.710215633617,657.168745274439,656.627274915261,656.085804556084,655.544334196906,655.002863837728,654.461393478551,653.919923119373,653.378452760195,652.836982401017,652.29551204184,651.754041682662,651.212571323484,650.671100964307],[661.350484280043,660.809013920866,660.267543561688,659.72607320251,659.184602843333,658.643132484155,658.101662124977,657.560191765799,657.018721406622,656.477251047444,655.935780688266,655.394310329089,654.852839969911,654.311369610733,653.769899251555,653.228428892378,652.6869585332,652.145488174022,651.604017814845,651.062547455667,650.521077096489,649.979606737312,649.438136378134,648.896666018956,648.355195659778],[659.034578975515,658.493108616337,657.95163825716,657.410167897982,656.868697538804,656.327227179626,655.785756820449,655.244286461271,654.702816102093,654.161345742916,653.619875383738,653.07840502456,652.536934665383,651.995464306205,651.453993947027,650.912523587849,650.371053228672,649.829582869494,649.288112510316,648.746642151139,648.205171791961,647.663701432783,647.122231073605,646.580760714428,646.03929035525],[656.718673670987,656.177203311809,655.635732952631,655.094262593454,654.552792234276,654.011321875098,653.46985151592,652.928381156743,652.386910797565,651.845440438387,651.30397007921,650.762499720032,650.221029360854,649.679559001676,649.138088642499,648.596618283321,648.055147924143,647.513677564966,646.972207205788,646.43073684661,645.889266487433,645.347796128255,644.806325769077,644.264855409899,643.723385050722],[654.402768366459,653.861298007281,653.319827648103,652.778357288925,652.236886929748,651.69541657057,651.153946211392,650.612475852215,650.071005493037,649.529535133859,648.988064774681,648.446594415504,647.905124056326,647.363653697148,646.822183337971,646.280712978793,645.739242619615,645.197772260438,644.65630190126,644.114831542082,643.573361182904,643.031890823727,642.490420464549,641.948950105371,641.407479746194],[652.08686306193,651.545392702752,651.003922343575,650.462451984397,649.920981625219,649.379511266042,648.838040906864,648.296570547686,647.755100188509,647.213629829331,646.672159470153,646.130689110975,645.589218751798,645.04774839262,644.506278033442,643.964807674265,643.423337315087,642.881866955909,642.340396596731,641.798926237554,641.257455878376,640.715985519198,640.174515160021,639.633044800843,639.091574441665],[649.770957757402,649.229487398224,648.688017039047,648.146546679869,647.605076320691,647.063605961513,646.522135602336,645.980665243158,645.43919488398,644.897724524803,644.356254165625,643.814783806447,643.27331344727,642.731843088092,642.190372728914,641.648902369736,641.107432010559,640.565961651381,640.024491292203,639.483020933026,638.941550573848,638.40008021467,637.858609855492,637.317139496315,636.775669137137],[647.455052452874,646.913582093696,646.372111734518,645.830641375341,645.289171016163,644.747700656985,644.206230297807,643.66475993863,643.123289579452,642.581819220274,642.040348861097,641.498878501919,640.957408142741,640.415937783563,639.874467424386,639.332997065208,638.79152670603,638.250056346853,637.708585987675,637.167115628497,636.62564526932,636.084174910142,635.542704550964,635.001234191786,634.459763832609],[645.139147148345,644.597676789168,644.05620642999,643.514736070812,642.973265711635,642.431795352457,641.890324993279,641.348854634101,640.807384274924,640.265913915746,639.724443556568,639.182973197391,638.641502838213,638.100032479035,637.558562119857,637.01709176068,636.475621401502,635.934151042324,635.392680683147,634.851210323969,634.309739964791,633.768269605614,633.226799246436,632.685328887258,632.14385852808],[642.823241843817,642.281771484639,641.740301125462,641.198830766284,640.657360407106,640.115890047929,639.574419688751,639.032949329573,638.491478970396,637.950008611218,637.40853825204,636.867067892862,636.325597533685,635.784127174507,635.242656815329,634.701186456152,634.159716096974,633.618245737796,633.076775378618,632.535305019441,631.993834660263,631.452364301085,630.910893941908,630.36942358273,629.827953223552],[640.507336539289,639.965866180111,639.424395820933,638.882925461756,638.341455102578,637.7999847434,637.258514384223,636.717044025045,636.175573665867,635.634103306689,635.092632947512,634.551162588334,634.009692229156,633.468221869979,632.926751510801,632.385281151623,631.843810792446,631.302340433268,630.76087007409,630.219399714912,629.677929355735,629.136458996557,628.594988637379,628.053518278202,627.512047919024],[638.191431234761,637.649960875583,637.108490516405,636.567020157227,636.02554979805,635.484079438872,634.942609079694,634.401138720517,633.859668361339,633.318198002161,632.776727642984,632.235257283806,631.693786924628,631.15231656545,630.610846206273,630.069375847095,629.527905487917,628.98643512874,628.444964769562,627.903494410384,627.362024051207,626.820553692029,626.279083332851,625.737612973673,625.196142614496],[635.875525930232,635.334055571055,634.792585211877,634.251114852699,633.709644493522,633.168174134344,632.626703775166,632.085233415988,631.543763056811,631.002292697633,630.460822338455,629.919351979278,629.3778816201,628.836411260922,628.294940901744,627.753470542567,627.212000183389,626.670529824211,626.129059465034,625.587589105856,625.046118746678,624.504648387501,623.963178028323,623.421707669145,622.880237309967],[633.559620625704,633.018150266526,632.476679907349,631.935209548171,631.393739188993,630.852268829815,630.310798470638,629.76932811146,629.227857752282,628.686387393105,628.144917033927,627.603446674749,627.061976315572,626.520505956394,625.979035597216,625.437565238038,624.896094878861,624.354624519683,623.813154160505,623.271683801328,622.73021344215,622.188743082972,621.647272723794,621.105802364617,620.564332005439],[631.243715321176,630.702244961998,630.16077460282,629.619304243643,629.077833884465,628.536363525287,627.99489316611,627.453422806932,626.911952447754,626.370482088576,625.829011729399,625.287541370221,624.746071011043,624.204600651866,623.663130292688,623.12165993351,622.580189574333,622.038719215155,621.497248855977,620.955778496799,620.414308137622,619.872837778444,619.331367419266,618.789897060089,618.248426700911],[628.927810016648,628.38633965747,627.844869298292,627.303398939114,626.761928579937,626.220458220759,625.678987861581,625.137517502404,624.596047143226,624.054576784048,623.51310642487,622.971636065693,622.430165706515,621.888695347337,621.34722498816,620.805754628982,620.264284269804,619.722813910627,619.181343551449,618.639873192271,618.098402833093,617.556932473916,617.015462114738,616.47399175556,615.932521396383],[626.611904712119,626.070434352941,625.528963993764,624.987493634586,624.446023275408,623.904552916231,623.363082557053,622.821612197875,622.280141838698,621.73867147952,621.197201120342,620.655730761164,620.114260401987,619.572790042809,619.031319683631,618.489849324454,617.948378965276,617.406908606098,616.865438246921,616.323967887743,615.782497528565,615.241027169388,614.69955681021,614.158086451032,613.616616091854],[624.295999407591,623.754529048413,623.213058689236,622.671588330058,622.13011797088,621.588647611702,621.047177252525,620.505706893347,619.964236534169,619.422766174992,618.881295815814,618.339825456636,617.798355097459,617.256884738281,616.715414379103,616.173944019925,615.632473660748,615.09100330157,614.549532942392,614.008062583215,613.466592224037,612.925121864859,612.383651505681,611.842181146504,611.300710787326],[621.980094103063,621.438623743885,620.897153384707,620.35568302553,619.814212666352,619.272742307174,618.731271947996,618.189801588819,617.648331229641,617.106860870463,616.565390511286,616.023920152108,615.48244979293,614.940979433752,614.399509074575,613.858038715397,613.316568356219,612.775097997042,612.233627637864,611.692157278686,611.150686919509,610.609216560331,610.067746201153,609.526275841975,608.984805482798],[619.664188798534,619.122718439357,618.581248080179,618.039777721001,617.498307361824,616.956837002646,616.415366643468,615.87389628429,615.332425925113,614.790955565935,614.249485206757,613.70801484758,613.166544488402,612.625074129224,612.083603770047,611.542133410869,611.000663051691,610.459192692514,609.917722333336,609.376251974158,608.83478161498,608.293311255803,607.751840896625,607.210370537447,606.668900178269],[617.348283494006,616.806813134828,616.265342775651,615.723872416473,615.182402057295,614.640931698118,614.09946133894,613.557990979762,613.016520620585,612.475050261407,611.933579902229,611.392109543051,610.850639183874,610.309168824696,609.767698465518,609.22622810634,608.684757747163,608.143287387985,607.601817028807,607.06034666963,606.518876310452,605.977405951274,605.435935592097,604.894465232919,604.352994873741],[615.032378189478,614.4909078303,613.949437471123,613.407967111945,612.866496752767,612.325026393589,611.783556034412,611.242085675234,610.700615316056,610.159144956879,609.617674597701,609.076204238523,608.534733879345,607.993263520168,607.45179316099,606.910322801812,606.368852442635,605.827382083457,605.285911724279,604.744441365102,604.202971005924,603.661500646746,603.120030287568,602.578559928391,602.037089569213]],"opacity":0.9,"name":"Reg.Plane","type":"surface","frame":null},{"x":[17.8899088829779,21.5246644135433,18.6972252288335,17.3571428571429,18.6713286713287,21.406249681022,19.5,20.8941176470588,19.9473684210526,20.8055555555556,21.2380952380952,21,20.6,20.0082168014375,18.0277777777778,20.2519611642598,16.9778699413794,16.5098039215686,22.7040227954819,19.9111111111111,18.3333333333333,22.6190476190476,19.448275862069,25.0526315789474,20.6754385964912,18.6823529411765,22.8455293273174,19.2666666666667,19.25,20.5454545454545,20.6069651741294,21.0726817042607,21.5358144363179,19.904,21.1940684544254,21.8653548739123,18.3296457083095,16.2285714285714,19.1785714285714,20.2773673693064,22.9861365135517,20.4444444444444,19.8208464129607,23.205223880597,19.2669683257919,23.3018867924528,21.1882860271413,20.8717948717949,19.0174947515745,21.9193802349385,20.1012373453318,21.4765100671141,20.0657888748265,20.3750946304228,22.446482206684,22.8952380952381,20.4979697160857,19.9999997290939,22.2565805492426,21.5643629196127,19.4773712501098,17.6700201456427,21.9475616151023,21.7833935018051,19.14,18.1104972375691,20.6824250654847,22.6236080178174,21.7864987387076,18.5829312134509,21.5454545454545,21.1528918488938,16.6333333333333,21.1443830899838,19.7818181818182,18.9837288944761,17.6676680724533,17.754991247092,15.2727272727273,14,20.5961335276821,16.3116883116883,21.1279620853081,17.4880123598627,17.8867924528302,19.3067588435028,20.8923076923077,21.2868392089495,20.1955990220049,24.95,18.1304347826087,20,18.7295084895385,18.25,18.9925686639621,19.8876413018577,19.3789473684211,20.4625850340136,22.2915734818168,20.7047392724654,19.0600525989991,20.2324702908189,19.6901229507238,20.3625387030444,19.7542237411884,19.3797669431263,22.9235094024774,19.3733975555516,19.1551557767,21.3,18.3035717402794,21.0792562824344,18.791208003486,19.6266181276984,19.590164240699,20.8718719045074,21.1150007392067,20.0845208845209,19.9104890079458,17.8128519025892,18.1333333333333,19.2222109626064,18.6607146035044,19.6,19.2838427947598,22.8181818181818,18.8092193175492,21.3736332119715,20.0204081632653,21.4986149584488,15.4285714285714,22.4,20.1270869566436,19.0379746835443,17.3421579447488,17.0186331371371,20.8,21.1538461538462,18.4583333333333,19.1408207270671,19.4076576857931,19.5689648737097,21.5012000186184,17.5294117647059,16.4301713487041,19.7965402233519,17.1861336595179,17.6158935947066,20.1253715192381,22.1666666666667,19.9615384615385,19.0394513640815,15.2243595327852,21.1447499009334,19.6438998246679,21.0486891385768,20.1754385964912,21.3913043478261,20.0083249004548,20.2913719276809,17.6666666666667,18.2205506816453,20.2710018717861,20.1989464047365,21.3842445345418,20.9736842105263,20,17.1532849103452,22.3497705836374,22.1700710363591,18.1818181818182,18.9571428571429,19.7453305580818,16.4262295081967,16.6253976791474,16.38176709392,20.0741582358159,17.9954440870962,19.3913043478261,16.4285717083483,16.7294869588045,24.4134521894715,18.2641509433962,18.9550418244691,21.0389615601121,20.7407407407407,18.1,19.8461538461538,21.6,22.4424209045409,23.0143764873862,17.7489176651741,18.2866407796733,19.2654419132432,22.6666666666667,19.2941176470588,17.3636363636364,19.8214290624205,20.4337797063172,21.0372093023256,19.9246234975196,19.0098568462085,23.8222222222222,19.3690847073363,19.8285714285714,15.2588552686217,17.1612903225806,21.8133333333333,19.0747133426306,25.7851231540294,18.212614444761,18.166064157175,16.972972972973,21.5008728866294,20.6,16.9902909475106,20.7795456185188,15.5124660296439,19.8850574712644,21.3988234659086,20.497512048797,19.3637581871342,17.659575184744,21.0179561441264,19.0556494863121,22.5384615384615,21.1078711835393,20.0513538034642,14.2017629244119,18.4768683274021,18.6354166666667,20.9459459459459,21.0854825556009,18.6928802180985,20.8680790498909,19.8255776972916,19.75,19.5,18.3908050008928,18.7867641789278,19.7701804862839,19.3333333333333,21.4639175257732,23.0849235566616,21.0629924423187,18.6868694069167,20.7702354006901,19.3055560669781,20.1328025598196,20.6696349496271,22.2815533980583,20.6002719936284,20.8273387010791,19.2249242350677,17.654770182971,17,16.4977277151551,19.7826084222295,22.3021585029028,17.7307692307692,20.4483612471435,20.3716944004797,20.1647869771202,21.6153779636056,20.5614288634761,19.9555109812711,21.183870895869,18.8104238242347,20.5783834180104,18.3246072688457,18.8206265775451,20.8163265306122,20,19.6818181818182,19.3901773923638,20.9273188292824,19.9443667533701,20.7910936237841,19.2035394988686,19.0243905162187,17.620578201782,20.2371534527511,19.2937402041726,18.8299814558293,20.3394923570245,19.2289969016058,17.8913043478261,19.5188096275881,19.0845072985972,19.9354838709677,18.8732569838045,20.1417852051784,23.5563711810368,21.4647887323944,19.1910112359551,20.1307996029783,25.8,18.7777401224092,19.1098147138764,19.7010865991333,18.6159420289855,20.9972114934227,20,20.9832509897728,21.6426229508197,20.0296731370496,19.8113968408637,18,19.3581078586307,20.1791214452076,21.1198631939305,23.3897364771151,22.1818181818182,19.9428279074446,17.7882555232377,14.7058821982578,19.040767037723,20.8919540229885,19.8385070816457,19.5219120539036,20.6862176489988,18.1818181818182,18.8922429984947,24.8888888888889,18.5806451612903,18.04,17.7339901477833,21.4545454545455,19.9234247876565,20.3394199785177,22.5460750853242,21.1034424809305,18.1974254885637,20.1076808229449,19.1598356162563,19.5454548278788,20.8888888888889,18.3915018503307,19.1799030878106,19.3977064458372,21.6782728550361,19.2888888888889,20.3492739161628,20.9641618174683,19.4603902706826,19.2857151615377,20.9197933397877,20.9002141266009,20.5957446808511,19.375,19.9512232540535,18.8497340903631,18.1178712480167,19.1834085642053,22,21.5841576006235,20.3888888888889,16.2931029124719,18.2777821171534,19.3747164524626,18.9090909090909,16.406926135985,15.5913975296964,18.7069414043726,18.3298532783061,17.9023506490849,18.9115648712309,20.3249661880789,20.0245691799889,24,17.6078431372549,19.3485337211153,19.6784651300815,18.7286056582498,15.8823532381685,20.0549127852273,17.9882527208952,16.9662928620368,19.2393743182499,19.1958581618667,19.5990618887251,20.5434782608696,18.5884843645164,15.6041861492374,15.2930401861936,17.6553674218923,17.5797611320959,22.3333333333333,18.75,18.1024099158844,20.2564097610765,18.8020749650075,18.7723051893905,20.405210291402,18.6507930861339,20.7070715049617,22,17.6997754983767,21.4832888462028,16.7010312562339,19.5756726978814,17.258064516129,17.3752559601841,17.3493114406599,16.2622843263867,17.7004542663956,20.1288155606007,18.2653941392753,14.5421361585846,19.1526116141991,17.3657415845815,15.1389850328556,17.8426602888311,15.407041884931,18.8653402295668,16.4741337274612,17.8626250782683,21.8858564937366,20.2,19.0364022585948],"y":[0,4.58333349227905,30.0000019073486,0,13.8576774597168,12.4087591171265,68.7179489135742,46.9594612121582,30.0791568756104,40.2759208679199,52.9147987365723,54.6099319458008,42.7184448242188,20.5338802337646,80.1232604980469,49.413143157959,85.5397186279297,58.9073638916016,77.0058135986328,49.8139877319336,40.6818199157715,16.2105255126953,45.0748634338379,39.0756301879883,76.6652526855469,40.4911842346191,73.7202301025391,70.0115356445312,55.962215423584,11.0619468688965,80.4200897216797,63.1303558349609,65.1218566894531,53.4164009094238,49.823070526123,35.4653701782227,56.1255264282227,32.3943672180176,65.5121002197266,53.0554428100586,49.6425323486328,45.1086959838867,30.3204593658447,52.2431259155273,36.8013153076172,30.2833995819092,49.8645668029785,13.7592134475708,28.8637046813965,52.8047866821289,44.0850601196289,35.25,37.4944610595703,50.3905906677246,31.0725784301758,18.2612323760986,34.7002067565918,33.288948059082,33.4877090454102,38.1587524414062,36.9294624328613,32.9894905090332,58.2166557312012,17.0036468505859,17.6593532562256,7.32153749465942,31.1981563568115,16.6174449920654,58.0810356140137,55.8925437927246,5.48523235321045,14.4291934967041,22.8456916809082,38.7833366394043,64.2463226318359,25.225564956665,5.38243627548218,6.07902765274048,0,0,34.8891792297363,13.0573244094849,36.0251235961914,34.6534652709961,28.6919822692871,1.79533219337463,30.6332855224609,59.0334548950195,13.5593223571777,5.01001977920532,0.95923262834549,0.666666686534882,38.512035369873,0,17.1739139556885,9.88700580596924,19.3916358947754,36.4893608093262,39.3999977111816,28.6776218414307,13.6986303329468,11.3498363494873,3.44262313842773,15.4302673339844,17.973783493042,22.7177333831787,18.4362449645996,16.1717147827148,2.02212882041931,9.62441349029541,41.4634132385254,9.89903450012207,16.0818710327148,43.4949378967285,8.78661060333252,39.0243873596191,53.8903045654297,41.1332931518555,1.38328528404236,35.4430389404297,8.63970565795898,15.3497743606567,19.8564586639404,3.06122446060181,9.87318801879883,16.0956172943115,43.4989776611328,45.0379524230957,18.1957187652588,15.4876947402954,0.92592591047287,7.5892858505249,29.0858383178711,0.132978722453117,50.8576316833496,11.4963502883911,13.4615392684937,4.72727251052856,21.444694519043,12.3536806106567,30.1488838195801,15.8590297698975,43.75,0,0,16.6522121429443,3.22033905982971,0,48.5245895385742,0.751879692077637,1.92678236961365,13.5135126113892,0,16.7146053314209,5.94353628158569,36.1743774414062,44.971866607666,16.6666679382324,15.1872396469116,34.3377990722656,0,13.0673999786377,4.27807474136353,39.5946311950684,21.6683731079102,3.2622332572937,7.85714292526245,39.5744667053223,10.1278028488159,27.5217914581299,14,8.84200000762939,6.40584659576416,2.39520978927612,5.95744705200195,8.17391300201416,15.4589366912842,0,0,0,31.8245830535889,12.8009166717529,0,3.84615397453308,2.46913576126099,10.7142858505249,0,1.93798446655273,4.62962961196899,5.25059652328491,27.5403823852539,14.9825782775879,47.8793754577637,0,1.76470601558685,0,0,7.28910732269287,17.028003692627,10.4355516433716,2.26986122131348,28.2479133605957,8.76865673065186,7.49185657501221,9.79827117919922,12.5,0,31.2041549682617,1.36919319629669,9.61538505554199,0,24.2572898864746,9.55414009094238,5.92532444000244,0.970873773097992,18.2857131958008,4.9843487739563,4.28571462631226,3.35260105133057,32.7074966430664,9.46601963043213,6.26078748703003,13.2530126571655,3.16913533210754,16.9911499023438,0.853242337703705,6.64956569671631,0.116414435207844,0,6.93374443054199,9.55841255187988,0.903225779533386,1.15830111503601,40.1080169677734,16.6632118225098,21.955358505249,8.86075973510742,0.854700922966003,0,3.91389417648315,11.9494590759277,3.99274039268494,22.9394817352295,2.48563003540039,9.87149524688721,0.54054057598114,8.95663166046143,6.47481966018677,20.7254314422607,0.187265917658806,13.9869289398193,8.74172115325928,20.0345420837402,1.38339924812317,2.06270623207092,28.5714302062988,0.169491529464722,13.7362642288208,0,0.216919749975204,3.12103939056396,47.3684234619141,22.7096786499023,29.1207408905029,4.43262434005737,4.81421661376953,5.24920463562012,1.89944136142731,8.66293334960938,10.4761905670166,1.24223601818085,0,9.375,1.38568139076233,35.3421211242676,9.64071846008301,2.23152017593384,0.366403609514236,0.576036870479584,0,0.851581513881683,5.52455377578735,0,0,2.43722319602966,20.766773223877,2.18712043762207,13.6261758804321,13.2841329574585,1.94174754619598,23.0615653991699,0.621118009090424,3.25551223754883,0,2.22482442855835,18.5583763122559,6.20155048370361,18.4574813842773,32.0725517272949,3.96551704406738,15.3367071151733,27.6652278900146,12.537314414978,12.6801748275757,6.90804433822632,14.9629621505737,11.2693252563477,9.72222232818604,3.31588125228882,0.693481266498566,5.14112901687622,4.96916532516479,6.96721315383911,7.99606513977051,0.48192772269249,2.5,3.84131002426147,1.32042253017426,4.91228055953979,0,0.222386956214905,0,17.8540592193604,4.4642858505249,9.54861164093018,3.99113082885742,20.6666660308838,7.6271185874939,27.4536724090576,10.8576259613037,5.02573394775391,14.2361688613892,0.235849052667618,2.0706889629364,8.55614948272705,0,4.78723430633545,3.96039605140686,1.57935285568237,3.5939085483551,8.72622680664062,0,0.264061272144318,1.44792151451111,0.147492617368698,0,3.70500636100769,0.268528461456299,0,4.51612901687622,2.44479489326477,0,0,5.40540552139282,0,6.42201805114746,6.53950929641724,14.2857151031494,3.67879748344421,0.502176105976105,0,22.6912937164307,0,0.141643062233925,2.73348522186279,1.68350172042847,0,0.143609374761581,0,11.0465116500854,0,0,0.0633312240242958,0,0,15.0598974227905,1.47959184646606,2.64900660514832,1.47991538047791,4.46989297866821,0.326441794633865,2.53968262672424,0.54200541973114,11.5853662490845,11.3772449493408,0,1.37488543987274,2.2388060092926,5.33333349227905,2.77315592765808,0,17.7257518768311,0,0,0.425531893968582,6.06707334518433,10.1275911331177,3.37552738189697,8.6485424041748,12.3456792831421,1.58959531784058,1.4953271150589,10.3855228424072,6.13402032852173,2.2662889957428,2.47863245010376,0.893629252910614,2.42165231704712,3.76569032669067,1.96286475658417,0.578034639358521,2.80728387832642,1.36363637447357,1.16448330879211,2.05040574073792,5.99593496322632,4.72610092163086,24.2630386352539,2.97029709815979,5.00562429428101],"z":[690.799987792969,661.200012207031,643.600006103516,647.700012207031,640.850006103516,605.550018310547,606.75,609,612.5,612.650024414062,615.75,616.299987792969,616.299987792969,616.299987792969,616.450012207031,617.350006103516,618.050018310547,618.300018310547,619.799987792969,620.299987792969,620.5,621.400024414062,621.75,622.050018310547,622.600006103516,623.100006103516,623.200012207031,623.450012207031,623.599975585938,624.150024414062,624.550018310547,624.950012207031,625.299987792969,625.849975585938,626.100006103516,626.800018310547,626.899993896484,627.100006103516,627.25,627.299987792969,628.25,628.399993896484,628.550018310547,628.649993896484,628.75,629.800018310547,630.350006103516,630.400024414062,630.549987792969,630.549987792969,631.050018310547,631.399993896484,631.850006103516,631.899993896484,631.950012207031,632,632.200012207031,632.25,632.449981689453,632.850006103516,632.950012207031,633.049987792969,633.149993896484,633.650024414062,633.899993896484,634,634.050018310547,634.100006103516,634.100006103516,634.149993896484,634.199981689453,634.399993896484,634.549987792969,634.700012207031,634.899993896484,634.949981689453,635.049987792969,635.199981689453,635.450012207031,635.599975585938,635.600006103516,635.75,635.950012207031,636.100006103516,636.5,636.600006103516,636.699981689453,636.900024414062,636.950012207031,637,637.100006103516,637.350006103516,637.650024414062,637.949981689453,637.950012207031,638,638.200012207031,638.300018310547,638.300018310547,638.349975585938,638.549987792969,638.700012207031,639.25,639.300018310547,639.350006103516,639.5,639.75,639.799987792969,639.850006103516,639.899993896484,640.100006103516,640.150024414062,640.5,640.75,640.900024414062,641.100006103516,641.449981689453,641.449981689453,641.549987792969,641.800018310547,642.199981689453,642.200012207031,642.399993896484,642.75,643.049987792969,643.199981689453,643.25,643.400024414062,643.399993896484,643.5,643.5,643.699981689453,643.700012207031,644.199981689453,644.200012207031,644.399993896484,644.450012207031,644.450012207031,644.5,644.549987792969,644.699981689453,644.950012207031,645.100006103516,645.25,645.549987792969,645.550018310547,645.600006103516,645.75,645.75,646,646.200012207031,646.350006103516,646.399993896484,646.5,646.549987792969,646.700012207031,646.899993896484,646.949981689453,647.049987792969,647.25,647.299987792969,647.600006103516,647.599975585938,648,648.200012207031,648.25,648.349975585938,648.700012207031,648.949981689453,649.149993896484,649.300018310547,649.5,649.699981689453,649.849975585938,650.449981689453,650.549987792969,650.600006103516,650.649993896484,650.899993896484,650.899993896484,651.149993896484,651.200012207031,651.350006103516,651.399993896484,651.450012207031,651.800018310547,651.850006103516,651.899993896484,652,652.100006103516,652.099975585938,652.299987792969,652.300018310547,652.350006103516,652.399993896484,652.399993896484,652.5,652.850006103516,653.099975585938,653.399993896484,653.5,653.549987792969,653.550018310547,653.699981689453,653.799987792969,653.850006103516,653.949981689453,654.100006103516,654.199981689453,654.199981689453,654.299987792969,654.600006103516,654.850006103516,654.850006103516,654.899993896484,655.049987792969,655.050018310547,655.050018310547,655.199981689453,655.300018310547,655.350006103516,655.349975585938,655.399993896484,655.549987792969,655.699981689453,655.799987792969,655.850006103516,656.399993896484,656.5,656.550018310547,656.650024414062,656.700012207031,656.800018310547,656.800018310547,657,657,657.149993896484,657.400024414062,657.5,657.550018310547,657.649993896484,657.75,657.799987792969,657.899993896484,658,658.350006103516,658.600006103516,658.799987792969,659.050018310547,659.149993896484,659.350006103516,659.399993896484,659.399993896484,659.799987792969,659.900024414062,660.050018310547,660.099975585938,660.199981689453,660.299987792969,660.75,660.949981689453,661.349975585938,661.450012207031,661.599975585938,661.600006103516,661.849975585938,661.850006103516,661.850006103516,661.899993896484,661.899993896484,661.950012207031,662.399993896484,662.400024414062,662.450012207031,662.5,662.550018310547,662.550018310547,662.649993896484,662.700012207031,662.75,662.899993896484,663.350006103516,663.449981689453,663.5,663.850006103516,663.850006103516,663.899993896484,664,664,664.149993896484,664.149993896484,664.299987792969,664.400024414062,664.449981689453,664.700012207031,664.75,664.949981689453,664.950012207031,665.100006103516,665.200012207031,665.350006103516,665.650024414062,665.899993896484,665.950012207031,666,666.050018310547,666.100006103516,666.150024414062,666.149993896484,666.449981689453,666.550018310547,666.600006103516,666.649993896484,666.649993896484,666.699981689453,666.850006103516,666.850006103516,667.149993896484,667.199981689453,667.450012207031,667.450012207031,667.600006103516,668,668.100006103516,668.399993896484,668.600006103516,668.649993896484,668.799987792969,668.899993896484,668.950012207031,669.099975585938,669.300018310547,669.300018310547,669.350006103516,669.349975585938,669.799987792969,669.850006103516,669.950012207031,670,670.699981689453,671.25,671.299987792969,671.600006103516,671.600006103516,671.649993896484,671.699981689453,671.75,671.899993896484,671.899993896484,671.949981689453,672.049987792969,672.050018310547,672.299987792969,672.349975585938,672.450012207031,672.550018310547,672.699981689453,673.049987792969,673.25,673.299987792969,673.549987792969,673.549987792969,673.899993896484,674.25,675.399993896484,675.700012207031,676.149993896484,676.549987792969,676.600006103516,676.850006103516,676.949981689453,677.25,677.950012207031,678.050018310547,678.399993896484,678.799987792969,679.399993896484,679.5,679.649993896484,679.75,679.800018310547,680.050018310547,680.450012207031,681.299987792969,681.299987792969,681.600006103516,681.899993896484,682.149993896484,682.450012207031,682.549987792969,682.649993896484,683.350006103516,683.399993896484,684.300018310547,684.350006103516,684.800018310547,684.950012207031,686.050018310547,686.699981689453,687.549987792969,689.099975585938,691.049987792969,691.350006103516,691.899993896484,693.950012207031,694.25,694.800018310547,695.199981689453,695.299987792969,696.550018310547,698.199981689453,698.25,698.449981689453,699.100006103516,700.300018310547,704.300018310547,706.75,645,672.200012207031,655.75],"opacity":0.9,"name":"CASchools","type":"scatter3d","mode":"markers","marker":{"color":["#71008D","#FF0000","#FF0000","#AA0055","#AA0055","#0000FF","#C60038","#8D0071","#5500AA","#8D0071","#C60038","#C60038","#AA0055","#3800C6","#FF0000","#C60038","#E2001C","#C60038","#E2001C","#C60038","#AA0055","#71008D","#C60038","#C60038","#E2001C","#AA0055","#C60038","#FF0000","#FF0000","#5500AA","#C60038","#FF0000","#E2001C","#FF0000","#FF0000","#C60038","#FF0000","#8D0071","#FF0000","#FF0000","#FF0000","#E2001C","#AA0055","#FF0000","#C60038","#C60038","#FF0000","#8D0071","#AA0055","#FF0000","#FF0000","#E2001C","#E2001C","#FF0000","#E2001C","#AA0055","#E2001C","#C60038","#E2001C","#FF0000","#E2001C","#C60038","#E2001C","#AA0055","#8D0071","#71008D","#E2001C","#AA0055","#E2001C","#FF0000","#71008D","#AA0055","#AA0055","#FF0000","#C60038","#C60038","#71008D","#71008D","#5500AA","#3800C6","#E2001C","#8D0071","#FF0000","#E2001C","#C60038","#71008D","#E2001C","#C60038","#AA0055","#AA0055","#71008D","#71008D","#FF0000","#71008D","#AA0055","#8D0071","#C60038","#FF0000","#FF0000","#E2001C","#AA0055","#AA0055","#8D0071","#C60038","#C60038","#C60038","#E2001C","#C60038","#8D0071","#AA0055","#FF0000","#AA0055","#C60038","#FF0000","#AA0055","#FF0000","#C60038","#FF0000","#8D0071","#FF0000","#AA0055","#C60038","#C60038","#8D0071","#AA0055","#E2001C","#E2001C","#C60038","#E2001C","#E2001C","#71008D","#C60038","#FF0000","#8D0071","#C60038","#AA0055","#C60038","#AA0055","#E2001C","#C60038","#FF0000","#E2001C","#C60038","#8D0071","#8D0071","#E2001C","#AA0055","#8D0071","#C60038","#AA0055","#AA0055","#C60038","#8D0071","#E2001C","#C60038","#E2001C","#C60038","#FF0000","#E2001C","#E2001C","#AA0055","#C60038","#C60038","#C60038","#FF0000","#C60038","#C60038","#E2001C","#E2001C","#E2001C","#E2001C","#C60038","#C60038","#AA0055","#C60038","#C60038","#FF0000","#AA0055","#C60038","#AA0055","#FF0000","#FF0000","#C60038","#C60038","#E2001C","#FF0000","#C60038","#C60038","#E2001C","#E2001C","#E2001C","#FF0000","#AA0055","#C60038","#E2001C","#C60038","#C60038","#E2001C","#FF0000","#FF0000","#E2001C","#E2001C","#FF0000","#E2001C","#FF0000","#E2001C","#C60038","#C60038","#C60038","#FF0000","#C60038","#FF0000","#E2001C","#FF0000","#E2001C","#FF0000","#FF0000","#C60038","#E2001C","#C60038","#FF0000","#E2001C","#FF0000","#E2001C","#FF0000","#FF0000","#FF0000","#E2001C","#C60038","#FF0000","#FF0000","#E2001C","#E2001C","#AA0055","#FF0000","#E2001C","#FF0000","#E2001C","#E2001C","#E2001C","#FF0000","#FF0000","#C60038","#FF0000","#FF0000","#E2001C","#FF0000","#FF0000","#E2001C","#FF0000","#E2001C","#FF0000","#E2001C","#FF0000","#E2001C","#C60038","#E2001C","#FF0000","#FF0000","#E2001C","#FF0000","#71008D","#C60038","#AA0055","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#8D0071","#E2001C","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#C60038","#FF0000","#E2001C","#E2001C","#FF0000","#C60038","#FF0000","#E2001C","#FF0000","#FF0000","#C60038","#C60038","#C60038","#8D0071","#FF0000","#E2001C","#8D0071","#C60038","#C60038","#E2001C","#C60038","#E2001C","#E2001C","#FF0000","#FF0000","#E2001C","#E2001C","#E2001C","#E2001C","#FF0000","#FF0000","#FF0000","#E2001C","#E2001C","#FF0000","#FF0000","#FF0000","#C60038","#C60038","#E2001C","#E2001C","#AA0055","#C60038","#8D0071","#C60038","#C60038","#AA0055","#FF0000","#E2001C","#C60038","#E2001C","#C60038","#E2001C","#E2001C","#E2001C","#AA0055","#E2001C","#E2001C","#E2001C","#E2001C","#E2001C","#C60038","#E2001C","#E2001C","#C60038","#E2001C","#E2001C","#E2001C","#C60038","#C60038","#C60038","#C60038","#C60038","#E2001C","#E2001C","#E2001C","#8D0071","#E2001C","#E2001C","#C60038","#C60038","#C60038","#C60038","#C60038","#8D0071","#C60038","#C60038","#C60038","#C60038","#C60038","#71008D","#C60038","#C60038","#AA0055","#AA0055","#AA0055","#AA0055","#AA0055","#8D0071","#AA0055","#AA0055","#AA0055","#8D0071","#8D0071","#AA0055","#AA0055","#5500AA","#AA0055","#8D0071","#AA0055","#71008D","#5500AA","#8D0071","#5500AA","#71008D","#71008D","#71008D","#5500AA","#71008D","#71008D","#71008D","#5500AA","#5500AA","#71008D","#5500AA","#5500AA","#5500AA","#5500AA","#5500AA","#3800C6","#1C00E2","#1C00E2","#FF0000","#C60038","#E2001C"],"opacity":0.85,"symbol":105,"size":4,"line":{"color":"rgba(255,127,14,1)"},"showscale":false},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</center>
<p>We observe that the estimated regression plane fits the data reasonably well — at least with regard to the shape and spatial position of the points. The color of the markers is an indicator for the absolute deviation from the predicted regression plane. Observations that are colored more reddish lie close to the regression plane while the color shifts to blue with growing distance. An anomaly that can be seen from the plot is that there might be heteroskedasticity: we see that the dispersion of regression errors made, i.e., the distance of observations to the regression plane tends to decrease as the share of English learning students increases.</p>
</div>
<div id="mofimr" class="section level2 hasAnchor" number="6.3">
<h2 class="hasAnchor"><span class="header-section-number">6.3</span> Measures of Fit in Multiple Regression<a href="#mofimr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In multiple regression, common summary statistics are <span class="math inline">\(SER\)</span>, <span class="math inline">\(R^2\)</span> and the adjusted <span class="math inline">\(R^2\)</span>.</p>
<p>Taking the code from Section @ref(tmrm), simply use <code>summary(mult.mod)</code> to obtain the <span class="math inline">\(SER\)</span>, <span class="math inline">\(R^2\)</span> and adjusted-<span class="math inline">\(R^2\)</span>. For multiple regression models the <span class="math inline">\(SER\)</span> is computed as</p>
<p><span class="math display">\[ SER = s_{\hat u} = \sqrt{s_{\hat u}^2} \]</span>
where modify the denominator of the premultiplied factor in <span class="math inline">\(s_{\hat u}^2\)</span> in order to accommodate for additional regressors. Thus,</p>
<p><span class="math display">\[ s_{\hat u}^2 = \frac{1}{n-k-1} \, SSR \]</span></p>
<p>with <span class="math inline">\(k\)</span> denoting the number of regressors <em>excluding</em> the intercept.</p>
<p>While <tt>summary()</tt> computes the <span class="math inline">\(R^2\)</span> just as in the case of a single regressor, it is no reliable measure for multiple regression models. This is due to <span class="math inline">\(R^2\)</span> increasing whenever an additional regressor is added to the model. Adding a regressor decreases the <span class="math inline">\(SSR\)</span> — at least unless the respective estimated coefficient is exactly zero what practically never happens (see Chapter 6.4 of the book for a detailed argument). The adjusted <span class="math inline">\(R^2\)</span> takes this into consideration by “punishing” the addition of regressors using a correction factor. So the adjusted <span class="math inline">\(R^2\)</span>, or simply <span class="math inline">\(\bar{R}^2\)</span>, is a modified version of <span class="math inline">\(R^2\)</span>. It is defined as</p>
<p><span class="math display">\[ \bar{R}^2 = 1-\frac{n-1}{n-k-1} \, \frac{SSR}{TSS}. \]</span></p>
<p>As you may have already suspected, <tt>summary()</tt> adjusts the formula for <span class="math inline">\(SER\)</span> and it computes <span class="math inline">\(\bar{R}^2\)</span> and of course <span class="math inline">\(R^2\)</span> by default, thereby leaving the decision which measure to rely on to the user.</p>
<p>You can find both measures at the bottom of the output produced by calling <code>summary(mult.mod)</code>.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mult.mod)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = score ~ STR + english, data = CASchools)</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -48.845 -10.240  -0.308   9.815  43.461 </span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 686.03224    7.41131  92.566  &lt; 2e-16 ***</span></span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; STR          -1.10130    0.38028  -2.896  0.00398 ** </span></span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; english      -0.64978    0.03934 -16.516  &lt; 2e-16 ***</span></span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb142-18"><a href="#cb142-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 14.46 on 417 degrees of freedom</span></span>
<span id="cb142-19"><a href="#cb142-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.4264, Adjusted R-squared:  0.4237 </span></span>
<span id="cb142-20"><a href="#cb142-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic:   155 on 2 and 417 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>We can also compute the measures by hand using the formulas above. Let us check that the results coincide with the values provided by <tt>summary()</tt>.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the components</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(CASchools)                            <span class="co"># number of observations (rows)</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">2</span>                                          <span class="co"># number of regressors</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>y_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(CASchools<span class="sc">$</span>score)                 <span class="co"># mean of avg. test-scores</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">residuals</span>(mult.mod)<span class="sc">^</span><span class="dv">2</span>)               <span class="co"># sum of squared residuals</span></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>TSS <span class="ot">&lt;-</span> <span class="fu">sum</span>((CASchools<span class="sc">$</span>score <span class="sc">-</span> y_mean )<span class="sc">^</span><span class="dv">2</span>)       <span class="co"># total sum of squares</span></span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>ESS <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="fu">fitted</span>(mult.mod) <span class="sc">-</span> y_mean)<span class="sc">^</span><span class="dv">2</span>)       <span class="co"># explained sum of squares</span></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the measures</span></span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>SER <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>(n<span class="sc">-</span>k<span class="dv">-1</span>) <span class="sc">*</span> SSR)                    <span class="co"># standard error of the regression</span></span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a>Rsq <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (SSR <span class="sc">/</span> TSS)                          <span class="co"># R^2</span></span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a>adj_Rsq <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (n<span class="dv">-1</span>)<span class="sc">/</span>(n<span class="sc">-</span>k<span class="dv">-1</span>) <span class="sc">*</span> SSR<span class="sc">/</span>TSS          <span class="co"># adj. R^2</span></span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a><span class="co"># print the measures to the console</span></span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;SER&quot;</span> <span class="ot">=</span> SER, <span class="st">&quot;R2&quot;</span> <span class="ot">=</span> Rsq, <span class="st">&quot;Adj.R2&quot;</span> <span class="ot">=</span> adj_Rsq)</span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        SER         R2     Adj.R2 </span></span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14.4644831  0.4264315  0.4236805</span></span></code></pre></div>
<p>Now, what can we say about the fit of our multiple regression model for test scores with the percentage of English learners as an additional regressor? Does it improve on the simple model including only an intercept and a measure of class size? The answer is yes: compare <span class="math inline">\(\bar{R}^2\)</span> with that obtained for the simple regression model <tt>mod</tt>.</p>
<p>Including <span class="math inline">\(PctEL\)</span> as a regressor improves the <span class="math inline">\(\bar{R}^2\)</span>, which we deem to be more reliable in view of the above discussion. Notice that the difference between <span class="math inline">\(R^2\)</span> and <span class="math inline">\(\bar{R}^2\)</span> is small since <span class="math inline">\(k=2\)</span> and <span class="math inline">\(n\)</span> is large. In short, the fit of (<a href="#mjx-eqn-6.6">6.6</a>) improves vastly on the fit of the simple regression model with <span class="math inline">\(STR\)</span> as the only regressor.<br>
Comparing regression errors we find that the precision of the multiple regression model (<a href="#mjx-eqn-6.6">6.6</a>) improves upon the simple model as adding <span class="math inline">\(PctEL\)</span> lowers the <span class="math inline">\(SER\)</span> from <span class="math inline">\(18.6\)</span> to <span class="math inline">\(14.5\)</span> units of test score.</p>
<p>As already mentioned, <span class="math inline">\(\bar{R}^2\)</span> may be used to quantify how good a model fits the data. However, it is rarely a good idea to maximize these measures by stuffing the model with regressors. You will not find any serious study that does so. Instead, it is more useful to include regressors that improve the estimation of the causal effect of interest which is <em>not</em> assessed by means the <span class="math inline">\(R^2\)</span> of the model. The issue of variable selection is covered in Chapter @ref(nrf).</p>
</div>
<div id="ols-assumptions-in-multiple-regression" class="section level2 hasAnchor" number="6.4">
<h2 class="hasAnchor"><span class="header-section-number">6.4</span> OLS Assumptions in Multiple Regression<a href="#ols-assumptions-in-multiple-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the multiple regression model we extend the three least squares assumptions of the simple regression model (see Chapter @ref(lrwor)) and add a fourth assumption. These assumptions are presented in Key Concept 6.4. We will not go into the details of assumptions 1-3 since their ideas generalize easy to the case of multiple regressors. We will focus on the fourth assumption. This assumption rules out perfect correlation between regressors.</p>
<div id="KC6.4" class="keyconcept">
<h3 class="right">
Key Concept 6.4
</h3>
<h3 class="left">
The Least Squares Assumptions in the Multiple Regression Model
</h3>
<p>The multiple regression model is given by</p>
<p><span class="math display">\[ Y_i = \beta_0 + \beta_1 X_{1i} + \beta_1 X_{2i} + \dots + \beta_k X_{ki} + u_i \ , \ i=1,\dots,n. \]</span></p>
<p>The OLS assumptions in the multiple regression model are an extension of the ones made for the simple regression model:</p>
<ol style="list-style-type: decimal">
<li>Regressors <span class="math inline">\((X_{1i}, X_{2i}, \dots, X_{ki}, Y_i) \ , \ i=1,\dots,n\)</span>, are drawn such that the i.i.d. assumption holds.</li>
<li><span class="math inline">\(u_i\)</span> is an error term with conditional mean zero given the regressors, i.e.,
<span class="math display">\[ E(u_i\vert X_{1i}, X_{2i}, \dots, X_{ki}) = 0. \]</span></li>
<li>Large outliers are unlikely, formally <span class="math inline">\(X_{1i},\dots,X_{ki}\)</span> and <span class="math inline">\(Y_i\)</span> have finite fourth moments.</li>
<li>No perfect multicollinearity.</li>
</ol>
</div>
<div id="multicollinearity" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Multicollinearity<a href="#multicollinearity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>Multicollinearity</em> means that two or more regressors in a multiple regression model are <em>strongly</em> correlated. If the correlation between two or more regressors is perfect, that is, one regressor can be written as a linear combination of the other(s), we have <em>perfect multicollinearity</em>. While strong multicollinearity in general is unpleasant as it causes the variance of the OLS estimator to be large (we will discuss this in more detail later), the presence of perfect multicollinearity makes it impossible to solve for the OLS estimator, i.e., the model cannot be estimated in the first place.</p>
<p>The next section presents some examples of perfect multicollinearity and demonstrates how <tt>lm()</tt> deals with them.</p>
<div id="examples-of-perfect-multicollinearity" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Examples of Perfect Multicollinearity<a href="#examples-of-perfect-multicollinearity" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>How does <tt>R</tt> react if we try to estimate a model with perfectly correlated regressors?</p>
<p><tt>lm</tt> will produce a warning in the first line of the coefficient section of the output (<tt>1 not defined because of singularities</tt>) and ignore the regressor(s) which is (are) assumed to be a linear combination of the other(s). Consider the following example where we add another variable <tt>FracEL</tt>, the fraction of English learners, to <tt>CASchools</tt> where observations are scaled values of the observations for <tt>english</tt> and use it as a regressor together with <tt>STR</tt> and <tt>english</tt> in a multiple regression model. In this example <tt>english</tt> and <tt>FracEL</tt> are perfectly collinear. The <tt>R</tt> code is as follows.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the fraction of English learners        </span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>CASchools<span class="sc">$</span>FracEL <span class="ot">&lt;-</span> CASchools<span class="sc">$</span>english <span class="sc">/</span> <span class="dv">100</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>mult.mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> STR <span class="sc">+</span> english <span class="sc">+</span> FracEL, <span class="at">data =</span> CASchools) </span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain a summary of the model</span></span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mult.mod)                                                 </span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = score ~ STR + english + FracEL, data = CASchools)</span></span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -48.845 -10.240  -0.308   9.815  43.461 </span></span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients: (1 not defined because of singularities)</span></span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb144-19"><a href="#cb144-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 686.03224    7.41131  92.566  &lt; 2e-16 ***</span></span>
<span id="cb144-20"><a href="#cb144-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; STR          -1.10130    0.38028  -2.896  0.00398 ** </span></span>
<span id="cb144-21"><a href="#cb144-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; english      -0.64978    0.03934 -16.516  &lt; 2e-16 ***</span></span>
<span id="cb144-22"><a href="#cb144-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; FracEL             NA         NA      NA       NA    </span></span>
<span id="cb144-23"><a href="#cb144-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb144-24"><a href="#cb144-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb144-25"><a href="#cb144-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb144-26"><a href="#cb144-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 14.46 on 417 degrees of freedom</span></span>
<span id="cb144-27"><a href="#cb144-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.4264, Adjusted R-squared:  0.4237 </span></span>
<span id="cb144-28"><a href="#cb144-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic:   155 on 2 and 417 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>The row <tt>FracEL</tt> in the coefficients section of the output consists of <tt>NA</tt> entries since <tt>FracEL</tt> was excluded from the model.</p>
<p>If we were to compute OLS by hand, we would run into the same problem but no one would be helping us out! The computation simply fails. Why is this? Take the following example:</p>
<p>Assume you want to estimate a simple linear regression model with a constant and a single regressor <span class="math inline">\(X\)</span>. As mentioned above, for perfect multicollinearity to be present <span class="math inline">\(X\)</span> has to be a linear combination of the other regressors. Since the only other regressor is a constant (think of the right hand side of the model equation as <span class="math inline">\(\beta_0 \times 1 + \beta_1 X_i + u_i\)</span> so that <span class="math inline">\(\beta_1\)</span> is always multiplied by <span class="math inline">\(1\)</span> for every observation), <span class="math inline">\(X\)</span> has to be constant as well. For <span class="math inline">\(\hat\beta_1\)</span> we have</p>
<p><span class="math display">\[ \hat\beta_1 =  \frac{\sum_{i = 1}^n (X_i - \bar{X})(Y_i - \bar{Y})} { \sum_{i=1}^n (X_i - \bar{X})^2} = \frac{\widehat{Cov}(X,Y)}{\widehat{Var}(X)}. \tag{6.7} \]</span></p>
<p>The variance of the regressor <span class="math inline">\(X\)</span> is in the denominator. Since the variance of a constant is zero, we are not able to compute this fraction and <span class="math inline">\(\hat{\beta}_1\)</span> is undefined.</p>
<p><strong>Note:</strong> In this special case the denominator in (<a href="#mjx-eqn-6.7">6.7</a>) equals zero, too. Can you show that?</p>
<p>Let us consider two further examples where our selection of regressors induces perfect multicollinearity. First, assume that we intend to analyze the effect of class size on test score by using a dummy variable that identifies classes which are not small (<span class="math inline">\(NS\)</span>). We define that a school has the <span class="math inline">\(NS\)</span> attribute when the school’s average student-teacher ratio is at least <span class="math inline">\(12\)</span>,</p>
<p><span class="math display">\[ NS = \begin{cases} 0, \ \ \ \text{if STR &lt; 12} \\ 1 \ \ \ \text{otherwise.} \end{cases} \]</span></p>
<p>We add the corresponding column to <tt>CASchools</tt> and estimate a multiple regression model with covariates <tt>computer</tt> and <tt>english</tt>.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># if STR smaller 12, NS = 0, else NS = 1</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>CASchools<span class="sc">$</span>NS <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(CASchools<span class="sc">$</span>STR <span class="sc">&lt;</span> <span class="dv">12</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>mult.mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> computer <span class="sc">+</span> english <span class="sc">+</span> NS, <span class="at">data =</span> CASchools)</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain a model summary</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mult.mod)                                                  </span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = score ~ computer + english + NS, data = CASchools)</span></span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -49.492  -9.976  -0.778   8.761  43.798 </span></span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients: (1 not defined because of singularities)</span></span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 663.704837   0.984259 674.319  &lt; 2e-16 ***</span></span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; computer      0.005374   0.001670   3.218  0.00139 ** </span></span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; english      -0.708947   0.040303 -17.591  &lt; 2e-16 ***</span></span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; NS                  NA         NA      NA       NA    </span></span>
<span id="cb145-23"><a href="#cb145-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb145-24"><a href="#cb145-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb145-25"><a href="#cb145-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb145-26"><a href="#cb145-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 14.43 on 417 degrees of freedom</span></span>
<span id="cb145-27"><a href="#cb145-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.4291, Adjusted R-squared:  0.4263 </span></span>
<span id="cb145-28"><a href="#cb145-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 156.7 on 2 and 417 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>Again, the output of <tt>summary(mult.mod)</tt> tells us that inclusion of <tt>NS</tt> in the regression would render the estimation infeasible. What happened here? This is an example where we made a logical mistake when defining the regressor <tt>NS</tt>: taking a closer look at <span class="math inline">\(NS\)</span>, the redefined measure for class size, reveals that there is not a single school with <span class="math inline">\(STR&lt;12\)</span> hence <span class="math inline">\(NS\)</span> equals one for all observations. We can check this by printing the contents of <tt>CASchools$NS</tt> or by using the function <tt>table()</tt>, see <code>?table</code>.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(CASchools<span class="sc">$</span>NS)</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   1 </span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 420</span></span></code></pre></div>
<p><tt>CASchools$NS</tt> is a vector of <span class="math inline">\(420\)</span> ones and our data set includes <span class="math inline">\(420\)</span> observations. This obviously violates assumption 4 of Key Concept 6.4: the observations for the intercept are always <span class="math inline">\(1\)</span>,</p>
<p><span class="math display">\[\begin{align*}
  intercept = \, &amp; \lambda \cdot NS
\end{align*}\]</span></p>
<p><span class="math display">\[\begin{align*}
\begin{pmatrix} 1
  \\ \vdots \\ 1
  \end{pmatrix} = \, &amp; \lambda \cdot
  \begin{pmatrix} 1 \\
  \vdots \\ 1
  \end{pmatrix} \\   
  \Leftrightarrow \, &amp; \lambda = 1.
\end{align*}\]</span></p>
<p>Since the regressors can be written as a linear combination of each other, we face perfect multicollinearity and <tt>R</tt> excludes <tt>NS</tt> from the model. Thus the take-away message is: think carefully about how the regressors in your models relate!</p>
<p>Another example of perfect multicollinearity is known as the <em>dummy variable trap</em>. This may occur when multiple dummy variables are used as regressors. A common case for this is when dummies are used to sort the data into mutually exclusive categories. For example, suppose we have spatial information that indicates whether a school is located in the North, West, South or East of the U.S. This allows us to create the dummy variables</p>
<p><span class="math display">\[\begin{align*}
  North_i =&amp;
  \begin{cases}
    1 \ \ \text{if located in the north} \\
    0 \ \ \text{otherwise}
  \end{cases} \\
    West_i =&amp;
  \begin{cases}
    1 \ \ \text{if located in the west} \\
    0 \ \ \text{otherwise}
  \end{cases} \\
    South_i =&amp;
  \begin{cases}
    1 \ \ \text{if located in the south} \\
    0 \ \ \text{otherwise}
  \end{cases} \\
    East_i =&amp;
  \begin{cases}
    1 \ \ \text{if located in the east} \\
    0 \ \ \text{otherwise}.
  \end{cases}
\end{align*}\]</span></p>
<p>Since the regions are mutually exclusive, for every school <span class="math inline">\(i=1,\dots,n\)</span> we have <span class="math display">\[ North_i + West_i + South_i + East_i = 1. \]</span></p>
<p>We run into problems when trying to estimate a model that includes a constant and <em>all four</em> direction dummies in the model, e.g., <span class="math display">\[ TestScore = \beta_0 + \beta_1 \times STR + \beta_2 \times english + \beta_3 \times North_i + \beta_4 \times West_i + \beta_5 \times South_i + \beta_6 \times East_i + u_i \tag{6.8}\]</span>
since then for all observations <span class="math inline">\(i=1,\dots,n\)</span> the constant term is a linear combination of the dummies:</p>
<p><span class="math display">\[\begin{align}
  intercept = \, &amp; \lambda_1 \cdot (North + West + South + East) \\
  \begin{pmatrix} 1 \\ \vdots \\ 1\end{pmatrix} = \, &amp; \lambda_1 \cdot \begin{pmatrix} 1 \\ \vdots \\ 1\end{pmatrix} \\   \Leftrightarrow \, &amp; \lambda_1 = 1
\end{align}\]</span></p>
<p>and we have perfect multicollinearity. Thus the “dummy variable trap” means not paying attention and falsely including exhaustive dummies <em>and</em> a constant in a regression model.</p>
<p>How does <tt>lm()</tt> handle a regression like (<a href="#mjx-eqn-6.8">6.8</a>)? Let us first generate some artificial categorical data and append a new column named <tt>directions</tt> to <tt>CASchools</tt> and see how <tt>lm()</tt> behaves when asked to estimate the model.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for reproducibility</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="co"># generate artificial data on location</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>CASchools<span class="sc">$</span>direction <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;West&quot;</span>, <span class="st">&quot;North&quot;</span>, <span class="st">&quot;South&quot;</span>, <span class="st">&quot;East&quot;</span>), </span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>                              <span class="dv">420</span>, </span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">replace =</span> T)</span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model</span></span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a>mult.mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> STR <span class="sc">+</span> english <span class="sc">+</span> direction, <span class="at">data =</span> CASchools)</span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain a model summary</span></span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mult.mod)                                                 </span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb147-16"><a href="#cb147-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = score ~ STR + english + direction, data = CASchools)</span></span>
<span id="cb147-17"><a href="#cb147-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb147-18"><a href="#cb147-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb147-19"><a href="#cb147-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb147-20"><a href="#cb147-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -49.603 -10.175  -0.484   9.524  42.830 </span></span>
<span id="cb147-21"><a href="#cb147-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb147-22"><a href="#cb147-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb147-23"><a href="#cb147-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb147-24"><a href="#cb147-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)    684.80477    7.54130  90.807  &lt; 2e-16 ***</span></span>
<span id="cb147-25"><a href="#cb147-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; STR             -1.08873    0.38153  -2.854  0.00454 ** </span></span>
<span id="cb147-26"><a href="#cb147-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; english         -0.65597    0.04018 -16.325  &lt; 2e-16 ***</span></span>
<span id="cb147-27"><a href="#cb147-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; directionNorth   1.66314    2.05870   0.808  0.41964    </span></span>
<span id="cb147-28"><a href="#cb147-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; directionSouth   0.71619    2.06321   0.347  0.72867    </span></span>
<span id="cb147-29"><a href="#cb147-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; directionWest    1.79351    1.98174   0.905  0.36598    </span></span>
<span id="cb147-30"><a href="#cb147-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb147-31"><a href="#cb147-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb147-32"><a href="#cb147-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb147-33"><a href="#cb147-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 14.5 on 414 degrees of freedom</span></span>
<span id="cb147-34"><a href="#cb147-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.4279, Adjusted R-squared:  0.421 </span></span>
<span id="cb147-35"><a href="#cb147-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 61.92 on 5 and 414 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>Notice that <tt>R</tt> solves the problem on its own by generating and including the dummies <tt>directionNorth</tt>, <tt>directionSouth</tt> and <tt>directionWest</tt> but omitting <tt>directionEast</tt>. Of course, the omission of every other dummy instead would achieve the same. Another solution would be to exclude the constant and to include all dummies instead.</p>
<p>Does this mean that the information on schools located in the East is lost? Fortunately, this is not the case: exclusion of <tt>directEast</tt> just alters the interpretation of coefficient estimates on the remaining dummies from absolute to relative. For example, the coefficient estimate on <tt>directionNorth</tt> states that, on average, test scores in the North are about <span class="math inline">\(1.61\)</span> points higher than in the East.</p>
<p>A last example considers the case where a perfect linear relationship arises from redundant regressors. Suppose we have a regressor <span class="math inline">\(PctES\)</span>, the percentage of English speakers in the school where</p>
<p><span class="math display">\[ PctES = 100 -  PctEL\]</span></p>
<p>and both <span class="math inline">\(PctES\)</span> and <span class="math inline">\(PctEL\)</span> are included in a regression model. One regressor is redundant since the other one conveys the same information. Since this obviously is a case where the regressors can be written as linear combination, we end up with perfect multicollinearity, again.</p>
<p>Let us do this in <tt>R</tt>.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Percentage of english speakers </span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>CASchools<span class="sc">$</span>PctES <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">-</span> CASchools<span class="sc">$</span>english</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>mult.mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> STR <span class="sc">+</span> english <span class="sc">+</span> PctES, <span class="at">data =</span> CASchools)</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain a model summary</span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mult.mod)                                                 </span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = score ~ STR + english + PctES, data = CASchools)</span></span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -48.845 -10.240  -0.308   9.815  43.461 </span></span>
<span id="cb148-16"><a href="#cb148-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb148-17"><a href="#cb148-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients: (1 not defined because of singularities)</span></span>
<span id="cb148-18"><a href="#cb148-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb148-19"><a href="#cb148-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 686.03224    7.41131  92.566  &lt; 2e-16 ***</span></span>
<span id="cb148-20"><a href="#cb148-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; STR          -1.10130    0.38028  -2.896  0.00398 ** </span></span>
<span id="cb148-21"><a href="#cb148-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; english      -0.64978    0.03934 -16.516  &lt; 2e-16 ***</span></span>
<span id="cb148-22"><a href="#cb148-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PctES              NA         NA      NA       NA    </span></span>
<span id="cb148-23"><a href="#cb148-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb148-24"><a href="#cb148-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb148-25"><a href="#cb148-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb148-26"><a href="#cb148-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 14.46 on 417 degrees of freedom</span></span>
<span id="cb148-27"><a href="#cb148-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.4264, Adjusted R-squared:  0.4237 </span></span>
<span id="cb148-28"><a href="#cb148-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic:   155 on 2 and 417 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>Once more, <tt>lm()</tt> refuses to estimate the full model using OLS and excludes <tt>PctES</tt>.</p>
<p>See Chapter 18.1 of the book for an explanation of perfect multicollinearity and its consequences to the OLS estimator in general multiple regression models using matrix notation.</p>
</div>
<div id="imperfect-multicollinearity" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Imperfect Multicollinearity<a href="#imperfect-multicollinearity" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As opposed to perfect multicollinearity, imperfect multicollinearity is — to a certain extent — less of a problem. In fact, imperfect multicollinearity is the reason why we are interested in estimating multiple regression models in the first place: the OLS estimator allows us to <em>isolate</em> influences of <em>correlated</em> regressors on the dependent variable. If it was not for these dependencies, there would not be a reason to resort to a multiple regression approach and we could simply work with a single-regressor model. However, this is rarely the case in applications. We already know that ignoring dependencies among regressors which influence the outcome variable has an adverse effect on estimation results.</p>
<p>So when and why is imperfect multicollinearity a problem? Suppose you have the regression model</p>
<p><span class="math display">\[ Y_i = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + u_i \tag{6.9} \]</span></p>
<p>and you are interested in estimating <span class="math inline">\(\beta_1\)</span>, the effect on <span class="math inline">\(Y_i\)</span> of a one unit change in <span class="math inline">\(X_{1i}\)</span>, while holding <span class="math inline">\(X_{2i}\)</span> constant. You do not know that the true model indeed includes <span class="math inline">\(X_2\)</span>. You follow some reasoning and add <span class="math inline">\(X_2\)</span> as a covariate to the model in order to address a potential omitted variable bias. You are confident that <span class="math inline">\(E(u_i\vert X_{1i}, X_{2i})=0\)</span> and that there is no reason to suspect a violation of the assumptions 2 and 3 made in Key Concept 6.4. If <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are highly correlated, OLS struggles to precisely estimate <span class="math inline">\(\beta_1\)</span>. That means that although <span class="math inline">\(\hat\beta_1\)</span> is a consistent and unbiased estimator for <span class="math inline">\(\beta_1\)</span>, it has a large variance due to <span class="math inline">\(X_2\)</span> being included in the model. If the errors are homoskedastic, this issue can be better understood from the formula for the variance of <span class="math inline">\(\hat\beta_1\)</span> in the model (<a href="#mjx-eqn-6.9">6.9</a>) (see Appendix 6.2 of the book):</p>
<p><span class="math display">\[ \sigma^2_{\hat\beta_1} = \frac{1}{n} \left( \frac{1}{1-\rho^2_{X_1,X_2}} \right) \frac{\sigma^2_u}{\sigma^2_{X_1}}. \tag{6.10} \]</span></p>
<p>First, if <span class="math inline">\(\rho_{X_1,X_2}=0\)</span>, i.e., if there is no correlation between both regressors, including <span class="math inline">\(X_2\)</span> in the model has no influence on the variance of <span class="math inline">\(\hat\beta_1\)</span>. Secondly, if <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are correlated, <span class="math inline">\(\sigma^2_{\hat\beta_1}\)</span> is inversely proportional to <span class="math inline">\(1-\rho^2_{X_1,X_2}\)</span> so the stronger the correlation between <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>, the smaller is <span class="math inline">\(1-\rho^2_{X_1,X_2}\)</span> and thus the bigger is the variance of <span class="math inline">\(\hat\beta_1\)</span>. Thirdly, increasing the sample size helps to reduce the variance of <span class="math inline">\(\hat\beta_1\)</span>. Of course, this is not limited to the case with two regressors: in multiple regressions, imperfect multicollinearity inflates the variance of one or more coefficient estimators. It is an empirical question which coefficient estimates are severely affected by this and which are not. When the sample size is small, one often faces the decision whether to accept the consequence of adding a large number of covariates (higher variance) or to use a model with only few regressors (possible omitted variable bias). This is called <em>bias-variance trade-off</em>.</p>
<p>In sum, undesirable consequences of imperfect multicollinearity are generally not the result of a logical error made by the researcher (as is often the case for perfect multicollinearity) but are rather a problem that is linked to the data used, the model to be estimated and the research question at hand.</p>
</div>
</div>
<div id="simulation-study-imperfect-multicollinearity" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Simulation Study: Imperfect Multicollinearity<a href="#simulation-study-imperfect-multicollinearity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let us conduct a simulation study to illustrate the issues sketched above.</p>
<ol style="list-style-type: decimal">
<li>We use (<a href="#mjx-eqn-6.8">6.9</a>) as the data generating process and choose <span class="math inline">\(\beta_0 = 5\)</span>, <span class="math inline">\(\beta_1 = 2.5\)</span> and <span class="math inline">\(\beta_2 = 3\)</span> and <span class="math inline">\(u_i\)</span> is an error term distributed as <span class="math inline">\(\mathcal{N}(0,5)\)</span>. In a first step, we sample the regressor data from a bivariate normal distribution: <span class="math display">\[ X_i = (X_{1i}, X_{2i}) \overset{i.i.d.}{\sim} \mathcal{N} \left[\begin{pmatrix} 0 \\ 0  \end{pmatrix}, \begin{pmatrix} 10 &amp; 2.5 \\ 2.5 &amp; 10 \end{pmatrix} \right] \]</span> It is straightforward to see that the correlation between <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> in the population is rather low:</li>
</ol>
<p><span class="math display">\[ \rho_{X_1,X_2} = \frac{Cov(X_1,X_2)}{\sqrt{Var(X_1)}\sqrt{Var{(X_2)}}} = \frac{2.5}{10} = 0.25 \]</span></p>
<ol start="2" style="list-style-type: decimal">
<li><p>Next, we estimate the model (<a href="#mjx-eqn-6.9">6.9</a>) and save the estimates for <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span>. This is repeated <span class="math inline">\(10000\)</span> times with a <code>for</code> loop so we end up with a large number of estimates that allow us to describe the distributions of <span class="math inline">\(\hat\beta_1\)</span> and <span class="math inline">\(\hat\beta_2\)</span>.</p></li>
<li><p>We repeat steps 1 and 2 but increase the covariance between <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> from <span class="math inline">\(2.5\)</span> to <span class="math inline">\(8.5\)</span> such that the correlation between the regressors is high: <span class="math display">\[ \rho_{X_1,X_2} = \frac{Cov(X_1,X_2)}{\sqrt{Var(X_1)}\sqrt{Var{(X_2)}}} = \frac{8.5}{10} = 0.85 \]</span></p></li>
<li><p>In order to assess the effect on the precision of the estimators of increasing the collinearity between <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> we estimate the variances of <span class="math inline">\(\hat\beta_1\)</span> and <span class="math inline">\(\hat\beta_2\)</span> and compare.</p></li>
</ol>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="co"># set number of observations</span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize vectors of coefficients</span></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>coefs1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">&quot;hat_beta_1&quot;</span> <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">10000</span>), <span class="st">&quot;hat_beta_2&quot;</span> <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">10000</span>))</span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a>coefs2 <span class="ot">&lt;-</span> coefs1</span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a><span class="co"># loop sampling and estimation</span></span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>) {</span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for cov(X_1,X_2) = 0.25</span></span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(n, <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">100</span>), <span class="at">sigma =</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="fl">2.5</span>), <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">10</span>)))</span>
<span id="cb149-20"><a href="#cb149-20" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> <span class="fl">2.5</span> <span class="sc">*</span> X[, <span class="dv">1</span>] <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> X[, <span class="dv">2</span>] <span class="sc">+</span> u</span>
<span id="cb149-22"><a href="#cb149-22" aria-hidden="true" tabindex="-1"></a>  coefs1[i, ] <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X[, <span class="dv">1</span>] <span class="sc">+</span> X[, <span class="dv">2</span>])<span class="sc">$</span>coefficients[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb149-23"><a href="#cb149-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb149-24"><a href="#cb149-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for cov(X_1,X_2) = 0.85</span></span>
<span id="cb149-25"><a href="#cb149-25" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(n, <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">100</span>), <span class="at">sigma =</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="fl">8.5</span>), <span class="fu">c</span>(<span class="fl">8.5</span>, <span class="dv">10</span>)))</span>
<span id="cb149-26"><a href="#cb149-26" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> <span class="fl">2.5</span> <span class="sc">*</span> X[, <span class="dv">1</span>] <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> X[, <span class="dv">2</span>] <span class="sc">+</span> u</span>
<span id="cb149-27"><a href="#cb149-27" aria-hidden="true" tabindex="-1"></a>  coefs2[i, ] <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X[, <span class="dv">1</span>] <span class="sc">+</span> X[, <span class="dv">2</span>])<span class="sc">$</span>coefficients[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb149-28"><a href="#cb149-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb149-29"><a href="#cb149-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb149-30"><a href="#cb149-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-31"><a href="#cb149-31" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain variance estimates</span></span>
<span id="cb149-32"><a href="#cb149-32" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(<span class="fu">var</span>(coefs1))</span>
<span id="cb149-33"><a href="#cb149-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; hat_beta_1 hat_beta_2 </span></span>
<span id="cb149-34"><a href="#cb149-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.05674375 0.05712459</span></span>
<span id="cb149-35"><a href="#cb149-35" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(<span class="fu">var</span>(coefs2))</span>
<span id="cb149-36"><a href="#cb149-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; hat_beta_1 hat_beta_2 </span></span>
<span id="cb149-37"><a href="#cb149-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0.1904949  0.1909056</span></span></code></pre></div>
<p>We are interested in the variances which are the diagonal elements. We see that due to the high collinearity, the variances of <span class="math inline">\(\hat\beta_1\)</span> and <span class="math inline">\(\hat\beta_2\)</span> have more than tripled, meaning it is more difficult to precisely estimate the true coefficients.</p>
</div>
</div>
<div id="the-distribution-of-the-ols-estimators-in-multiple-regression" class="section level2 hasAnchor" number="6.5">
<h2 class="hasAnchor"><span class="header-section-number">6.5</span> The Distribution of the OLS Estimators in Multiple Regression<a href="#the-distribution-of-the-ols-estimators-in-multiple-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As in simple linear regression, different samples will produce different values of the OLS estimators in the multiple regression model. Again, this variation leads to uncertainty of those estimators which we seek to describe using their sampling distribution(s). In short, if the assumption made in Key Concept 6.4 hold, the large sample distribution of <span class="math inline">\(\hat\beta_0,\hat\beta_1,\dots,\hat\beta_k\)</span> is multivariate normal such that the individual estimators themselves are also normally distributed. Key Concept 6.5 summarizes the corresponding statements made in Chapter 6.6 of the book. A more technical derivation of these results can be found in Chapter 18 of the book.</p>
<div id="KC6.5" class="keyconcept">
<h3 class="right">
Key Concept 6.5
</h3>
<h3 class="left">
Large-sample distribution of <span class="math inline">\(\hat\beta_0,\hat\beta_1,\dots,\hat\beta_k\)</span>
</h3>
<p>If the least squares assumptions in the multiple regression model (see Key Concept 6.4) hold, then, in large samples, the OLS estimators <span class="math inline">\(\hat\beta_0,\hat\beta_1,\dots,\hat\beta_k\)</span> are jointly normally distributed. We also say that their joint distribution is <em>multivariate</em> normal. Further, each <span class="math inline">\(\hat\beta_j\)</span> is distributed as <span class="math inline">\(\mathcal{N}(\beta_j,\sigma_{\beta_j}^2)\)</span>.</p>
</div>
<p>Essentially, Key Concept 6.5 states that, if the sample size is large, we can approximate the individual sampling distributions of the coefficient estimators by specific normal distributions and their joint sampling distribution by a multivariate normal distribution.</p>
<p>How can we use <tt>R</tt> to get an idea of what the joint PDF of the coefficient estimators in multiple regression model looks like? When estimating a model on some data, we end up with a set of point estimates that do not reveal much information on the <em>joint</em> density of the estimators. However, with a large number of estimations using repeatedly randomly sampled data from the same population we can generate a large set of point estimates that allows us to plot an <em>estimate</em> of the joint density function.</p>
<p>The approach we will use to do this in <tt>R</tt> is a follows:</p>
<ul>
<li><p>Generate <span class="math inline">\(10000\)</span> random samples of size <span class="math inline">\(50\)</span> using the DGP <span class="math display">\[ Y_i = 5 + 2.5 \cdot X_{1i} + 3 \cdot X_{2i} + u_i  \]</span> where the regressors <span class="math inline">\(X_{1i}\)</span> and <span class="math inline">\(X_{2i}\)</span> are sampled for each observation as <span class="math display">\[ X_i = (X_{1i}, X_{2i}) \sim \mathcal{N} \left[\begin{pmatrix} 0 \\ 0  \end{pmatrix}, \begin{pmatrix} 10 &amp; 2.5 \\ 2.5 &amp; 10 \end{pmatrix} \right] \]</span> and <span class="math display">\[ u_i \sim \mathcal{N}(0,5) \]</span> is an error term.</p></li>
<li><p>For each of the <span class="math inline">\(10000\)</span> simulated sets of sample data, we estimate the model <span class="math display">\[ Y_i = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + u_i \]</span> and save the coefficient estimates <span class="math inline">\(\hat\beta_1\)</span> and <span class="math inline">\(\hat\beta_2\)</span>.</p></li>
<li><p>We compute a density estimate of the joint distribution of <span class="math inline">\(\hat\beta_1\)</span> and <span class="math inline">\(\hat\beta_2\)</span> in the model above using the function <tt>kde2d()</tt> from the package <tt>MASS</tt>, see <code>?MASS</code>. This estimate is then plotted using the function <tt>persp()</tt>.</p></li>
</ul>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a><span class="co"># set sample size</span></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize vector of coefficients</span></span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">&quot;hat_beta_1&quot;</span> <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">10000</span>), <span class="st">&quot;hat_beta_2&quot;</span> <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">10000</span>))</span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for reproducibility</span></span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a><span class="co"># loop sampling and estimation</span></span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>) {</span>
<span id="cb150-16"><a href="#cb150-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb150-17"><a href="#cb150-17" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(n, <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">100</span>), <span class="at">sigma =</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="fl">2.5</span>), <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">10</span>)))</span>
<span id="cb150-18"><a href="#cb150-18" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb150-19"><a href="#cb150-19" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> <span class="fl">2.5</span> <span class="sc">*</span> X[, <span class="dv">1</span>] <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> X[, <span class="dv">2</span>] <span class="sc">+</span> u</span>
<span id="cb150-20"><a href="#cb150-20" aria-hidden="true" tabindex="-1"></a>  coefs[i,] <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X[, <span class="dv">1</span>] <span class="sc">+</span> X[, <span class="dv">2</span>])<span class="sc">$</span>coefficients[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb150-21"><a href="#cb150-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb150-22"><a href="#cb150-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb150-23"><a href="#cb150-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-24"><a href="#cb150-24" aria-hidden="true" tabindex="-1"></a><span class="co"># compute density estimate</span></span>
<span id="cb150-25"><a href="#cb150-25" aria-hidden="true" tabindex="-1"></a>kde <span class="ot">&lt;-</span> <span class="fu">kde2d</span>(coefs[, <span class="dv">1</span>], coefs[, <span class="dv">2</span>])</span>
<span id="cb150-26"><a href="#cb150-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-27"><a href="#cb150-27" aria-hidden="true" tabindex="-1"></a><span class="co"># plot density estimate</span></span>
<span id="cb150-28"><a href="#cb150-28" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(kde, </span>
<span id="cb150-29"><a href="#cb150-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">theta =</span> <span class="dv">310</span>, </span>
<span id="cb150-30"><a href="#cb150-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">phi =</span> <span class="dv">30</span>, </span>
<span id="cb150-31"><a href="#cb150-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;beta_1&quot;</span>, </span>
<span id="cb150-32"><a href="#cb150-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;beta_2&quot;</span>, </span>
<span id="cb150-33"><a href="#cb150-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">zlab =</span> <span class="st">&quot;Est. Density&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-269-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>From the plot above we can see that the density estimate has some similarity to a bivariate normal distribution (see Chapter @ref(pt)) though it is not very pretty and probably a little rough. Furthermore, there is a correlation between the estimates such that <span class="math inline">\(\rho\neq0\)</span> in (<a href="#mjx-eqn-2.1">2.1</a>). Also, the distribution’s shape deviates from the symmetric bell shape of the bivariate standard normal distribution and has an elliptical surface area instead.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the correlation between estimators</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(coefs[, <span class="dv">1</span>], coefs[, <span class="dv">2</span>])</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -0.2503028</span></span></code></pre></div>
<p>Where does this correlation come from? Notice that, due to the way we generated the data, there is correlation between the regressors <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>. Correlation between the regressors in a multiple regression model always translates into correlation between the estimators (see Appendix 6.2 of the book). In our case, the positive correlation between <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> translates to negative correlation between <span class="math inline">\(\hat\beta_1\)</span> and <span class="math inline">\(\hat\beta_2\)</span>. To get a better idea of the distribution you can vary the point of view in the subsequent smooth interactive 3D plot of the same density estimate used for plotting with <tt>persp()</tt>. Here you can see that the shape of the distribution is somewhat stretched due to <span class="math inline">\(\rho=-0.20\)</span> and it is also apparent that both estimators are unbiased since their joint density seems to be centered close to the true parameter vector <span class="math inline">\((\beta_1,\beta_2) = (2.5,3)\)</span>.</p>
<center>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-7b43f271904e432cb7c7" style="width:80%;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-7b43f271904e432cb7c7">{"x":{"visdat":{"cf5925ab9a15":["function () ","plotlyVisDat"]},"cur_data":"cf5925ab9a15","attrs":{"cf5925ab9a15":{"x":[1.43134001510477,1.45235563835942,1.47337126161407,1.49438688486872,1.51540250812337,1.53641813137802,1.55743375463267,1.57844937788733,1.59946500114198,1.62048062439663,1.64149624765128,1.66251187090593,1.68352749416058,1.70454311741523,1.72555874066988,1.74657436392453,1.76758998717918,1.78860561043383,1.80962123368848,1.83063685694313,1.85165248019778,1.87266810345244,1.89368372670709,1.91469934996174,1.93571497321639,1.95673059647104,1.97774621972569,1.99876184298034,2.01977746623499,2.04079308948964,2.06180871274429,2.08282433599894,2.10383995925359,2.12485558250824,2.14587120576289,2.16688682901755,2.1879024522722,2.20891807552685,2.2299336987815,2.25094932203615,2.2719649452908,2.29298056854545,2.3139961918001,2.33501181505475,2.3560274383094,2.37704306156405,2.3980586848187,2.41907430807335,2.44008993132801,2.46110555458266,2.48212117783731,2.50313680109196,2.52415242434661,2.54516804760126,2.56618367085591,2.58719929411056,2.60821491736521,2.62923054061986,2.65024616387451,2.67126178712916,2.69227741038381,2.71329303363846,2.73430865689312,2.75532428014777,2.77633990340242,2.79735552665707,2.81837114991172,2.83938677316637,2.86040239642102,2.88141801967567,2.90243364293032,2.92344926618497,2.94446488943962,2.96548051269427,2.98649613594892,3.00751175920357,3.02852738245823,3.04954300571288,3.07055862896753,3.09157425222218,3.11258987547683,3.13360549873148,3.15462112198613,3.17563674524078,3.19665236849543,3.21766799175008,3.23868361500473,3.25969923825938,3.28071486151403,3.30173048476868,3.32274610802334,3.34376173127799,3.36477735453264,3.38579297778729,3.40680860104194,3.42782422429659,3.44883984755124,3.46985547080589,3.49087109406054,3.51188671731519],"y":[2.03952549432711,2.05920615619286,2.0788868180586,2.09856747992435,2.11824814179009,2.13792880365583,2.15760946552158,2.17729012738732,2.19697078925306,2.21665145111881,2.23633211298455,2.2560127748503,2.27569343671604,2.29537409858178,2.31505476044753,2.33473542231327,2.35441608417901,2.37409674604476,2.3937774079105,2.41345806977625,2.43313873164199,2.45281939350773,2.47250005537348,2.49218071723922,2.51186137910496,2.53154204097071,2.55122270283645,2.5709033647022,2.59058402656794,2.61026468843368,2.62994535029943,2.64962601216517,2.66930667403091,2.68898733589666,2.7086679977624,2.72834865962814,2.74802932149389,2.76770998335963,2.78739064522538,2.80707130709112,2.82675196895686,2.84643263082261,2.86611329268835,2.88579395455409,2.90547461641984,2.92515527828558,2.94483594015133,2.96451660201707,2.98419726388281,3.00387792574856,3.0235585876143,3.04323924948004,3.06291991134579,3.08260057321153,3.10228123507728,3.12196189694302,3.14164255880876,3.16132322067451,3.18100388254025,3.20068454440599,3.22036520627174,3.24004586813748,3.25972653000323,3.27940719186897,3.29908785373471,3.31876851560046,3.3384491774662,3.35812983933194,3.37781050119769,3.39749116306343,3.41717182492918,3.43685248679492,3.45653314866066,3.47621381052641,3.49589447239215,3.51557513425789,3.53525579612364,3.55493645798938,3.57461711985512,3.59429778172087,3.61397844358661,3.63365910545236,3.6533397673181,3.67302042918384,3.69270109104959,3.71238175291533,3.73206241478107,3.75174307664682,3.77142373851256,3.79110440037831,3.81078506224405,3.83046572410979,3.85014638597554,3.86982704784128,3.88950770970702,3.90918837157277,3.92886903343851,3.94854969530426,3.96823035717,3.98791101903574],"z":[[1.74793112339092e-53,5.00573696158945e-51,1.13356688606497e-48,2.02983970952988e-46,2.87416655206788e-44,3.21808876149447e-42,2.84918574268412e-40,1.99472033490735e-38,1.10429809034053e-36,4.83442502082799e-35,1.67372799762715e-33,4.58324964626228e-32,9.93058736527922e-31,1.70408209140544e-29,2.32111163209611e-28,2.52309224448223e-27,2.21639718513921e-26,1.61659418916743e-25,1.02869277888053e-24,6.08310830612498e-24,3.4565658328211e-23,1.83119879034301e-22,8.50665016096826e-22,3.38714679541162e-21,1.64269318887755e-20,2.99754769697153e-19,9.64422446347102e-18,2.65443607436317e-16,5.80414505285129e-15,1.00381736253526e-13,1.37281828940582e-12,1.48459215896239e-11,1.26951159872379e-10,8.58423447958354e-10,4.58988572762437e-09,1.9406072830902e-08,6.48797777260665e-08,1.71521788634228e-07,3.58575145896696e-07,5.92872210647421e-07,7.75956941206693e-07,8.07685441346813e-07,6.85324536292839e-07,5.31559559333503e-07,5.18244551207288e-07,7.5183829089218e-07,1.18367717758147e-06,1.59664407897987e-06,1.73017609991485e-06,1.48692086316815e-06,1.01101319530976e-06,5.43632458567499e-07,2.31153103721941e-07,7.7720891328223e-08,2.06647736454996e-08,4.34525120638897e-09,7.22900435076655e-10,9.59645088886738e-11,1.31315508093805e-11,1.1773477580114e-11,5.3654743634523e-11,6.03048450097714e-10,8.21527123844134e-09,9.40864473069755e-08,8.57717112567498e-07,6.1872293440762e-06,3.52951382319733e-05,0.000159210675716365,0.000567891286309979,0.00160174597577209,0.00357237847019383,0.00630023380772047,0.00878600106777462,0.00968860427747992,0.00844824627260689,0.00582515242861002,0.00317602128462798,0.00136928829479663,0.000466811738530801,0.000125841539419972,2.68251190335997e-05,4.52162639128125e-06,6.02674861655989e-07,6.35194721997032e-08,5.29378374325641e-09,3.48868458696837e-10,1.81801598882016e-11,7.49205605762461e-13,2.44252927923854e-14,6.31486894682952e-16,1.31415534762744e-17,2.39553021341855e-19,5.27410906984329e-21,1.93530008441015e-22,8.5709701710441e-24,3.3413409157662e-25,1.06680391845498e-26,2.8383134306486e-28,6.76628411256167e-30,1.61942860877593e-31],[2.21819502978144e-51,6.35248180341189e-49,1.43854196972015e-46,2.57594795986263e-44,3.64743162986015e-42,4.08388000865163e-40,3.61572210441055e-38,2.53136427321666e-36,1.40137673608635e-34,6.13484338132394e-33,2.12382717666693e-31,5.81497810177892e-30,1.25951454004319e-28,2.15953844495217e-27,2.93558988339425e-26,3.17566861908136e-25,2.75823276489838e-24,1.96212111785161e-23,1.18941031684473e-22,6.52868480118373e-22,3.41987383535033e-21,1.7033101360419e-20,7.62862783207782e-20,2.90374166539151e-19,9.48550597670353e-19,4.50929010504995e-18,8.4176035365964e-17,2.21338191024113e-15,4.82686871838368e-14,8.34672781737187e-13,1.14148678363208e-11,1.23442524169709e-10,1.05558766916293e-09,7.13771541926739e-09,3.81644984418293e-08,1.61359810810707e-07,5.39469723519016e-07,1.42618805133038e-06,2.98150890048396e-06,4.92955823314917e-06,6.45111596083674e-06,6.71073818073784e-06,5.67569356762209e-06,4.33989907415658e-06,4.08666573880483e-06,5.76205481691754e-06,8.99091376128356e-06,1.21051701212309e-05,1.31129741686329e-05,1.12686306617268e-05,7.66189541964768e-06,4.11990652319731e-06,1.75182777913217e-06,5.89056536444234e-07,1.56648737276686e-07,3.29556883009258e-08,5.49240683006093e-09,7.42396649087931e-10,1.42320811432807e-10,2.08758761688673e-10,5.13175141416764e-10,1.41798393697417e-09,8.52504346067788e-09,8.38025619439609e-08,7.5076674872689e-07,5.40581563508367e-06,3.08316404788552e-05,0.000139073746441176,0.000496063453440136,0.00139915414877269,0.00312053727041605,0.0055033682736513,0.00767473096625152,0.00846317120667695,0.00737969603785442,0.00508837608537615,0.00277431208014848,0.00119609811055461,0.000407768503330874,0.00010992486272452,2.34322273338953e-05,3.94972282046552e-06,5.26447670376539e-07,5.54855868857181e-08,4.62430893038659e-09,3.04781307588351e-10,1.58932317126588e-11,6.57679787591552e-13,2.19962890428243e-14,6.58204417150365e-16,2.50850454220054e-17,1.58283907082589e-18,1.14331722901483e-19,7.11326068503657e-21,3.57017491098667e-22,1.44439997832888e-23,4.84982343604071e-25,1.45366675798456e-26,4.3585156536008e-28,1.38530396103754e-29],[2.14792424023533e-49,6.15123977143203e-47,1.39296995901628e-44,2.49434353762349e-42,3.53188265056666e-40,3.95450282955973e-38,3.50117243085323e-36,2.45116174422566e-34,1.3569675107365e-32,5.94033876773033e-31,2.05641231082306e-29,5.62986685102077e-28,1.21913775364726e-26,2.08912611911384e-25,2.83595352358325e-24,3.05763682912505e-23,2.63467365832398e-22,1.84057314942584e-21,1.07464368805164e-20,5.53065673837535e-20,2.66939110881927e-19,1.23723057653726e-18,5.29444504163144e-18,1.9642004441727e-17,6.05561042303648e-17,1.63471236760408e-16,8.00045967736955e-16,1.44592403884381e-14,3.06759544713018e-13,5.2961372156811e-12,7.24227057514928e-11,7.83188806741087e-10,6.69724085825845e-09,4.52856818999806e-08,2.42137108883777e-07,1.02375801875726e-06,3.42270273864617e-06,9.04854853916527e-06,1.89163403924383e-05,3.12752815567014e-05,4.09245011482378e-05,4.25475068097991e-05,3.58787303647725e-05,2.70726047534218e-05,2.46417330726509e-05,3.37277532825006e-05,5.21210012608888e-05,7.0031894093335e-05,7.58332975762253e-05,6.51629442299311e-05,4.4306214315004e-05,2.38246984026822e-05,1.01313338920519e-05,3.40746086434915e-06,9.06726946862162e-07,1.91099738593501e-07,3.20396005925897e-08,4.55484212886565e-09,1.51426147097293e-09,3.2417927149306e-09,7.75405432536948e-09,1.51211540516797e-08,2.71502490001295e-08,8.16108728958886e-08,5.24921767125033e-07,3.62169178316169e-06,2.05613243458953e-05,9.27015619097559e-05,0.000330640455306344,0.000932570515509698,0.00207991295445362,0.00366812657808545,0.00511539164291259,0.00564090588392827,0.00491874378187444,0.00339152427035093,0.00184914530631929,0.000797227978614905,0.000271787457236478,7.32675555546996e-05,1.56181494372252e-05,2.63259510759795e-06,3.50898676706732e-07,3.69882267210401e-08,3.08521729911641e-09,2.04384333529527e-10,1.09980689338387e-11,5.42859338179864e-13,3.59913662228198e-14,3.88182978676361e-15,4.5629924429663e-16,4.54596370152156e-17,3.62974408974196e-18,2.30867047112719e-19,1.18058986815047e-20,5.00102379393925e-22,1.88485414069308e-23,7.08013593585091e-25,2.82013781989944e-26,1.10881889023309e-27],[1.58701857179095e-47,4.54491433813395e-45,1.02921187387991e-42,1.84297431759016e-40,2.60957166915973e-38,2.92182852681476e-36,2.58687841838971e-34,1.81106363571371e-32,1.00260365662138e-30,4.38900799162489e-29,1.51933619722477e-27,4.15923715636962e-26,9.00532470645392e-25,1.54256092174704e-23,2.09201053123083e-22,2.25033254934315e-21,1.92831294660038e-20,1.32981365523232e-19,7.54923433325637e-19,3.68518005391642e-18,1.64668494209696e-17,7.05163280324586e-17,2.85128434017534e-16,1.02529688714262e-15,3.1012767452257e-15,7.69092793742903e-15,1.74448328072051e-14,9.12177788581718e-14,1.51134767377276e-12,2.56649975780222e-11,3.5062683430285e-10,3.79152253269844e-09,3.24221613164064e-08,2.19233626801383e-07,1.17221698019264e-06,4.95615096732138e-06,1.65697947881033e-05,4.3805405159114e-05,9.15769166600563e-05,0.000151406529802097,0.000198101711007274,0.000205853718407086,0.000173120612179504,0.000129027669534056,0.000113621351879259,0.000150795466838755,0.000230605786296801,0.000309161729015927,0.000334632884477823,0.000287528774329328,0.000195503832070085,0.000105138619875331,4.47226911762847e-05,1.50537760354702e-05,4.01491115583031e-06,8.51573125528e-07,1.45661684544403e-07,2.36113384254531e-08,1.51735881467608e-08,3.90883729374601e-08,9.38935393591785e-08,1.79816679071332e-07,2.74693643121975e-07,3.54993973812189e-07,5.66362215843538e-07,2.07033187772768e-06,1.05976835594123e-05,4.72174041313277e-05,0.000168188008515801,0.000474299050586159,0.00105780737330623,0.00186553877274049,0.00260158824647267,0.00286885403500258,0.00250157643358082,0.00172486257319542,0.000940438961471655,0.000405454523828406,0.000138225864933294,3.72626213971205e-05,7.94332821014517e-06,1.33914399612159e-06,1.78675315517179e-07,1.89534504813342e-08,1.64316771342182e-09,1.34522573363267e-10,1.55731448511593e-11,2.85194494134715e-12,5.44090350118796e-13,8.6859292172119e-14,1.10752308501681e-14,1.12035185882559e-15,9.01162697408834e-17,5.82298519717865e-18,3.11196668268077e-19,1.4749790962246e-20,6.94179953799786e-22,3.46483316990951e-23,1.71354998102659e-24,7.50211973408086e-26],[8.94723567231075e-46,2.56231528650043e-43,5.80245321436933e-41,1.03902531265269e-38,1.47121463819616e-36,1.64725731521599e-34,1.45841969354753e-32,1.02103276655861e-30,5.65241375537231e-29,2.47438811913778e-27,8.56539626766279e-26,2.34470356412071e-24,5.07605443160966e-23,8.69266893008434e-22,1.17812298374832e-20,1.26526326494735e-19,1.08003544488767e-18,7.38059725141296e-18,4.10475942410918e-17,1.92230192259396e-16,8.02304934773922e-16,3.16653077996679e-15,1.19692234246459e-14,4.13268414077751e-14,1.22479570041302e-13,2.98727517993117e-13,5.94142037077812e-13,1.16383852711186e-12,6.60668101998817e-12,9.58089369308947e-11,1.2959761283496e-09,1.40061766237743e-08,1.19766288583726e-07,8.0984147042016e-07,4.33014312008552e-06,1.83079950148426e-05,6.1209124719506e-05,0.000161819343593685,0.000338292942071691,0.000559309463747306,0.000731759754663262,0.000760061835615438,0.000637646204326941,0.000469841554352946,0.000400662810627486,0.000515024938314786,0.000778738377762786,0.00104146793995741,0.00112676665890832,0.000968121871332214,0.000658347654900954,0.000354179578537102,0.000150814157739012,5.09120673399194e-05,1.36880790577472e-05,2.96808546734827e-06,5.41145031618997e-07,1.16193119273049e-07,1.31061849890185e-07,3.61604847083358e-07,8.69896705685474e-07,1.66555919827774e-06,2.52820543459958e-06,3.05461418147684e-06,3.0185889046958e-06,2.95825520863252e-06,5.46276194859022e-06,1.90305715426361e-05,6.55919612809998e-05,0.000184197265710795,0.000410556219362088,0.00072397468653702,0.00100959518304786,0.00111330546435779,0.000970775408186779,0.000669359158865212,0.000364951834568673,0.000157343672504531,5.3642674909177e-05,1.44637802648567e-05,3.08713756952881e-06,5.24533373979306e-07,7.33888108142892e-08,1.00273669471751e-08,2.03181418587579e-09,6.27485399533865e-10,1.93783262554876e-10,4.95619442192678e-11,1.0102923910293e-11,1.63147920151497e-12,2.08732562519294e-13,2.1226548044508e-14,1.73306195357527e-15,1.16857470268666e-16,6.9661350072525e-18,4.10802708790472e-19,2.56912356472379e-20,1.59795741617171e-21,8.82674512370086e-23,4.03513282006351e-24],[3.84892601113591e-44,1.10225797977899e-41,2.49610199447131e-39,4.46968376819853e-37,6.32887739305934e-35,7.08617753689673e-33,6.27383300814254e-31,4.39227726853273e-29,2.43154949280946e-27,1.06442431190574e-25,3.68458867827366e-24,1.00859364107415e-22,2.18334318119999e-21,3.73825635242858e-20,5.06420358800973e-19,5.4328043653783e-18,4.62511145315129e-17,3.14053263061624e-16,1.72106184768711e-15,7.81029741423009e-15,3.07876299176227e-14,1.12305008880629e-13,3.93535819998884e-13,1.29079464840974e-12,3.72322970024392e-12,8.96262044368442e-12,1.75011767826356e-11,2.79311353341512e-11,4.9117427036733e-11,2.99942431170344e-10,3.67610060662162e-09,3.94928074349651e-08,3.37587867365023e-07,2.28269110063905e-06,1.22054551489337e-05,5.1605944123834e-05,0.000172538183770192,0.000456156025905616,0.000953661888071326,0.00157679294182551,0.00206297751747229,0.00214210335332612,0.00179329954889848,0.00130758629622095,0.00108087816968138,0.00134402852282877,0.00200729191540014,0.00267726705565934,0.00289520622054224,0.00248775594761069,0.00169251917429417,0.000911762169387058,0.000389686791037329,0.000132908238628819,3.67385772112344e-05,8.55592145044191e-06,1.85164642042841e-06,5.98195936868611e-07,9.16259676343636e-07,2.56092361917484e-06,6.15647382919325e-06,1.17949981008274e-05,1.7929566544094e-05,2.16717471487304e-05,2.095652753867e-05,1.65268785363904e-05,1.16722024103066e-05,1.11448877353725e-05,2.21412746780379e-05,5.58293173766802e-05,0.000122181266617461,0.000214674620538351,0.000299104867546899,0.000329746423552244,0.000287506424450313,0.000198233252738406,0.000108084831489086,4.66107621263749e-05,1.59158120785201e-05,4.33333589848993e-06,9.80652116904702e-07,2.25250099852718e-07,7.99834083658776e-08,4.13699607974066e-08,2.06281211142726e-08,8.44714040924686e-09,2.75298235174047e-09,7.10414967964771e-10,1.45081263615194e-10,2.34695301281069e-11,3.01718391115301e-12,3.11259735430479e-13,2.64811965719555e-14,1.9856596268734e-15,1.46734541601282e-16,1.149700134623e-17,8.99228302537423e-19,6.26641491291906e-20,3.61959120047675e-21,1.68084903121758e-22],[1.26338019929263e-42,3.61807657104694e-40,8.1932616972258e-38,1.46713909573104e-35,2.07740492889009e-33,2.32598260465371e-31,2.0593363509123e-29,1.44172963854434e-27,7.9813540171986e-26,3.49386990523286e-24,1.20942025537904e-22,3.31051320937257e-21,7.16603163655712e-20,1.22679193771294e-18,1.66141644624136e-17,1.78099399399132e-16,1.51341959339081e-15,1.02307861504534e-14,5.54830260932162e-14,2.46005102794111e-13,9.26478140581331e-13,3.14655334481493e-12,1.01781462665629e-11,3.13761175751276e-11,8.73269213361995e-11,2.0663379650389e-10,3.99994658352608e-10,6.22663845943991e-10,8.0074357399816e-10,1.32617468899302e-09,8.43565374405305e-09,8.52705096913923e-08,7.26276904777996e-07,4.90999825663687e-06,2.62542612373279e-05,0.000111012215273063,0.000371186817723102,0.000981457222554476,0.00205221145255207,0.0033938681913785,0.00444139987948488,0.00461193422666216,0.00385512020032839,0.00278491757371861,0.00223358453357643,0.00268183462822453,0.00395029591277531,0.00525260456782354,0.00567791260840269,0.00488126679493296,0.00332654718700968,0.00180056633367653,0.00077970725513275,0.000275416777783057,8.30960109669736e-05,2.3337228936508e-05,6.86916425459466e-06,3.10334434025919e-06,5.05322507390355e-06,1.38980825009976e-05,3.3314947127691e-05,6.38719309428445e-05,9.73349919839674e-05,0.000118231889955011,0.000115310922916703,9.16263387730609e-05,6.10811300892994e-05,3.64788985143881e-05,2.32764636625486e-05,2.2212692460279e-05,3.26694260524022e-05,5.12405174692795e-05,6.91510627539603e-05,7.54772960999494e-05,6.55781381786783e-05,4.51664024664099e-05,2.46616695332874e-05,1.07640536510973e-05,3.95165710213552e-06,1.53757183788992e-06,9.54601033119479e-07,8.19988800697355e-07,6.57928119309565e-07,4.30779287789855e-07,2.24305616010613e-07,9.24791009148083e-08,3.01692680996846e-08,7.78873793349442e-09,1.59283691282639e-09,2.58841225137187e-10,3.37379773346348e-11,3.62168909566771e-12,3.41622530143626e-13,3.1636226282859e-14,3.10522111347084e-15,3.05364367269142e-16,2.68437982908027e-17,1.95907804691715e-18,1.15013546745836e-19,5.3702593942941e-21],[3.16426164421023e-41,9.06183340908957e-39,2.05208405033793e-36,3.67459604740321e-34,5.20306749127572e-32,5.82565464466926e-30,5.15781175725669e-28,3.61095316389498e-26,1.99900637007375e-24,8.75070996704952e-23,3.02908344720426e-21,8.29130792647096e-20,1.79469657665249e-18,3.07217140506561e-17,4.1596847141856e-16,4.456743065602e-15,3.78234322348848e-14,2.54899525573642e-13,1.37222392087377e-12,5.98279958214955e-12,2.17545740743959e-11,6.95021743443892e-11,2.0769030458899e-10,5.96298602379211e-10,1.58568287811684e-09,3.66593603087657e-09,7.02201991621474e-09,1.08605370773163e-08,1.34481095375083e-08,1.40577475336342e-08,2.30774071380051e-08,1.45711722316996e-07,1.1952620511213e-06,8.06263282051285e-06,4.31104728180711e-05,0.000182320496048461,0.00060979686690275,0.00161304197960778,0.00337481095800072,0.00558560527760564,0.00731738746168923,0.00760739570117802,0.00635980586485531,0.00456165485521586,0.00355221717089324,0.00410182830773934,0.00594042718393792,0.00786832389279963,0.00850475071710125,0.00732627231405089,0.0050231578396626,0.00276463693070259,0.00125120498380007,0.000491887165245498,0.000183930325408406,7.0463387922663e-05,2.79610148110571e-05,1.46307229784807e-05,2.20100742080761e-05,5.80637645063649e-05,0.000138175932336479,0.000264994211561406,0.000405258574306651,0.000495906373187664,0.000490478100059307,0.000399835563842803,0.000277947779079902,0.000173334386187883,0.000102839712702787,6.12231379172311e-05,3.88322271945774e-05,2.84130021275233e-05,2.41923981527402e-05,2.12168175567501e-05,1.67788978010003e-05,1.12095351073752e-05,6.43726014433912e-06,3.90377825510821e-06,3.72674907566349e-06,4.99776109280582e-06,6.34793871498612e-06,6.61130899560404e-06,5.48604362358747e-06,3.60809419884956e-06,1.87871592694563e-06,7.74255921646522e-07,2.52579946297117e-07,6.52801360444111e-08,1.34064644320865e-08,2.20751690566814e-09,2.98985084617926e-10,3.54786130092385e-11,4.11740919149023e-12,5.0621123470797e-13,6.25784514913796e-14,6.9387922279987e-15,6.3979379470458e-16,4.74850846983852e-17,2.80361281189311e-18,1.31153983896667e-19],[6.04720269306309e-40,1.73180190034439e-37,3.92172630648907e-35,7.02249982042597e-33,9.94355280716196e-31,1.11333750802752e-28,9.8570632746942e-27,6.90086914825419e-25,3.82028551769469e-23,1.67233860322905e-21,5.7888247053158e-20,1.58452055528262e-18,3.42969302447185e-17,5.87061521317688e-16,7.94757674890422e-15,8.51207551636251e-14,7.21765824140437e-13,4.85371159556491e-12,2.59952563766964e-11,1.1198382631577e-10,3.96650260619286e-10,1.20565889822526e-09,3.34695585815377e-09,8.89875280872085e-09,2.23794655535818e-08,5.01737919309301e-08,9.4736648517638e-08,1.45595971326445e-07,1.79210806391081e-07,1.76441859889475e-07,1.5232587939846e-07,2.59599354977606e-07,1.53971370469968e-06,1.01366189415083e-05,5.41189316556304e-05,0.000228976162373555,0.000766596620776337,0.00203079913374289,0.0042576825531805,0.00706717337823366,0.0092948281624829,0.00971295231348497,0.00816384156253075,0.00584807829491862,0.00442260551593534,0.00485365545107876,0.00684822648169451,0.00901387158698868,0.00975384921293766,0.00846479593812911,0.00592777342061608,0.00344798224596139,0.00177613466617297,0.00088959512450747,0.000456187085707908,0.000229348569229981,0.000108225248265158,5.95745373756128e-05,7.77351816989002e-05,0.000189039372375623,0.000441752523319458,0.000845839269768077,0.00129960386550652,0.00160726007500413,0.00162178614607446,0.00137006353171334,0.00100971637759134,0.000683614338079145,0.000444008409348764,0.000282006527769448,0.000177069708291387,0.000113734418253286,7.80577080438195e-05,5.63414215644005e-05,3.94528724119352e-05,2.52684391889261e-05,1.60645872104617e-05,1.43970089386259e-05,2.05738114382452e-05,3.14726320565474e-05,4.08398640861679e-05,4.25587463411407e-05,3.52408589884595e-05,2.31329189129246e-05,1.20288088240672e-05,4.95408510575861e-06,1.61712102004675e-06,4.19511149418911e-07,8.72360503050719e-08,1.4904229771738e-08,2.22471688371222e-09,3.23537386417483e-10,4.98139321859795e-11,7.73962233532555e-12,1.0823256506256e-12,1.26077210584634e-13,1.18293627944387e-14,8.83141425950078e-16,5.2244047598835e-17,2.44556100728618e-18],[8.81821114165596e-39,2.52536507214465e-36,5.71877798122062e-34,1.02404181131683e-31,1.44999842724812e-29,1.62350179656409e-27,1.43738610993475e-25,1.00630495117409e-23,5.57084963997544e-22,2.43864921027051e-20,8.44139649316139e-19,2.31056819685647e-17,5.00113796594403e-16,8.56010759404081e-15,1.1587406625109e-13,1.24073465881482e-12,1.05141762210241e-11,7.06005028484435e-11,3.76762844584781e-10,1.60929185784264e-09,5.59177666184832e-09,1.63469907596431e-08,4.25416331090515e-08,1.04621276619436e-07,2.46549872212836e-07,5.31404368851659e-07,9.84113632356347e-07,1.49956045806279e-06,1.8386907386828e-06,1.79755361878605e-06,1.41116653723991e-06,1.03987994194574e-06,1.90787117670812e-06,1.00184486985203e-05,5.24015735714814e-05,0.000221429311077308,0.000743274295288742,0.00197866192938255,0.00417820425690258,0.00700469031480922,0.009338444093319,0.00993543682327713,0.00853414658752305,0.00620964154143542,0.00456247911857691,0.00459552516464818,0.00612781126032579,0.00794480286442817,0.0086411763731225,0.00769467019078053,0.00577107915347687,0.00391767984870478,0.00263716766172079,0.00180795560902559,0.00118238119722451,0.000689267796890039,0.000362232523122461,0.000211811304548552,0.000235873793131246,0.000493845568371108,0.00110334527358159,0.0020960035694818,0.00323712472768246,0.00406265940589612,0.00421396432331738,0.00373031436180363,0.00294979796605581,0.00218253267418804,0.00155202284110748,0.00106711557955834,0.000718980009540791,0.000495824545565259,0.000364165275638518,0.000276173890871053,0.000198954470433915,0.000129490277629382,8.31277295058342e-05,7.42322013152679e-05,0.000104477453015658,0.000157860342925297,0.000203142018686869,0.000210442749606604,0.000173509799626421,0.00011354766934013,5.89303457678173e-05,2.42617578147326e-05,7.94250078028822e-06,2.08430000029406e-06,4.48981495484554e-07,8.42770624827094e-08,1.53549347522327e-08,2.95974851428623e-09,5.77789281212196e-10,1.01884522928139e-10,1.49923148547225e-11,1.77819477406119e-12,1.67858684318059e-13,1.25569971755928e-14,7.43324090695343e-16,3.48026595182422e-17],[9.81184365263204e-38,2.80992033496057e-35,6.36316260052317e-33,1.1394295084079e-30,1.61338233920399e-28,1.8064357983349e-26,1.59934876016514e-24,1.11969383420177e-22,6.19856235139547e-21,2.71342940781003e-19,9.392531318846e-18,2.57089936989766e-16,5.564550057945e-15,9.52418903786424e-14,1.28915319372427e-12,1.38013765900076e-11,1.16905663740016e-10,7.84188540768393e-10,4.17439694328432e-09,1.77238947479308e-08,6.07382208193471e-08,1.72387485159516e-07,4.25121389267988e-07,9.7051848089653e-07,2.12892698585465e-06,4.3709435764303e-06,7.89017815210539e-06,1.18836661279019e-05,1.44997699687308e-05,1.41414893436288e-05,1.09954670151394e-05,7.00722461534751e-06,4.85670707934307e-06,9.79320078156645e-06,4.19393982142907e-05,0.000171143491540961,0.000573916647426917,0.00154750564493779,0.00334064520276538,0.00577609375075478,0.0080196370171966,0.00898098407793253,0.00819071920086853,0.00627606216974469,0.00450630171071702,0.00387012000927716,0.00445738815271815,0.00551138143865435,0.00609644565550117,0.0058848547595555,0.00528757463532795,0.00478999171982057,0.00437071234697222,0.00371084897376306,0.00274440876693894,0.00175598890296099,0.00103987016644926,0.000679441234441323,0.000663964013635341,0.00109895517109319,0.00221928097838971,0.00411151254679579,0.00636708966353319,0.00814000015957469,0.00874855138457901,0.00819749151721903,0.00700402006835903,0.00564885827354825,0.00434801063374279,0.00319851364616541,0.00230135685700275,0.00170825227038452,0.00134856558835516,0.00107790538858223,0.000800916099074302,0.000530661778922001,0.000343295397505086,0.000302275756634447,0.000414136755588131,0.000613869904443273,0.000780144504225562,0.000801056232163105,0.000656232476192457,0.000427538747437319,0.000221378238293458,9.12631969190982e-05,3.0177462243766e-05,8.18702366893677e-06,1.93101380366859e-06,4.40501910045252e-07,1.0623659969627e-07,2.60447564785363e-08,5.78933211087016e-09,1.07596347472621e-09,1.61306388015063e-10,1.92524303154719e-11,1.82115250662029e-12,1.36325967467117e-13,8.07165955083476e-15,3.77941628805581e-16],[8.33057443000456e-37,2.38566541946991e-34,5.40240290933027e-32,9.67388947932501e-30,1.36978024896189e-27,1.53368480346992e-25,1.3578654639173e-23,9.50632835537781e-22,5.26264895468997e-20,2.30373073681923e-18,7.97434934261148e-17,2.18271107083279e-15,4.72430266178834e-14,8.08587537935027e-13,1.09441594628466e-11,1.17151649827361e-10,9.92051923045192e-10,6.64979512182823e-09,3.53365166392483e-08,1.49404081196438e-07,5.0695691501558e-07,1.4076276472004e-06,3.32525918325454e-06,7.09957711751484e-06,1.44557404836649e-05,2.80265723697405e-05,4.89617625698047e-05,7.26038123930464e-05,8.79976198283949e-05,8.55991711220876e-05,6.64760012608207e-05,4.18577120176087e-05,2.40290777584264e-05,2.08707451637851e-05,4.35564572672959e-05,0.000132932759605074,0.000407272086097661,0.00109940839083501,0.00248183098147286,0.00459597152492421,0.00694221357017707,0.00854616934168609,0.00859256540773366,0.00713135705481614,0.00509889462383444,0.00358195479892166,0.00305542498214989,0.00326857677847302,0.00375982416279675,0.00439823004522965,0.005333587544755,0.00643590815461751,0.0070651928217839,0.00664471368147935,0.00531666811241217,0.00378685795971044,0.00263197868550674,0.00198034378950998,0.00179657192569846,0.00226785670178703,0.00381437471392335,0.00663890505138984,0.0101978006031808,0.0132796656298468,0.014855440076542,0.0147966062613023,0.0136310906343076,0.0118515797439582,0.00972825635398362,0.00756966853617631,0.00578549724559751,0.00460987929522108,0.00389128750568527,0.00325859932584819,0.00248933333788875,0.00167966667763992,0.00110075243931969,0.000963868380683055,0.00128656212963383,0.0018621506811553,0.00232580579536876,0.00235774211144924,0.00191348963149016,0.00123907124879656,0.000640522758609812,0.00026602701952841,9.0682330230568e-05,2.68289466822588e-05,7.65227099279648e-06,2.30629627877384e-06,7.09410019479512e-07,1.98668386428479e-07,4.66187745715536e-08,8.83220792581104e-09,1.33265027709832e-09,1.59389189050719e-10,1.50871317527642e-11,1.12960036688985e-12,6.6885427490791e-14,3.13182071284148e-15],[5.40083996826322e-36,1.545701637157e-33,3.49989532777376e-31,6.267012107911e-29,8.87378094659334e-27,9.93558864071619e-25,8.79658601884571e-23,6.15843241030802e-21,3.40927236271737e-19,1.49241239212842e-17,5.1659712010991e-16,1.41400836389432e-14,3.06049021805517e-13,5.23810655790337e-12,7.08948979622658e-11,7.58830674794132e-10,6.42454476129963e-09,4.30426963425106e-08,2.2844717406555e-07,9.63035689160889e-07,3.24489090818027e-06,8.86665063585072e-06,2.02610004769725e-05,4.08511822640173e-05,7.73271037016635e-05,0.000140597824047349,0.00023587975099619,0.000342739451002846,0.000411706744584024,0.000399095657482426,0.000309786685908324,0.000195586587295963,0.000111940996385994,8.4868389226852e-05,0.000114913062590487,0.000207681233090367,0.000428275752850549,0.000972888463295145,0.00217125763604554,0.00426740812586619,0.00699422899110198,0.00936375607145562,0.0101752187705886,0.00899283502554352,0.00656364978607021,0.00416376230387753,0.00263892563337561,0.00212703842577471,0.0024877969233555,0.00371812380090246,0.0057928069430254,0.00816028780954793,0.00975137015706606,0.00981984730150499,0.00864878651936855,0.0071549681794019,0.00594960482071808,0.00506340866361749,0.00446457766950105,0.00455834677222505,0.0060779412925511,0.00941691383497454,0.0139828114991373,0.0183440414139884,0.0212320166298201,0.0223118102369772,0.0218710153606718,0.020149290894998,0.0173679416884291,0.0141595447738545,0.0114546370846762,0.00977433150793442,0.0087778531462813,0.00766479289082888,0.0060109162551161,0.00413965771387419,0.00276796222517307,0.00243291096365861,0.00316509635660231,0.00444686212676615,0.00542420204276455,0.00540042768579426,0.00432614121403158,0.00278123124166351,0.00144177066186608,0.000614565991083015,0.000227239328794134,8.0801911818808e-05,3.03588474365817e-05,1.16955907385023e-05,4.12173126851141e-06,1.22030615577501e-06,2.92037377220403e-07,5.56894623756653e-08,8.42005960955391e-09,1.00768286897766e-09,9.53980620276079e-11,7.14277241805113e-12,4.22929234533544e-13,1.98027457295485e-14],[2.73191071416505e-35,7.67214664084674e-33,1.73132311840776e-30,3.09828103063093e-28,4.38653070364267e-26,4.91130731871381e-24,4.34826380833417e-22,3.04418827600538e-20,1.68524437506973e-18,7.3771717083948e-17,2.55359920083057e-15,6.98959532944474e-14,1.51282726154909e-12,2.58921721959015e-11,3.50428049931723e-10,3.75062411626433e-09,3.1749666908796e-08,2.12639881519037e-07,1.12761401018808e-06,4.74368518659537e-06,1.5904155239184e-05,4.29574464658161e-05,9.57280575942845e-05,0.000184169565654037,0.000325848647553542,0.000553443033299547,0.000885014520510188,0.0012532059701964,0.00148780207006548,0.00143563388646691,0.00111396655608218,0.000707414585459129,0.000413906558449481,0.000322399512117415,0.000411732800475603,0.00061417461277374,0.000908873215061477,0.00145209003021973,0.00263574753985576,0.0048496051542839,0.00793657209960823,0.0108535147750761,0.0121765523834465,0.0112209996424288,0.00860886153761615,0.00566112256438021,0.00340608708797566,0.00223481557194958,0.00222512263825359,0.00345449294468763,0.00583496084963386,0.0087204016816339,0.0110414754097709,0.0121416957622368,0.0122968304097624,0.0121236681424537,0.0117268138067036,0.0108019566529135,0.00944967687492808,0.00858107416445345,0.00943386767136043,0.0126124133608706,0.0174709383837775,0.0224834054923849,0.0263369922810397,0.02857160529513,0.0291469480297049,0.0278984545014313,0.0249041128886717,0.0211252609811325,0.0180567431529554,0.0164695992369977,0.0156663925252602,0.0142215823893111,0.0114575428559603,0.00809182748260078,0.00556791678667086,0.00494616254868118,0.00625389424778401,0.00846124087331251,0.0100001742114636,0.00971631106921146,0.00765445061856524,0.00489537840168892,0.00258559907241403,0.0011862567878107,0.000522765286588353,0.000243656584008252,0.00011713460965613,5.18239904134487e-05,1.93293836979588e-05,5.83745648327523e-06,1.40594006186945e-06,2.68610791101887e-07,4.06321659622705e-08,4.86296536977088e-09,4.60356613414313e-10,3.44662855663371e-11,2.04067401335154e-12,9.5546909248806e-14],[1.75471808595624e-34,3.25919548717462e-32,6.67738773709225e-30,1.17336275051809e-27,1.65574712833132e-25,1.85270206193766e-23,1.64011441060609e-21,1.14820552605846e-19,6.35636348586765e-18,2.78249934948866e-16,9.63158009341718e-15,2.63630887159118e-13,5.70600805495982e-12,9.76581689714863e-11,1.32169649026273e-09,1.41455134639667e-08,1.19732189763952e-07,8.01696543109375e-07,4.24878884562079e-06,1.78478183837263e-05,5.96273417102736e-05,0.000159717414204079,0.000349344384898456,0.000647589908144331,0.00107963256534361,0.00171241050467165,0.00259355496553592,0.00355817135734938,0.00416130830889672,0.0039919249829276,0.00309745235968388,0.00198515231612813,0.00120050175140006,0.00098420531965272,0.00125855247229054,0.001780461680814,0.00233880160579122,0.00300306489819956,0.00423542440752767,0.00654497836725752,0.00979923733001211,0.0129214752180862,0.0145197314434999,0.0139346381129927,0.0116214059587457,0.00861150011834283,0.00582356996309109,0.00383154005827414,0.00297426308066351,0.00345114200932033,0.0052144620019466,0.00780709595890885,0.0105718014600339,0.0132010131361255,0.0157978156385949,0.0181466155095038,0.0193257567933588,0.0185336601707363,0.0162077576728488,0.0140589920298617,0.0139340805407219,0.0165190956624395,0.0209509135077037,0.0256267378758589,0.0293969403410732,0.031922329055581,0.0330178371122791,0.0322185834605874,0.0294585661516669,0.0258967205018991,0.0233765466478409,0.0227243507562063,0.022780829213375,0.0214566279983057,0.0178092053997382,0.0129891585901236,0.00927063341850353,0.00832008203782263,0.0101246133133674,0.0130395367950537,0.0147867123147303,0.013924118192912,0.0107741229985794,0.00693953096636104,0.0038990282807452,0.00210601649797579,0.0012062146750689,0.000718338412119959,0.000397006877817139,0.00018593608006442,7.07083098940016e-05,2.14783595625365e-05,5.18033528205723e-06,9.89840865080462e-07,1.49701896522499e-07,1.79127934275272e-08,1.69543433323579e-09,1.26919499633894e-10,7.51407959930051e-12,3.5181165545079e-13],[6.95377910211299e-33,4.17838140232423e-31,3.21922079663989e-29,3.7923929572808e-27,4.87227880957627e-25,5.35450843852262e-23,4.7241426838808e-21,3.30510752446639e-19,1.82943213397438e-17,8.00809434280633e-16,2.77196624300185e-14,7.58726458139954e-13,1.64217742369483e-11,2.81056767478018e-10,3.80375077461126e-09,4.07086324756313e-08,3.44546664968173e-07,2.30659807779746e-06,1.22192011411938e-05,5.12758332929543e-05,0.000170876123733511,0.000454972805636157,0.00098158324008824,0.00176808793090273,0.00280341937552471,0.0041657088750522,0.005950386729497,0.00786432602316326,0.00902810027697138,0.00859868118137819,0.00667836604050198,0.00434397038285615,0.00275430381243686,0.0024034226134054,0.00308216220924747,0.00421150783879256,0.00525207231211181,0.00616332680457902,0.00756700206715313,0.0101490997144753,0.0137128191946328,0.0170427934190214,0.0188724802851139,0.0187815851542615,0.017082550479683,0.0142737965141486,0.0109159336641852,0.0077312157034246,0.005442025205792,0.00449588020690089,0.00497118354701474,0.00668668228456279,0.00948794249864493,0.0134403269941785,0.0183876932704195,0.0231672551928642,0.025827216084277,0.0252029849338836,0.0222074684874219,0.0193275250292245,0.0187959533623957,0.021088056750911,0.0249369830077248,0.0286635106645316,0.0314271285668182,0.0332308617653018,0.0340157652997837,0.0332831238194043,0.0309239353164773,0.0281076570022132,0.0266848916606744,0.0273497949066599,0.028581208693783,0.027812309618138,0.023842806288384,0.0180747233276778,0.0134183232790639,0.0120318291938918,0.01382867188397,0.0166700865151782,0.0179173027529507,0.0162587421137974,0.0124515917758229,0.00838472376473767,0.0054467066789894,0.00376904861454582,0.00274234933342687,0.00187441584979454,0.00109478653536594,0.000521815780916343,0.000199282466332852,6.05486098869546e-05,1.45932752775933e-05,2.78631392311114e-06,4.2114523838949e-07,5.03714322724322e-08,4.76631927751592e-09,3.5675516695417e-10,2.11218494201536e-11,9.89300802970061e-13],[4.54117993966029e-31,2.28974517645072e-29,9.46665780035019e-28,3.61771707978122e-26,1.77917032822328e-24,1.32157398882321e-22,1.06189993825518e-20,7.29242841115875e-19,4.02163382775161e-17,1.7590423605238e-15,6.08771513439346e-14,1.66620741872695e-12,3.6062524099544e-11,6.17200122583592e-10,8.35294012470711e-09,8.93932092387637e-08,7.56561253339265e-07,5.06424164752546e-06,2.68197168161176e-05,0.000112461390309068,0.000374103704976223,0.000991796430812634,0.00211836534704555,0.00373339525888329,0.005682266491093,0.00795807453815888,0.0107059841304417,0.0135663548158973,0.0152349570876745,0.0143926628953787,0.0112148516745835,0.00747378651870482,0.00507000632662949,0.00475797595976815,0.00607798439734678,0.00797829833361689,0.00955908656612893,0.0107873521009078,0.0126356631675628,0.0160559876305095,0.0206376755538366,0.0247270228366078,0.0270077460904982,0.0273928415710107,0.026248030293191,0.0235924815502701,0.019529550583498,0.0148576269941527,0.0107491055250517,0.00803976355015431,0.00699333370378361,0.00756947550125205,0.0098204220906301,0.0139320835175181,0.0195445806226361,0.0250174168945677,0.0280411286679057,0.0275438653908316,0.0248636016521966,0.0227779992595932,0.0233348058425192,0.0264712389574795,0.0304798590152128,0.033656215449736,0.0354564622197403,0.0362207596204144,0.0361641862251526,0.035027192837298,0.0328169740884307,0.0305879022630584,0.0299545261847992,0.0314549276926772,0.0334794186080536,0.0332714246407469,0.0293735743425877,0.0231473992567565,0.0177711998761293,0.0156455490295309,0.0166042904302037,0.0183406728853852,0.0184201368585554,0.0161038432613036,0.0125635243284167,0.00952450164385242,0.00774865341660775,0.00672808332243522,0.00558376796809919,0.00401262875396184,0.00237422781209496,0.00113233432769469,0.000431393287111137,0.000130734125856732,3.14451305739972e-05,5.99516006359711e-06,9.05277438165206e-07,1.08213795943533e-07,1.0237613916512e-08,7.66586943201016e-10,4.54652098620601e-11,2.14083553028803e-12],[2.35793902889964e-29,1.17820820826604e-27,4.68445943275822e-26,1.49175650310132e-24,3.91265713279757e-23,9.54053970424376e-22,2.98090359085184e-20,1.38381385501672e-18,6.92259662596575e-17,2.96578381210916e-15,1.0217300364799e-13,2.79332601991475e-12,6.04376815179256e-11,1.03426052702525e-09,1.3996628228671e-08,1.49787431930498e-07,1.26764172290243e-06,8.48452242700824e-06,4.49234234093863e-05,0.000188274821436655,0.000625490883372392,0.00165310654482659,0.00350507098914304,0.00607720278509535,0.0089551424003526,0.0119157713606068,0.0151290239512771,0.0183356783588202,0.0201000645707467,0.0188451884506348,0.0148095113134378,0.0102686086241427,0.00764107089616479,0.00776002387785009,0.00979410522331807,0.0122392530800375,0.0140602690917102,0.0155463962150118,0.0182098353797186,0.0232341184299978,0.0297856542693697,0.035470763795771,0.0386544627564984,0.0395349714632142,0.0387589592479024,0.0361462411077697,0.0314230828051186,0.0253813642466159,0.0196135068209333,0.015414915571211,0.0132153434242346,0.0128269550323762,0.0140371685366448,0.0168361857449653,0.0208406650597598,0.0246592959331084,0.0265276108158882,0.0259787100387948,0.0246095988895814,0.0248736212045126,0.0280736358625193,0.0334289449320645,0.0388789284813741,0.0426986368144106,0.0444249272408426,0.0445003954804276,0.0434024323959434,0.0413180321232902,0.0385735520127216,0.0361425458448498,0.0353679480175811,0.0367268348968133,0.0387598630206743,0.0387234976866557,0.0349035225935897,0.0283952828138958,0.0223084795161015,0.0190389758225644,0.0183884553529853,0.0182737278218375,0.0169573893884643,0.0144811896094065,0.0121945676803722,0.0111822977633928,0.0111920780552894,0.0109611488781612,0.00947021270058018,0.0068317431493093,0.00401447427162858,0.00189915605160738,0.000718734838459571,0.00021675745614081,5.19625615131614e-05,9.88577131075918e-06,1.49111229682633e-06,1.78259861059407e-07,1.69031343999392e-08,1.27540655493739e-09,7.73232438381168e-11,3.8673664898314e-12],[9.36489463150914e-28,4.66800352126778e-26,1.84812479340124e-24,5.82149762218144e-23,1.46341009966229e-21,2.95949784720682e-20,4.96213228299685e-19,7.77353611886487e-18,1.53492938240103e-16,4.38943973471113e-15,1.35488962751377e-13,3.6075481291673e-12,7.75207759103324e-11,1.32388230034387e-09,1.79034446703209e-08,1.91544267021011e-07,1.62081399165549e-06,1.08472014115071e-05,5.74233020248137e-05,0.000240569324547931,0.000798487213064791,0.00210562789986656,0.00444109027863342,0.00760877489848662,0.0109408511112457,0.0139684551297321,0.016857239874476,0.0195994815548138,0.0210313999337401,0.0196817320199443,0.0157893518831481,0.0116618712392604,0.00972868238968334,0.0106235051129638,0.0131273252347027,0.0155280741310327,0.017097878369917,0.0188102337339409,0.0227120755843778,0.0299387807822671,0.0390333884252383,0.0468426612631219,0.051363548717738,0.052957716732379,0.052591434106276,0.0501303199462461,0.0451120787507913,0.0383202040424921,0.0317200719853646,0.0270429867436318,0.0247343620248116,0.0241089942616969,0.0243299442771155,0.0250789875895415,0.0261667254824511,0.0268920900839213,0.0264829666539474,0.0252989371090066,0.0251171173912346,0.0278567944250943,0.0339794900449802,0.0420663177531494,0.0497870357253326,0.0552864897401188,0.0578787774092541,0.0577797345040631,0.0555493826260564,0.0518806230276887,0.0476681684904104,0.0440772588732913,0.0423403348683047,0.0429217460325368,0.0445288537580024,0.0444659048285774,0.0407541228467617,0.034065480782883,0.0271796657020384,0.0223660074364474,0.0195937357528584,0.0173859327664222,0.0149186716611801,0.0128690879668745,0.0123898145353203,0.0136049649262745,0.0151791956456741,0.0152925880761526,0.0130845029582029,0.0092536952486408,0.00533572595006917,0.00248672147368617,0.000930951640049856,0.000278701253747762,6.65149053446295e-05,1.26337037657328e-05,1.91016143896235e-06,2.30826362557193e-07,2.25889158445848e-08,1.85358518906979e-09,1.37374819357664e-10,1.01710694639739e-11],[2.84085403446014e-26,1.41335816350335e-24,5.58122325107213e-23,1.75157526746989e-21,4.37637194232913e-20,8.72838470714866e-19,1.39610202783405e-17,1.81043831664079e-16,1.96884447248973e-15,2.01249289872692e-14,2.50336958197682e-13,4.30447869716975e-12,8.04181824381528e-11,1.31837392944489e-09,1.75996923202247e-08,1.87433959479943e-07,1.58322114354661e-06,1.05876413103489e-05,5.60269053239343e-05,0.000234630872671463,0.000778257606540545,0.00204920565379297,0.00430703192009205,0.00732146457749325,0.0103598470346785,0.0128703966844192,0.0150256610994434,0.0170640913410301,0.0182566571403991,0.0174154528642856,0.0146451763526686,0.0118450599968092,0.0110528403179113,0.0125904637485636,0.0150330534724795,0.0168355380957841,0.0179656464193502,0.020191454278892,0.0257623620571977,0.035274959529652,0.0465348384391563,0.0560062299018257,0.0617090971686327,0.0641984704518655,0.0646244308089893,0.0628953892815339,0.0584248907411204,0.0519641525727555,0.0457801650697422,0.0419497700530892,0.0407489634770854,0.0407919889501826,0.04061958259852,0.0398183325822348,0.0385233765590603,0.0365537917334883,0.0337815070030313,0.0311590116008578,0.0307132554001923,0.0341948502602353,0.0417006002893045,0.051503626766612,0.0610623246997454,0.0682678237661681,0.0720238496444583,0.0720553115106176,0.0686800891772604,0.0629321736492026,0.0564831948301409,0.0511344711325425,0.0482907034451796,0.0483357725256555,0.0499379288344534,0.0503578003357186,0.0472997450921735,0.0407925122622187,0.0330099830366605,0.0261381944370601,0.0207590543315198,0.016424290306183,0.0131916132987443,0.0119529946320665,0.013259525133596,0.0161719323043123,0.0184948296850489,0.0182559876085955,0.0150873935080527,0.01030897262611,0.00577578880370606,0.00263410385364528,0.000971655902092556,0.000288539576396803,6.88544074686681e-05,1.32552615083347e-05,2.09283735687997e-06,2.82930543686204e-07,3.55523030915593e-08,4.52794720658616e-09,5.85517183576179e-10,7.06376243385172e-11],[6.58097159672424e-25,3.26882982382854e-23,1.28805020671902e-21,4.03060993396788e-20,1.00304916757724e-18,1.98900492593879e-17,3.1516898024788e-16,4.00859372399649e-15,4.12531413155328e-14,3.4927373675833e-13,2.53305786282938e-12,1.74252049336111e-11,1.37184809196819e-10,1.36802274152625e-09,1.48646055732836e-08,1.46621721514966e-07,1.2029230724203e-06,7.95180522353304e-06,4.18781366294848e-05,0.000175017060242868,0.000579926645824223,0.00152575151989485,0.0032031093780286,0.00543417657304166,0.00767021655694512,0.00953259375316462,0.0112631366879509,0.0132057404095015,0.0148681413096292,0.0151608488417175,0.0138664942416844,0.0123356972002238,0.0122217415445336,0.0137227289610674,0.015521750789483,0.0165441101546909,0.0175469381247868,0.0208299746066014,0.0282905413922837,0.0394918539121265,0.0515167022334296,0.0610569306950363,0.0668910616435141,0.0701019661349574,0.0719259823738694,0.0720711685511315,0.0695730128988464,0.0648721723065472,0.0602910113565022,0.0581144715492445,0.0584581660760797,0.0594824803106499,0.0596056401319268,0.0587561062795623,0.0573042454096861,0.054882457121711,0.0511128143399758,0.0470062778978051,0.0449115414053383,0.0469674998606406,0.0535835837868205,0.0631461473912238,0.0729783242542427,0.0806710509443752,0.084734576890781,0.0844018334596698,0.0795794351860564,0.0714019734126975,0.0623032051797507,0.0550001301513651,0.051311016077315,0.0514725183224818,0.0539131995549097,0.0557722533044915,0.0543634714200358,0.0487715370293827,0.0402204751222401,0.0308743030359173,0.0224313898630064,0.0158961782308442,0.0121267173923142,0.011812548039473,0.014610409114807,0.018573151580007,0.0209473878435668,0.0199301798169388,0.0157915253434412,0.0103770078969068,0.00563339306990019,0.00251466758924998,0.000919805213704068,0.0002763004382792,6.93006369981598e-05,1.51846321419653e-05,3.14878312540884e-06,6.62386911487596e-07,1.38884902174458e-07,2.66879880968466e-08,4.37178732442225e-09,5.87571820846637e-10],[1.1640565797785e-23,5.7739943286958e-22,2.27100627433684e-20,7.08910889061958e-19,1.7583837036697e-17,3.47117075176646e-16,5.46549036060723e-15,6.88567745810091e-14,6.97530598001086e-13,5.72892104142682e-12,3.87171390781464e-11,2.21185630270361e-10,1.11989868803037e-09,5.41551843087435e-09,2.74281291319497e-08,1.53735726423846e-07,9.12696429496696e-07,5.15577249277298e-06,2.53100749534599e-05,0.000102641394714073,0.000336073555309312,0.000881626323645879,0.0018577659563892,0.00319347556558418,0.0046553085672101,0.00619235286991385,0.00817399379824115,0.0109110704676331,0.0138275894099146,0.0155909383159119,0.0155137380327733,0.0145312248848571,0.0142198025898925,0.0149773046934737,0.0158403396995246,0.0162786729933937,0.0176396719260436,0.0223224671777927,0.0314311958126619,0.0432991948174172,0.0544709639072629,0.0623835470604036,0.067176525452654,0.0708251712850427,0.0746285029535294,0.0777993123084296,0.0786147837120731,0.0768086947843085,0.0743972369100791,0.0737247295419406,0.0750219704651645,0.0766973032846624,0.0778163918392682,0.0789470641304791,0.0802727842559686,0.0804017524412951,0.0779842564688102,0.0737439307414199,0.0703157887030192,0.0703889411894983,0.0749680360420349,0.0828161512574795,0.0912338061216948,0.0975206827977031,0.0999029051299063,0.0974313908243633,0.08988796545637,0.0784652364453264,0.0660821785235786,0.0562377972354081,0.0512656429356013,0.0513760555062506,0.054799252263185,0.0585774759301944,0.0596051300760207,0.0558301754217555,0.047246355899357,0.0358752325935646,0.0246507850506096,0.0161755201997,0.0120811266122036,0.0127288198142001,0.0168568034831092,0.0216507084590046,0.0239718531869906,0.0222179142233724,0.017170540562856,0.0110731993512129,0.00596270468261241,0.00268750349390013,0.00102601300759935,0.000343589093358063,0.000107953586383254,3.40680294210301e-05,1.07730541495707e-05,3.17031871728006e-06,8.05701258731139e-07,1.69333565418867e-07,2.88499608814262e-08,3.94978458046295e-09],[1.57201968976785e-22,7.78835210352955e-21,3.05846528320308e-19,9.52726903032297e-18,2.35657757064087e-16,4.63473083888215e-15,7.26057447442124e-14,9.08204327465166e-13,9.1032982227737e-12,7.35199547203092e-11,4.82822460820471e-10,2.61949344362644e-09,1.20527250207559e-08,4.88313887184014e-08,1.81337500201658e-07,6.33811713974196e-07,2.10780629120331e-06,6.76035499654515e-06,2.12835818902018e-05,6.51011198536356e-05,0.000184104293447041,0.000455854812152539,0.000961270464870015,0.00174263403072017,0.00285283469392701,0.0045346049469492,0.00725634604855494,0.0112190069539334,0.0156080510918231,0.018711011115135,0.0193886329204163,0.0183507623404062,0.0173581430803461,0.0172294812675029,0.017437859036298,0.0178495494642575,0.0200344943658011,0.0261184111604628,0.0363294392761547,0.048054198595545,0.0576917514035807,0.0636292259076739,0.0673605719769903,0.0716552249370361,0.0777018069725078,0.0840119910946203,0.0880250837863926,0.0888106405597734,0.0880613632282899,0.0881715852474538,0.0898124202176427,0.0922874124956519,0.095710628707244,0.100969252178724,0.107297867477554,0.111826033330017,0.112405393316847,0.109816298316196,0.106899727808377,0.106405438307585,0.10955252160337,0.11551188855051,0.121771847058476,0.125403162301029,0.124355100138207,0.117760165366625,0.105702619571547,0.0895597719834877,0.0724456366420577,0.0583680923714358,0.0502838480313492,0.048727576131341,0.0519585214338889,0.0569215038248798,0.060092951603698,0.0584408350054365,0.0508418553160036,0.0389700399462523,0.0265099352546846,0.0172181625224274,0.0133560386335064,0.0150985915120377,0.020526016512648,0.0261977632573337,0.0286955225656171,0.0264918701878878,0.0206127195836584,0.0135620026325585,0.00759383335992788,0.00368331931116518,0.00161484162063034,0.000684479222179055,0.000293347317927914,0.000123072129459232,4.67472629409876e-05,1.50928806595354e-05,4.00401252081525e-06,8.59398005305947e-07,1.48185233140159e-07,2.04529393423304e-08],[1.62070929814336e-21,8.02141376466043e-20,3.14573208830131e-18,9.78155260310864e-17,2.4137323047693e-15,4.73218891563462e-14,7.38205043993759e-13,9.18115294228363e-12,9.12863010050164e-11,7.28476604330951e-10,4.69460002932626e-09,2.46832416013667e-08,1.07739376305829e-07,4.01333053236386e-07,1.32269514750101e-06,3.97907235648398e-06,1.1011268629148e-05,2.76024478451157e-05,6.18066204627857e-05,0.000125112504962558,0.000238604985160427,0.000447925150895927,0.000838656992767156,0.00154984521168848,0.00281130250114644,0.00499623661219385,0.00853354713702691,0.013462668830781,0.0188170050607162,0.0227268242616348,0.0238246954322689,0.0226749855905034,0.0212155299592452,0.020731812228701,0.0211604577718417,0.0225621206855233,0.0263127542689518,0.0339639923159975,0.0450192673658266,0.0564851139257928,0.0651195618150709,0.0702303716574536,0.0741524458763254,0.079854719847494,0.08797293592497,0.0961366701550466,0.101247841527144,0.10246096234929,0.101838098824064,0.102125325567728,0.104552355330856,0.109343559507399,0.117207833397123,0.128335462770677,0.140202981312664,0.148683402562722,0.151886724024428,0.151484425068068,0.150393939588833,0.150648592929192,0.153140691394136,0.157558642744905,0.161954903387381,0.163280200509977,0.159013405386152,0.148188862891165,0.131173859653598,0.109528848150741,0.0864503733879134,0.066358411552567,0.0529943887498461,0.0475943906806322,0.0486510224660328,0.0528989127994784,0.0564258497740472,0.055784169967343,0.0494162773887761,0.0386569665490341,0.027125419699667,0.0187595797574283,0.0159959662492844,0.01893478647252,0.0253433788341909,0.0315220631926075,0.0340676260299057,0.0315983509117154,0.0251898992150576,0.0173646564571183,0.0105217603458148,0.0058274813277511,0.00313407595823733,0.00169811122357021,0.000895581005870163,0.000426549377675843,0.000172708708491202,5.75177676103064e-05,1.55140974520387e-05,3.3648996708235e-06,5.84676901975458e-07,8.11956240452864e-08],[1.27551163414869e-20,6.30740698790185e-19,2.47068393222114e-17,7.67068354717348e-16,1.88899059200747e-14,3.69345114418319e-13,5.74113894255303e-12,7.10643650019158e-11,7.02024453696104e-10,5.55149709644793e-09,3.52961892567119e-08,1.81668820360589e-07,7.6561825860793e-07,2.69271939480363e-06,8.13727885432903e-06,2.18927724465662e-05,5.38527036413541e-05,0.000121291708962208,0.000245616541977053,0.000441712086040571,0.000717102305793076,0.00110458651466477,0.00171284640554773,0.0027478658358036,0.00449415272305219,0.00726949023999337,0.0113105365666558,0.0164961053929056,0.0219609804720003,0.0261193645022422,0.0276889988588225,0.0270113241328353,0.0259035297102161,0.0259803899374704,0.0277026685243508,0.0312902779940411,0.0376738543134935,0.0475948203575797,0.0598878039862526,0.0715333800271682,0.080000852175303,0.0855314820005326,0.0909330193882201,0.098843973309483,0.108838093447441,0.11735520861576,0.121007097483357,0.119965135764927,0.117747468135408,0.118019791672008,0.122483191788846,0.131677388514537,0.145867133854035,0.163513559946175,0.180092860208025,0.190951587718232,0.195362060617384,0.196118820209603,0.19581413385692,0.1954407048081,0.195818225760229,0.197788517214375,0.200432588722551,0.200590997602306,0.194936581110486,0.181948887514389,0.161914452010934,0.136407890290786,0.108570151175173,0.0829624622934176,0.0639121773446572,0.0534601981624365,0.0505285379530246,0.0517052115224841,0.0529282048664491,0.0510921293195124,0.045088344136743,0.0361132568316473,0.027026067102168,0.0209783235392786,0.0200165690796634,0.0240877857176606,0.0308065463189069,0.0365312157948317,0.0383495170186466,0.035440047434305,0.0289959603777556,0.0212754310042167,0.0144275515776609,0.00950407991772085,0.00629134388328321,0.00406874174100743,0.00239544146796483,0.00120731239262609,0.000502745698005985,0.000170017676526386,4.63148925423309e-05,1.01202593186284e-05,1.76915847271165e-06,2.46944807360774e-07],[7.66249744478082e-20,3.78626094286061e-18,1.48164135892639e-16,4.59392948293704e-15,1.12932313020067e-13,2.20300405700836e-12,3.41394192870527e-11,4.2088341898011e-10,4.13558588068647e-09,3.24668795788375e-08,2.04323309276367e-07,1.03578794437942e-06,4.26183130016899e-06,1.44131472026433e-05,4.0902308297127e-05,0.000100421332994146,0.000220851665108957,0.000445220307613097,0.000821929589503762,0.00137050005551206,0.00206298243881929,0.00288655288666871,0.00394396197682637,0.00545309005062019,0.00763679862714678,0.010635058577226,0.0144830605593183,0.0190684149233373,0.0239602193018579,0.0282511380754633,0.0309560086264893,0.031987688859374,0.0325296216040201,0.0341336616679223,0.0377877788790217,0.0441279373842943,0.0538337864252621,0.0668040357276829,0.0810109430063519,0.0932501348656317,0.101748174990962,0.107919018034914,0.115265148754681,0.126088633662155,0.138627792120157,0.14772576908687,0.149458987462614,0.145237285404104,0.140668095539956,0.140906248010309,0.148150430851263,0.162640655080196,0.183399718088332,0.206979174313858,0.227534189302007,0.240518440436237,0.245909861293851,0.246364147996149,0.243436792233185,0.237728968758372,0.231475781137038,0.22789033494755,0.227452030841817,0.226644568485101,0.220943659837244,0.208001974349884,0.187952910745753,0.162353933131066,0.133883827627196,0.106329520983464,0.0837035905798455,0.0685615800485425,0.0605737375263772,0.0567418834175883,0.053460045020984,0.048570448893948,0.0418353067415875,0.0343271110110788,0.0278137229818549,0.0243027214677408,0.0252659280002392,0.0303976842826665,0.037033061023765,0.0415480345586934,0.0417598605866144,0.0378777936012115,0.0315941323511699,0.024894253446793,0.0192607755246128,0.0150681414448681,0.0116648313388081,0.00835876061387872,0.00519545138334327,0.0026897942985237,0.00113623551870316,0.000387739857251465,0.000106340799635444,2.33666731870573e-05,4.10448739365119e-06,5.75302867931866e-07],[3.51358590779387e-19,1.73502333357188e-17,6.78363384129538e-16,2.1009076431002e-14,5.15684513421216e-13,1.00395602343286e-11,1.55172821973232e-10,1.90644706586687e-09,1.86480085812872e-08,1.4552160412806e-07,9.08391273505351e-07,4.55254432241111e-06,1.84154085309135e-05,6.06302862035455e-05,0.000164734026841543,0.000377716886697146,0.00075444500021989,0.00135810321891588,0.00224929828336674,0.0034272231992008,0.00477977153684681,0.00618121672402445,0.00766868649618641,0.00941375564750135,0.0115055616849788,0.0139007413555167,0.0166151579614183,0.0198729008126236,0.0239617779784824,0.0287971620644595,0.0337034672601319,0.0379601145185797,0.0416064881161843,0.0455484024071297,0.0511263052731572,0.0598143837320935,0.0726537754363698,0.0889114134270339,0.105369258845101,0.118186495749346,0.126270757840896,0.132607860157985,0.141933494792838,0.156552630615657,0.173463673279857,0.185738086246322,0.188307385872082,0.182945132816758,0.176856079423801,0.176914168143489,0.186269062453552,0.204958354007134,0.230824351954048,0.259258448111003,0.284169917051508,0.301034875203363,0.30867448322436,0.307426021717579,0.297308612525224,0.280040378672674,0.261390037658367,0.248224581110055,0.242545060109568,0.239988912667289,0.234372090234886,0.222461018995498,0.204582200343359,0.182528795685182,0.158050434180313,0.132978175827995,0.109820181108114,0.0911487665679344,0.0777523295461779,0.0679308201918898,0.0593071141929693,0.0508688277380416,0.042921904674222,0.0360327069077173,0.0308751009196539,0.0287032023387998,0.0308430842490844,0.0368766108492426,0.0436504483486871,0.0471485901126392,0.0455916851946133,0.0402764919441375,0.0338304945997752,0.0283587615304722,0.0246155267967099,0.0218485429837385,0.0185558147176321,0.0139988128897603,0.00892100136570753,0.00467543376735739,0.00198885417943205,0.000682082905917119,0.000187852537045006,4.1433869134164e-05,7.30316230632352e-06,1.02680545956527e-06],[1.23002387604029e-18,6.0695779551509e-17,2.37119898319829e-15,7.33621513123563e-14,1.79835750869129e-12,3.49506526130524e-11,5.3897745738949e-10,6.60220574911907e-09,6.43294328750194e-08,4.9945504986847e-07,3.09688449284097e-06,1.53803313533598e-05,6.14252435148569e-05,0.000198424381969882,0.000523238298158059,0.00114347180970076,0.00212128347489439,0.00345251808093816,0.00509900917217536,0.00697477447273825,0.00887912011149243,0.0105861474403361,0.0120688085855272,0.0134507603581638,0.0147071209839356,0.0157094612216293,0.0166783190648805,0.0184177631422232,0.0219779825771146,0.0279199722431067,0.0357296246284839,0.0440457098882162,0.0516583132660924,0.058481229418021,0.0659584535417861,0.0766338517926547,0.0924037895618211,0.112070880484649,0.130925115880797,0.144165059892547,0.151408922777056,0.157494149380506,0.168652369014429,0.18747290221801,0.210247138577755,0.228820213663648,0.23668612468942,0.23450556370541,0.229434888063635,0.229530016734128,0.239472498425396,0.259975707829969,0.288598399338455,0.320603929462524,0.350256673267758,0.37230602090137,0.382552360378204,0.377622335228937,0.356314846183252,0.323054309932717,0.288593011420748,0.263916088308977,0.252228002626824,0.247802348945758,0.242459341882817,0.232085718414307,0.21749216767049,0.200928421305629,0.182993993424208,0.16291171070552,0.140964830700733,0.11940411524448,0.100467090912012,0.0845350108636845,0.0709746174945884,0.059642914216659,0.0505780606045474,0.043242568207919,0.0373479538112919,0.0341209672043238,0.0355229767195749,0.0414875929997001,0.0484509991898462,0.0516662326271166,0.049092258477187,0.042571342721344,0.0356732653081218,0.0310213104054342,0.0289336557816246,0.0275458859847058,0.0244409286793968,0.0188169517894274,0.0120829528238123,0.00634791065050739,0.00270272932920645,0.000927669328679336,0.00025578269456573,5.64998369457157e-05,9.97523783514894e-06,1.40489566853395e-06],[3.29967201412295e-18,1.62262654481779e-16,6.33083735258132e-15,1.95645876546704e-13,4.78980194416454e-12,9.29420788276195e-11,1.43039347356452e-09,1.74761867181269e-08,1.69708880656304e-07,1.31187372871822e-06,8.08813723242666e-06,3.98692925517663e-05,0.000157630387373998,0.000502026086611082,0.00129612954693895,0.00274013253194407,0.00482241104455508,0.00725031965230433,0.00964132363520332,0.0117468689609699,0.0134358589363038,0.0146317544842048,0.015400761796079,0.0158649172889767,0.0159265107389487,0.0154632224080273,0.014990599459896,0.0158673836256133,0.0196460848137261,0.0270910006607748,0.0375724887711554,0.0493094641735452,0.06041168044378,0.0702120126594932,0.0802668591390883,0.0939959006626784,0.113959168536482,0.138288083889504,0.160579794484747,0.174990118125051,0.181784894487549,0.187390723491064,0.199244559261961,0.220486860054096,0.247867017843134,0.273523836548158,0.290102885646216,0.295994227174076,0.296134577123196,0.29812983018965,0.307886189290813,0.327574160854122,0.355742268875228,0.388553158702189,0.420799796250047,0.445989141386051,0.456568755079524,0.445931773837373,0.412652381267427,0.364459631021169,0.31663622373496,0.283058145669112,0.267094523102384,0.261506325947186,0.256688471871589,0.248194263871908,0.237341483716504,0.226531922046923,0.215048171605821,0.199562234295062,0.178215131607196,0.153081457972799,0.128250660149658,0.10663487300962,0.0892935619017552,0.0762459984300469,0.0663691158067592,0.0575298093816003,0.0486252099832938,0.0414521303442041,0.0392888338297829,0.0430037597161099,0.049076301368549,0.0521544251095344,0.0495007592105621,0.0427123013339317,0.0357033411481903,0.0315152373614556,0.0303226466824393,0.0296283582928288,0.0265604061076007,0.0204206236563102,0.0130274124948918,0.00679283461324186,0.00287323752358212,0.000981305546020211,0.00026966284975254,5.94461403563656e-05,1.04852082106716e-05,1.47639484197812e-06],[7.40024968024454e-18,3.3624309907042e-16,1.29721444652721e-14,3.99440991349975e-13,9.75622712856286e-12,1.88923007909751e-10,2.90135146985255e-09,3.53602488755012e-08,3.42332703154992e-07,2.63608880436603e-06,1.61723171161154e-05,7.9213213100889e-05,0.000310589870187154,0.000978194975484988,0.00248618946883015,0.00513462239323096,0.00871265065846238,0.0123706990510805,0.0151253223339498,0.0165591749925837,0.0169332362782218,0.0167546623531672,0.016420093621391,0.0160257996020149,0.0153081859768788,0.0141263413237219,0.0132693596156878,0.0145046220018422,0.019531812027147,0.028780020922036,0.0410918672945832,0.0544913866363329,0.0673993726835164,0.0797049865461231,0.0935222487192045,0.112689672341316,0.139620562458163,0.17128992538969,0.19960338194442,0.217692007252955,0.22590397923041,0.231160917185258,0.241393161384677,0.260851768791766,0.288495511670549,0.318770567166404,0.34469972797198,0.3622005514274,0.372398077535085,0.380161345865434,0.39074861899803,0.407371640538661,0.430662216924931,0.459078760825582,0.488664147143444,0.512233524621406,0.520157594160314,0.504280501322481,0.463781445392637,0.408750932615627,0.356420926368559,0.320558125321997,0.303003715260549,0.295595326147727,0.289388208689855,0.281215923213006,0.272868551161649,0.265969983945225,0.258108675249725,0.24395414863526,0.220374538058676,0.189985044486704,0.159131668112326,0.133114311130819,0.1138833785058,0.100561048289418,0.0901714879829699,0.0789262282073868,0.0652601935431234,0.0519280827254879,0.0437822774480839,0.042885528580661,0.0461816013972263,0.0481672672356077,0.0455378415760948,0.0392445354106551,0.0328213217745432,0.0291618986079274,0.0282830084430232,0.0275876692154664,0.0244026297592709,0.0183874861479293,0.0114747001818078,0.00586001813541925,0.00243460140100042,0.000819572990748334,0.000222772750933819,4.8733917564225e-05,8.55468324256789e-06,1.20193626701352e-06],[4.42571407298507e-17,7.01609939207867e-16,2.15469415808127e-14,6.37925516813952e-13,1.53745144054331e-11,2.95490107897877e-10,4.51474818385115e-09,5.48011529146846e-08,5.28558839944757e-07,4.05389130344046e-06,2.47551326332988e-05,0.000120564086963231,0.000469348204184141,0.00146461497162829,0.00367700577298408,0.00746461960494577,0.012348366124106,0.0168600221999719,0.0194238698582643,0.0195869079502575,0.0182473581396202,0.0167263881421169,0.0157930376045022,0.0153487094005649,0.0147700320422179,0.0138450955796049,0.0136779564134,0.0164104992172673,0.0236547864213936,0.0350686252537732,0.0485648188509412,0.0620666485410249,0.0751421215175662,0.0893614101437625,0.107934024621471,0.13468406170424,0.171051633749547,0.212542904452416,0.249710420604211,0.274782414053272,0.287298909247975,0.293208467759647,0.300225997255968,0.314435551225821,0.338436305342057,0.370123676620257,0.403665455249159,0.433171425298705,0.456018414041054,0.472988718705736,0.486342661554069,0.498740096796451,0.513212102475877,0.532001924210108,0.553825115470124,0.572102129574694,0.576756235247283,0.559580647398074,0.520523157950937,0.470125532172581,0.424039736884718,0.392430834588203,0.374186677470464,0.361648183030395,0.349389407439543,0.337374067413516,0.327640893596105,0.319923853871937,0.30989107934752,0.291317214490684,0.261392084263303,0.22433250973074,0.188689297702705,0.161002107149832,0.142497921995265,0.130215964060796,0.119149026144924,0.104560554971965,0.0852735395543479,0.0652691272419054,0.0506287798180097,0.0441965533924362,0.0433497150768573,0.0428177600582573,0.0392576265702217,0.0332443625011316,0.0276926222144309,0.0248274057270346,0.0242241365774285,0.0233593370175838,0.0201030145402747,0.0146055181690235,0.00875951355224517,0.0043025145781636,0.00172575551667187,0.000564256289946158,0.000150110601760554,3.24305772691942e-05,5.68161924641055e-06,8.06890507244107e-07],[1.39237124977142e-15,7.10830021656263e-15,5.49448171838906e-14,9.69907665814471e-13,2.05614508829886e-11,3.74957906524059e-10,5.55995662251599e-09,6.62456919879152e-08,6.31216847298393e-07,4.79934307730086e-06,2.9100237351479e-05,0.000140778656593799,0.00054411759516723,0.00168377296567878,0.00418385128314604,0.0083814853737311,0.0136188813471086,0.0181340612519977,0.0201750001878677,0.0194813262278273,0.0174846438477611,0.0159892984057301,0.0157785401029586,0.0163235773732818,0.0166225944442914,0.0165837972655086,0.0178482633857815,0.0229500445823233,0.0331790467661151,0.0471308335407791,0.0616857975019535,0.0748604089220457,0.0877827883015312,0.104080102408361,0.128073644783027,0.163153329821507,0.209343491427531,0.260792697503753,0.307354510881003,0.340808721945241,0.359596987620209,0.368083330286644,0.373596164274415,0.384242666892231,0.405952111870638,0.438992537006059,0.477925032555106,0.515829106177136,0.548241419688275,0.573221538765802,0.589839530998807,0.599029861558206,0.605248282225015,0.614257395863971,0.627703184605397,0.640270378982458,0.642566854683461,0.627554249088526,0.596185717572563,0.557843583422634,0.523675570538968,0.497975751737604,0.476780958729325,0.455015470599516,0.432698706338713,0.413162631283012,0.397671032360098,0.383286662580951,0.364261935058458,0.335189686726558,0.295518856552953,0.251964521359807,0.21444788709789,0.188677932564073,0.173159777876332,0.162027544890453,0.148893717733278,0.129614798064845,0.104642193332146,0.0792152843540656,0.0596886927502987,0.0487007138527138,0.043663415624341,0.0397246677649538,0.0340407977368671,0.0273912921391936,0.0223456289017486,0.0203395363760679,0.0202493966604543,0.0194604877639176,0.0163027333890151,0.0113593691575447,0.00648386481606358,0.00302743976248492,0.00116162160864586,0.000369084329772515,9.80357763522814e-05,2.19932540594784e-05,4.20507549351846e-06,6.88670632662912e-07],[4.41533840490845e-14,1.99409454906807e-13,7.82243287974697e-13,3.89351499200854e-12,3.91765075810297e-11,5.31641790973252e-10,6.68172755240901e-09,7.13629645044501e-08,6.3274054704956e-07,4.59305063141962e-06,2.70303934272894e-05,0.000128181222067808,0.000488291717131928,0.0014930962508371,0.0036687836869388,0.00726533473515205,0.0116620892692098,0.01535165712914,0.0170041086446263,0.0167535978851919,0.0161804583267338,0.0168421052795188,0.0188960255821434,0.0211589906742871,0.0225214882492599,0.0235635285227468,0.0268519753899699,0.0351891417381467,0.0490475170930887,0.065669714652582,0.0811984322769606,0.0943242829716961,0.107963790072082,0.127414067437875,0.157385172620665,0.200224261434502,0.254385917306927,0.313093679681266,0.366357871495081,0.406473827944981,0.431729982507915,0.445762851641422,0.455765734050898,0.47076862077495,0.497524517227358,0.535741246437005,0.578476699233879,0.618084578104627,0.650985853695789,0.676619321419064,0.694313040528997,0.704098329989671,0.709613587158114,0.716391773695429,0.725974347356489,0.733329301677414,0.730920182553163,0.715179406779053,0.689653886344616,0.662115257708444,0.637543686376595,0.613890860055383,0.586079394414886,0.553611124557366,0.521746901777113,0.495018390891433,0.472080387199731,0.447278224036175,0.414888268996359,0.372250478920805,0.322451047161247,0.274660324339824,0.238624760562705,0.217164786458271,0.204779504012218,0.192851045858257,0.17502435113846,0.149540180369005,0.119466510333612,0.0908950927280124,0.0691957680799117,0.0557176012412495,0.047497298848557,0.0402036391513445,0.0318238868803479,0.0237545847253636,0.0185849160627973,0.017150990092969,0.0176140242179396,0.0170960420073846,0.0141493672447665,0.00962731717108552,0.00536347636496795,0.00247958051574928,0.000976730587397613,0.000338851379862417,0.000106037642575766,2.9863586106998e-05,7.36696223161236e-06,1.53831590591339e-06],[1.08443156960414e-12,4.83411456499231e-12,1.73507650482318e-11,5.49800253760849e-11,2.21506624870632e-10,1.60098252668109e-09,1.42863974317302e-08,1.1591129298107e-07,8.05856519013943e-07,4.78474326267169e-06,2.41883765506247e-05,0.000103096297744783,0.000365721336173263,0.00106739825247397,0.00254400570887959,0.00494066773098732,0.00786130346949504,0.0104542775367545,0.0122143800269754,0.0137843466001203,0.0165999448045096,0.0213954450199207,0.0271126945145564,0.0316270333700887,0.0339520322600532,0.0359446233073494,0.041542276401029,0.0536484228897546,0.0713279725845985,0.0901841470894913,0.106088819936277,0.119191396115286,0.13442242758862,0.158083497499561,0.194215018066694,0.243417432978808,0.302619505311028,0.364812945193825,0.42120198294153,0.465884799232873,0.498544889052795,0.523268406307762,0.546632538799496,0.57601709761526,0.615693208728799,0.662465918829029,0.706902283277598,0.740848521994418,0.763673378933462,0.780593120499285,0.796281098915398,0.812160053622277,0.828355546262588,0.844053717941742,0.855186548514458,0.855166038352095,0.840323848263349,0.814269345650409,0.785820006285076,0.761610799301593,0.740064206740897,0.713622700348675,0.678000226163715,0.637748352611346,0.601002278131052,0.570169729724298,0.539898653123976,0.503029479259283,0.45619528500045,0.401134062322808,0.344472778783695,0.296089785147301,0.263473362343884,0.245624519368345,0.233644093772464,0.217655903746815,0.192885119712931,0.160899900467709,0.127342743141939,0.098307440394227,0.077153098659226,0.0632794223190003,0.0531802975934195,0.0431780104211087,0.0322675210931664,0.0225879647156983,0.0168958136363567,0.015637367593536,0.0164322075479158,0.0161593229004457,0.0134642374472145,0.00931020278156544,0.00544108786313648,0.00279862605399208,0.00132074599464293,0.000577754458667088,0.000227015198576636,7.64447936336564e-05,2.12592102463875e-05,4.77868857030343e-06],[2.03583259310696e-11,9.05221234653334e-11,3.19585671611386e-10,9.15870510147939e-10,2.41349104730206e-09,8.76230264614494e-09,5.34473588599035e-08,3.58147682794421e-07,2.05881991132303e-06,9.71405388021127e-06,3.78133994935546e-05,0.000123327816962273,0.000342437728085545,0.000818013958170309,0.00168516585276904,0.0029908926079075,0.0046149086511345,0.00644494169406338,0.0088750779633064,0.0131030673201585,0.0204284752402619,0.0306627392676001,0.0412426886112107,0.0487182233106874,0.0520357396208347,0.0544831528554469,0.0616461061079838,0.0766373021096419,0.0971041534805706,0.117177624881258,0.132873393410153,0.14611089130754,0.163616512257884,0.191944308435859,0.233678208391393,0.287451784505733,0.349221564052037,0.412732838626806,0.471339468326796,0.521816940498856,0.566044287018714,0.608509261371078,0.653278780138785,0.702984211240984,0.757456955107394,0.811086252518609,0.85350534578347,0.876850390538556,0.883839154181566,0.887072698437819,0.899347090408512,0.925065798458094,0.959047422118909,0.989704174075248,1.0036020877828,0.992075882190291,0.957526662566099,0.91313412715388,0.873936802648639,0.845681024372005,0.821405631937445,0.790077636085455,0.749030816910711,0.705980555268506,0.668480481220155,0.634520223710522,0.59520543644726,0.544402119713008,0.483712230347001,0.420066320260716,0.361816052235971,0.316278526070043,0.286559076005694,0.268541111291225,0.252608512983405,0.230093118284716,0.198655119627405,0.162486180362737,0.128432088929177,0.101506101601068,0.0826796200373975,0.0695335503500421,0.0583193030639457,0.0462807903642079,0.033496939053591,0.0226995178180029,0.0166531151951495,0.0154628037046342,0.016414290041998,0.0163180420749893,0.0139427475865773,0.010258412752295,0.0067726905696507,0.00417507371749744,0.00239863882523615,0.00122909320562412,0.000534032258767942,0.000190039703611733,5.43839285877967e-05,1.24299296614213e-05],[2.9172892590072e-10,1.29641029682379e-09,4.55992774563563e-09,1.27616549996673e-08,2.93698198910417e-08,6.6111306798029e-08,2.25906097835716e-07,1.20327171239755e-06,6.41924461224513e-06,2.8413500292265e-05,0.000100851791243434,0.00028675968270501,0.000658130304044712,0.00123722613413888,0.00195606461734631,0.00272848426337811,0.00365427709493152,0.00528213593544515,0.00881788543208576,0.0159854977822082,0.0280443915513632,0.0440544792006791,0.0600145921226681,0.0709534985367554,0.0753189738392033,0.0773705944392296,0.0841556589457213,0.0993895786420623,0.120318813773867,0.140719032885194,0.157141147912626,0.172572567234056,0.194198930846483,0.227727296919939,0.274090532477635,0.330808632650736,0.394284779265701,0.460091731065169,0.523848140858804,0.58442841744097,0.645174849781706,0.709900172838133,0.778356787385126,0.846819306134936,0.911125223305594,0.966110045735735,1.00360156280416,1.01694937975056,1.01065682049098,1.0023290394755,1.01129653841719,1.04450591627943,1.09177410313118,1.13175515630059,1.14372308362213,1.1193636978044,1.06773425074117,1.00894296511344,0.960318196722001,0.925445345458045,0.894748104147399,0.857279914309625,0.812309757180239,0.767831370667405,0.728232808134301,0.687277246608208,0.63492956070262,0.568703183010961,0.496387479409395,0.429124362256713,0.374114571072625,0.333086187174048,0.303872927355535,0.281270828421695,0.258248761364873,0.229395461931336,0.194436638691278,0.158188968110878,0.126718036369798,0.103138045783806,0.0864503339787345,0.0733982969070368,0.0608390567107966,0.047288094464247,0.0336955497246565,0.0228479011359057,0.0170942289448005,0.0161547170444827,0.0172123729940476,0.0172611853755122,0.0153061401859315,0.0122647002321861,0.00924849228638974,0.00658086027831342,0.00422335494549928,0.00231274342897753,0.00103996909489312,0.000376406695455504,0.000108872426732936,2.53538983615737e-05],[3.19003664491935e-09,1.41742669483558e-08,4.98126355004577e-08,1.38629297502959e-07,3.08000509028945e-07,5.7417597323235e-07,1.13928899517048e-06,3.72215300182883e-06,1.71326775551461e-05,7.3509283371155e-05,0.000257060050612625,0.000715863888698138,0.00158520717429386,0.00280591265890936,0.00403294617338682,0.00492090172177181,0.00570769316173898,0.00758165924372917,0.0124996828511249,0.0225439315692501,0.0387671710320052,0.0595421952271454,0.0798226566672266,0.0935648458794572,0.0986895754936018,0.0997038901358731,0.104309264441348,0.11700663131147,0.136153099079249,0.156944897949664,0.176926268197251,0.198766786035872,0.227913747094205,0.267813495074435,0.318012523030909,0.376608199904781,0.442430095279968,0.513712260656219,0.587228208753641,0.661521007309239,0.739249522811345,0.822834076057091,0.908426537746713,0.987627772642367,1.05467831311035,1.10760062905433,1.14241318471055,1.15343280555794,1.14379761733196,1.13111043319865,1.13669667058592,1.16834441982139,1.2133413249875,1.24686871422522,1.24857117107923,1.21535151256205,1.16133531918261,1.10590625583792,1.06026829132277,1.022597661142,0.98345771303916,0.936081467122491,0.882795385810255,0.830765474723043,0.781338647501416,0.726555519263779,0.658155924950549,0.578298268584925,0.499342380485985,0.433495134294303,0.384138189089893,0.346788566172877,0.315528477875802,0.286472989225435,0.256863251003944,0.224558373272362,0.189866599427923,0.156335652090044,0.128108578869419,0.106497784541673,0.0896007332595717,0.0746829623633048,0.0601353013246589,0.0457937267420381,0.0327659603178122,0.0230272648093565,0.018076695074917,0.017348527857713,0.0182602075912365,0.0182589287565941,0.0166765659121839,0.0143302963469973,0.0118454562878721,0.0091242732578155,0.00615750081308171,0.00346240562060905,0.00157771388689439,0.000576378184445068,0.000170091286297864,4.29639709545533e-05],[2.66172854912172e-08,1.18264681468507e-07,4.15532838941479e-07,1.15490173557767e-06,2.54404189679831e-06,4.49805430554829e-06,6.88599615790294e-06,1.25069614832263e-05,3.90160606967325e-05,0.000152336208360406,0.000525154815211981,0.00146022951659561,0.00322981656722076,0.00569412242519259,0.00810327988531074,0.0096716913411293,0.0107032598241561,0.0130821578505858,0.0194826842223387,0.0320212113263577,0.0510832914436224,0.0742664358689373,0.0961729929260039,0.110875695283333,0.116453611434741,0.117115187845917,0.119990744802423,0.129832057293177,0.146876144684952,0.168977433537065,0.195058916240328,0.226546182428433,0.265667864715883,0.312769488481884,0.366395257868454,0.426488043970312,0.495609653168461,0.574998911339271,0.661128576807957,0.749172176557465,0.838397527277426,0.929884806910146,1.01957062878788,1.09902523357478,1.16409746870429,1.21691848888136,1.25712481680941,1.27821446159303,1.27835769204787,1.270107666252,1.27242650535862,1.29277121224895,1.31919713108081,1.33052089738519,1.31479862717163,1.27875242777717,1.23960911655601,1.20862036416562,1.18290369295776,1.15110758852049,1.10415264724746,1.04150629455935,0.970496540017052,0.899561860840732,0.830034723376438,0.755511336249754,0.671247043868595,0.58285442000014,0.50342536056823,0.442170114621441,0.397385870009093,0.360635426408278,0.325663739157258,0.291546026062584,0.258875660859453,0.226635254107664,0.193977719512878,0.162598165193926,0.135180151896002,0.112278201162268,0.0922638766865627,0.0738625912970558,0.0573125100341264,0.0432753714497423,0.0320534654134772,0.024052208716311,0.0197682756361107,0.018669859328407,0.0188071662917211,0.0182785782330131,0.0167322450036061,0.0148466402702447,0.0128250936723412,0.0102360567386413,0.00705607609875383,0.0040135119322577,0.00184560428892112,0.000689472725087306,0.000223066576855534,7.77145146398661e-05],[1.69464042677149e-07,7.52949118781674e-07,2.64542113681208e-06,7.35016343412709e-06,1.61577516564374e-05,2.81910706557063e-05,3.98342628105903e-05,5.11910068457677e-05,8.87083417793608e-05,0.000260193634948532,0.000847156501792981,0.0023425694819913,0.00519719343364202,0.00920516048679037,0.0131670436560715,0.0157754750851551,0.0173457487016973,0.0204189952661245,0.0282273006761852,0.0425492897219325,0.0627114976961506,0.0855931367744421,0.106296764604758,0.120355148084976,0.126919709511803,0.129707017651207,0.134253901176528,0.14449355928424,0.161829336419265,0.186382736481442,0.21837916652921,0.258331937374612,0.305973591064068,0.359401000397492,0.416607126370818,0.479027028428686,0.552145415464294,0.63966521750166,0.737354137187518,0.83586896927089,0.92946319047545,1.01787350784591,1.0999385399416,1.17180017279099,1.23361872416525,1.29116888131265,1.34573356432843,1.38798500052239,1.40872285920896,1.41253878788397,1.41407709878098,1.42079487725281,1.42381605951405,1.40855932447353,1.37392814253495,1.33761638673492,1.31968934012972,1.32208996141921,1.3261466391239,1.30853826235258,1.25757755595361,1.17709623470474,1.08039062286138,0.980740959326876,0.883533026770089,0.786463806434645,0.688429535744047,0.596149879100858,0.519634773687562,0.462294850619749,0.417903908122867,0.377536109697198,0.337757659832486,0.300795824947519,0.268230794895651,0.237686810037081,0.206307443558371,0.174611640206794,0.145029307869756,0.11836482491262,0.0938461841170333,0.0717690311209702,0.0538660805933754,0.0409992248320875,0.0321124535552535,0.0258038820240313,0.0216542828560951,0.0194476597595342,0.0181515860388795,0.0166100949874159,0.014694055835967,0.0129052970200987,0.0112000243335132,0.00901330913646965,0.00625649257039873,0.00358781659856528,0.00169111153301078,0.000700905579432467,0.000322018479968861,0.000207825950808078],[8.23257367907312e-07,3.65782491709898e-06,1.28512984703684e-05,3.57039174499471e-05,7.84479953558765e-05,0.000136423636555824,0.000188755495048155,0.000214786170677299,0.000239875685238838,0.000411728110108801,0.00110608382999113,0.00296438006260289,0.00658083177093064,0.0117370431354817,0.0169632900042557,0.0206184852064041,0.0230155343317289,0.0270625184839473,0.0361549949859758,0.0514967002416365,0.0714351536836019,0.0925442415170197,0.111036623322403,0.124447909699166,0.133310933005866,0.141010233779409,0.15147655718816,0.167178886670401,0.18908330942775,0.217663416412219,0.253571593139879,0.297442756092877,0.349068017869089,0.406869796448966,0.469061053016453,0.536714127345556,0.615072810976487,0.708559233759446,0.813325789872348,0.917861538136674,1.0124042756089,1.09470845366907,1.16629818612546,1.22909850867288,1.28865355636536,1.35386394056816,1.42645272458589,1.49382140049553,1.53953511743635,1.56026469373105,1.56665232488952,1.56705274188184,1.55591816647051,1.52311042596543,1.47397929944062,1.43374489890688,1.42656721132448,1.45119176431141,1.47965378218217,1.4783710794702,1.42915285887492,1.33486648313183,1.2125183860084,1.08163744624987,0.954301155976692,0.833933191258148,0.722848435284081,0.627121482917174,0.551761645154133,0.494023205834562,0.444895996142159,0.397373253396375,0.351825418682612,0.312554276743211,0.280317141916069,0.250526089243072,0.218786784133365,0.185360755489229,0.152950776190681,0.122649399649296,0.0943113484921231,0.0693817398554967,0.0506148733881299,0.0388875271786342,0.0320011637792401,0.0270313728411695,0.0227060808928083,0.0190886310309515,0.0161158511041117,0.0134231428808464,0.011027071059912,0.00919509291515142,0.00775301249742521,0.00617005549073718,0.00428873321389929,0.00252200469774221,0.00133519657231256,0.000809411290068908,0.00069214120734363,0.000673394719539561],[3.05167033277534e-06,1.35589080354307e-05,4.7637346711147e-05,0.000132345205441764,0.000290750311098545,0.00050521119816314,0.000695278020813785,0.000764656952812119,0.000710727370444928,0.000726498371201065,0.0012627944100235,0.0030143154632646,0.00661188497720069,0.0118999378174517,0.0175115454854013,0.0219054454336016,0.0254170744185401,0.030814887130116,0.0411232812736509,0.0570153295365798,0.0765086451534,0.096522171778675,0.114334828181509,0.128674113259943,0.140760540901838,0.154098003860146,0.172329977326803,0.197069775510871,0.227710929945375,0.262934912768465,0.30237084868721,0.347247385486826,0.399768087488469,0.461473421246609,0.531855324246903,0.609655387196299,0.696010255592821,0.793592629239192,0.900544810583924,1.00778512237291,1.10484114795173,1.18662584539702,1.2538904115401,1.31169555947212,1.37025219598907,1.44171087661725,1.52876025792117,1.61712806626515,1.68561477655889,1.72490390837987,1.7422356834394,1.74660788231473,1.73472059227797,1.69736923717723,1.63967794633181,1.58825463264899,1.57182911737186,1.59452258667193,1.62998935106636,1.64010962242918,1.5982170668793,1.49999119483975,1.36057653702002,1.20322161089224,1.04695274916121,0.902374764643737,0.776057866597064,0.673232743693345,0.594033943367329,0.530944294710049,0.473787655137304,0.41774643611378,0.365764037863374,0.322839360267018,0.288725498953996,0.25762631159761,0.22466979047857,0.190087627815186,0.156375473843477,0.124332458293484,0.0939845163847048,0.0674510319631485,0.0481257706380504,0.0370147383519211,0.0313909047121313,0.0273514338633825,0.0228303262311473,0.0179456915209547,0.0134667668932475,0.00981204297080162,0.00712054906569279,0.00537081003236822,0.00424653981111233,0.00329100433464939,0.00232502198559455,0.00155049749499464,0.0012354903881891,0.00139490108068993,0.00174545373466432,0.0019083793737735],[8.63144405013926e-06,3.83504554610694e-05,0.00013473892971993,0.00037432751004449,0.000822337778211081,0.00142860854270689,0.00196337737904504,0.00213994387678856,0.00188014137522114,0.00146836781722656,0.00147885901326125,0.00260907661835473,0.00542431256222086,0.00988686776840617,0.0150805434638709,0.0199682716180022,0.024887119195878,0.0319331538995617,0.0433362142627675,0.0595964840083488,0.0793780850465394,0.100539363308073,0.120723836629059,0.138096018673565,0.153281400678357,0.170442329340187,0.194839896973952,0.228748812621937,0.270082636880491,0.314784971385869,0.360356743635474,0.408051875067671,0.462859431277176,0.530548462581125,0.612783567584595,0.705552327877998,0.803940170785817,0.906894269757444,1.01493990087655,1.12470344432602,1.22825780253165,1.31746449219465,1.38870067771779,1.44638305688686,1.50388477914855,1.57720038820996,1.67163536916928,1.77366559295176,1.85999798546726,1.91664380129027,1.94657662142567,1.95800911343181,1.94971191595775,1.91309257937188,1.84961521441476,1.78177323889612,1.74082694151967,1.74100562105919,1.76599054346839,1.77939772403429,1.74706687372388,1.65384796377446,1.50749778790564,1.33066438841266,1.14812867203021,0.978941775975882,0.835326918508653,0.722298702606671,0.636036385097146,0.565710803533077,0.500533693156211,0.436711464525842,0.378021256428524,0.329600208745904,0.291300793820947,0.25766349700671,0.223816637395619,0.189281275495366,0.155642088297096,0.123354859736304,0.0927391646664969,0.0662519244237114,0.0473098721769011,0.0367998047465104,0.0318245910927821,0.0280984217215819,0.0231234621480915,0.0170695566407205,0.0113458038415555,0.00698930165287011,0.00420421827912183,0.00266655520781229,0.00187442131403335,0.00140686784234552,0.00111882261545645,0.00114937428472042,0.00170140787051567,0.00273170137166576,0.00379044463694021,0.0042409930812954],[1.86282987539474e-05,8.27675940634664e-05,0.000290792361281689,0.000807870063110751,0.00177475127124063,0.0030830462386372,0.00423570006148893,0.00460608143115725,0.00398594897595801,0.00284090054233219,0.00200782213940702,0.00225274864929566,0.00406064478259917,0.00752210755487633,0.0122783411488578,0.0178840125240226,0.0245276928707724,0.0332837753305705,0.0454901394712139,0.0620092144025158,0.0829934933254265,0.107478135342258,0.132546137021232,0.154272071798774,0.17181407491356,0.190407579473867,0.218077086358441,0.258830716477151,0.309955003472464,0.365359455656187,0.420537488101308,0.475781772582929,0.537085758157062,0.613117544834515,0.708076435857331,0.817148583119246,0.931044701386367,1.04455559763504,1.1586756157013,1.2747469329794,1.38821592139726,1.4888664767238,1.56807085583325,1.62775929903884,1.68321140199119,1.75465685534704,1.85161623154546,1.96304052182536,2.06429248722932,2.13565877599236,2.17361945675437,2.18460793101864,2.17143606175699,2.12948092463525,2.05769127224539,1.97204341162231,1.90287864579772,1.8731576148564,1.87803169622838,1.88602826434415,1.85870804701324,1.77141354886177,1.62308230121193,1.43302519185703,1.22990033408603,1.04058927252844,0.882793692449778,0.761540371037924,0.669983724897389,0.594791632778188,0.524204578707019,0.454306582643712,0.389070631020705,0.334322941312516,0.29128643030576,0.255633267357833,0.221999357086645,0.188075065381021,0.154248523980116,0.121496787326623,0.0912835868577962,0.0662690520421123,0.0490306746295256,0.0395878627906403,0.0347743052480036,0.0304432572649845,0.0243413418869412,0.0169883832466087,0.0102360415164162,0.00539972525305541,0.00260806500258682,0.00127121657052838,0.000722420971149176,0.000547097298053929,0.0006617813546387,0.00125758793310761,0.00258142357831605,0.00454311652037086,0.00643243169706111,0.00722712325956523],[3.06765941864788e-05,0.000136299651147202,0.000478870809898544,0.00133038970706454,0.00292266424944034,0.00507725023013979,0.00697548550236242,0.00758342044783611,0.0065454367673126,0.0045754271574926,0.00289777688100012,0.00247483790247902,0.00378393974138703,0.00699696052461208,0.0121158192138591,0.0190146049112311,0.0275437063545267,0.0377906547412611,0.0505042549135474,0.0673388830885583,0.090118409493883,0.118670269481113,0.148827159721177,0.174324817850786,0.193272006592837,0.212320078677354,0.241927358951519,0.287441613558966,0.34614260859713,0.411558011169277,0.478480088041344,0.545613617100041,0.617205704508237,0.70185951620041,0.80600308511617,0.927452923292293,1.05710474532934,1.1869322158348,1.31506099753774,1.44277634043179,1.56705323404106,1.67754214980852,1.76341855733153,1.82492092634062,1.87822845107583,1.94715743655802,2.04610897631987,2.16729548775706,2.28403159514472,2.36857386011701,2.40870464350619,2.40889762796211,2.37820289606834,2.31945344682681,2.23234185068081,2.12759723064079,2.03252735112718,1.97401593662175,1.95442509580628,1.946981123686,1.91331141378667,1.82500244674998,1.67558095686276,1.48076356342678,1.26994367259343,1.07344997683037,0.91121165330936,0.787927797933386,0.695416825186577,0.619089212085431,0.546110646699172,0.472102913985996,0.401563410888695,0.341676467846955,0.295411087349041,0.259384023555435,0.227041945761311,0.193564198657333,0.158241681194623,0.123472583273949,0.0926982110406092,0.0688958490478405,0.0533552365533979,0.0447266554355509,0.0394186078852527,0.0337207627965895,0.0260752685515638,0.0174925750117984,0.0099972010528048,0.00485190361622793,0.00202585709747878,0.000766875890083143,0.000320691874875193,0.000269228397936502,0.000569752596174513,0.00147395002759985,0.00328602318830077,0.00588672436327417,0.00836521740630764,0.00940567387136758],[3.85467059387238e-05,0.000171268529319506,0.000601736998855049,0.00167177900012695,0.0036728613678146,0.00638138330155789,0.00877043756273289,0.00954560220385983,0.00827205385573567,0.00587163425311347,0.00391587889031363,0.00362287401210671,0.00553307056698334,0.00974949103886018,0.0161852146154118,0.0245941163702405,0.0345293395314594,0.0456943779010247,0.0589160468404482,0.0767319074196073,0.101924036501168,0.134056807634788,0.167352743371887,0.194249862707001,0.213440249789901,0.233411651824411,0.265721529073278,0.315524505354466,0.38011874394521,0.454246824414645,0.533610778268388,0.615250969019977,0.69939373404312,0.791536528209754,0.899306206313735,1.02582609054633,1.16684262294005,1.3139781308203,1.46026471325993,1.60219437924065,1.73576435432838,1.8523210278957,1.94238423168102,2.00590989301475,2.05855005225057,2.12579040308215,2.22649704053247,2.35691012135862,2.48876800550418,2.58581817468214,2.62624120430029,2.61178297820515,2.55728713409006,2.47377558279783,2.36458283976288,2.23857398076977,2.11991698885455,2.03463616053187,1.98685667549733,1.95347515270332,1.90075356261168,1.80359223452291,1.65543897712475,1.46916252176718,1.27042008054074,1.085643371353,0.931479370239198,0.811723029758715,0.719762446106456,0.642688642088793,0.568075460089854,0.491631226060392,0.418421846145859,0.356390522324306,0.309224079360225,0.273808855139204,0.242564643477473,0.208786167495253,0.171058221623107,0.133108286299584,0.100112310758922,0.0754249448979119,0.0594853474985358,0.0500772634178721,0.0434683196390237,0.0363836793492313,0.0277001068237938,0.0184974432556473,0.0106175559986694,0.00517871945672538,0.00213376822967446,0.000748557412265485,0.000254644761010089,0.000201059392686601,0.000517176743891506,0.00143589415032191,0.00325090535464881,0.00584219331403649,0.00830725009809669,0.00934170897021448],[3.6959510665694e-05,0.000164222250728066,0.000577022463778015,0.00160335741571937,0.00352367661283837,0.00612663452120251,0.00843538687707641,0.00922719936292529,0.00812987154114972,0.00613232722384583,0.0049389831622681,0.00595311570660778,0.00974914455343325,0.0160704503162998,0.0241708362884574,0.0333486203628426,0.0433268591676749,0.0545282188510417,0.0686659653825948,0.0888850044170141,0.117682913141123,0.153100131055824,0.187613443245035,0.213703791980534,0.232294878292008,0.253936434629186,0.289894273882677,0.343752347210414,0.412837244714413,0.494215834083041,0.585562464208048,0.682431172901064,0.779997195472462,0.878745051612486,0.985995638940727,1.11054458289807,1.25529945504633,1.41402987560995,1.57541182081424,1.73011817621316,1.87223703621582,1.99517002868194,2.09149139169026,2.16036075756783,2.21485576515893,2.27964490133143,2.37678145558829,2.50762616032711,2.64553604217223,2.7492234572585,2.78873784671927,2.76157947308799,2.68530770352162,2.577505504176,2.44663535650915,2.30221699909754,2.16504726088392,2.05675733009177,1.97992262361914,1.9152533648201,1.83719707365662,1.72879113887946,1.58714064886346,1.42281216967012,1.25404915334817,1.09715475172291,0.960574008848797,0.8462490290701,0.751611288971657,0.669150256846152,0.589961142601301,0.511213720602654,0.437892767174998,0.376728900581835,0.330112893526978,0.294463760630322,0.262308610869535,0.22704010165149,0.187379826914456,0.147322499854654,0.112117290270462,0.0849376031161583,0.0662183457384168,0.0541716529677906,0.0456808164341724,0.0377972607191321,0.0291361857311639,0.0201291679559822,0.0121341082576312,0.00625917245134837,0.00272468667161263,0.000997565119413316,0.00032868542100568,0.000186329863114319,0.000397921550753006,0.00108845242722056,0.00246348435308517,0.00442754965852591,0.00629583707535893,0.00707982325125509],[2.70468322408676e-05,0.000120201578803788,0.000422523701050891,0.0011750586481855,0.00258703516061602,0.00451554479982162,0.00627236579054091,0.00701274947952846,0.00655632780567001,0.0058107755039014,0.00635728047156414,0.00961393191787699,0.0160474575433296,0.0247430467595223,0.0339261484201143,0.0424598936843737,0.050960458578924,0.0615798505789078,0.0773314839281026,0.101393965065671,0.134965598171139,0.17401107090574,0.209603887197253,0.235082107199221,0.253904889489427,0.277948939052865,0.317117130505087,0.373182111393359,0.444225337735849,0.530426286986762,0.631743553762874,0.742389494388863,0.852603634769096,0.957411351806066,1.06248806607516,1.18073481016559,1.32175303658203,1.48296313204228,1.65167598706446,1.81562657706363,1.96817911500322,2.10372251906606,2.21443042212179,2.29623748732831,2.35745900254172,2.41920498514854,2.50409402598782,2.61876841234998,2.74277213298987,2.8367106652752,2.86734415520253,2.82794030055935,2.73548629443986,2.61129921561187,2.46830313149928,2.31656300855274,2.17211999265088,2.05024949392614,1.95124221578134,1.86021759809518,1.76055443694793,1.64403434898407,1.51230324665956,1.37436872506681,1.24079112552904,1.11646990084952,1.00004659143507,0.890323244214161,0.788693468611026,0.694904625919053,0.60642853687552,0.523529500129423,0.45054611289307,0.391240034256944,0.34511966862674,0.307610851493653,0.272411223826042,0.235033939055656,0.195384499961877,0.156646503812922,0.12207552798092,0.0935412589890772,0.0718639623769708,0.0567272217501073,0.0463456552966723,0.0381612125696755,0.0301821913638639,0.0218478307221304,0.0139283287032862,0.00761696675989003,0.00352912832543897,0.00139733961942703,0.000502623885561197,0.000225395512270778,0.000277111138805155,0.000649629572179859,0.00143361216838911,0.00256430244751525,0.00364231118005324,0.00409464216488173],[1.51360232665532e-05,6.73413328911938e-05,0.000237262898826231,0.000663009759582759,0.00147420620579301,0.00262668222007928,0.00381034198273076,0.0046685321170695,0.00524524959225739,0.00624680968250341,0.00888819097399612,0.0143512558516834,0.0228508551463061,0.0328542386694213,0.0418324775186087,0.0486893844089791,0.055393683445937,0.0659033024669187,0.0840254584701118,0.112215014767031,0.150143566047574,0.192513072616146,0.230309221102784,0.258133414326616,0.280617823068181,0.308776272152884,0.350074279155834,0.405263160685841,0.474640782197713,0.562164329900624,0.669942064483331,0.790985245401596,0.91148768011298,1.0217951521412,1.12530207449012,1.23672750647425,1.37000970799157,1.52611593456189,1.69386873388278,1.86200588724699,2.02536680511729,2.17881906312587,2.31235705000057,2.41713376074832,2.49470988146109,2.55876729281517,2.62777138681609,2.71172243744879,2.79992061346771,2.86270759058544,2.87109084197553,2.81695419640969,2.71436224934427,2.58413007270387,2.44074218228412,2.29366346592885,2.15387300491337,2.03055411711405,1.92214721230348,1.81735758176006,1.70575300073707,1.58490488005363,1.46010356121887,1.34042937150435,1.23201796214021,1.13199342111881,1.03132714485853,0.924902800806694,0.815600899529903,0.709007065698343,0.609336726867811,0.520569563452755,0.446413386656001,0.387651521590323,0.341143680098519,0.301411752346045,0.263363353857535,0.225011223674951,0.187815402457533,0.153844832236722,0.123509563728189,0.0966678794789912,0.0742710378981295,0.0574817640591286,0.045933015779683,0.0376492262900833,0.0303469943493643,0.0227650031902845,0.0151834420665697,0.00878288602252988,0.00442227623408455,0.00202053918346464,0.000907721191347488,0.000446952315231552,0.00030274786831892,0.000380647687384292,0.000680353238320262,0.00115398274317259,0.00161638106461474,0.00180989311252057],[6.63069452216347e-06,2.96437219243466e-05,0.000105671998703245,0.000302715430383023,0.000707353160073145,0.00138471371021772,0.00236819255825333,0.00372843546941915,0.00565968078240108,0.00851813436982737,0.012864037392873,0.019336225508978,0.0279177355308141,0.037078718967861,0.044548668906007,0.049961706394939,0.0563737072774159,0.0684111789722276,0.0893926588722864,0.120431334565873,0.160271351304074,0.204204027102297,0.245200576275421,0.279517895996811,0.310802070288601,0.346184494733144,0.38944642338754,0.441367338399321,0.505956449927063,0.591295811141665,0.701252023252599,0.827971150175037,0.955279295814634,1.07076388215139,1.17569081630654,1.2840950598422,1.41077744471301,1.55870320957773,1.71952959638653,1.88536797943937,2.0541733535604,2.22263877658026,2.38051153260473,2.51547017390136,2.62074370135793,2.6978620694906,2.75575229781369,2.80496487696772,2.84621518429945,2.86525728801517,2.84394618218574,2.77586238246541,2.6696464566623,2.54040310439376,2.40116398807806,2.26169928591386,2.13060633719736,2.0128781290516,1.90512070505312,1.79739825158917,1.6814992303481,1.55709556153097,1.43186612500601,1.31662898879021,1.21697964950905,1.12724341261497,1.03466354701526,0.930867411550819,0.817745901922237,0.703445766267964,0.596536189977008,0.503437666907795,0.427229334219897,0.367154055218954,0.319408460931536,0.278582486183181,0.240095751691274,0.203000547776948,0.169524324671599,0.141041351801743,0.116081180071746,0.0929982263925787,0.0725194602276577,0.0564427544930906,0.045154987479788,0.0372014245460829,0.0304728842766508,0.0235522661163205,0.0164671035605967,0.0102929187896325,0.00592706131916372,0.00334783931118753,0.00194413695374333,0.00115873939808876,0.000710516966092373,0.000485734522384129,0.000427908280865808,0.000487538001201889,0.000586025951188752,0.000623821363390101],[2.99818394361343e-06,1.34371432831918e-05,4.93630790142025e-05,0.000152533287709774,0.000410585745709146,0.000995251412543358,0.00220233843003493,0.00440273811130921,0.00781559489976422,0.0122876733393937,0.0174732367576272,0.0232701351713907,0.029678184655597,0.0361051181870662,0.0417113185070637,0.0472587032328007,0.0559330514286941,0.0713274132543478,0.0950497874451359,0.126824752772062,0.16553877105727,0.20887657243047,0.253496596780672,0.297567097767228,0.342006655015122,0.387714563036276,0.433839936238688,0.481905560282907,0.540424857657215,0.621246171693758,0.729161054121799,0.855924600067394,0.985534700537728,1.10584423816266,1.21667871208652,1.32866498023603,1.45359251884593,1.594565431621,1.74652890751241,1.90553714838171,2.07268816522891,2.24784516051776,2.42374472386238,2.5872220108477,2.7230985598168,2.81884492775038,2.87189637924004,2.89199630839379,2.89082853540597,2.87047557001036,2.82515183463489,2.75004326015264,2.64559222664974,2.51796148982806,2.37855967554468,2.2408092873415,2.11459038117249,2.00191307004136,1.89656213838896,1.7882542858088,1.66920721766844,1.53959353370391,1.40859765354525,1.28895199634941,1.18714159244313,1.09746751752145,1.00672479189657,0.905313007322029,0.793771189163173,0.680378802981953,0.574755919804817,0.483048961691636,0.406842868203854,0.345073190371858,0.295543525222438,0.254492400101628,0.217517612644142,0.182897325111121,0.152269325839009,0.126863116707469,0.105177482362479,0.0854520111894004,0.0681833974580683,0.0548415465055455,0.04555086875415,0.03886631060542,0.0329029458642115,0.0264316319404585,0.0195581430906625,0.0134138027688206,0.0089208215080119,0.00602725989304245,0.00413823869328933,0.00281198892880696,0.0018731481103909,0.00121868776430558,0.000762348125802915,0.000463654288815421,0.000296434837649369,0.000211177575822087],[4.05369081348745e-06,1.72024038400575e-05,6.04830913135428e-05,0.000182608675807248,0.000494486927049276,0.00123672523812622,0.00284140720494831,0.00581532645000376,0.0103020678221279,0.0156487767160113,0.0206825478031212,0.0247009330068359,0.0280467462423876,0.0316439290589712,0.0365757001626455,0.0445008868706331,0.0576160421207777,0.0772370906237807,0.102870979175048,0.13346907712179,0.169055988630241,0.210509309371012,0.258549355337491,0.313120145219268,0.371894351859478,0.429061672562343,0.479057014562331,0.524324056125856,0.577689237578808,0.653726207719972,0.756907683600517,0.87882694063184,1.00615488599819,1.13009559406329,1.24984602735135,1.37039914237077,1.49769449030731,1.63417522673511,1.77888996556952,1.9318425015744,2.09579314226974,2.27241097034876,2.4572641924804,2.63731448035505,2.79161838651238,2.8982156436237,2.94724753946154,2.9480602284575,2.91975000513083,2.87588895540022,2.81908568751705,2.7437542564902,2.64168841406484,2.51167200398481,2.36637645378528,2.22556931290839,2.10132328082116,1.99156066430979,1.88573233346008,1.77301351232792,1.64715961687964,1.50991441595709,1.37199135579493,1.24708492651717,1.1414831971108,1.04923465556023,0.957844441638781,0.85860442173745,0.75236938427003,0.647303691838779,0.55183857515136,0.469108319926558,0.397552175735768,0.335733779257271,0.284210689547739,0.242351345684161,0.206557016974571,0.17360890677647,0.143558793939233,0.117699807383231,0.0959098759661617,0.0776081239132926,0.0633222260089747,0.0536073089661647,0.0475011868916672,0.0429272665552242,0.0379525679181441,0.0316441803940841,0.0245070374354872,0.0180093979732696,0.0131905085826471,0.0099149239418348,0.00752826961980493,0.00564822309618721,0.00414623964488229,0.00289525422603848,0.00182214898771736,0.000984301559593024,0.000448714956874769,0.00017859940596305],[1.11619512117681e-05,4.55591630706746e-05,0.000150278100484637,0.000409365045055403,0.000955300600112854,0.00200291967940347,0.00391080716972749,0.00710172806807054,0.0116241582503537,0.0166459498630435,0.0207193337010786,0.0230150869166812,0.0243609506150093,0.0269791975680258,0.0333728774754045,0.0453835941977756,0.0635501098143719,0.0867746832852168,0.11307753308043,0.141504642839224,0.173519570232472,0.212617463861646,0.262652418770412,0.325045449059405,0.395156324206334,0.462061740998711,0.516406710356511,0.561169022649921,0.612314390771391,0.685889701533823,0.785115058513898,0.901243273794127,1.024416112797,1.15033581841605,1.2780736264944,1.40669502485633,1.5360556323396,1.66847524206237,1.8079921195906,1.95857724703982,2.1228818188338,2.30083592456057,2.48690732068619,2.66699532057586,2.81902186029355,2.92091541580201,2.96320543016297,2.95511719109437,2.9166339332213,2.86467636901675,2.804853997094,2.7299445411198,2.62647979595079,2.49093617835261,2.34037433601505,2.20048746296603,2.08291308430703,1.97876997706032,1.87168470202064,1.75068343169608,1.61316644427062,1.46490107166736,1.31942202956133,1.19116292387746,1.08492036622199,0.992723587935389,0.901650317767068,0.804515742670636,0.70439479994692,0.610581054696647,0.529945849149803,0.461412664394706,0.399096880634577,0.340178869730441,0.287431978392913,0.243759997763123,0.207357882033894,0.174101530789271,0.142387674250655,0.113523824657664,0.0891778818209184,0.0704641354988935,0.0581077681834196,0.0515656463796761,0.0484815899407206,0.045886692954832,0.0417075490187147,0.035408567989628,0.0280328919094081,0.0214039061933372,0.0166151798633755,0.0134157598721587,0.0110665748263791,0.00913280667643813,0.00736004129708433,0.00550926196906524,0.00360162299426139,0.00196216559749939,0.000868216003442488,0.000309305604548158],[2.69628637969539e-05,0.000108708865330579,0.000349727180397806,0.00090644007884131,0.00192879108463373,0.00348384731786149,0.00560252844314739,0.00838825830731799,0.0118480311257809,0.0154629414625078,0.0182438117707219,0.0197236541633123,0.0210523896732689,0.0249368690488806,0.0342401991399354,0.0502582982813952,0.0719644915359283,0.0968396247378902,0.122707914308841,0.149269693518212,0.178629672861625,0.215128400762509,0.264192580568018,0.328672315211387,0.403620676126167,0.475997376030217,0.534402044422103,0.581598132417301,0.634676467090569,0.710032047356928,0.809799061940312,0.924777643710763,1.0470410241118,1.17487005451167,1.30702797193356,1.43872863739113,1.5662125156735,1.69259782172346,1.8265199669554,1.97548951475678,2.14131878249861,2.31973017696105,2.5004714915361,2.6672243721191,2.80102932718507,2.88741002600802,2.92251901787991,2.91412528835838,2.87689305480866,2.82502124894788,2.76460628571682,2.68830289225013,2.58152888475744,2.44245952326179,2.29354724452561,2.16410894880791,2.06210732094733,1.96959351760886,1.8632268493109,1.73198934745797,1.57866965278201,1.41557866034216,1.26090691005321,1.13058794882917,1.02761446681628,0.940238014552535,0.852582435569049,0.757631925617622,0.661301825984428,0.575513164801066,0.507018621819382,0.451871449433895,0.400565732280108,0.34800655548161,0.297041288888928,0.252465360473991,0.214341265346283,0.178913240330145,0.144031865353584,0.111258697335545,0.0837027496681637,0.0637794244971153,0.052234673129265,0.047477533064513,0.0459597538577207,0.0441030968159182,0.040001735257645,0.0337069688321587,0.0266820922242153,0.0207464478742461,0.0167912827753414,0.0144618161141933,0.0130003099744217,0.0118229637108741,0.0103675074169194,0.00820637622146616,0.0055284174453397,0.00305335428312545,0.00135596444440806,0.000479920721882932],[5.04577088920836e-05,0.000202746650761582,0.000647366108799279,0.00165055571483705,0.00339298689293096,0.00572839562696535,0.0082066456872128,0.0104727488820646,0.0125382881449064,0.0145098135654196,0.01628620360487,0.0179638553194195,0.0206796997906745,0.0267615925081701,0.03848067028099,0.0562552409141901,0.0782791868878072,0.102236682816516,0.127118778198312,0.153255963607818,0.181815028592772,0.215794034715798,0.260715435408536,0.321043569482954,0.393613235705505,0.466361884536889,0.527834812460673,0.579843437323677,0.638288018666096,0.719021963909724,0.824423936298354,0.945525678627524,1.07383665226654,1.20635008692366,1.3404964871991,1.47060172380101,1.5927572020603,1.71121841621241,1.83709554695472,1.98017461045588,2.14205709884447,2.31487752055467,2.48343598286242,2.62977718392354,2.74033204400297,2.81032433103543,2.8412976413269,2.83728294614063,2.80546032833714,2.75670146106679,2.69816958291369,2.62331366756119,2.51738605537354,2.38068747710427,2.24014928973434,2.12697482474014,2.04448228536997,1.96574117545823,1.86058567614557,1.71819141489473,1.54783318608854,1.36969386965293,1.20704441376707,1.07717541945122,0.981196597410345,0.902918321493306,0.821718720159171,0.728769773433398,0.631944001878491,0.546473823490649,0.481247947394727,0.432789621320098,0.390711750857187,0.347698316167839,0.30377282176762,0.262052550273472,0.222994376871295,0.184431692370124,0.145719115825332,0.109492663790845,0.0796284176286149,0.0588118779409616,0.047364516294987,0.0428626472874234,0.0410923991458526,0.0384272200375855,0.0335551641145106,0.0272215277407582,0.0210196472298802,0.0163211027160136,0.0135965894047317,0.0124604194798446,0.0122461805688312,0.0122226884839964,0.0115044274808971,0.00949648676563929,0.00653465661776516,0.00364465588908097,0.00162534937963239,0.000575977589778423],[7.23060386900458e-05,0.000290517055427753,0.00092706735596228,0.00235857021777504,0.00481837807507161,0.0080100702279868,0.0110961890815187,0.0133241885685751,0.0146733140805371,0.0157653678998727,0.0172936514528477,0.0198258092396959,0.024209440293576,0.0318340579305347,0.0438687421276536,0.0600381699105286,0.0788963070034202,0.0997963973615837,0.123636759750654,0.150904527830174,0.180536071786086,0.212829462632041,0.252562464440251,0.305835467477779,0.372328470272133,0.442734025545113,0.506761347105357,0.564608217806946,0.62911496938888,0.715072538107764,0.8269492720752,0.957721174171516,1.09711554340736,1.23771562697715,1.37427673160463,1.50209246369566,1.61943801674278,1.73120157931835,1.84799200217314,1.97989512237261,2.12936392085636,2.28773569796352,2.43750907791346,2.56096258236411,2.65015693843628,2.70766194392275,2.73695185025376,2.73716091798361,2.71022800809259,2.66655715771075,2.61485286580714,2.54775346170999,2.44875810403551,2.31914602843616,2.18881354156293,2.08978915628248,2.02192840063983,1.95232947966821,1.84649242037764,1.6946025677453,1.51205626148106,1.32558130735974,1.16125741309276,1.03571839757981,0.9480076374136,0.879016099108005,0.80469860687194,0.713913190687149,0.614551426265934,0.523806525640254,0.453677224769602,0.40434043693527,0.367919758528845,0.336002352033078,0.303729570297691,0.269026879625727,0.230746817426669,0.189085859062397,0.146860390968344,0.108610405676963,0.0781849996791759,0.0573723841878496,0.0456735407841972,0.0402640964179016,0.0369779508409049,0.0326692799512089,0.0267554836387425,0.0204383334242825,0.0150675768974807,0.0113533357878834,0.00938391580151492,0.00887931283542475,0.00936300788357405,0.0100737503139799,0.00999834156920437,0.00849877813058468,0.00593165000420638,0.00332962415849934,0.00148901399230824,0.000528274604481363],[7.92435184195855e-05,0.000318811181075756,0.00102024169899542,0.00260812165352027,0.0053688806736295,0.00902481095599978,0.0126796681820677,0.0154436243410832,0.0171800461341491,0.0186067642069767,0.0207821504116225,0.0245504506283791,0.0303663293709356,0.0384447463885491,0.0487250416760588,0.0607293168015887,0.074373945246876,0.0913174420008797,0.114110118563067,0.142832836539506,0.174123951368724,0.205888921772086,0.242180747193048,0.290349371127471,0.352594030302599,0.422327001086122,0.490266281971763,0.554195433013765,0.622754346622158,0.709421148983314,0.8221492217611,0.957982735453807,1.10607559138143,1.25445675525812,1.39473611214242,1.52326760201185,1.64062967178777,1.75115784403325,1.86232362168368,1.98230436315641,2.11465540312328,2.25260497858794,2.37966471404249,2.48015285250959,2.55057738895959,2.59724141089003,2.62281060973161,2.62273875788746,2.5976196821964,2.5595297161258,2.51729684435793,2.46051987453592,2.3703835423966,2.24885071876401,2.12685639700003,2.03555449085479,1.97318198574135,1.90592773154225,1.79926260693787,1.64486464615412,1.46132796965128,1.27780118301756,1.11948769666242,1.00015658569805,0.917306562050535,0.852517855421179,0.782689993592159,0.695882248012876,0.597670217358813,0.503717149990407,0.427644469358398,0.374406166285565,0.340793759210412,0.318711396615958,0.298340213803643,0.271407243511787,0.234503495292998,0.190499492228075,0.146259637740506,0.108107176991905,0.0790090832292793,0.0590692732419013,0.0468912034592808,0.039849004261771,0.034600351897558,0.0288709308146167,0.0225618662705394,0.0167294690342815,0.0120780310866776,0.00871240862776239,0.00661889560755205,0.00580436190508776,0.00604729119042074,0.00668942430444825,0.00682076346895792,0.00588800641038793,0.00413888898482152,0.00233001066328805,0.00104305080205282,0.000370157392844856],[6.68198106103956e-05,0.000268243272035603,0.000862442651791191,0.00222710235600548,0.00466621851909842,0.00807286134924524,0.0118424387820083,0.0152705732357718,0.0181035436704533,0.0207980792429399,0.0243701262961166,0.0297825279472497,0.0371298903834231,0.0454425525174137,0.0534685498753619,0.0608919491514518,0.0694069758122422,0.0827313335875223,0.104221150758163,0.13325847567521,0.165177243044077,0.196906165549459,0.232251402318745,0.279178838863776,0.341429902537688,0.414246852840396,0.4884980871936,0.558738418160979,0.628715933274485,0.710086421646673,0.8143748448228,0.944132159796714,1.09081389107326,1.24085619879693,1.38401999385164,1.51700179765928,1.64106526501705,1.75838691186327,1.8715934859514,1.98507889076529,2.10248587551177,2.21994526206127,2.32432330409151,2.40311876055573,2.455720834973,2.48961518584588,2.50628306201632,2.49991551450519,2.47213156009463,2.43651711629199,2.40060711736505,2.35113631551256,2.26844284430051,2.15475562976877,2.03891249218664,1.94897504609496,1.88395591999846,1.81499739620622,1.71175857354253,1.56625354288379,1.39501671162274,1.22450780260919,1.07661639765785,0.962097132392236,0.878472011111697,0.811484976180801,0.743134335500374,0.662662166571788,0.57181533180352,0.481507377089564,0.40453678634213,0.349577832140571,0.317831326259757,0.302043487726642,0.289071983653095,0.266607101378089,0.230342158041943,0.185641529902443,0.142143997180071,0.106622887861055,0.080442406112103,0.0619346856690474,0.0491179040754067,0.0401216509535216,0.0330068588918584,0.0265657455538165,0.0207994721780046,0.0160309013498839,0.0120827076533498,0.00866357691390713,0.00595015877487658,0.00433484656245445,0.00382681558763504,0.00389953920360438,0.00384525733266858,0.00326210658370438,0.00226668999868857,0.00126571599521925,0.000563440775943304,0.000199202827911567],[4.69180434137827e-05,0.000176436997861405,0.000563686297999693,0.00147653140069181,0.00318743043873315,0.00579209903459082,0.00912745144896169,0.0128852110710767,0.0168299109631434,0.0211074020107875,0.0265086772308951,0.0340167383360327,0.043480388825993,0.0529261119395228,0.0599612923639264,0.0643226091576896,0.069176094352938,0.0797368432111172,0.0996619542980066,0.12781871865618,0.159215717086472,0.190745600859498,0.226057332992286,0.273194505154309,0.336967351862266,0.414163184963062,0.495500199467472,0.571997705366694,0.642008700662094,0.714186065213796,0.802157220341434,0.91399616459454,1.04627965760358,1.18815334602482,1.33027096023428,1.4693607805276,1.60535946741949,1.73665165659565,1.86012335821893,1.9751198573938,2.08362862943981,2.18410268133881,2.26798408919352,2.32703074019348,2.36293260930598,2.38352657479229,2.38969918267178,2.37521291314244,2.34187589295672,2.30343008872591,2.26719913952793,2.22052643495647,2.14496112106653,2.04090840877682,1.93090993010977,1.83818432485057,1.76537560160903,1.69371892527714,1.59982183509669,1.47368166781253,1.3242725027848,1.1714034006201,1.03360900275826,0.920824592133213,0.832524619936751,0.759744825619032,0.690506961433461,0.616093569415159,0.534855513367918,0.452668375086507,0.380275326818257,0.327797823253824,0.29838474468927,0.284977218038559,0.273485807663615,0.25140200713359,0.215708225167352,0.173391098113093,0.134373474094955,0.104042278136463,0.0818520009885928,0.0649566606527155,0.0514257431194225,0.040521418661526,0.0318400503602255,0.0251101907030724,0.0201413194696608,0.0163892894186399,0.0129886562827482,0.00954006006611943,0.00647725684510175,0.004406344658585,0.00336443016944425,0.00286159203128408,0.00239701357547155,0.00178721247388034,0.00112831164116285,0.000588687277500231,0.000250206744626604,8.5789771142074e-05],[5.06638003439168e-05,0.000112027305706003,0.000301791641309721,0.000779363824168918,0.00175931861448241,0.00347083703349834,0.00612185086728853,0.00983000591952232,0.0145456368975776,0.0202653805091111,0.0275487666186439,0.037338210194254,0.0493979289936594,0.0610912843389297,0.0689643639575932,0.07233326062955,0.0751060455551123,0.0836278794139368,0.102131052776849,0.129523795276914,0.160709640365183,0.192165680985268,0.226751632260575,0.27233402054504,0.335143677335873,0.414138835716786,0.500505190623696,0.582256203081688,0.652269259236285,0.714746861436323,0.783059725316742,0.869602621659422,0.977684341023564,1.10262280047391,1.2384727646394,1.38197295591533,1.53029713648365,1.67720553307302,1.81399022302975,1.93465722881654,2.03813083122621,2.12420860895778,2.1897869615474,2.23256799323501,2.25729319986753,2.27188349328947,2.27566817756609,2.25960335857173,2.22227548987177,2.17629652951299,2.13205011274058,2.08292714843296,2.01436554211,1.92317021491845,1.82212653924216,1.72784140257832,1.64740248716795,1.57417055220403,1.49282756165985,1.39012151126268,1.26459347853804,1.12763224825658,0.99560503621314,0.880460938644459,0.785226057887756,0.705371752859503,0.633134722056173,0.561498946562283,0.487210418983329,0.413194759586222,0.34817835185975,0.301281113125547,0.274659324561843,0.260739177257287,0.246840757181326,0.223572295857109,0.190493519081637,0.154694776707016,0.123896035742952,0.100733490764485,0.082976978134493,0.0675666427997822,0.05338624645456,0.041003149184298,0.0312275096458018,0.0242685885452758,0.0195910357039933,0.01613446015296,0.0129270647358456,0.00977192809418926,0.0071899556094205,0.00557616084024844,0.00464158481931309,0.00378434646501423,0.00273678984355934,0.00167133921584143,0.000850174390267464,0.000360412191960287,0.000127682313911674,3.77759065945848e-05],[0.000160584062805484,0.000168789604957589,0.000208925659815475,0.000382355910533232,0.000859211865034687,0.00192215395347416,0.00399848001140323,0.00754108803267177,0.0127625288723592,0.0196581096711001,0.0285771924176673,0.0403425162153609,0.0547456402193075,0.0688927359115731,0.0785568154637259,0.0823270369728206,0.0841641052022292,0.0912650664175217,0.108896275659405,0.136523178877207,0.168718024377331,0.20071345490378,0.233957017068679,0.276140061977018,0.335243206259158,0.412740626090824,0.500902652674064,0.58587129777423,0.655973331446775,0.71047851994029,0.760665306860024,0.821686679725008,0.903543646499371,1.0085445666465,1.13430674659816,1.27681267565022,1.43005798954361,1.58428359562835,1.72734875645858,1.84941943530089,1.9462792466338,2.01850916605395,2.06896037982393,2.10265813755483,2.12801111285551,2.15170597701143,2.168419402439,2.16236461087975,2.12557113215788,2.06872471007834,2.00805954622339,1.94794088022804,1.88189132183994,1.80484565556114,1.71902926551137,1.63166775195155,1.55065017957459,1.47888200007032,1.40910500892009,1.32659928040663,1.22082223616339,1.09492080442926,0.963421530196341,0.841541152999145,0.736849331973526,0.648630244747017,0.571698301427726,0.500054026932027,0.4299449300584,0.36284608525776,0.305486257664738,0.264498688308318,0.239818414788296,0.223802415341198,0.206878136776371,0.184024118567828,0.15697109297082,0.131249984266774,0.110902677894774,0.0955176678092074,0.081910353324852,0.0677801983740895,0.0533597237387187,0.0403784835720486,0.0302760453402467,0.0232423159563985,0.0184014383405258,0.014656619591623,0.0114639572947546,0.00901595861913069,0.00771009038498278,0.00736344921172838,0.00708283540084005,0.00605332147298955,0.00428936849083061,0.0024539163815276,0.00112509894754128,0.000413695305569896,0.000122573856067057,2.94846694691033e-05],[0.000599182788363155,0.000541047735538061,0.000412097790613915,0.000338755472547436,0.00049897167802909,0.00119279735102497,0.00294989479750987,0.00644728915859178,0.0121377064070112,0.0200381607110436,0.0302053635023309,0.043138757344402,0.0586294425285086,0.07398378927198,0.0849137992853598,0.0895611273655652,0.0914986576847699,0.0981478597958165,0.11559818668967,0.143977810965754,0.17755901696627,0.210354317950592,0.24264467716992,0.282090889134433,0.337909613226947,0.41311835329967,0.500743386066934,0.58624434554227,0.655562203457417,0.704580182746588,0.742431519480641,0.785661624024634,0.848785492425653,0.938308385265725,1.05270561723641,1.18594464221546,1.3299377821259,1.47457692461654,1.60831927681873,1.72084135207368,1.8063180019959,1.86578107641023,1.90686970994108,1.94090491430025,1.97884539652327,2.02416333260821,2.06442353046889,2.07545184840725,2.04216386491792,1.97304672342771,1.89024237927934,1.8107253035765,1.73989640244224,1.67524853174333,1.61048126730069,1.54084377555346,1.46880489005771,1.40133890169541,1.33878779367594,1.26936845479629,1.17819198922915,1.06135635479615,0.929770745240851,0.800247670030313,0.684848987381572,0.587408254244923,0.505643242273912,0.434242161809864,0.36837770071757,0.307560508851949,0.256213953758631,0.218764090219056,0.194075868350733,0.175820365671209,0.157944243888358,0.138807716286615,0.120677283550356,0.106340954419339,0.0960322636791394,0.0870965616026853,0.0765113884280873,0.0634699220123621,0.0495568916341294,0.0370972944643573,0.0275370815121415,0.0208247631886455,0.0159466195347395,0.0120547096732767,0.00912405430196314,0.00765384600689555,0.0078252255353673,0.00886964651978534,0.00934398300177369,0.00825833058048297,0.00588897626291689,0.00334474716122865,0.00150713607352395,0.00053834440257026,0.00015251690278209,3.43198289560429e-05],[0.00178067802674241,0.00158595396709971,0.00112745585580854,0.000682957812339684,0.000530030669503003,0.00099160994534354,0.00263595268830561,0.00628244100729955,0.0125564530311481,0.0213993885476596,0.0323393370601329,0.045198215395251,0.0596557334787932,0.0737930656375546,0.0843637021146599,0.0898247279415758,0.0930991480237475,0.100803420087695,0.118885949446409,0.147812232849984,0.181944924167931,0.214971573648913,0.246898986433358,0.285477271402698,0.34009306083318,0.413634718942507,0.498961960441427,0.581829390500575,0.64858012819413,0.694810293163269,0.728987754756612,0.767672155768023,0.825758109997886,0.908852158170996,1.01291539880338,1.1296881629295,1.25119218007745,1.37014529980513,1.47920522123341,1.57134534191628,1.6417963851477,1.69169226288837,1.7299714722594,1.76996701792691,1.82252183511841,1.8874695687559,1.94676237381824,1.9707131702148,1.93977040821771,1.86043040023113,1.7581640851775,1.65962645863207,1.58173706248503,1.52730540945753,1.48482844801264,1.43782575858662,1.37941578771482,1.31585930973022,1.25440429518735,1.19081853718555,1.11159269901555,1.00747305745177,0.88277145281368,0.75192635748854,0.629856781600644,0.525738735499251,0.441463778478212,0.372550250109693,0.312081110488704,0.256626219172145,0.208526052947581,0.171590938646223,0.145611994323964,0.126478266879201,0.110689872363622,0.0979249683743125,0.0893757554205108,0.0848282438620209,0.0816380973088432,0.0763212420353471,0.0671281891989536,0.055016742023913,0.0423766432819887,0.0313133235614076,0.0228282724449359,0.0167473034497438,0.0122458886408326,0.0087666598339303,0.00649607868078921,0.0059415936841323,0.00708858853402975,0.00891183042957525,0.00981225976409832,0.00880896351406875,0.00631106451988663,0.00358574836345229,0.00161267894218074,0.000573826317745067,0.000161528921084406,3.59768186259029e-05],[0.00405123938383857,0.0036035988535727,0.00254114623018417,0.00145445395332816,0.000836342097150141,0.00104839318359146,0.00264194012508379,0.00649499275390396,0.0133132214308741,0.0228431631327979,0.0338799482974181,0.0452951207951774,0.0565862200281828,0.067103921674403,0.0756120863749306,0.0816346441731672,0.0873415386783156,0.0976416313750092,0.117296385689302,0.146624979744329,0.180408087609981,0.212786457361229,0.244046516017072,0.281881017019464,0.33506189779952,0.405457426425295,0.48546971877703,0.562070599639199,0.624244191413686,0.669956215805998,0.708298490598716,0.754268786035115,0.81917127612371,0.904005422900602,1.00110798241416,1.10104905860524,1.19708586031577,1.28515706793272,1.36303019507342,1.42959669356469,1.48419478769478,1.52822518567363,1.56771548897556,1.61227223566379,1.6698253162075,1.73853434179712,1.79993734792335,1.82454690262765,1.79225022531724,1.70806029220054,1.59742748417155,1.49084151939806,1.41153149966458,1.36629513656201,1.34147697580432,1.31294692367437,1.26558002596372,1.20287709785276,1.13748793427629,1.07473310829808,1.00662591728562,0.920820572951283,0.813436703281838,0.692957260959229,0.574411681544903,0.471257799054611,0.389415974368872,0.325270282240547,0.269982647064222,0.217846579050665,0.170465141013347,0.132611465240864,0.105872891486088,0.0878237467609685,0.0758578953977041,0.0693540680421341,0.0679522797718812,0.0692659403117511,0.0692517197715041,0.0648698315607475,0.0561057087984709,0.0452326552059389,0.0345500750633618,0.025267420870251,0.0178404825226967,0.0122999896597317,0.0083130486746398,0.00554737033135804,0.00404336492749354,0.0040314335654754,0.00535624668462747,0.00711093750365929,0.00798663417747144,0.00721801223005052,0.00518235532176473,0.00294611456641795,0.00132491600074072,0.000471226832294831,0.000132539522344108,2.9480492366136e-05],[0.00703472850689818,0.00625629611008226,0.0044049665731721,0.00248529271188431,0.00127207746984325,0.00115532636078502,0.00258681588563327,0.00637346294897889,0.0131892504010672,0.0225924987221055,0.0327911507216437,0.0418529949269489,0.0491173634011092,0.0552000464402247,0.0610137228311083,0.0673945891043787,0.0758597834864288,0.0893512704438867,0.11094849408354,0.14055233455569,0.173552954706321,0.204791218129518,0.234582307382093,0.269918688718054,0.318605053073683,0.381855261228805,0.452462701856097,0.519514580874603,0.57544147644962,0.621173139277434,0.666274635361535,0.722963516174411,0.797710024196187,0.887291414182199,0.982237002135471,1.07291616041297,1.1524332788391,1.21719462293084,1.26820211818885,1.31079540312953,1.3507440218327,1.39099349470821,1.43258897571947,1.47738207858374,1.52836199064317,1.58423383014376,1.63124988106522,1.64528892790247,1.608923182856,1.52618172282685,1.41974873677763,1.3181631085108,1.24441048307794,1.20600469854276,1.18963224624223,1.16963823252915,1.12733940761614,1.06369883766873,0.994013994165299,0.931149243820336,0.87343112295471,0.807849036429211,0.723913683080447,0.623683276818948,0.520135662277941,0.428074879136186,0.354973052110538,0.297352610922311,0.245795281150518,0.194691396557874,0.146847438067628,0.108620203991064,0.0826479421824979,0.0666779169206769,0.0576233546436994,0.0541250005144571,0.0550620287472834,0.0574870883979404,0.0574810856365094,0.0530447078966612,0.0453578195899116,0.0368674357437829,0.028857453663327,0.0213824119444121,0.0146206531085308,0.00918741514036579,0.00543011082495016,0.00318964786422092,0.00219750180344298,0.00229967613210105,0.00324178763546497,0.00441172114386872,0.00499406375815053,0.00452428335467745,0.00325072400009503,0.00184840189562443,0.000831287303396383,0.000295647811781223,8.31469956300974e-05,1.84910474363709e-05],[0.00932098604085057,0.00828915985291801,0.0058332381817885,0.00327285370284039,0.00158798396077375,0.0011527494630363,0.00225233289045399,0.00549959331326965,0.011448435346396,0.019620822398191,0.0281259227234589,0.0347803435275888,0.038874585704992,0.041753362151451,0.0457056284358199,0.0524981305306936,0.0631630685213166,0.0789714267583575,0.101419983909482,0.130148391769418,0.161622466248722,0.191679681223726,0.220119489766337,0.252127416592587,0.294019500904564,0.347073037629277,0.405752758344264,0.461865358691374,0.510736344041555,0.555036838689473,0.603640860187204,0.665695009558023,0.744370129276702,0.835487245200508,0.930738814390769,1.02078384829556,1.096494556707,1.15152276612201,1.18698173693441,1.21268439995578,1.24097456360648,1.27815027628952,1.32166741682846,1.36523833987741,1.40571877041988,1.44230011448117,1.46783096719531,1.46654330779676,1.42609253354315,1.34985468728169,1.25549761628539,1.16544977541906,1.09823754125416,1.06040036805154,1.04145733405124,1.01975718478912,0.977988978638773,0.915516255951634,0.846794429340175,0.787278590811101,0.739190161455562,0.690573048864388,0.628217423563553,0.550447544478496,0.467788939469686,0.393516845600645,0.333615689164402,0.28372296784826,0.235187333596842,0.184652200432731,0.137238837589556,0.100367637662699,0.0763260760701072,0.0618299231939751,0.0529054041682129,0.047944024023526,0.0463096337841619,0.0460657633687687,0.0444975193431873,0.0405391871733981,0.0354321824299836,0.0305726467700611,0.0257051913151348,0.0199179392020577,0.0135056773747955,0.00787347738330551,0.00404953450260585,0.00201390237027318,0.00121797372597394,0.00118878035951391,0.00161165829733907,0.00214724580101144,0.00240712092827844,0.00217190008981266,0.00155803811488822,0.000885374887786369,0.000398087687331385,0.000141566495591495,3.98118213191244e-05,8.8534380172866e-06],[0.00942389607905228,0.00838062727738969,0.00589642405963465,0.00330028692270785,0.00156176354760025,0.000993980528239067,0.00174284514416624,0.00422617689040192,0.00887721232804255,0.0153347073841225,0.0220277526615918,0.0270262080109891,0.0296798855481097,0.0314534955436202,0.0350215547655607,0.0424591644442305,0.0543925373470722,0.0708187428521858,0.0919567875636474,0.117580001480354,0.146023146570011,0.174902074188851,0.203401629470047,0.233812042427894,0.269932187588261,0.313131958204908,0.360299951049833,0.406196662406562,0.448139224070647,0.489070031674571,0.536168465842329,0.595795103121765,0.669634857080102,0.755140542130735,0.847250343294883,0.937967498290701,1.01620791042031,1.07210122085918,1.10431300989437,1.12329014967329,1.14521378126683,1.18024692860605,1.22541289996473,1.2690985976162,1.30217329845088,1.32242651997756,1.3280313333039,1.31244370135023,1.27008361344178,1.20379394261566,1.12424100939764,1.04525954447266,0.979786354808828,0.934292876222037,0.903710886904788,0.873801448605924,0.831505163552063,0.775046418178708,0.714970114902641,0.664246560071809,0.625572194489595,0.588734117618559,0.541386727648347,0.481250800335273,0.417083648394293,0.359589313418235,0.312346887307217,0.270257564115267,0.226137021846705,0.179021118185981,0.135414232965038,0.102368465665232,0.0808929893742571,0.0666823213485381,0.0554791533226397,0.0461525516352097,0.0392959795668123,0.0347114090831711,0.0312189607369832,0.0282567460880474,0.026256169043602,0.0250465895481816,0.0230241981235331,0.0187813998330479,0.0129094985394386,0.00740668187313414,0.00371756572277329,0.00188235784319207,0.00117624347854315,0.000958462406045584,0.000930232676525101,0.000967057259085269,0.000957256401649825,0.000819763604516118,0.000576238599447939,0.000324952726238024,0.000145689596720014,5.17544999860823e-05,1.45488179579214e-05,3.23491543794696e-06],[0.0072718572156794,0.00646789824123726,0.00455178805249803,0.00254805737473753,0.00120367857739765,0.000759812790437949,0.0013358869872948,0.00328574681118842,0.00701660253461508,0.0123439440806999,0.0180926788729606,0.0226851481592872,0.0254883413023711,0.0277049476056182,0.0318053848699519,0.0398202029120999,0.0520864164246337,0.067675628930798,0.0857929150203003,0.10657748238881,0.130732213334522,0.158404650918746,0.18860291355123,0.220292873674306,0.253707380945874,0.289491615814011,0.326789186889793,0.363399285881449,0.398498540265794,0.435009605621775,0.478285123162983,0.53194618017698,0.596061435161053,0.669349963825766,0.750284074450796,0.834212142041875,0.911337809970659,0.970588120700106,1.00751429677047,1.02936458620389,1.05139248937735,1.08540271438299,1.13008375788586,1.17287324838933,1.20129432098429,1.21088226596286,1.20269284292284,1.17795343277558,1.13765470966591,1.08384257473751,1.019330071741,0.948815609813345,0.880375790348782,0.822171561540431,0.7762195882288,0.736699564482101,0.695356427862379,0.649162706158352,0.603167667204197,0.565042605776581,0.53581327817754,0.507059150505633,0.468826001661193,0.419432693956861,0.366309868920196,0.318372267545254,0.278550623899815,0.242798303100579,0.205690182961393,0.166964622170817,0.13193898503424,0.10555862552326,0.0874655411335474,0.0733264651367837,0.0595861174840698,0.0459906190293166,0.0342887743991546,0.0257784374072974,0.0205081482664812,0.018083014171731,0.0180118106204728,0.0189585504083818,0.0187182051672458,0.0158833136698878,0.0112098504290965,0.00675890995788633,0.00394045620028361,0.00270049419547191,0.0021998694781278,0.00177305447549903,0.00126737666671162,0.000810372045432381,0.000497016723422473,0.000306047601224562,0.00018129008564264,9.49388232971948e-05,4.1339528169975e-05,1.45234702419682e-05,4.06584231562431e-06,9.02645078622669e-07],[0.00429337286309134,0.00382633920858183,0.00270219829232642,0.00152475514631483,0.000747232079315964,0.000558508525756321,0.00114538348468894,0.00292725431102791,0.00639367028951769,0.0115560959312141,0.0175458800114147,0.0229829002839101,0.0270476386343959,0.0304125023580564,0.035105168269868,0.0431047300713257,0.0547664965361266,0.0687014098780525,0.0834257221403345,0.0993942700461488,0.119368723184429,0.145977688557301,0.178562159086335,0.213310732042882,0.246650481719759,0.277456166466816,0.306153001274405,0.333462020922564,0.361150562827675,0.393139719003248,0.433634200697813,0.483206689727905,0.538524992768742,0.596988433266135,0.659363217838716,0.726113654976737,0.792717819007413,0.85064305675484,0.893648873034787,0.923633319784107,0.950149835109075,0.982584688255022,1.02148056227764,1.05772391555251,1.08027123636873,1.08387286659268,1.07018658195178,1.04438521945736,1.01119962623518,0.971355793917484,0.921236288452991,0.858395745363347,0.787469440778949,0.718699322952914,0.660526355003814,0.614359983532733,0.576007381273561,0.541294783612898,0.510057705906361,0.484448853322573,0.46339190050503,0.440154033865414,0.407161046157688,0.363042932979769,0.313915255997799,0.268094971816892,0.230030916071684,0.198515850299278,0.169964715803812,0.143087190465858,0.119819528886877,0.101951548165987,0.0882100345086657,0.0752554503030883,0.0608369915007247,0.0454716638270176,0.0314472300355572,0.0207763023178546,0.0141691047170702,0.0113319334049357,0.0113414335193433,0.0125335446819936,0.0128740287910387,0.0112607537700935,0.00837338172988156,0.00584910535187327,0.00467826745425778,0.00453097469632026,0.00441260127952517,0.00369633745043512,0.00251728584021988,0.00138140923577413,0.000620554148369681,0.000238501413734641,8.47482899117586e-05,2.99224274289681e-05,1.04136746347335e-05,3.30274986806499e-06,8.87095188608002e-07,1.93838415071201e-07],[0.00199641669837071,0.00181918224578792,0.00133196836219917,0.000799648625720073,0.000449471275109268,0.000445312268518883,0.00104703232023328,0.00275008011430482,0.00614983665392725,0.0114816386267004,0.0181951429257213,0.0250664821937934,0.0309591852484595,0.0358188222487764,0.0410736147165235,0.0486588163798628,0.0591947501245275,0.071294943821185,0.0832050053937317,0.0955543236592492,0.112277656852409,0.137642103383172,0.171650149545097,0.20912307222086,0.243670720287982,0.271849992560854,0.29393251536733,0.312750899943823,0.333095167146062,0.360939922659954,0.400151067304997,0.448286559649498,0.497559287608381,0.542134825199533,0.583492185766853,0.627239431076856,0.675876715102482,0.725951830915516,0.771434794808027,0.808877043305828,0.839678304301383,0.867797425404906,0.895079263328676,0.918727259872075,0.933269334435673,0.93479746015758,0.923826904454646,0.904864231159777,0.882360481851239,0.855489314389054,0.817711676944091,0.763575067374868,0.695939264023265,0.62557591411153,0.564014972621668,0.516930468164924,0.483081305079603,0.457971359752524,0.437894729483794,0.420783446379394,0.403969265621519,0.382479158593084,0.351119381727144,0.308869956890968,0.260687012143397,0.214546100675345,0.17657367164861,0.14832614844809,0.127749660682391,0.112092317113648,0.0996822905239713,0.0894546698435487,0.0798923776612858,0.0691792275052657,0.0564268184454258,0.0424846799063541,0.0293520934463386,0.0188258589030599,0.0117222611997845,0.00797894503736897,0.00688793622627332,0.00715419509329089,0.00731104471649508,0.00661531476579518,0.00553654012659334,0.00512926043748927,0.00584376236152708,0.0069781701988329,0.00730848729981883,0.00623405207738865,0.00423908981302838,0.00228667392705272,0.000979169045096203,0.00033459642024659,9.25647213711536e-05,2.14552154759455e-05,4.45462254587106e-06,9.00121312566948e-07,1.8189576814201e-07,3.45838410489191e-08],[0.000958441349923669,0.001028508132319,0.000930197794738929,0.000716532608250522,0.000504511672908255,0.000473299777175351,0.000918550568482933,0.00232632664316243,0.00531276330307873,0.0103149747708335,0.0171789494809991,0.0249892811360634,0.0324566150463832,0.0389105956248915,0.0451581020050933,0.0529028683680245,0.0628338029755149,0.0736333252120724,0.0835665624233175,0.0933814030249689,0.107338736151569,0.130338896082787,0.163240354867934,0.201257473578331,0.237077109306002,0.265240845679593,0.28449500226034,0.298133749137132,0.313127203288914,0.337375367811822,0.374631191176955,0.420236410823593,0.463376587950675,0.496014386876614,0.519743890221643,0.543247079201179,0.574026634255519,0.613163529249846,0.655996863600106,0.695648978495018,0.726698988853642,0.747768497744285,0.761396683823247,0.770975784702634,0.777596358442316,0.779920337264994,0.776777625960349,0.768956400070532,0.757389194984447,0.739654479210907,0.710070017532283,0.664843222717209,0.606977035435144,0.545653026589112,0.491043093627256,0.44926999720318,0.420709378946596,0.401572876209436,0.386753830580226,0.371897081745936,0.353762466501362,0.329489871751867,0.296704335441116,0.255439182111991,0.209745113440634,0.166363453198928,0.131291223734122,0.10716947201054,0.0928877799955782,0.0848959768082189,0.0792237559244758,0.0731472683162797,0.0656149192280384,0.0566016290151268,0.0465178090014725,0.0361222332298103,0.0263576362899675,0.0179770515090482,0.011446164850962,0.00704197657853241,0.00470301399152643,0.00382699955637925,0.00354163475251567,0.00335908938733905,0.00353045055095127,0.00463623238166776,0.00671060975577167,0.00877256255738947,0.00942812570961361,0.00809475266943174,0.00551019646983936,0.00296827501369488,0.00126499781818045,0.000426686888731197,0.000114075431492301,2.42688404750406e-05,4.150977362734e-06,5.85479109673981e-07,7.18877925969507e-08,8.34770562035567e-09],[0.00109400875279384,0.0015143975260812,0.00169800433752312,0.0015339798738374,0.00113357267487948,0.000783090007479231,0.000831252220194534,0.00168057544401699,0.00383367360718701,0.00779387001990991,0.0137448853131432,0.0211974851079582,0.029064417072423,0.0365265689343878,0.0440103219669063,0.0527603397165366,0.0630423005746087,0.0733397247936195,0.0820578290264415,0.0901129864230207,0.101537905921429,0.120984031849717,0.150041566111943,0.185630420448706,0.221500835067017,0.251242843496859,0.271428282985875,0.284117486509224,0.296821613350748,0.318237985711943,0.35160549558347,0.391154777974657,0.426029099971495,0.449148753450302,0.462722827752751,0.475462289494363,0.495335362619904,0.524807222421734,0.560555502453902,0.595409851056174,0.621544387356151,0.634831800615538,0.637509883486659,0.636078077114798,0.636248902634123,0.639834965625156,0.645232215972448,0.649029898781398,0.646779391674983,0.633829244175634,0.607437833137963,0.568881495598055,0.523264087851792,0.477117161412902,0.436006215420539,0.403304534821477,0.379563651998835,0.362274765263951,0.346798146172368,0.328585911552373,0.305124955651896,0.275946570899152,0.241525058363856,0.203232179711906,0.164119777396985,0.128515647874719,0.100390444676227,0.0819250638463349,0.0725867474848462,0.0688920147495737,0.0659425555047993,0.0603764051335678,0.0520508758785723,0.0429016047868094,0.0347119589883043,0.0280298559422965,0.0223947731034113,0.0170969479080652,0.0119437619133789,0.00745226751343854,0.00426175107644304,0.00248513747496406,0.00173400455364858,0.00165429864497702,0.00230035216642802,0.00393028892151934,0.00636911844597308,0.00861178361917017,0.00933810505698624,0.00803554202199468,0.00547269521256933,0.00294799423430788,0.00125581520562873,0.000423060765791204,0.000112723525470359,2.37643600526099e-05,3.96811557343832e-06,5.26242445654738e-07,5.5832306387644e-08,4.82693841396055e-09],[0.0021973932757295,0.00322467564418634,0.00375156166165595,0.0034588869874848,0.00253771198558285,0.00153426624102001,0.000957191337552727,0.00112785275234976,0.00233503755347768,0.00495952967518127,0.00930346098581369,0.0152169679056406,0.0220257755932058,0.0291932806575821,0.0370797164046574,0.0464426331532077,0.0569302466135227,0.0668027426770817,0.0747902315775634,0.0820293148727362,0.0918772339302361,0.107864317682873,0.131669905368562,0.16224821310062,0.195736551911005,0.226205706935749,0.248576354868389,0.263023164605191,0.276270853162521,0.296492290560087,0.325764341529418,0.357978608559154,0.384582995612605,0.401980751067213,0.413461550030466,0.425300608172461,0.441947665693037,0.464139782490072,0.489549651329819,0.513696060137736,0.530997004370979,0.537470175514287,0.533924521540386,0.526163397979353,0.521630493921505,0.525403756352321,0.537396412184827,0.551250302222869,0.556706116475719,0.545932605898507,0.519140334978333,0.483795278799029,0.448281392560408,0.416687198056617,0.389051919806641,0.364647569822575,0.343384552045048,0.324335021350277,0.304613867971162,0.280971932409175,0.252315827515716,0.220105509724878,0.186769856416633,0.154518240959644,0.125189628910618,0.100263386791985,0.0810243297524816,0.0687047037557253,0.0633816688347056,0.0622447182391196,0.0602427879042188,0.0537607567106352,0.0434571457096247,0.0329944718520921,0.0254770004862407,0.0213986246869993,0.0191413208989358,0.0166776267194886,0.0130598181995965,0.00879623048402426,0.00503470956743442,0.00251272631128536,0.00124764988060399,0.000946741166909144,0.00146409538628851,0.00281086128699533,0.00475199756017104,0.00650153864976997,0.00707151140780999,0.00608984491536964,0.00414834899404019,0.00223467889958638,0.000951919909919127,0.000320646668615753,8.54079508738848e-05,1.79899740101598e-05,2.99685735450236e-06,3.94930094515837e-07,4.12006286997947e-08,3.40919215277599e-09],[0.00387829663511781,0.00572389567611933,0.0066815887879604,0.0061692070240791,0.00451021268843582,0.00263425865667558,0.00132162514936193,0.000868403148686129,0.00133996119233536,0.00289546254823683,0.00575791149657816,0.00989744102040205,0.0149340958877604,0.0206360052950446,0.0274104360767142,0.0357278404744821,0.0449606119227753,0.0535579094199715,0.0608198451941469,0.0680174656590288,0.0774487467070722,0.0909118710873241,0.109436612810723,0.133507575047433,0.161931253775267,0.190499910576134,0.214023302819823,0.231481930125882,0.248091886943278,0.270088703570404,0.297598310125756,0.324537149967335,0.345569363407437,0.361136415903968,0.37531664881999,0.390854386457427,0.407307662619897,0.42281256720316,0.436277800598956,0.447391054854872,0.454929436665762,0.456500244027821,0.451102361954888,0.441785220089214,0.43543010119476,0.439322310005311,0.455510693636216,0.476324842047207,0.487127871632057,0.477148924435932,0.448584100787595,0.413891973800244,0.3843591822173,0.362273714063556,0.343140802505716,0.322774767948932,0.300763065937384,0.278201731828375,0.2545440714184,0.228007482261292,0.198210460445991,0.167157103829955,0.137934895099128,0.113070497110985,0.0934941698372749,0.0784841711452742,0.0671205313371642,0.0598256029831765,0.0573325771757595,0.0578191036623491,0.0565893426962572,0.0499460764081966,0.0388636946570195,0.0279112787880518,0.0209815072530043,0.0186052038427568,0.0185467853872984,0.017981347967944,0.0153744658720532,0.0111004378010637,0.00665067025300227,0.00329905239725073,0.00141449713615734,0.000718651894290387,0.00085190566031997,0.00160478474702395,0.00273546804179931,0.00375556780067078,0.00408891477974728,0.00352222732589237,0.00239947260565592,0.00129259500424701,0.000550614722987121,0.000185468290068954,4.94001180402068e-05,1.04045705500229e-05,1.73285562063188e-06,2.28220495612898e-07,2.37704289874632e-08,1.95852763275784e-09],[0.00529227880933611,0.00781457983644472,0.00912460580399053,0.00842522487534138,0.00615388888635336,0.00356652898520069,0.00168902826351701,0.000835741777742187,0.000937069111201284,0.00199571976243785,0.00412070421715363,0.00721837941538168,0.0108949954759185,0.0149298253862767,0.0197092624062641,0.0256913389021871,0.0324557810230188,0.0389938672283029,0.0451531097181737,0.0520994281829386,0.0610268163219266,0.0721808887895439,0.0857945915709765,0.103103787576212,0.124905440821764,0.14926662431854,0.172619503689949,0.194044054850791,0.216749717292969,0.243485714346183,0.271626955986907,0.295402061094291,0.312849083535384,0.327874659217293,0.344762819889976,0.362850471064496,0.377623125076778,0.385718114734707,0.387990420063891,0.388073435113555,0.388378499878145,0.3879302362683,0.38442945047713,0.378193551842857,0.374070494818242,0.379226872405597,0.396722186556961,0.41915416428699,0.430777196129734,0.419888008224589,0.389636635359242,0.354730392244023,0.327658350913349,0.309522516034808,0.293277869549809,0.273034582434495,0.248898696525057,0.224162192549995,0.200319549693453,0.176121611951385,0.150400314046354,0.124217806371407,0.100427832291399,0.0818282216265287,0.0692359503734239,0.0609944055054437,0.0549619665175606,0.0509227916496823,0.0499265019018971,0.0510698301224277,0.0504920220015116,0.044846422427095,0.0350928542797066,0.0256897211425758,0.0203903859634409,0.0195376750563734,0.0207049873511878,0.0208917902938524,0.01841274892309,0.0136479895780225,0.00835597019633088,0.00418767703147066,0.00173126424054275,0.000672341287924354,0.000463302825985782,0.000723188999236945,0.00120831046594883,0.00165716966563251,0.00180450538994177,0.00155452996188114,0.00105902710466581,0.000570500807372204,0.0002430200519753,8.18584876686224e-05,2.18032478932017e-05,4.59215316277264e-06,7.64822240234854e-07,1.00744879491766e-07,1.05059258161996e-08,8.72699553646678e-10],[0.00551669829158837,0.00814629414610069,0.00951213328344177,0.00878295764117442,0.00641409467187689,0.00371281416476639,0.00174446282243346,0.000832354123069971,0.000904370521244924,0.00196492791308026,0.00409621886219036,0.00708221405794878,0.010301443183423,0.0133099808146039,0.0164294462274829,0.0202935048944725,0.0248703758176886,0.0295806941447652,0.0344253419788189,0.0402104719531218,0.0473886510955866,0.0555059157896428,0.064464294362005,0.0756663252928398,0.0908469491381377,0.110123909022929,0.132461016066824,0.157867891442755,0.187234667029251,0.218990034687342,0.247630916063084,0.268106427156186,0.281653186963244,0.294854894258826,0.311925932797888,0.329614932590553,0.340772327145914,0.3417963307666,0.335770270831925,0.329154204374966,0.326304570229088,0.327037814309649,0.328596733664792,0.32928137784608,0.330771246530951,0.337540275168627,0.352207752332379,0.369412603284873,0.376225802154643,0.362519236011198,0.33131323089358,0.296482876868954,0.269888006301942,0.252233030144086,0.236098012896665,0.215528148367316,0.191395443436214,0.168416586677779,0.149049517593422,0.13155535221282,0.113141476098061,0.0934161764699198,0.0748075939510467,0.0604664689069744,0.0516704282752343,0.046952439549752,0.0439737065143226,0.0420245486715622,0.0418380275550679,0.0429201221567384,0.0424612912444927,0.0380281256300523,0.0306558105926536,0.0240701361886263,0.0210924470120304,0.0215311471626767,0.0230056261557118,0.0229041369744873,0.0199192632798234,0.0146420855627971,0.00892392863474966,0.00445502151870857,0.00181413823795334,0.00062719736112979,0.000260260854582597,0.000264966528129135,0.000410321375602335,0.000558479336915749,0.000607734115058489,0.00052352353808413,0.000356652079135514,0.000192129781204115,8.18429708998284e-05,2.75681186529136e-05,7.34328427129669e-06,1.54720238407308e-06,2.58287839931413e-07,3.4519302767575e-08,3.92400877495059e-09,4.93090541353782e-10],[0.00438835110054179,0.00648013034905974,0.00756662906440032,0.00698661173069183,0.00510247779412894,0.00295566289611579,0.00140147469932968,0.000725224465472547,0.000939079344274803,0.00215485018507223,0.00450439046513846,0.00770196597716251,0.010941128189387,0.0136024143810806,0.01600559878314,0.0189870591931548,0.0227616134490967,0.0268006990585829,0.0308279618653477,0.035174089641324,0.0399516567689194,0.0446822856074298,0.0493344949673606,0.055252289399751,0.0644702319331024,0.0785810810264692,0.098770952654505,0.125875761530117,0.158690984527074,0.192122700775437,0.218850216445239,0.234919750050931,0.24399571416589,0.254284251431953,0.269872641522571,0.286014388208505,0.294139089387792,0.290760823199212,0.280475937101246,0.271216604418837,0.26815801039351,0.271830301008323,0.27985933713068,0.289080912107527,0.297236429529325,0.304501809287809,0.312438604241789,0.319346837642107,0.31789197064803,0.300872096092126,0.269925229715363,0.235833492381888,0.208948873893916,0.190671660162983,0.174913287391176,0.156398322215416,0.136075591198848,0.118632226009137,0.10631492313853,0.0965890953742009,0.0854630648910758,0.0716828541868714,0.0574645484676357,0.0460929722419185,0.0392102865518532,0.0360357369373031,0.0347917415013398,0.0345438380002728,0.0352661989559793,0.0362369612097737,0.0354566745196909,0.0316059353397596,0.0260338995201515,0.0217179619497486,0.0203821172269535,0.0212486788899628,0.0221664213207699,0.0212561399473951,0.0178719703340415,0.0128013983713975,0.00765566559191145,0.00376790983951064,0.00151259578314853,0.000498916956568903,0.000154551685717121,8.62987634540599e-05,0.000108450555895477,0.00014390522155939,0.000156209195891745,0.000134532880914278,9.16493009231683e-05,4.9372535854477e-05,2.10337179313193e-05,7.08952301301867e-06,1.89592506680704e-06,4.09361803569825e-07,7.86660933454866e-08,1.90181652461165e-08,7.63181779422863e-09,3.54521644053058e-09],[0.00266361148084255,0.00393326690394972,0.00459274820071655,0.00424074606085633,0.00309757908118787,0.00179752692998132,0.00086967822512554,0.000521107725717248,0.00084161136771837,0.00202964278302723,0.00426049842735968,0.00727720099691938,0.0103224472848647,0.0128493481654921,0.0152645264911315,0.0184926286170745,0.0227629972175985,0.0273601501315301,0.0316161338024462,0.0354638668698406,0.0387908738929808,0.0410286654176863,0.0420608526475612,0.0432110478701361,0.0469119164279586,0.0558338841906759,0.0723822204670074,0.0975402035182409,0.128758250039636,0.159403500749595,0.182022184400147,0.193838998726627,0.199596901883425,0.207710894483717,0.221953223558216,0.237177238608707,0.244542936413147,0.240632260083543,0.230256734773168,0.221272744693246,0.218862895431939,0.224474389576873,0.236942483860657,0.25248046397505,0.265386300358047,0.271728341113939,0.272189140929898,0.269068437383897,0.260828190243341,0.242729813773693,0.213948986276921,0.181351230419069,0.154003200765092,0.135047263750418,0.120616967545355,0.10608595784764,0.091541185232515,0.0804734006899615,0.0743682509052301,0.0703503310077879,0.0643009791213104,0.054966924185876,0.0444611320874123,0.035706156256147,0.030195017448367,0.0277452051095898,0.0274594128598391,0.0285573445120509,0.0303428981119589,0.0315654360355048,0.0305467891414311,0.0267316801314795,0.0217743326200045,0.0182062115408442,0.0170830897944622,0.0173937580101449,0.0173818878656065,0.0158907952004557,0.0127999400096214,0.00885659449010804,0.00515743115632875,0.00248728818144224,0.000982071671582379,0.000316165659065916,8.64332457481886e-05,2.85088120501028e-05,2.31780844986328e-05,2.84683385556012e-05,3.06554765947957e-05,2.63818092598295e-05,1.79741183984364e-05,9.69322959054246e-06,4.15736803946915e-06,1.46006515869918e-06,4.88565419040614e-07,2.34479418161703e-07,1.76402455313675e-07,1.36605011214768e-07,8.8225007659066e-08,4.54575375441412e-08],[0.00123362883616278,0.00182165920787918,0.00212709646530397,0.00196411343167763,0.00143503014300342,0.000835304132174496,0.00041773732138484,0.000304644190917357,0.000602139272438076,0.00150663507924162,0.0031855290367342,0.00549009891328195,0.00793952527845988,0.010280869720166,0.0130260303153706,0.0170066357921889,0.0222892513740434,0.0279723721099998,0.0331840832744439,0.0376622307995064,0.0409990831506992,0.0421089452660531,0.0404101847911006,0.0373398041515796,0.0361270852314058,0.0403598260005925,0.0527587684675624,0.0738599601532869,0.100558976207179,0.126432783449195,0.145077291663903,0.15461548228908,0.159546557293034,0.16719151006204,0.180656573341805,0.195239235617654,0.20307346516047,0.201189167527747,0.193652245721663,0.186655648529083,0.184207195981326,0.188377147724535,0.199810671983475,0.215575515375126,0.228701745940042,0.233142814895959,0.229194757616396,0.221685207363827,0.212502675663888,0.197680537740925,0.173568770652247,0.143619425581145,0.116245435265582,0.0967058087091518,0.0834419023323494,0.072328915747145,0.0622671825311329,0.0552757981471606,0.0522472567921146,0.0507131551700243,0.04731246426207,0.0411689238185401,0.0340150793925254,0.0278782136474567,0.0236592168119878,0.0214953912567166,0.021350078103735,0.0229338832616562,0.0253517199400399,0.0269852173137367,0.0261415656572084,0.0224749736410194,0.0176392137281191,0.0139017477921734,0.0121523504883305,0.0115775130834694,0.010896267447738,0.00942572626488182,0.00722951362565186,0.00480333619657542,0.00270891622561684,0.00127442978492637,0.000493491848143073,0.000155942503660361,4.05172908270818e-05,9.90691286357389e-06,4.39302300800203e-06,4.38074629240721e-06,4.60072625190179e-06,3.9567224035779e-06,2.72596773084103e-06,1.57426600586033e-06,9.53143221647268e-07,9.17575220506346e-07,1.2402608148985e-06,1.57586552357233e-06,1.63476534775184e-06,1.34803777219101e-06,8.79728314345353e-07,4.54034288270212e-07],[0.000435955332579479,0.000643761103572831,0.000751702773446496,0.000694131147529493,0.000507368164273295,0.000296808817915985,0.000156307147849341,0.000144640584718526,0.00033838895683898,0.000875308897933086,0.00189079659795455,0.00338198411062429,0.00523345720221901,0.00754386749811321,0.0108574418261911,0.0157243195054187,0.021906626454381,0.028375509866528,0.0342798663020722,0.0393594430809629,0.0429488767915628,0.0433984603270715,0.0396930710553532,0.0335120437933857,0.0289060701076165,0.0300918081822724,0.0396512238384914,0.0575662320838157,0.080676766660524,0.103414113540703,0.120543415389967,0.130574715232968,0.13700599880951,0.14542773224737,0.158054106598287,0.17104600540216,0.178387716506681,0.178193958868118,0.173626943918591,0.168385677332865,0.164311779748928,0.16337335951291,0.168000965498446,0.177366077792118,0.185799694744622,0.187697443737834,0.183436431491913,0.178093381056556,0.173824980336529,0.165935947366917,0.14862242863378,0.123132460084773,0.0974207742161474,0.0781141705299669,0.065333010649437,0.0555499716890902,0.0470069022593198,0.0407706741358923,0.0376458674302743,0.0361485270069922,0.0340431193018362,0.0306513584227446,0.0267829251087796,0.0231607929076403,0.0199464880505368,0.0174887172328683,0.0165319904577448,0.0174485903578996,0.0195554379598479,0.0212071612471246,0.020711775072807,0.0176531034003419,0.0133630080649691,0.00973108186311982,0.00759929176301896,0.0065022394285086,0.00561200904313613,0.00451467740793856,0.00325337531400851,0.00205317767785163,0.00111213604912923,0.000507341455332464,0.000191885684566612,5.94865892376811e-05,1.50540705433744e-05,3.23944722468781e-06,8.44476730731318e-07,5.46513601506967e-07,5.42003290573806e-07,5.17664790588703e-07,5.91256589766428e-07,1.12526016091985e-06,2.63335910364006e-06,5.43469276573439e-06,9.03967700321501e-06,1.19263428750757e-05,1.24483428880965e-05,1.02750846837838e-05,6.70656473485249e-06,3.4613943849408e-06],[0.000117555594578622,0.000173590610628456,0.000202698192658341,0.000187185155637544,0.000136918143358683,8.07611480984499e-05,4.61276691426009e-05,5.65695560294709e-05,0.000154576823099771,0.000426334151971567,0.00100042287863514,0.00203324993726202,0.00374636088075558,0.00651060916478938,0.01076776559969,0.0166091410602309,0.0233617339878832,0.0298941224968905,0.0355128702037799,0.0400796834765938,0.0428544727925256,0.0420582139937346,0.0367461440136749,0.0289172944409794,0.0229704615851474,0.0232117345817392,0.0319980806938016,0.0490978842754532,0.071550375122911,0.0943792549653857,0.11285652018069,0.125330339666251,0.134193236266446,0.143506645573485,0.154783997387449,0.165094758050758,0.17022438243365,0.169387155159513,0.165140518286969,0.159263822975791,0.151793052843468,0.144249808253527,0.14012180173601,0.140598817067283,0.142415385456106,0.141853542441771,0.13955448414554,0.139248959513947,0.141505110745826,0.140746736609544,0.13055542755704,0.111238557029149,0.0898184670077793,0.0726859694315639,0.0605381884307867,0.0506150754235033,0.0414029392155226,0.0338168019677083,0.0290017173453663,0.02663854966674,0.0255605383340663,0.0249399503878132,0.0242384911219787,0.022708385284198,0.0198901767099406,0.0164837039845746,0.014019420481885,0.0134855445524686,0.0144529479525047,0.0154248135808764,0.0149446968399651,0.0126616672235514,0.00951276756202775,0.00677491416707398,0.00498618306326604,0.00385678545775436,0.00293723789046913,0.00206894217203964,0.0013137802635535,0.000744984541621252,0.000372150936828073,0.000160401685618941,5.83630923937195e-05,1.76110781901534e-05,4.35644096696194e-06,8.88697908842605e-07,1.72240623470207e-07,7.05371072084035e-08,1.191596148308e-07,4.26693934166697e-07,1.68050779650418e-06,5.59834671115971e-06,1.4914996465328e-05,3.14783403101431e-05,5.25487131783663e-05,6.93693884970496e-05,7.24122832487631e-05,5.97712737500447e-05,3.90129007978561e-05,2.013535867784e-05],[2.41873583655685e-05,3.57167291356002e-05,4.17060482175129e-05,3.85181343748026e-05,2.82098739396575e-05,1.6897970894866e-05,1.11832060330786e-05,2.0211980283166e-05,6.89505226836272e-05,0.000226725309495492,0.000655370509882736,0.00166820358958401,0.0037437287938784,0.0073860450018228,0.0127836618298206,0.0194517069471064,0.0262664201790396,0.0321219064590791,0.0366471940853352,0.0398895752524136,0.0411128432696229,0.0387191239471058,0.0322050232281582,0.0238584750527299,0.0179336326758789,0.0184032159242825,0.027508951355001,0.0452413787700153,0.06895903386083,0.0937620264266327,0.11465005350013,0.129440303053222,0.139776278996054,0.148970194852654,0.158405922399053,0.165932985959563,0.168305341373929,0.164983219392571,0.158081591957572,0.148905261092921,0.137282210385586,0.124650874539951,0.114596598670778,0.109094904224444,0.10659455675285,0.105045087390453,0.105098662807097,0.108702957116298,0.114801347628742,0.11797102690567,0.112870142700465,0.099813653056224,0.0843045394762088,0.0710954446225447,0.0605164520025379,0.0505941563359282,0.0406174055790072,0.0317896067116912,0.02562271560282,0.0227077263533056,0.0226752751669238,0.024418911033861,0.0261168972724237,0.0257927406355683,0.0226766498643586,0.0180179375750705,0.0140812126804195,0.0121979013433644,0.0119043390168373,0.0117804309690449,0.0108147965228385,0.00904856549284888,0.00720731886447972,0.00584474428597672,0.00487121544869326,0.00388080354185319,0.00272823144763647,0.00162644285385758,0.000820100308590134,0.000357209161610068,0.000138458089728556,4.86448391556312e-05,1.53770108507214e-05,4.25448690231401e-06,9.99229954670386e-07,1.95835547715287e-07,3.82021174364412e-08,5.3336235610299e-08,3.21775409983542e-07,1.72170697093228e-06,7.34226946453238e-06,2.4786198366373e-05,6.61758124369738e-05,0.000139712696275407,0.000233243601118584,0.000307906803277945,0.000321413608860121,0.000265304506099557,0.000173165102445105,8.9374063361114e-05],[3.79732190134851e-06,5.60739584748505e-06,6.54780453888151e-06,6.04862850271709e-06,4.44358665347532e-06,2.7821787014034e-06,2.72266771348401e-06,9.3071695839275e-06,4.34319471722934e-05,0.000179110016542217,0.000621647612009167,0.00179770923023676,0.00432274566217116,0.00868324730171983,0.0147305037511226,0.0214662976383086,0.0275372311785666,0.0321610760544004,0.0355065159086708,0.0378275689467653,0.0382539791707775,0.0351792836149601,0.0283415096010122,0.0201097011972561,0.0144314279980535,0.0149246314591892,0.0238684798174419,0.0416811519609627,0.0660810548799522,0.0920264847280191,0.113949741924354,0.129120990460074,0.138911347902557,0.146640135509334,0.154059579718742,0.159619554035591,0.160217855745068,0.15466589076047,0.144541654228963,0.131702893324898,0.117093616807602,0.102544746060785,0.0911462018109479,0.084554558867678,0.0817488596070374,0.0813188494745235,0.0834211963194728,0.0884782135532956,0.0946704086826885,0.0978363439449157,0.0946805511014211,0.0859896778995806,0.0756444190143487,0.066441509907894,0.0581384846130217,0.049464159506668,0.040419483601302,0.0322693790652758,0.0264299041641235,0.0238173125739767,0.0245121280456064,0.0273085051182293,0.0297353098967857,0.0293064394433526,0.0253797682386016,0.0197661295565775,0.0151416897644746,0.0127504919259603,0.0117705328232381,0.0107329408509546,0.00913307072444393,0.00760436505244923,0.00688736201651339,0.00689187511783552,0.00676681261593208,0.00579602358792948,0.00408332801430739,0.00231552822806952,0.00105180300510867,0.000384369904699848,0.000114520999076207,2.85440502793953e-05,6.19415621549702e-06,1.22257399233644e-06,2.24228169477436e-07,3.9153255630227e-08,2.38426207973669e-08,1.58690950199588e-07,1.07840010782764e-06,5.82235382776856e-06,2.48612292332348e-05,8.39439396493342e-05,0.000224126183885133,0.000473185474418651,0.000789960947164031,0.00104283410294957,0.00108857964763161,0.000898546541771506,0.000586484211396037,0.000302696538354945],[4.54894058060694e-07,6.71731157652761e-07,7.84426114394071e-07,7.2523606910881e-07,5.40681474339264e-07,4.22762789075709e-07,1.11015289340605e-06,6.6850879586769e-06,3.70777320550607e-05,0.00016791682815546,0.000614873231332351,0.00182136177822548,0.00438554835529829,0.00866235109188592,0.0142381585014339,0.0199009409598224,0.0244428041396097,0.0276427476213512,0.0302518654671327,0.0326801757666428,0.0337981254355766,0.0316611982912474,0.0257460246624863,0.018147285251863,0.0125069726159144,0.0122534691098836,0.0197423175361631,0.0357368897478441,0.0583595178896286,0.0827356947695727,0.103160769709678,0.116705771617029,0.124707897256357,0.130631647046627,0.136534424988605,0.14122054864859,0.141519043506181,0.135506398547645,0.124178139319228,0.109917962343231,0.0947866046869345,0.0809818733099747,0.0710274870916886,0.066066229908401,0.0650827271552642,0.0665707598966011,0.0698891004759151,0.07445565638147,0.0785215559544883,0.0795763321474719,0.076262844336122,0.0697567193260766,0.0626265294534865,0.0562930378483096,0.0503581224496352,0.0442066328200711,0.0381417039112466,0.0329515441771155,0.0293410103584896,0.0279022848166709,0.0287875176758632,0.0309466592596933,0.032117567264655,0.0302497150244705,0.0252702506289113,0.0193213336505018,0.0149372856430669,0.0128842242331859,0.0119127715021926,0.0105328066773891,0.00865612669028414,0.00739148253811652,0.00754812509532403,0.00859687326025223,0.00909085690279444,0.00802853289343783,0.00570326201907843,0.00322192690127976,0.0014429300007589,0.000512122359958311,0.000144234777765243,3.23466226880019e-05,5.82007588282404e-06,8.53520088992107e-07,1.05454576001588e-07,1.57427959056945e-08,4.83970605831866e-08,4.08122913751533e-07,2.78633403091452e-06,1.50462494124925e-05,6.42481770353299e-05,0.000216934621481313,0.000579205030862141,0.00122284430806322,0.00204148122000607,0.00269497656629235,0.00281319591824088,0.00232209693547532,0.00151564012178288,0.000782252973467214],[4.1580264812894e-08,6.14015944844893e-08,7.17248968893827e-08,6.67049739685644e-08,5.53434327640253e-08,1.06563444741541e-07,7.23102071365735e-07,5.14092541321126e-06,2.9655980727413e-05,0.000136636905759456,0.000503108368537112,0.00148528155675038,0.00353565970196013,0.00684771239496428,0.0109451563773418,0.0147840059249917,0.0175777833299471,0.0196070788663614,0.0219460204836269,0.025045255179544,0.0276098006234399,0.02735889595493,0.0232449136264011,0.016794469362662,0.0112628468968619,0.0098986117958263,0.0149869063306692,0.0273989346436201,0.0457218213845658,0.0658548841719237,0.0828244210094687,0.0940472804683885,0.100753401964181,0.106020670510214,0.111577665282605,0.116274545553655,0.11719273761192,0.112316974166399,0.102229876023633,0.0892303255605991,0.0756688722248657,0.0637286276854251,0.0555039692830476,0.0518986519604124,0.0519727100463084,0.0540658462314573,0.0569835427673822,0.059810149402159,0.0613653747807386,0.0604989874013596,0.0569889472557972,0.0519383723138423,0.046889858204287,0.0425561804219955,0.0388265913135888,0.0357120638698904,0.0335274017524616,0.0323145360664515,0.0318235801612297,0.0319901230361782,0.0327418782174351,0.0332501903500176,0.0319916336987079,0.027995117307521,0.0220037219822132,0.016191534137337,0.012487200669522,0.0110379799316515,0.0103890218986759,0.00919801374427692,0.00759573024084114,0.00678830011712079,0.00752003267108203,0.00908748708220357,0.00986875380161108,0.00880277462998193,0.0062737340600293,0.00354582897513605,0.00158609315603367,0.000561239680701909,0.000157100170356431,3.47970170376608e-05,6.10329005013088e-06,8.49145282941832e-07,9.4669163122151e-08,1.68935997183638e-08,9.37673849014035e-08,8.04586459699852e-07,5.49432739389926e-06,2.96695990571198e-05,0.000126690593788611,0.000427772094554138,0.00114213097621418,0.00241131946462061,0.00402558475424659,0.00531420836612052,0.00554732440768076,0.00457892922552916,0.00298868180005433,0.00154252001595851],[2.90008468050288e-09,4.28311674381091e-09,5.0162266637565e-09,4.90511452266019e-09,7.56516363684993e-09,5.0528298434802e-08,4.47860278904453e-07,3.26463037562494e-06,1.89283165173426e-05,8.72334260028276e-05,0.000320150749365886,0.000938639754623915,0.00220942480559373,0.00420895989265683,0.00657940298059997,0.00866420929541026,0.0101269385606087,0.0114834384872913,0.0137801421167682,0.017397423409975,0.0210707245318269,0.02245756902835,0.0201228284677405,0.0150087760992729,0.00989166537931148,0.0076936411150635,0.0104057603436194,0.0187653762113304,0.0317846840226466,0.046513547879189,0.0593823728541537,0.0686384265171172,0.0752907853949192,0.0813837886593743,0.0876010738683545,0.0925804269062755,0.0940817845742941,0.0907205754120616,0.0829271339143959,0.0724638023893201,0.0613591363513078,0.0515314207349467,0.044640605447654,0.0413062545298265,0.0406709828450908,0.0412613750728851,0.042035408408048,0.0424514799553477,0.0420754247088559,0.0405687365864395,0.0380093367289103,0.0349677519388011,0.0320717137458332,0.0296428958197424,0.0279602534483129,0.0274999868319546,0.0284488223780919,0.0302423986713038,0.0320276329004653,0.0333441579836693,0.0338993581267853,0.0329467990396533,0.0295921579044858,0.0238847726341246,0.017279247930245,0.0118081547711793,0.00870080800462945,0.00763114568766676,0.00723705817987598,0.00646338369708081,0.00545153335206364,0.00513445906800757,0.00603949524179182,0.00753737969056228,0.00828165862874923,0.00741527818106654,0.00529127254092665,0.00299155348959176,0.00133812571144837,0.000473368116662763,0.000132423964181594,2.92955803350213e-05,5.12545926592841e-06,7.09343026719303e-07,7.85941915272397e-08,1.95681330909204e-08,1.40632646295783e-07,1.21056728914791e-06,8.26688353562368e-06,4.46415306396244e-05,0.000190621452365124,0.000643635297336704,0.00171847537488055,0.00362812427584017,0.00605698331791636,0.00799587473287761,0.00834662625372995,0.0068895575738921,0.00449683633822453,0.00232090952609101],[1.54348274153405e-10,2.28225185063257e-10,2.73610296968468e-10,3.84779593307694e-10,2.22440521802017e-09,2.39225856223847e-08,2.19780438038439e-07,1.60598585654065e-06,9.3052402117057e-06,4.27894320798907e-05,0.000156424049605625,0.000455804273817374,0.00106317319607697,0.00199974975555567,0.00307767895552128,0.0040059179338387,0.00475568029706622,0.0058564288414688,0.00814564431245884,0.0118844377105148,0.015934441418926,0.0181138817960536,0.0168932641355026,0.0128563458420053,0.00834588289397545,0.00586875982580964,0.00700673273353594,0.0122245274670356,0.0207599499755572,0.0306487697475306,0.0397577873972709,0.0473596377695314,0.0543419189386049,0.0615631004823007,0.0684104564777742,0.0732235825943847,0.0746251596578535,0.0721797534154954,0.0663567519421785,0.0583568047903013,0.049834395389767,0.04244571172988,0.0372372737243877,0.0341145432842443,0.0320477383834297,0.0300674896359447,0.0279682951819347,0.0260539501176391,0.0245619669836083,0.0234954713279976,0.0227701299804758,0.0222661290109376,0.0218065468447191,0.0214091235561748,0.0215813507769744,0.0229282562894806,0.0253213878863128,0.0278582450591161,0.029776667610547,0.0309467509553455,0.0312026054062695,0.0297114184680087,0.0256588920655045,0.0194837357380102,0.0129560681455587,0.00794357656159898,0.00521405280919555,0.00424819224359794,0.00394240801320578,0.00353422088094068,0.0030600153148717,0.00304400338857577,0.00376602620663608,0.00480774795172135,0.00532014310262506,0.0047732237307876,0.00340796141010046,0.00192709185612972,0.0008620219731314,0.000304939599358933,8.53015989850477e-05,1.88686790979291e-05,3.30040974586576e-06,4.56561017300882e-07,5.0998286181024e-08,1.90535955368779e-08,1.61220881698038e-07,1.38981196140176e-06,9.49102269411072e-06,5.12519385700316e-05,0.000218848207751458,0.000738943227648102,0.00197294297780845,0.00416536798680319,0.00695388649640685,0.00917988417888631,0.00958257412145799,0.0079097462985563,0.00516271679276949,0.00266458409504394],[6.27130169605588e-12,9.37415322573704e-12,1.36163110360908e-11,6.22781173255572e-11,7.7754773289646e-10,8.98119885903207e-09,8.28096075065406e-08,6.04811145125669e-07,3.49971517887513e-06,1.60584788931376e-05,5.85114929427028e-05,0.000169672494955749,0.000393099477771927,0.000733438079497606,0.00112395256559701,0.00149332024700549,0.00195544711887039,0.0029658491694499,0.00515133533948879,0.0086649461745051,0.0125018041605647,0.014738179446191,0.0139790495376942,0.0106790426271933,0.00684373536881034,0.00457759176190738,0.00509217856193727,0.00858587079273385,0.0143043253523041,0.0207857067294748,0.0268408793278508,0.0325974603611206,0.0390551043294581,0.0463403452145563,0.0529479473348943,0.0570350146341766,0.0578824976923026,0.0557653091593094,0.0512143295651421,0.0451047132277721,0.038936844807247,0.0341851530185747,0.031188642201134,0.0289128054430426,0.0259936402468296,0.0220280364730512,0.0178003663368163,0.0144368773733906,0.0126034687482542,0.0123861799382642,0.0134727579152744,0.0152258125548701,0.0169247448680592,0.0183812188530306,0.0201341074854705,0.0225505408531534,0.0249510257963175,0.0262500462825943,0.0263216024037693,0.0260120540389636,0.0256834494027995,0.0243847646463963,0.020927806121625,0.0154985263787773,0.00974115429212498,0.00535522274873364,0.00293220712073641,0.00198791206555988,0.00169081558145557,0.00149324454854126,0.00132636251788799,0.00139430562673379,0.00180470714927938,0.0023464376165433,0.00261037853914021,0.00234532964463918,0.00167512386282208,0.00094732085303065,0.000423763997354782,0.000149906855137862,4.19336980026153e-05,9.27561399062908e-06,1.62240499761611e-06,2.24447487026679e-07,2.54760535199272e-08,1.50301100547805e-08,1.41119312116606e-07,1.21749975641312e-06,8.31434488641504e-06,4.48978282545588e-05,0.000191715855469626,0.000647330560701402,0.00172834155084088,0.00364895420045603,0.00609175790013032,0.00804178095197662,0.00839454622075568,0.00692911216298314,0.00452265374546156,0.00233423441983598],[1.95346731754541e-13,3.21127152998561e-13,1.14392529154149e-12,1.53742122931753e-11,2.22114659629615e-10,2.58564496964447e-09,2.38394085636582e-08,1.73986686058001e-07,1.00559134396568e-06,4.60609798855106e-06,1.67404609797761e-05,4.83776030194023e-05,0.000111673452695087,0.000208489615800618,0.000327310129938314,0.0004835696341518,0.000819470220721488,0.00169211741690926,0.00355747498070558,0.00649610114175704,0.0096747479753571,0.0115307056373325,0.0109478449382984,0.00832597858620434,0.00530856997411819,0.0035801510856127,0.00405880249590227,0.00678126187314332,0.0109536960876332,0.0152852730918155,0.0190004483810128,0.0226785542342991,0.0275150913145574,0.0335383965415517,0.0391148651071698,0.0424730300295886,0.0430976187598693,0.0413538149776282,0.0376712961607429,0.0328351116316191,0.0283777388292841,0.0256557874758196,0.024499545594593,0.0232765795445505,0.0204684962659687,0.0160522801675957,0.0113486085414586,0.00783262858512225,0.00629418291532237,0.00682460223214619,0.0090227276663704,0.0120547520338823,0.0150190072452568,0.0176938839537458,0.0205572526847377,0.0235701607458475,0.0254553651292767,0.0249959104291696,0.0227349137449893,0.0205171792301376,0.0193401365999355,0.018302279934811,0.0158775544417531,0.0117872899017223,0.00725981725764046,0.0037274469198828,0.00171498846513034,0.000871032806060882,0.000595798326479117,0.000491341381464783,0.000443161703451029,0.000491486929265219,0.000662670947375285,0.000875044505367267,0.000977717390091609,0.000879424491863559,0.000628295308104409,0.000355340652661552,0.00015895702127376,5.62314242938225e-05,1.57297217451632e-05,3.47936659298791e-06,6.08578146820479e-07,8.4207406799478e-08,9.83027002859435e-09,9.42405385011988e-09,9.42864364578872e-08,8.13816533562744e-07,5.55759483880661e-06,3.00112572170119e-05,0.000128149491309299,0.000432698077369237,0.0011552831142035,0.00243908686349514,0.00407194112437577,0.00537540380107272,0.0056112042758687,0.00463165759940324,0.00302309777889615,0.00156028280898363],[4.84515952688479e-15,1.43393709675011e-14,1.85886523701094e-13,3.320940503431e-12,4.88038757112149e-11,5.68468810111474e-10,5.23927398706786e-09,3.8213720258912e-08,2.20659274027949e-07,1.00939624423011e-06,3.66238486616447e-06,1.05697052051193e-05,2.44717105904531e-05,4.68141763804988e-05,8.1478218379354e-05,0.000158691430332564,0.00039004500314551,0.00101993155000345,0.00234991738723354,0.00441942176578777,0.00663652096885158,0.00791227955509183,0.00748725277271691,0.00567014023812918,0.0036315100738555,0.002563850381918,0.00311828559510545,0.00527883992899119,0.00833758779997035,0.0111845267788038,0.013221224059496,0.0150854312404904,0.0179924018036937,0.0222017391849993,0.0265454031790746,0.0295703875432384,0.0306073994715138,0.0295845331936571,0.0266530447601037,0.0226079442537091,0.0190399874114801,0.0172136472744332,0.0168181266480342,0.0162448935808516,0.01415929692523,0.0106523286331265,0.00694974818136051,0.00433610588456199,0.00349441472068504,0.00452288678622445,0.00705231840872391,0.0102740443731098,0.0133673134779578,0.0162339111893902,0.0193508144056484,0.0224528256686321,0.0239752026034921,0.0226189864242676,0.0191231220524507,0.0156803948999411,0.0136746503014255,0.0125440721143433,0.0108743108176675,0.00811829488601519,0.00498819165786927,0.00249270360286564,0.00103798909451045,0.000404276943785234,0.000192184377345775,0.00013012749227004,0.000114698027804587,0.000133215496651549,0.000186260899248046,0.000249237599780924,0.000279499660480912,0.000251633434229333,0.000179818170479798,0.000101704336695577,4.54967600504252e-05,1.60946440722192e-05,4.50218876230156e-06,9.95870583976863e-07,1.74188666585642e-07,2.41099856077637e-08,2.95344528265344e-09,4.62844345677212e-09,4.80774956725233e-08,4.15076830121733e-07,2.83458542891711e-06,1.53068864713053e-05,6.53611310170764e-05,0.000220692532110945,0.000589238476234369,0.00124402738097666,0.00207684536711803,0.00274166107506232,0.00286192831584158,0.00236232212931917,0.00154189523489434,0.00079580377619736],[1.25462030063351e-16,1.39149333378787e-15,3.00206810002949e-14,5.56378442015254e-13,8.19050599663408e-12,9.53904323269074e-11,8.78870177471571e-10,6.40708048361004e-09,3.69716951734966e-08,1.68993124200955e-07,6.13028543997015e-07,1.77587819669264e-06,4.20457454215081e-06,8.82927207406569e-06,2.01148788179385e-05,5.87248388420407e-05,0.000189868628867323,0.000550442656961891,0.00130699836868125,0.00247723716554361,0.00372357332775156,0.00443239689878669,0.00418329255523597,0.00316375199808529,0.00205055098764805,0.00154073427376882,0.00203085517824281,0.00350739662209067,0.00547925718895923,0.00716288033657341,0.00813755948420396,0.00889148962681774,0.0104195228769634,0.0131664182619598,0.0165526919675168,0.0195051083072408,0.0211087594132443,0.0207758311355052,0.0184287105536927,0.0149040172807044,0.0117415024029224,0.0100539127135556,0.00962008809354671,0.00925473547099067,0.00800494015065878,0.00591100592540169,0.00376868065343398,0.00243613158691643,0.00242872259959484,0.00386314808364347,0.00639191213581239,0.00920836170923426,0.0115764919330176,0.0135740199103883,0.0158691130801224,0.0184132330458586,0.0198565419968391,0.018860957473874,0.0157229241182044,0.0121534307012456,0.00956830546651138,0.00799079814560808,0.00657921847344081,0.00481306804770659,0.00293313779245368,0.00144931574051106,0.00057984109552105,0.000195631070435034,6.54554293249539e-05,3.03017287004179e-05,2.34040890489928e-05,2.77930414225343e-05,4.00586299128895e-05,5.42094151491444e-05,6.09788651507051e-05,5.49419448213519e-05,3.92692756055368e-05,2.22115784520782e-05,9.93631873956491e-06,3.5150190218787e-06,9.83264393516035e-07,2.17495161675292e-07,3.80424256196664e-08,5.2686637666547e-09,6.99434916056727e-10,1.76236647480306e-09,1.87079652437304e-08,1.61537959965549e-07,1.10315372877806e-06,5.95707887585098e-06,2.54370092590008e-05,8.58883237689536e-05,0.000229317705224845,0.000484146089823525,0.000808259190299256,0.00106698977000868,0.0011137949410584,0.000919360007104955,0.000600069227017781,0.000309708043733144],[6.60266166466156e-18,1.64286937857504e-16,3.82960176799728e-15,7.12563943989506e-14,1.04905494530636e-12,1.22156960640311e-11,1.1251910758349e-10,8.19999777637911e-10,4.73021832710415e-09,2.16274894609409e-08,7.87491416831938e-08,2.3260873973124e-07,5.97075032034138e-07,1.60731440245123e-06,5.54940450244256e-06,2.20412698324876e-05,8.01945434016162e-05,0.000240331466239023,0.000575421035902095,0.00109237485299361,0.00164129203866534,0.00195146100955913,0.00183949475013411,0.00139272672116134,0.000918301373706035,0.00073962163989741,0.00105199656418364,0.00185280838332605,0.00288273834929521,0.00371844238441618,0.00414276346890369,0.00448264608650287,0.00544051081215921,0.00749044034710958,0.0104190189039566,0.0133581280165942,0.0151742135931463,0.0150117201225625,0.0128423290654504,0.00963373945042345,0.00677466070179592,0.0051149548435827,0.00450262927989317,0.00418633550932086,0.00357269340782179,0.00263211708727082,0.00177104649415246,0.00150912564727694,0.00226801049979344,0.00418940086801586,0.00685899844746291,0.00930236383666377,0.0106984676631038,0.0112625771587108,0.0120469714022259,0.0136030153517397,0.0151282206598178,0.0152308151631672,0.0133753039257466,0.0103465347270477,0.00740200908293104,0.00521641306837139,0.00367959274382197,0.0024521004328057,0.00142857739993825,0.000690734695782898,0.000270791579229602,8.63133655918149e-05,2.37392059766768e-05,7.17822104046926e-06,3.95724009557266e-06,4.48390662442058e-06,6.59174201939498e-06,9.00255933259756e-06,1.01529455807387e-05,9.15379405181792e-06,6.54365545091104e-06,3.70138537263133e-06,1.65582587937342e-06,5.85757532949071e-07,1.63855405989786e-07,3.62443356294713e-08,6.33959638396826e-09,8.78917982112255e-10,1.3271457198265e-10,5.16858263608825e-10,5.55497606462651e-09,4.79694438707835e-08,3.27586761481834e-07,1.76898299121318e-06,7.55364125020971e-06,2.55049474852493e-05,6.80969865581626e-05,0.000143769491058589,0.00024001642247097,0.00031684770242549,0.000330746721259208,0.000273008340043146,0.000178193419675689,9.19692810913658e-05],[5.46011350016751e-19,1.5913852719219e-17,3.74195110370895e-16,6.96512154308707e-15,1.02534639722147e-13,1.19380255769073e-12,1.09943219189072e-11,8.01146004138378e-11,4.62364664777141e-10,2.1212141320562e-09,7.85157843884137e-09,2.48320792272337e-08,7.95652176630632e-08,3.23463642110072e-07,1.5676326982965e-06,7.13902846963075e-06,2.69878455253856e-05,8.16478187695689e-05,0.000195898741277604,0.000371958918201129,0.000558645030721616,0.000663835519053694,0.000625619618873847,0.000475154619845793,0.000320396904446348,0.000278293214288509,0.000424248582068522,0.000759746776771632,0.00118188451037537,0.00152441163829326,0.00173263659858151,0.00204977304201491,0.00298324738281403,0.00496915355520989,0.00790012578559175,0.0108757112652541,0.0125553158435739,0.0120526326055967,0.00963259069842867,0.00650296401441625,0.00390861493898696,0.00239438780082667,0.0017594578203037,0.0014991645742669,0.00124771645751541,0.000949007610164959,0.000803662981171365,0.00117006573277689,0.00245299094528684,0.0048148555242046,0.00773982455870338,0.0100268016638335,0.010683131645095,0.00999160369970439,0.00937791512330585,0.0100064054532169,0.0116093874098561,0.0127453276200804,0.0121302307182257,0.00972593437298902,0.00661451293330358,0.00395505691765715,0.00219919968614908,0.00118057338236454,0.000598369381535504,0.000269154314186764,0.000101772010216261,3.14555616345231e-05,7.9885486645638e-06,1.84095182111052e-06,6.17461843823732e-07,5.67536405068309e-07,8.30458242079548e-07,1.14147843973405e-06,1.29005794034569e-06,1.16374210438334e-06,8.32023108251599e-07,4.70645486499041e-07,2.10546418445009e-07,7.44821079583143e-08,2.08350750485229e-08,4.60865844925499e-09,8.06122572612806e-10,1.11968654350951e-10,2.05364768059936e-11,1.16288544838515e-10,1.25862646467553e-09,1.08692276700426e-08,7.4226753481828e-08,4.00827750296024e-07,1.71155349934793e-06,5.77907801986952e-06,1.54298611461651e-05,3.25762327558229e-05,5.43844927464333e-05,7.17934272866986e-05,7.49427579915019e-05,6.18600174768793e-05,4.03762319263249e-05,2.08390019687633e-05],[3.99339797726196e-20,1.18593435361242e-18,2.79111345643328e-17,5.19524641285704e-16,7.64748946654536e-15,8.90323523986107e-14,8.19946182743429e-13,5.97791083286805e-12,3.46015837080924e-11,1.60920846719778e-10,6.30524564894772e-10,2.42038688122395e-09,1.15515265248813e-08,6.78443679262063e-08,3.85593250880622e-07,1.83740992545007e-06,7.02391661776603e-06,2.13048538208689e-05,5.11421868275424e-05,9.71026858024022e-05,0.000145827394095026,0.000173352765770913,0.000163823779367848,0.000126130496835941,8.99254835914549e-05,8.79154770139351e-05,0.000141718689795786,0.000251272377784501,0.000386481867172886,0.000508751344108674,0.000652552851937535,0.00103520381354303,0.00207741636289168,0.00417680653620487,0.00721340273514753,0.0101867362170179,0.0116262653938967,0.010713338398323,0.0079977118170351,0.00488284088409847,0.00250935737064433,0.00118908253011619,0.000635658113951844,0.000440355174039575,0.000347806466860565,0.000303806175520066,0.000428277054904231,0.0010069675199064,0.00242162152850919,0.00483215212318861,0.00770006833025295,0.00978073881354884,0.0100437046140023,0.00876757290142801,0.00746501507569825,0.0075440625974634,0.00904584414452683,0.0106193779279425,0.0107010339077735,0.0088384519525966,0.00593056728037934,0.00326622774311579,0.00152208389110675,0.000632758117930361,0.000247947040278039,9.26195191286431e-05,3.15340052624478e-05,9.22824681614042e-06,2.23968104681518e-06,4.57255153199226e-07,1.00372568147205e-07,5.86466097077945e-08,8.03091427837283e-08,1.10512798829967e-07,1.25090757912288e-07,1.1289344485688e-07,8.07229838161797e-08,4.56633799666774e-08,2.04279624703788e-08,7.22653148397594e-09,2.02149742645512e-09,4.47149499412778e-10,7.82146976864771e-11,1.08998604806619e-11,2.62550928930837e-12,2.00254956048367e-11,2.17602500455527e-10,1.87921538206891e-09,1.28333017727247e-08,6.93003969886578e-08,2.95915981079822e-07,9.9916335810602e-07,2.66771824586995e-06,5.6322094982698e-06,9.40270960429872e-06,1.24125962049804e-05,1.29570941044687e-05,1.06951770822591e-05,6.98077640420662e-06,3.60292197390295e-06],[2.26822202514162e-21,6.74965518775406e-20,1.58865902983027e-18,2.95696607862696e-17,4.35257302946191e-16,5.06752756829032e-15,4.6691824223088e-14,3.41252204420025e-13,1.99745468905622e-12,9.73599482617859e-12,4.50598875029888e-11,2.52162883004078e-10,1.78261233930089e-09,1.26030822564405e-08,7.56336056306036e-08,3.65275406952344e-07,1.40076552229577e-06,4.25199076729781e-06,1.02106140066102e-05,1.94068916823701e-05,2.92717729454026e-05,3.54170083941396e-05,3.58379127324295e-05,3.46731714766679e-05,4.07091828547795e-05,6.09550924293667e-05,9.45566668617938e-05,0.000132120114552995,0.000162986601047765,0.000194730032320958,0.000296202248630662,0.000666712482236486,0.00166718231398122,0.00364704398314769,0.00648549222741882,0.00922357096632662,0.0104616661476307,0.00946913350787943,0.00685343664185543,0.00398214931152604,0.00187641100598846,0.000741909470445167,0.000276397962398458,0.00012544522220898,8.53980093920395e-05,0.00010575837925726,0.000263349824479764,0.000770905899134107,0.00192851969386565,0.00386259401157068,0.00613598552198897,0.00774138850052531,0.00784197292001653,0.00665418671719665,0.00540809760003323,0.00530011499063202,0.00645783951504838,0.00783532174244854,0.00810793334922344,0.00679457825278164,0.00455368397417124,0.0024420600935922,0.00105806350691846,0.000379080281773011,0.000117365640952791,3.33321497587132e-05,9.02802498051057e-06,2.28759985421128e-06,5.12596477874741e-07,9.75030573151016e-08,1.68828827336412e-08,5.40178571455182e-09,6.00943977247418e-09,8.17281920098884e-09,9.25642155135523e-09,8.35671754008469e-09,5.97592906060359e-09,3.38054449590552e-09,1.51232877649117e-09,5.34997427973808e-10,1.49656348085562e-10,3.31035704944329e-11,5.79064045981538e-12,8.11723867620902e-13,2.77878048032033e-13,2.6359080805497e-12,2.87064515815593e-11,2.47912416655751e-10,1.69301250182478e-09,9.14234237030661e-09,3.90382354134132e-08,1.31813003974525e-07,3.51934398807744e-07,7.43020094720109e-07,1.24043720017125e-06,1.6375116037108e-06,1.70934360516191e-06,1.41094387400712e-06,9.20927594519858e-07,4.75309632417067e-07],[9.84937160801783e-23,2.93152588674777e-21,6.89985922354513e-20,1.28425941260435e-18,1.89051480603459e-17,2.20197612026437e-16,2.03302594226712e-15,1.49945908918376e-14,9.12097534252132e-14,5.12091410566865e-13,3.36256478268063e-12,2.84243527744042e-11,2.49064282673739e-10,1.88039548018703e-09,1.14708111792958e-08,5.56183512459834e-08,2.13577533097541e-07,6.49705909893469e-07,1.57260543726053e-06,3.08382045348429e-06,5.22516052263168e-06,9.05607672905778e-06,1.93110826888007e-05,4.67413790352178e-05,0.000104350039188871,0.000193079761123209,0.000286745520173873,0.000339885766175145,0.000324839719317478,0.000268398465919223,0.000266952418395372,0.000505042881224935,0.00127340606232142,0.00285896333203771,0.00519609257608735,0.00753889454809909,0.00872167799829492,0.00805248941390446,0.00594103422648129,0.00350823982337289,0.00166231580453728,0.000636284016755964,0.000201779565247207,5.90572990438072e-05,2.60710966149008e-05,4.45629617986965e-05,0.000150555781019179,0.000470993414513049,0.00119006706063415,0.00238541367254316,0.00378555889426879,0.0047656117406581,0.00480539679677212,0.0040363761195317,0.00322205958630294,0.00311651067270247,0.00381950706623734,0.00469366426083072,0.00490635855254835,0.00413542861672296,0.0027735420218966,0.00147693218609982,0.000625820701332067,0.000212513097442748,5.87945299458487e-05,1.37057808504012e-05,2.84327397389396e-06,5.54917624974596e-07,1.03063741778488e-07,1.74736276558233e-08,2.6374914646211e-09,4.99150798321689e-10,3.56114103016951e-10,4.62292782151852e-10,5.2274299231384e-10,4.72017189654009e-10,3.37566826543433e-10,1.90963168304888e-10,8.5430181325164e-11,3.02215920154435e-11,8.45397422917619e-12,1.86999664322961e-12,3.27130727274665e-13,4.63349101177935e-14,2.41029254385041e-14,2.65001210849336e-13,2.88962608872134e-12,2.49553596548775e-11,1.70422032646463e-10,9.20286512178052e-10,3.92966704320222e-09,1.32685612476789e-08,3.54264221658137e-08,7.47938923913403e-08,1.24864895481424e-07,1.64835201023268e-07,1.72065954302979e-07,1.42028439113025e-07,9.27024180021412e-08,4.78456205319201e-08],[3.26413590888702e-24,9.71539381363752e-23,2.28669681970116e-21,4.25646472038653e-20,6.26803744688605e-19,7.31289750846273e-18,6.80191430069709e-17,5.17664392905848e-16,3.54627271802102e-15,2.73883074631745e-14,2.75151253914445e-13,2.975642452458e-12,2.82279577135738e-11,2.17471496576944e-10,1.33405064500294e-09,6.49826173490998e-09,2.531335682778e-08,8.1333754199881e-08,2.38661657753256e-07,7.85277566280882e-07,3.18946498730647e-06,1.34087446375006e-05,4.90030255242503e-05,0.000145354159689397,0.000343220812982674,0.000641963952565151,0.000950017289337947,0.00111234087334185,0.00103241158078624,0.000770928630315488,0.000515800441627271,0.000495667853298722,0.000957904636367597,0.00214276724798956,0.00407302848586456,0.00624307559027917,0.00766865234598618,0.00754463793688253,0.00594428516644022,0.00374940916278232,0.001892421133488,0.000764079004717657,0.000247147032236588,6.50315186876301e-05,1.74363724334099e-05,2.00104481499513e-05,6.99714491354459e-05,0.00022216791987149,0.00056268144542055,0.00112802329233654,0.00178955511593404,0.00225130005246714,0.00226664563839574,0.00189726036428013,0.00150469236023126,0.0014479438055002,0.00177770554889547,0.0021942585656928,0.00230187779496873,0.00194430627516451,0.0013047266262565,0.000693589556231845,0.000292109077683278,9.76462794364683e-05,2.60340831903118e-05,5.5989614957453e-06,9.95170403185374e-07,1.528918273239e-07,2.15598371584953e-08,2.90156395167159e-09,3.68930424265204e-10,4.87167809712369e-11,1.77616749582941e-11,2.00825272848671e-11,2.25346020415296e-11,2.03441071775908e-11,1.4549903697502e-11,8.23108053309862e-12,3.68231017843599e-12,1.30264725002378e-12,3.64393415407272e-13,8.06029201177726e-14,1.41020583734771e-14,2.03414653554777e-15,1.68455075708894e-15,2.03399291070783e-14,2.21946915138774e-13,1.9167841715675e-12,1.30898639896263e-11,7.06858443765522e-11,3.01831907120266e-10,1.01913854331677e-09,2.72105103236479e-09,5.74480813087671e-09,9.59068774051136e-09,1.26607477270805e-08,1.32161311802682e-08,1.0908994113625e-08,7.12033546675387e-09,3.67495127035854e-09],[8.25439543076298e-26,2.45686659383056e-24,5.78302826319767e-23,1.07677544733437e-21,1.58780847622416e-20,1.86360904378033e-19,1.77816962412852e-18,1.49427752182487e-17,1.36256061011827e-16,1.61813568582198e-15,2.14981397942484e-14,2.55930078629983e-13,2.49216621820216e-12,1.94332890826012e-11,1.22378308474177e-10,6.55108937343535e-10,3.45916634745934e-09,2.20573235870127e-08,1.64801089772382e-07,1.16891741311609e-06,6.93578824271968e-06,3.3028304768832e-05,0.00012483471241603,0.000373443074318359,0.000883588415032553,0.00165324651549875,0.00244608813433523,0.00286202130160133,0.00264931086469359,0.00194761998828635,0.00117432160781393,0.000729338294674227,0.000884648587463372,0.00185857062743247,0.00374109752694037,0.00615711027468161,0.00811047986530361,0.00852226547031815,0.00713392082259133,0.00475233711356999,0.00251697437069194,0.00105897042966339,0.00035373393701624,9.39705889485898e-05,2.09777536666192e-05,9.51545041509605e-06,2.54800281962444e-05,8.02286112079972e-05,0.000203228850815175,0.000407422701273614,0.000646290839140722,0.000812867930031504,0.000817991983618994,0.000683851550420422,0.000541063418770228,0.00051957291920037,0.000638143807652351,0.00078881173809553,0.000828501447348697,0.00070032858374646,0.000470081959094342,0.000249798454323671,0.000105035055942984,3.49603107083934e-05,9.22321999512832e-06,1.93489396448102e-06,3.25226649300832e-07,4.45468630324879e-08,5.14482297764073e-09,5.2942650193612e-10,5.1422304620176e-11,4.99274033879729e-12,8.53866603131659e-13,6.78700307832598e-13,7.42018369142355e-13,6.69101539176775e-13,4.78527619020461e-13,2.70712523132968e-13,1.21108136546679e-13,4.28430278131245e-14,1.19846111123257e-14,2.65096989556797e-15,4.63903638585795e-16,6.90677880014255e-17,9.32427313659585e-17,1.19159812185054e-15,1.30077218216644e-14,1.12337930279347e-13,7.67164228951895e-13,4.14272076067367e-12,1.7689614078889e-11,5.97291641437078e-11,1.59474003629167e-10,3.36688853614077e-10,5.6208625025577e-10,7.4201479684183e-10,7.74564433646053e-10,6.39348893561499e-10,4.17305074605365e-10,2.15379713667789e-10],[1.592775048999e-27,4.74103359968854e-26,1.11622891540508e-24,2.08066290596563e-23,3.08300190341575e-22,3.69413927364445e-21,3.82634609569025e-20,4.13985612811683e-19,5.78694512634111e-18,9.40099529299544e-17,1.40489135117851e-15,1.74316780697227e-14,1.78599432743651e-13,1.63340401582773e-12,1.61533796603145e-11,1.98336823852261e-10,2.61766057100364e-09,3.06681004792455e-08,2.93547283387066e-07,2.24050379500515e-06,1.35506352967224e-05,6.48388717313718e-05,0.000245359469822553,0.000734208724638513,0.00173730128772301,0.00325062704781923,0.00480945423863258,0.00562689420302309,0.00520663617404738,0.00381610990705814,0.00224678069625181,0.00119713140389576,0.00101428451171561,0.00187668903167476,0.00386639708905823,0.00662138650381781,0.00904373785258351,0.00980204935033944,0.0084221084929968,0.00573378676697434,0.00309181016058764,0.00132007920618443,0.000446170364291022,0.000119400451593761,2.55988179737899e-05,5.93569355825789e-06,7.45712902086025e-06,2.21598214122701e-05,5.60280696847425e-05,0.000112314956594027,0.000178157996044726,0.000224060558503594,0.000225432648632564,0.000188378519559827,0.000148901654891113,0.000142845480751816,0.000175430508456015,0.00021694135490658,0.000227947155408178,0.000192732685957688,0.00012938259028383,6.87477617896658e-05,2.88949731620392e-05,9.60642222692793e-06,2.52708242078564e-06,5.26473145238948e-07,8.70468093177969e-08,1.14796258355333e-08,1.22151613179415e-09,1.07492695266784e-10,8.18841445051169e-12,5.79328880533638e-13,4.96755016955202e-14,1.86841270321744e-14,1.87050372168823e-14,1.67943827352069e-14,1.20088817402029e-14,6.7936655619158e-15,3.03927627938653e-15,1.07517045489357e-15,3.00760775958063e-16,6.65277880618378e-17,1.16463173418522e-17,1.83017281946507e-18,4.03213044091297e-18,5.32757799424863e-17,5.81698120799143e-16,5.02369705496008e-15,3.43072077403312e-14,1.85260438887427e-13,7.91070858339093e-13,2.67105890136e-12,7.13159916158106e-12,1.50565602637738e-11,2.51362212011785e-11,3.31825374833074e-11,3.4638141263611e-11,2.8591368684037e-11,1.86616780945658e-11,9.63167507217362e-12],[2.34524420012915e-29,6.98222157586253e-28,1.64535957878468e-26,3.07894973824912e-25,4.63923300130645e-24,5.94786524313155e-23,7.67968206088567e-22,1.26070299668674e-20,2.49940914298929e-19,4.74965856701628e-18,7.94628826108768e-17,1.28310108412172e-15,2.44486460144908e-14,5.61019456391704e-13,1.26342867868531e-11,2.41243601504874e-10,3.71107942706502e-09,4.53554709641336e-08,4.3883911674227e-07,3.35848348896791e-06,2.03258144080064e-05,9.72737999634566e-05,0.000368112975220016,0.00110154497211879,0.0026065067044122,0.00487697941249042,0.00721570642939807,0.00844202477225442,0.00781074502978964,0.00571985572114064,0.00334248574313242,0.00167891512893943,0.0011349236319826,0.00179488228357558,0.00365041162103294,0.00632130452258155,0.00873293893281032,0.00955571035981037,0.00827425707494002,0.00566851053665009,0.00307208501017808,0.00131699539405199,0.000446573881348688,0.000119776690033487,2.54731494992866e-05,4.61922839557679e-06,2.01566811150577e-06,4.70839763064012e-06,1.17901344023458e-05,2.36271602842939e-05,3.74774466503573e-05,4.71322904983037e-05,4.74175718436619e-05,3.96156676508878e-05,3.12987500809266e-05,3.00074018547407e-05,3.68442706296803e-05,4.55658394134469e-05,4.78831056763465e-05,4.04893634657992e-05,2.71819182367727e-05,1.44430086157563e-05,6.0698125378321e-06,2.01734926592565e-06,5.30276215372572e-07,1.10265268022063e-07,1.81485029195507e-08,2.36761083575606e-09,2.45629595309741e-10,2.04220303813594e-11,1.38435509127304e-12,7.93163265970977e-14,4.2595862431166e-15,5.06189807662538e-16,3.64474650563602e-16,3.21827249912491e-16,2.29961044988214e-16,1.30090214864339e-16,5.81983875031344e-17,2.05881973554236e-17,5.75920149691559e-18,1.27393125255657e-18,2.23162405444542e-19,3.83512429832765e-20,1.34950758088609e-19,1.81767488159417e-18,1.98489786632103e-17,1.7142110297844e-16,1.17064770334557e-15,6.32154936515097e-15,2.69933155311297e-14,9.11432079270668e-14,2.43347993900668e-13,5.13767480787797e-13,8.57710713258054e-13,1.13227114229824e-12,1.18193998259977e-12,9.75608983973277e-13,6.3678311473213e-13,3.28656834689079e-13],[2.63532122613071e-31,7.8514780450738e-30,1.85602349631901e-28,3.52050203154319e-27,5.60745236117888e-26,8.69839613529742e-25,1.6831224690406e-23,4.15423499609872e-22,1.10217250225656e-20,3.23545646439486e-19,1.19146404819787e-17,4.90712086671323e-16,1.83909426624304e-14,5.67738421386949e-13,1.40061605903054e-11,2.73953284538255e-10,4.23989993890611e-09,5.18968671527683e-08,5.02319090607384e-07,3.84466035307009e-06,2.32687332091451e-05,0.000111358443352602,0.000421414049805756,0.00126104408169269,0.0029839182057972,0.0055831458310045,0.00826050681933294,0.00966434795555827,0.00894130155936214,0.00654526852930028,0.00381112804943326,0.00185513448443759,0.00106738758445811,0.00141629986506362,0.00278364071178556,0.00481797953030909,0.00667408703588309,0.00732106376016254,0.00635214476656885,0.0043588033507546,0.00236536397938154,0.00101508504156166,0.000344487252238438,9.24509548587837e-05,1.96307412593252e-05,3.34992497340386e-06,6.69721203540901e-07,7.92105677435591e-07,1.89554034707635e-06,3.79277310685352e-06,6.01577603646064e-06,7.56544795394862e-06,7.61097409314475e-06,6.35796831348171e-06,5.02159452164882e-06,4.81210236029019e-06,5.90688909511256e-06,7.30482416944285e-06,7.67648986462351e-06,6.49131320403931e-06,4.35791096778778e-06,2.31555861824827e-06,9.7310976560968e-07,3.23394221910539e-07,8.49890473632944e-08,1.76635662429438e-08,2.90365775939789e-09,3.77682727490888e-10,3.89059484873603e-11,3.18090731168586e-12,2.07467977482695e-13,1.09235587237107e-14,4.79000834823128e-16,2.2511588692945e-17,5.81815926531227e-18,4.717321090783e-18,3.36040722048336e-18,1.90077619789839e-18,8.50346025976104e-19,3.00817542737318e-19,8.41486552581143e-20,1.86137615501257e-20,3.2645595215775e-21,6.4642485206211e-22,3.47515268195125e-21,4.73227861348976e-20,5.16800155828031e-19,4.46322669947412e-18,3.04797134588118e-17,1.64591800520507e-16,7.02814792490537e-16,2.37306138596834e-15,6.33596008756501e-15,1.33767704445883e-14,2.23318908809177e-14,2.94805173895605e-14,3.07737262823143e-14,2.54015637624189e-14,1.6579682185607e-14,8.55711425320175e-15]],"showscale":false,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"zaxis":{"title":"Est. Density"},"xaxis":{"title":"hat_beta_1"},"yaxis":{"title":"hat_beta_2"}},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"showLink":false,"displayModeBar":false},"data":[{"colorbar":{"title":"","ticklen":2},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"x":[1.43134001510477,1.45235563835942,1.47337126161407,1.49438688486872,1.51540250812337,1.53641813137802,1.55743375463267,1.57844937788733,1.59946500114198,1.62048062439663,1.64149624765128,1.66251187090593,1.68352749416058,1.70454311741523,1.72555874066988,1.74657436392453,1.76758998717918,1.78860561043383,1.80962123368848,1.83063685694313,1.85165248019778,1.87266810345244,1.89368372670709,1.91469934996174,1.93571497321639,1.95673059647104,1.97774621972569,1.99876184298034,2.01977746623499,2.04079308948964,2.06180871274429,2.08282433599894,2.10383995925359,2.12485558250824,2.14587120576289,2.16688682901755,2.1879024522722,2.20891807552685,2.2299336987815,2.25094932203615,2.2719649452908,2.29298056854545,2.3139961918001,2.33501181505475,2.3560274383094,2.37704306156405,2.3980586848187,2.41907430807335,2.44008993132801,2.46110555458266,2.48212117783731,2.50313680109196,2.52415242434661,2.54516804760126,2.56618367085591,2.58719929411056,2.60821491736521,2.62923054061986,2.65024616387451,2.67126178712916,2.69227741038381,2.71329303363846,2.73430865689312,2.75532428014777,2.77633990340242,2.79735552665707,2.81837114991172,2.83938677316637,2.86040239642102,2.88141801967567,2.90243364293032,2.92344926618497,2.94446488943962,2.96548051269427,2.98649613594892,3.00751175920357,3.02852738245823,3.04954300571288,3.07055862896753,3.09157425222218,3.11258987547683,3.13360549873148,3.15462112198613,3.17563674524078,3.19665236849543,3.21766799175008,3.23868361500473,3.25969923825938,3.28071486151403,3.30173048476868,3.32274610802334,3.34376173127799,3.36477735453264,3.38579297778729,3.40680860104194,3.42782422429659,3.44883984755124,3.46985547080589,3.49087109406054,3.51188671731519],"y":[2.03952549432711,2.05920615619286,2.0788868180586,2.09856747992435,2.11824814179009,2.13792880365583,2.15760946552158,2.17729012738732,2.19697078925306,2.21665145111881,2.23633211298455,2.2560127748503,2.27569343671604,2.29537409858178,2.31505476044753,2.33473542231327,2.35441608417901,2.37409674604476,2.3937774079105,2.41345806977625,2.43313873164199,2.45281939350773,2.47250005537348,2.49218071723922,2.51186137910496,2.53154204097071,2.55122270283645,2.5709033647022,2.59058402656794,2.61026468843368,2.62994535029943,2.64962601216517,2.66930667403091,2.68898733589666,2.7086679977624,2.72834865962814,2.74802932149389,2.76770998335963,2.78739064522538,2.80707130709112,2.82675196895686,2.84643263082261,2.86611329268835,2.88579395455409,2.90547461641984,2.92515527828558,2.94483594015133,2.96451660201707,2.98419726388281,3.00387792574856,3.0235585876143,3.04323924948004,3.06291991134579,3.08260057321153,3.10228123507728,3.12196189694302,3.14164255880876,3.16132322067451,3.18100388254025,3.20068454440599,3.22036520627174,3.24004586813748,3.25972653000323,3.27940719186897,3.29908785373471,3.31876851560046,3.3384491774662,3.35812983933194,3.37781050119769,3.39749116306343,3.41717182492918,3.43685248679492,3.45653314866066,3.47621381052641,3.49589447239215,3.51557513425789,3.53525579612364,3.55493645798938,3.57461711985512,3.59429778172087,3.61397844358661,3.63365910545236,3.6533397673181,3.67302042918384,3.69270109104959,3.71238175291533,3.73206241478107,3.75174307664682,3.77142373851256,3.79110440037831,3.81078506224405,3.83046572410979,3.85014638597554,3.86982704784128,3.88950770970702,3.90918837157277,3.92886903343851,3.94854969530426,3.96823035717,3.98791101903574],"z":[[1.74793112339092e-53,5.00573696158945e-51,1.13356688606497e-48,2.02983970952988e-46,2.87416655206788e-44,3.21808876149447e-42,2.84918574268412e-40,1.99472033490735e-38,1.10429809034053e-36,4.83442502082799e-35,1.67372799762715e-33,4.58324964626228e-32,9.93058736527922e-31,1.70408209140544e-29,2.32111163209611e-28,2.52309224448223e-27,2.21639718513921e-26,1.61659418916743e-25,1.02869277888053e-24,6.08310830612498e-24,3.4565658328211e-23,1.83119879034301e-22,8.50665016096826e-22,3.38714679541162e-21,1.64269318887755e-20,2.99754769697153e-19,9.64422446347102e-18,2.65443607436317e-16,5.80414505285129e-15,1.00381736253526e-13,1.37281828940582e-12,1.48459215896239e-11,1.26951159872379e-10,8.58423447958354e-10,4.58988572762437e-09,1.9406072830902e-08,6.48797777260665e-08,1.71521788634228e-07,3.58575145896696e-07,5.92872210647421e-07,7.75956941206693e-07,8.07685441346813e-07,6.85324536292839e-07,5.31559559333503e-07,5.18244551207288e-07,7.5183829089218e-07,1.18367717758147e-06,1.59664407897987e-06,1.73017609991485e-06,1.48692086316815e-06,1.01101319530976e-06,5.43632458567499e-07,2.31153103721941e-07,7.7720891328223e-08,2.06647736454996e-08,4.34525120638897e-09,7.22900435076655e-10,9.59645088886738e-11,1.31315508093805e-11,1.1773477580114e-11,5.3654743634523e-11,6.03048450097714e-10,8.21527123844134e-09,9.40864473069755e-08,8.57717112567498e-07,6.1872293440762e-06,3.52951382319733e-05,0.000159210675716365,0.000567891286309979,0.00160174597577209,0.00357237847019383,0.00630023380772047,0.00878600106777462,0.00968860427747992,0.00844824627260689,0.00582515242861002,0.00317602128462798,0.00136928829479663,0.000466811738530801,0.000125841539419972,2.68251190335997e-05,4.52162639128125e-06,6.02674861655989e-07,6.35194721997032e-08,5.29378374325641e-09,3.48868458696837e-10,1.81801598882016e-11,7.49205605762461e-13,2.44252927923854e-14,6.31486894682952e-16,1.31415534762744e-17,2.39553021341855e-19,5.27410906984329e-21,1.93530008441015e-22,8.5709701710441e-24,3.3413409157662e-25,1.06680391845498e-26,2.8383134306486e-28,6.76628411256167e-30,1.61942860877593e-31],[2.21819502978144e-51,6.35248180341189e-49,1.43854196972015e-46,2.57594795986263e-44,3.64743162986015e-42,4.08388000865163e-40,3.61572210441055e-38,2.53136427321666e-36,1.40137673608635e-34,6.13484338132394e-33,2.12382717666693e-31,5.81497810177892e-30,1.25951454004319e-28,2.15953844495217e-27,2.93558988339425e-26,3.17566861908136e-25,2.75823276489838e-24,1.96212111785161e-23,1.18941031684473e-22,6.52868480118373e-22,3.41987383535033e-21,1.7033101360419e-20,7.62862783207782e-20,2.90374166539151e-19,9.48550597670353e-19,4.50929010504995e-18,8.4176035365964e-17,2.21338191024113e-15,4.82686871838368e-14,8.34672781737187e-13,1.14148678363208e-11,1.23442524169709e-10,1.05558766916293e-09,7.13771541926739e-09,3.81644984418293e-08,1.61359810810707e-07,5.39469723519016e-07,1.42618805133038e-06,2.98150890048396e-06,4.92955823314917e-06,6.45111596083674e-06,6.71073818073784e-06,5.67569356762209e-06,4.33989907415658e-06,4.08666573880483e-06,5.76205481691754e-06,8.99091376128356e-06,1.21051701212309e-05,1.31129741686329e-05,1.12686306617268e-05,7.66189541964768e-06,4.11990652319731e-06,1.75182777913217e-06,5.89056536444234e-07,1.56648737276686e-07,3.29556883009258e-08,5.49240683006093e-09,7.42396649087931e-10,1.42320811432807e-10,2.08758761688673e-10,5.13175141416764e-10,1.41798393697417e-09,8.52504346067788e-09,8.38025619439609e-08,7.5076674872689e-07,5.40581563508367e-06,3.08316404788552e-05,0.000139073746441176,0.000496063453440136,0.00139915414877269,0.00312053727041605,0.0055033682736513,0.00767473096625152,0.00846317120667695,0.00737969603785442,0.00508837608537615,0.00277431208014848,0.00119609811055461,0.000407768503330874,0.00010992486272452,2.34322273338953e-05,3.94972282046552e-06,5.26447670376539e-07,5.54855868857181e-08,4.62430893038659e-09,3.04781307588351e-10,1.58932317126588e-11,6.57679787591552e-13,2.19962890428243e-14,6.58204417150365e-16,2.50850454220054e-17,1.58283907082589e-18,1.14331722901483e-19,7.11326068503657e-21,3.57017491098667e-22,1.44439997832888e-23,4.84982343604071e-25,1.45366675798456e-26,4.3585156536008e-28,1.38530396103754e-29],[2.14792424023533e-49,6.15123977143203e-47,1.39296995901628e-44,2.49434353762349e-42,3.53188265056666e-40,3.95450282955973e-38,3.50117243085323e-36,2.45116174422566e-34,1.3569675107365e-32,5.94033876773033e-31,2.05641231082306e-29,5.62986685102077e-28,1.21913775364726e-26,2.08912611911384e-25,2.83595352358325e-24,3.05763682912505e-23,2.63467365832398e-22,1.84057314942584e-21,1.07464368805164e-20,5.53065673837535e-20,2.66939110881927e-19,1.23723057653726e-18,5.29444504163144e-18,1.9642004441727e-17,6.05561042303648e-17,1.63471236760408e-16,8.00045967736955e-16,1.44592403884381e-14,3.06759544713018e-13,5.2961372156811e-12,7.24227057514928e-11,7.83188806741087e-10,6.69724085825845e-09,4.52856818999806e-08,2.42137108883777e-07,1.02375801875726e-06,3.42270273864617e-06,9.04854853916527e-06,1.89163403924383e-05,3.12752815567014e-05,4.09245011482378e-05,4.25475068097991e-05,3.58787303647725e-05,2.70726047534218e-05,2.46417330726509e-05,3.37277532825006e-05,5.21210012608888e-05,7.0031894093335e-05,7.58332975762253e-05,6.51629442299311e-05,4.4306214315004e-05,2.38246984026822e-05,1.01313338920519e-05,3.40746086434915e-06,9.06726946862162e-07,1.91099738593501e-07,3.20396005925897e-08,4.55484212886565e-09,1.51426147097293e-09,3.2417927149306e-09,7.75405432536948e-09,1.51211540516797e-08,2.71502490001295e-08,8.16108728958886e-08,5.24921767125033e-07,3.62169178316169e-06,2.05613243458953e-05,9.27015619097559e-05,0.000330640455306344,0.000932570515509698,0.00207991295445362,0.00366812657808545,0.00511539164291259,0.00564090588392827,0.00491874378187444,0.00339152427035093,0.00184914530631929,0.000797227978614905,0.000271787457236478,7.32675555546996e-05,1.56181494372252e-05,2.63259510759795e-06,3.50898676706732e-07,3.69882267210401e-08,3.08521729911641e-09,2.04384333529527e-10,1.09980689338387e-11,5.42859338179864e-13,3.59913662228198e-14,3.88182978676361e-15,4.5629924429663e-16,4.54596370152156e-17,3.62974408974196e-18,2.30867047112719e-19,1.18058986815047e-20,5.00102379393925e-22,1.88485414069308e-23,7.08013593585091e-25,2.82013781989944e-26,1.10881889023309e-27],[1.58701857179095e-47,4.54491433813395e-45,1.02921187387991e-42,1.84297431759016e-40,2.60957166915973e-38,2.92182852681476e-36,2.58687841838971e-34,1.81106363571371e-32,1.00260365662138e-30,4.38900799162489e-29,1.51933619722477e-27,4.15923715636962e-26,9.00532470645392e-25,1.54256092174704e-23,2.09201053123083e-22,2.25033254934315e-21,1.92831294660038e-20,1.32981365523232e-19,7.54923433325637e-19,3.68518005391642e-18,1.64668494209696e-17,7.05163280324586e-17,2.85128434017534e-16,1.02529688714262e-15,3.1012767452257e-15,7.69092793742903e-15,1.74448328072051e-14,9.12177788581718e-14,1.51134767377276e-12,2.56649975780222e-11,3.5062683430285e-10,3.79152253269844e-09,3.24221613164064e-08,2.19233626801383e-07,1.17221698019264e-06,4.95615096732138e-06,1.65697947881033e-05,4.3805405159114e-05,9.15769166600563e-05,0.000151406529802097,0.000198101711007274,0.000205853718407086,0.000173120612179504,0.000129027669534056,0.000113621351879259,0.000150795466838755,0.000230605786296801,0.000309161729015927,0.000334632884477823,0.000287528774329328,0.000195503832070085,0.000105138619875331,4.47226911762847e-05,1.50537760354702e-05,4.01491115583031e-06,8.51573125528e-07,1.45661684544403e-07,2.36113384254531e-08,1.51735881467608e-08,3.90883729374601e-08,9.38935393591785e-08,1.79816679071332e-07,2.74693643121975e-07,3.54993973812189e-07,5.66362215843538e-07,2.07033187772768e-06,1.05976835594123e-05,4.72174041313277e-05,0.000168188008515801,0.000474299050586159,0.00105780737330623,0.00186553877274049,0.00260158824647267,0.00286885403500258,0.00250157643358082,0.00172486257319542,0.000940438961471655,0.000405454523828406,0.000138225864933294,3.72626213971205e-05,7.94332821014517e-06,1.33914399612159e-06,1.78675315517179e-07,1.89534504813342e-08,1.64316771342182e-09,1.34522573363267e-10,1.55731448511593e-11,2.85194494134715e-12,5.44090350118796e-13,8.6859292172119e-14,1.10752308501681e-14,1.12035185882559e-15,9.01162697408834e-17,5.82298519717865e-18,3.11196668268077e-19,1.4749790962246e-20,6.94179953799786e-22,3.46483316990951e-23,1.71354998102659e-24,7.50211973408086e-26],[8.94723567231075e-46,2.56231528650043e-43,5.80245321436933e-41,1.03902531265269e-38,1.47121463819616e-36,1.64725731521599e-34,1.45841969354753e-32,1.02103276655861e-30,5.65241375537231e-29,2.47438811913778e-27,8.56539626766279e-26,2.34470356412071e-24,5.07605443160966e-23,8.69266893008434e-22,1.17812298374832e-20,1.26526326494735e-19,1.08003544488767e-18,7.38059725141296e-18,4.10475942410918e-17,1.92230192259396e-16,8.02304934773922e-16,3.16653077996679e-15,1.19692234246459e-14,4.13268414077751e-14,1.22479570041302e-13,2.98727517993117e-13,5.94142037077812e-13,1.16383852711186e-12,6.60668101998817e-12,9.58089369308947e-11,1.2959761283496e-09,1.40061766237743e-08,1.19766288583726e-07,8.0984147042016e-07,4.33014312008552e-06,1.83079950148426e-05,6.1209124719506e-05,0.000161819343593685,0.000338292942071691,0.000559309463747306,0.000731759754663262,0.000760061835615438,0.000637646204326941,0.000469841554352946,0.000400662810627486,0.000515024938314786,0.000778738377762786,0.00104146793995741,0.00112676665890832,0.000968121871332214,0.000658347654900954,0.000354179578537102,0.000150814157739012,5.09120673399194e-05,1.36880790577472e-05,2.96808546734827e-06,5.41145031618997e-07,1.16193119273049e-07,1.31061849890185e-07,3.61604847083358e-07,8.69896705685474e-07,1.66555919827774e-06,2.52820543459958e-06,3.05461418147684e-06,3.0185889046958e-06,2.95825520863252e-06,5.46276194859022e-06,1.90305715426361e-05,6.55919612809998e-05,0.000184197265710795,0.000410556219362088,0.00072397468653702,0.00100959518304786,0.00111330546435779,0.000970775408186779,0.000669359158865212,0.000364951834568673,0.000157343672504531,5.3642674909177e-05,1.44637802648567e-05,3.08713756952881e-06,5.24533373979306e-07,7.33888108142892e-08,1.00273669471751e-08,2.03181418587579e-09,6.27485399533865e-10,1.93783262554876e-10,4.95619442192678e-11,1.0102923910293e-11,1.63147920151497e-12,2.08732562519294e-13,2.1226548044508e-14,1.73306195357527e-15,1.16857470268666e-16,6.9661350072525e-18,4.10802708790472e-19,2.56912356472379e-20,1.59795741617171e-21,8.82674512370086e-23,4.03513282006351e-24],[3.84892601113591e-44,1.10225797977899e-41,2.49610199447131e-39,4.46968376819853e-37,6.32887739305934e-35,7.08617753689673e-33,6.27383300814254e-31,4.39227726853273e-29,2.43154949280946e-27,1.06442431190574e-25,3.68458867827366e-24,1.00859364107415e-22,2.18334318119999e-21,3.73825635242858e-20,5.06420358800973e-19,5.4328043653783e-18,4.62511145315129e-17,3.14053263061624e-16,1.72106184768711e-15,7.81029741423009e-15,3.07876299176227e-14,1.12305008880629e-13,3.93535819998884e-13,1.29079464840974e-12,3.72322970024392e-12,8.96262044368442e-12,1.75011767826356e-11,2.79311353341512e-11,4.9117427036733e-11,2.99942431170344e-10,3.67610060662162e-09,3.94928074349651e-08,3.37587867365023e-07,2.28269110063905e-06,1.22054551489337e-05,5.1605944123834e-05,0.000172538183770192,0.000456156025905616,0.000953661888071326,0.00157679294182551,0.00206297751747229,0.00214210335332612,0.00179329954889848,0.00130758629622095,0.00108087816968138,0.00134402852282877,0.00200729191540014,0.00267726705565934,0.00289520622054224,0.00248775594761069,0.00169251917429417,0.000911762169387058,0.000389686791037329,0.000132908238628819,3.67385772112344e-05,8.55592145044191e-06,1.85164642042841e-06,5.98195936868611e-07,9.16259676343636e-07,2.56092361917484e-06,6.15647382919325e-06,1.17949981008274e-05,1.7929566544094e-05,2.16717471487304e-05,2.095652753867e-05,1.65268785363904e-05,1.16722024103066e-05,1.11448877353725e-05,2.21412746780379e-05,5.58293173766802e-05,0.000122181266617461,0.000214674620538351,0.000299104867546899,0.000329746423552244,0.000287506424450313,0.000198233252738406,0.000108084831489086,4.66107621263749e-05,1.59158120785201e-05,4.33333589848993e-06,9.80652116904702e-07,2.25250099852718e-07,7.99834083658776e-08,4.13699607974066e-08,2.06281211142726e-08,8.44714040924686e-09,2.75298235174047e-09,7.10414967964771e-10,1.45081263615194e-10,2.34695301281069e-11,3.01718391115301e-12,3.11259735430479e-13,2.64811965719555e-14,1.9856596268734e-15,1.46734541601282e-16,1.149700134623e-17,8.99228302537423e-19,6.26641491291906e-20,3.61959120047675e-21,1.68084903121758e-22],[1.26338019929263e-42,3.61807657104694e-40,8.1932616972258e-38,1.46713909573104e-35,2.07740492889009e-33,2.32598260465371e-31,2.0593363509123e-29,1.44172963854434e-27,7.9813540171986e-26,3.49386990523286e-24,1.20942025537904e-22,3.31051320937257e-21,7.16603163655712e-20,1.22679193771294e-18,1.66141644624136e-17,1.78099399399132e-16,1.51341959339081e-15,1.02307861504534e-14,5.54830260932162e-14,2.46005102794111e-13,9.26478140581331e-13,3.14655334481493e-12,1.01781462665629e-11,3.13761175751276e-11,8.73269213361995e-11,2.0663379650389e-10,3.99994658352608e-10,6.22663845943991e-10,8.0074357399816e-10,1.32617468899302e-09,8.43565374405305e-09,8.52705096913923e-08,7.26276904777996e-07,4.90999825663687e-06,2.62542612373279e-05,0.000111012215273063,0.000371186817723102,0.000981457222554476,0.00205221145255207,0.0033938681913785,0.00444139987948488,0.00461193422666216,0.00385512020032839,0.00278491757371861,0.00223358453357643,0.00268183462822453,0.00395029591277531,0.00525260456782354,0.00567791260840269,0.00488126679493296,0.00332654718700968,0.00180056633367653,0.00077970725513275,0.000275416777783057,8.30960109669736e-05,2.3337228936508e-05,6.86916425459466e-06,3.10334434025919e-06,5.05322507390355e-06,1.38980825009976e-05,3.3314947127691e-05,6.38719309428445e-05,9.73349919839674e-05,0.000118231889955011,0.000115310922916703,9.16263387730609e-05,6.10811300892994e-05,3.64788985143881e-05,2.32764636625486e-05,2.2212692460279e-05,3.26694260524022e-05,5.12405174692795e-05,6.91510627539603e-05,7.54772960999494e-05,6.55781381786783e-05,4.51664024664099e-05,2.46616695332874e-05,1.07640536510973e-05,3.95165710213552e-06,1.53757183788992e-06,9.54601033119479e-07,8.19988800697355e-07,6.57928119309565e-07,4.30779287789855e-07,2.24305616010613e-07,9.24791009148083e-08,3.01692680996846e-08,7.78873793349442e-09,1.59283691282639e-09,2.58841225137187e-10,3.37379773346348e-11,3.62168909566771e-12,3.41622530143626e-13,3.1636226282859e-14,3.10522111347084e-15,3.05364367269142e-16,2.68437982908027e-17,1.95907804691715e-18,1.15013546745836e-19,5.3702593942941e-21],[3.16426164421023e-41,9.06183340908957e-39,2.05208405033793e-36,3.67459604740321e-34,5.20306749127572e-32,5.82565464466926e-30,5.15781175725669e-28,3.61095316389498e-26,1.99900637007375e-24,8.75070996704952e-23,3.02908344720426e-21,8.29130792647096e-20,1.79469657665249e-18,3.07217140506561e-17,4.1596847141856e-16,4.456743065602e-15,3.78234322348848e-14,2.54899525573642e-13,1.37222392087377e-12,5.98279958214955e-12,2.17545740743959e-11,6.95021743443892e-11,2.0769030458899e-10,5.96298602379211e-10,1.58568287811684e-09,3.66593603087657e-09,7.02201991621474e-09,1.08605370773163e-08,1.34481095375083e-08,1.40577475336342e-08,2.30774071380051e-08,1.45711722316996e-07,1.1952620511213e-06,8.06263282051285e-06,4.31104728180711e-05,0.000182320496048461,0.00060979686690275,0.00161304197960778,0.00337481095800072,0.00558560527760564,0.00731738746168923,0.00760739570117802,0.00635980586485531,0.00456165485521586,0.00355221717089324,0.00410182830773934,0.00594042718393792,0.00786832389279963,0.00850475071710125,0.00732627231405089,0.0050231578396626,0.00276463693070259,0.00125120498380007,0.000491887165245498,0.000183930325408406,7.0463387922663e-05,2.79610148110571e-05,1.46307229784807e-05,2.20100742080761e-05,5.80637645063649e-05,0.000138175932336479,0.000264994211561406,0.000405258574306651,0.000495906373187664,0.000490478100059307,0.000399835563842803,0.000277947779079902,0.000173334386187883,0.000102839712702787,6.12231379172311e-05,3.88322271945774e-05,2.84130021275233e-05,2.41923981527402e-05,2.12168175567501e-05,1.67788978010003e-05,1.12095351073752e-05,6.43726014433912e-06,3.90377825510821e-06,3.72674907566349e-06,4.99776109280582e-06,6.34793871498612e-06,6.61130899560404e-06,5.48604362358747e-06,3.60809419884956e-06,1.87871592694563e-06,7.74255921646522e-07,2.52579946297117e-07,6.52801360444111e-08,1.34064644320865e-08,2.20751690566814e-09,2.98985084617926e-10,3.54786130092385e-11,4.11740919149023e-12,5.0621123470797e-13,6.25784514913796e-14,6.9387922279987e-15,6.3979379470458e-16,4.74850846983852e-17,2.80361281189311e-18,1.31153983896667e-19],[6.04720269306309e-40,1.73180190034439e-37,3.92172630648907e-35,7.02249982042597e-33,9.94355280716196e-31,1.11333750802752e-28,9.8570632746942e-27,6.90086914825419e-25,3.82028551769469e-23,1.67233860322905e-21,5.7888247053158e-20,1.58452055528262e-18,3.42969302447185e-17,5.87061521317688e-16,7.94757674890422e-15,8.51207551636251e-14,7.21765824140437e-13,4.85371159556491e-12,2.59952563766964e-11,1.1198382631577e-10,3.96650260619286e-10,1.20565889822526e-09,3.34695585815377e-09,8.89875280872085e-09,2.23794655535818e-08,5.01737919309301e-08,9.4736648517638e-08,1.45595971326445e-07,1.79210806391081e-07,1.76441859889475e-07,1.5232587939846e-07,2.59599354977606e-07,1.53971370469968e-06,1.01366189415083e-05,5.41189316556304e-05,0.000228976162373555,0.000766596620776337,0.00203079913374289,0.0042576825531805,0.00706717337823366,0.0092948281624829,0.00971295231348497,0.00816384156253075,0.00584807829491862,0.00442260551593534,0.00485365545107876,0.00684822648169451,0.00901387158698868,0.00975384921293766,0.00846479593812911,0.00592777342061608,0.00344798224596139,0.00177613466617297,0.00088959512450747,0.000456187085707908,0.000229348569229981,0.000108225248265158,5.95745373756128e-05,7.77351816989002e-05,0.000189039372375623,0.000441752523319458,0.000845839269768077,0.00129960386550652,0.00160726007500413,0.00162178614607446,0.00137006353171334,0.00100971637759134,0.000683614338079145,0.000444008409348764,0.000282006527769448,0.000177069708291387,0.000113734418253286,7.80577080438195e-05,5.63414215644005e-05,3.94528724119352e-05,2.52684391889261e-05,1.60645872104617e-05,1.43970089386259e-05,2.05738114382452e-05,3.14726320565474e-05,4.08398640861679e-05,4.25587463411407e-05,3.52408589884595e-05,2.31329189129246e-05,1.20288088240672e-05,4.95408510575861e-06,1.61712102004675e-06,4.19511149418911e-07,8.72360503050719e-08,1.4904229771738e-08,2.22471688371222e-09,3.23537386417483e-10,4.98139321859795e-11,7.73962233532555e-12,1.0823256506256e-12,1.26077210584634e-13,1.18293627944387e-14,8.83141425950078e-16,5.2244047598835e-17,2.44556100728618e-18],[8.81821114165596e-39,2.52536507214465e-36,5.71877798122062e-34,1.02404181131683e-31,1.44999842724812e-29,1.62350179656409e-27,1.43738610993475e-25,1.00630495117409e-23,5.57084963997544e-22,2.43864921027051e-20,8.44139649316139e-19,2.31056819685647e-17,5.00113796594403e-16,8.56010759404081e-15,1.1587406625109e-13,1.24073465881482e-12,1.05141762210241e-11,7.06005028484435e-11,3.76762844584781e-10,1.60929185784264e-09,5.59177666184832e-09,1.63469907596431e-08,4.25416331090515e-08,1.04621276619436e-07,2.46549872212836e-07,5.31404368851659e-07,9.84113632356347e-07,1.49956045806279e-06,1.8386907386828e-06,1.79755361878605e-06,1.41116653723991e-06,1.03987994194574e-06,1.90787117670812e-06,1.00184486985203e-05,5.24015735714814e-05,0.000221429311077308,0.000743274295288742,0.00197866192938255,0.00417820425690258,0.00700469031480922,0.009338444093319,0.00993543682327713,0.00853414658752305,0.00620964154143542,0.00456247911857691,0.00459552516464818,0.00612781126032579,0.00794480286442817,0.0086411763731225,0.00769467019078053,0.00577107915347687,0.00391767984870478,0.00263716766172079,0.00180795560902559,0.00118238119722451,0.000689267796890039,0.000362232523122461,0.000211811304548552,0.000235873793131246,0.000493845568371108,0.00110334527358159,0.0020960035694818,0.00323712472768246,0.00406265940589612,0.00421396432331738,0.00373031436180363,0.00294979796605581,0.00218253267418804,0.00155202284110748,0.00106711557955834,0.000718980009540791,0.000495824545565259,0.000364165275638518,0.000276173890871053,0.000198954470433915,0.000129490277629382,8.31277295058342e-05,7.42322013152679e-05,0.000104477453015658,0.000157860342925297,0.000203142018686869,0.000210442749606604,0.000173509799626421,0.00011354766934013,5.89303457678173e-05,2.42617578147326e-05,7.94250078028822e-06,2.08430000029406e-06,4.48981495484554e-07,8.42770624827094e-08,1.53549347522327e-08,2.95974851428623e-09,5.77789281212196e-10,1.01884522928139e-10,1.49923148547225e-11,1.77819477406119e-12,1.67858684318059e-13,1.25569971755928e-14,7.43324090695343e-16,3.48026595182422e-17],[9.81184365263204e-38,2.80992033496057e-35,6.36316260052317e-33,1.1394295084079e-30,1.61338233920399e-28,1.8064357983349e-26,1.59934876016514e-24,1.11969383420177e-22,6.19856235139547e-21,2.71342940781003e-19,9.392531318846e-18,2.57089936989766e-16,5.564550057945e-15,9.52418903786424e-14,1.28915319372427e-12,1.38013765900076e-11,1.16905663740016e-10,7.84188540768393e-10,4.17439694328432e-09,1.77238947479308e-08,6.07382208193471e-08,1.72387485159516e-07,4.25121389267988e-07,9.7051848089653e-07,2.12892698585465e-06,4.3709435764303e-06,7.89017815210539e-06,1.18836661279019e-05,1.44997699687308e-05,1.41414893436288e-05,1.09954670151394e-05,7.00722461534751e-06,4.85670707934307e-06,9.79320078156645e-06,4.19393982142907e-05,0.000171143491540961,0.000573916647426917,0.00154750564493779,0.00334064520276538,0.00577609375075478,0.0080196370171966,0.00898098407793253,0.00819071920086853,0.00627606216974469,0.00450630171071702,0.00387012000927716,0.00445738815271815,0.00551138143865435,0.00609644565550117,0.0058848547595555,0.00528757463532795,0.00478999171982057,0.00437071234697222,0.00371084897376306,0.00274440876693894,0.00175598890296099,0.00103987016644926,0.000679441234441323,0.000663964013635341,0.00109895517109319,0.00221928097838971,0.00411151254679579,0.00636708966353319,0.00814000015957469,0.00874855138457901,0.00819749151721903,0.00700402006835903,0.00564885827354825,0.00434801063374279,0.00319851364616541,0.00230135685700275,0.00170825227038452,0.00134856558835516,0.00107790538858223,0.000800916099074302,0.000530661778922001,0.000343295397505086,0.000302275756634447,0.000414136755588131,0.000613869904443273,0.000780144504225562,0.000801056232163105,0.000656232476192457,0.000427538747437319,0.000221378238293458,9.12631969190982e-05,3.0177462243766e-05,8.18702366893677e-06,1.93101380366859e-06,4.40501910045252e-07,1.0623659969627e-07,2.60447564785363e-08,5.78933211087016e-09,1.07596347472621e-09,1.61306388015063e-10,1.92524303154719e-11,1.82115250662029e-12,1.36325967467117e-13,8.07165955083476e-15,3.77941628805581e-16],[8.33057443000456e-37,2.38566541946991e-34,5.40240290933027e-32,9.67388947932501e-30,1.36978024896189e-27,1.53368480346992e-25,1.3578654639173e-23,9.50632835537781e-22,5.26264895468997e-20,2.30373073681923e-18,7.97434934261148e-17,2.18271107083279e-15,4.72430266178834e-14,8.08587537935027e-13,1.09441594628466e-11,1.17151649827361e-10,9.92051923045192e-10,6.64979512182823e-09,3.53365166392483e-08,1.49404081196438e-07,5.0695691501558e-07,1.4076276472004e-06,3.32525918325454e-06,7.09957711751484e-06,1.44557404836649e-05,2.80265723697405e-05,4.89617625698047e-05,7.26038123930464e-05,8.79976198283949e-05,8.55991711220876e-05,6.64760012608207e-05,4.18577120176087e-05,2.40290777584264e-05,2.08707451637851e-05,4.35564572672959e-05,0.000132932759605074,0.000407272086097661,0.00109940839083501,0.00248183098147286,0.00459597152492421,0.00694221357017707,0.00854616934168609,0.00859256540773366,0.00713135705481614,0.00509889462383444,0.00358195479892166,0.00305542498214989,0.00326857677847302,0.00375982416279675,0.00439823004522965,0.005333587544755,0.00643590815461751,0.0070651928217839,0.00664471368147935,0.00531666811241217,0.00378685795971044,0.00263197868550674,0.00198034378950998,0.00179657192569846,0.00226785670178703,0.00381437471392335,0.00663890505138984,0.0101978006031808,0.0132796656298468,0.014855440076542,0.0147966062613023,0.0136310906343076,0.0118515797439582,0.00972825635398362,0.00756966853617631,0.00578549724559751,0.00460987929522108,0.00389128750568527,0.00325859932584819,0.00248933333788875,0.00167966667763992,0.00110075243931969,0.000963868380683055,0.00128656212963383,0.0018621506811553,0.00232580579536876,0.00235774211144924,0.00191348963149016,0.00123907124879656,0.000640522758609812,0.00026602701952841,9.0682330230568e-05,2.68289466822588e-05,7.65227099279648e-06,2.30629627877384e-06,7.09410019479512e-07,1.98668386428479e-07,4.66187745715536e-08,8.83220792581104e-09,1.33265027709832e-09,1.59389189050719e-10,1.50871317527642e-11,1.12960036688985e-12,6.6885427490791e-14,3.13182071284148e-15],[5.40083996826322e-36,1.545701637157e-33,3.49989532777376e-31,6.267012107911e-29,8.87378094659334e-27,9.93558864071619e-25,8.79658601884571e-23,6.15843241030802e-21,3.40927236271737e-19,1.49241239212842e-17,5.1659712010991e-16,1.41400836389432e-14,3.06049021805517e-13,5.23810655790337e-12,7.08948979622658e-11,7.58830674794132e-10,6.42454476129963e-09,4.30426963425106e-08,2.2844717406555e-07,9.63035689160889e-07,3.24489090818027e-06,8.86665063585072e-06,2.02610004769725e-05,4.08511822640173e-05,7.73271037016635e-05,0.000140597824047349,0.00023587975099619,0.000342739451002846,0.000411706744584024,0.000399095657482426,0.000309786685908324,0.000195586587295963,0.000111940996385994,8.4868389226852e-05,0.000114913062590487,0.000207681233090367,0.000428275752850549,0.000972888463295145,0.00217125763604554,0.00426740812586619,0.00699422899110198,0.00936375607145562,0.0101752187705886,0.00899283502554352,0.00656364978607021,0.00416376230387753,0.00263892563337561,0.00212703842577471,0.0024877969233555,0.00371812380090246,0.0057928069430254,0.00816028780954793,0.00975137015706606,0.00981984730150499,0.00864878651936855,0.0071549681794019,0.00594960482071808,0.00506340866361749,0.00446457766950105,0.00455834677222505,0.0060779412925511,0.00941691383497454,0.0139828114991373,0.0183440414139884,0.0212320166298201,0.0223118102369772,0.0218710153606718,0.020149290894998,0.0173679416884291,0.0141595447738545,0.0114546370846762,0.00977433150793442,0.0087778531462813,0.00766479289082888,0.0060109162551161,0.00413965771387419,0.00276796222517307,0.00243291096365861,0.00316509635660231,0.00444686212676615,0.00542420204276455,0.00540042768579426,0.00432614121403158,0.00278123124166351,0.00144177066186608,0.000614565991083015,0.000227239328794134,8.0801911818808e-05,3.03588474365817e-05,1.16955907385023e-05,4.12173126851141e-06,1.22030615577501e-06,2.92037377220403e-07,5.56894623756653e-08,8.42005960955391e-09,1.00768286897766e-09,9.53980620276079e-11,7.14277241805113e-12,4.22929234533544e-13,1.98027457295485e-14],[2.73191071416505e-35,7.67214664084674e-33,1.73132311840776e-30,3.09828103063093e-28,4.38653070364267e-26,4.91130731871381e-24,4.34826380833417e-22,3.04418827600538e-20,1.68524437506973e-18,7.3771717083948e-17,2.55359920083057e-15,6.98959532944474e-14,1.51282726154909e-12,2.58921721959015e-11,3.50428049931723e-10,3.75062411626433e-09,3.1749666908796e-08,2.12639881519037e-07,1.12761401018808e-06,4.74368518659537e-06,1.5904155239184e-05,4.29574464658161e-05,9.57280575942845e-05,0.000184169565654037,0.000325848647553542,0.000553443033299547,0.000885014520510188,0.0012532059701964,0.00148780207006548,0.00143563388646691,0.00111396655608218,0.000707414585459129,0.000413906558449481,0.000322399512117415,0.000411732800475603,0.00061417461277374,0.000908873215061477,0.00145209003021973,0.00263574753985576,0.0048496051542839,0.00793657209960823,0.0108535147750761,0.0121765523834465,0.0112209996424288,0.00860886153761615,0.00566112256438021,0.00340608708797566,0.00223481557194958,0.00222512263825359,0.00345449294468763,0.00583496084963386,0.0087204016816339,0.0110414754097709,0.0121416957622368,0.0122968304097624,0.0121236681424537,0.0117268138067036,0.0108019566529135,0.00944967687492808,0.00858107416445345,0.00943386767136043,0.0126124133608706,0.0174709383837775,0.0224834054923849,0.0263369922810397,0.02857160529513,0.0291469480297049,0.0278984545014313,0.0249041128886717,0.0211252609811325,0.0180567431529554,0.0164695992369977,0.0156663925252602,0.0142215823893111,0.0114575428559603,0.00809182748260078,0.00556791678667086,0.00494616254868118,0.00625389424778401,0.00846124087331251,0.0100001742114636,0.00971631106921146,0.00765445061856524,0.00489537840168892,0.00258559907241403,0.0011862567878107,0.000522765286588353,0.000243656584008252,0.00011713460965613,5.18239904134487e-05,1.93293836979588e-05,5.83745648327523e-06,1.40594006186945e-06,2.68610791101887e-07,4.06321659622705e-08,4.86296536977088e-09,4.60356613414313e-10,3.44662855663371e-11,2.04067401335154e-12,9.5546909248806e-14],[1.75471808595624e-34,3.25919548717462e-32,6.67738773709225e-30,1.17336275051809e-27,1.65574712833132e-25,1.85270206193766e-23,1.64011441060609e-21,1.14820552605846e-19,6.35636348586765e-18,2.78249934948866e-16,9.63158009341718e-15,2.63630887159118e-13,5.70600805495982e-12,9.76581689714863e-11,1.32169649026273e-09,1.41455134639667e-08,1.19732189763952e-07,8.01696543109375e-07,4.24878884562079e-06,1.78478183837263e-05,5.96273417102736e-05,0.000159717414204079,0.000349344384898456,0.000647589908144331,0.00107963256534361,0.00171241050467165,0.00259355496553592,0.00355817135734938,0.00416130830889672,0.0039919249829276,0.00309745235968388,0.00198515231612813,0.00120050175140006,0.00098420531965272,0.00125855247229054,0.001780461680814,0.00233880160579122,0.00300306489819956,0.00423542440752767,0.00654497836725752,0.00979923733001211,0.0129214752180862,0.0145197314434999,0.0139346381129927,0.0116214059587457,0.00861150011834283,0.00582356996309109,0.00383154005827414,0.00297426308066351,0.00345114200932033,0.0052144620019466,0.00780709595890885,0.0105718014600339,0.0132010131361255,0.0157978156385949,0.0181466155095038,0.0193257567933588,0.0185336601707363,0.0162077576728488,0.0140589920298617,0.0139340805407219,0.0165190956624395,0.0209509135077037,0.0256267378758589,0.0293969403410732,0.031922329055581,0.0330178371122791,0.0322185834605874,0.0294585661516669,0.0258967205018991,0.0233765466478409,0.0227243507562063,0.022780829213375,0.0214566279983057,0.0178092053997382,0.0129891585901236,0.00927063341850353,0.00832008203782263,0.0101246133133674,0.0130395367950537,0.0147867123147303,0.013924118192912,0.0107741229985794,0.00693953096636104,0.0038990282807452,0.00210601649797579,0.0012062146750689,0.000718338412119959,0.000397006877817139,0.00018593608006442,7.07083098940016e-05,2.14783595625365e-05,5.18033528205723e-06,9.89840865080462e-07,1.49701896522499e-07,1.79127934275272e-08,1.69543433323579e-09,1.26919499633894e-10,7.51407959930051e-12,3.5181165545079e-13],[6.95377910211299e-33,4.17838140232423e-31,3.21922079663989e-29,3.7923929572808e-27,4.87227880957627e-25,5.35450843852262e-23,4.7241426838808e-21,3.30510752446639e-19,1.82943213397438e-17,8.00809434280633e-16,2.77196624300185e-14,7.58726458139954e-13,1.64217742369483e-11,2.81056767478018e-10,3.80375077461126e-09,4.07086324756313e-08,3.44546664968173e-07,2.30659807779746e-06,1.22192011411938e-05,5.12758332929543e-05,0.000170876123733511,0.000454972805636157,0.00098158324008824,0.00176808793090273,0.00280341937552471,0.0041657088750522,0.005950386729497,0.00786432602316326,0.00902810027697138,0.00859868118137819,0.00667836604050198,0.00434397038285615,0.00275430381243686,0.0024034226134054,0.00308216220924747,0.00421150783879256,0.00525207231211181,0.00616332680457902,0.00756700206715313,0.0101490997144753,0.0137128191946328,0.0170427934190214,0.0188724802851139,0.0187815851542615,0.017082550479683,0.0142737965141486,0.0109159336641852,0.0077312157034246,0.005442025205792,0.00449588020690089,0.00497118354701474,0.00668668228456279,0.00948794249864493,0.0134403269941785,0.0183876932704195,0.0231672551928642,0.025827216084277,0.0252029849338836,0.0222074684874219,0.0193275250292245,0.0187959533623957,0.021088056750911,0.0249369830077248,0.0286635106645316,0.0314271285668182,0.0332308617653018,0.0340157652997837,0.0332831238194043,0.0309239353164773,0.0281076570022132,0.0266848916606744,0.0273497949066599,0.028581208693783,0.027812309618138,0.023842806288384,0.0180747233276778,0.0134183232790639,0.0120318291938918,0.01382867188397,0.0166700865151782,0.0179173027529507,0.0162587421137974,0.0124515917758229,0.00838472376473767,0.0054467066789894,0.00376904861454582,0.00274234933342687,0.00187441584979454,0.00109478653536594,0.000521815780916343,0.000199282466332852,6.05486098869546e-05,1.45932752775933e-05,2.78631392311114e-06,4.2114523838949e-07,5.03714322724322e-08,4.76631927751592e-09,3.5675516695417e-10,2.11218494201536e-11,9.89300802970061e-13],[4.54117993966029e-31,2.28974517645072e-29,9.46665780035019e-28,3.61771707978122e-26,1.77917032822328e-24,1.32157398882321e-22,1.06189993825518e-20,7.29242841115875e-19,4.02163382775161e-17,1.7590423605238e-15,6.08771513439346e-14,1.66620741872695e-12,3.6062524099544e-11,6.17200122583592e-10,8.35294012470711e-09,8.93932092387637e-08,7.56561253339265e-07,5.06424164752546e-06,2.68197168161176e-05,0.000112461390309068,0.000374103704976223,0.000991796430812634,0.00211836534704555,0.00373339525888329,0.005682266491093,0.00795807453815888,0.0107059841304417,0.0135663548158973,0.0152349570876745,0.0143926628953787,0.0112148516745835,0.00747378651870482,0.00507000632662949,0.00475797595976815,0.00607798439734678,0.00797829833361689,0.00955908656612893,0.0107873521009078,0.0126356631675628,0.0160559876305095,0.0206376755538366,0.0247270228366078,0.0270077460904982,0.0273928415710107,0.026248030293191,0.0235924815502701,0.019529550583498,0.0148576269941527,0.0107491055250517,0.00803976355015431,0.00699333370378361,0.00756947550125205,0.0098204220906301,0.0139320835175181,0.0195445806226361,0.0250174168945677,0.0280411286679057,0.0275438653908316,0.0248636016521966,0.0227779992595932,0.0233348058425192,0.0264712389574795,0.0304798590152128,0.033656215449736,0.0354564622197403,0.0362207596204144,0.0361641862251526,0.035027192837298,0.0328169740884307,0.0305879022630584,0.0299545261847992,0.0314549276926772,0.0334794186080536,0.0332714246407469,0.0293735743425877,0.0231473992567565,0.0177711998761293,0.0156455490295309,0.0166042904302037,0.0183406728853852,0.0184201368585554,0.0161038432613036,0.0125635243284167,0.00952450164385242,0.00774865341660775,0.00672808332243522,0.00558376796809919,0.00401262875396184,0.00237422781209496,0.00113233432769469,0.000431393287111137,0.000130734125856732,3.14451305739972e-05,5.99516006359711e-06,9.05277438165206e-07,1.08213795943533e-07,1.0237613916512e-08,7.66586943201016e-10,4.54652098620601e-11,2.14083553028803e-12],[2.35793902889964e-29,1.17820820826604e-27,4.68445943275822e-26,1.49175650310132e-24,3.91265713279757e-23,9.54053970424376e-22,2.98090359085184e-20,1.38381385501672e-18,6.92259662596575e-17,2.96578381210916e-15,1.0217300364799e-13,2.79332601991475e-12,6.04376815179256e-11,1.03426052702525e-09,1.3996628228671e-08,1.49787431930498e-07,1.26764172290243e-06,8.48452242700824e-06,4.49234234093863e-05,0.000188274821436655,0.000625490883372392,0.00165310654482659,0.00350507098914304,0.00607720278509535,0.0089551424003526,0.0119157713606068,0.0151290239512771,0.0183356783588202,0.0201000645707467,0.0188451884506348,0.0148095113134378,0.0102686086241427,0.00764107089616479,0.00776002387785009,0.00979410522331807,0.0122392530800375,0.0140602690917102,0.0155463962150118,0.0182098353797186,0.0232341184299978,0.0297856542693697,0.035470763795771,0.0386544627564984,0.0395349714632142,0.0387589592479024,0.0361462411077697,0.0314230828051186,0.0253813642466159,0.0196135068209333,0.015414915571211,0.0132153434242346,0.0128269550323762,0.0140371685366448,0.0168361857449653,0.0208406650597598,0.0246592959331084,0.0265276108158882,0.0259787100387948,0.0246095988895814,0.0248736212045126,0.0280736358625193,0.0334289449320645,0.0388789284813741,0.0426986368144106,0.0444249272408426,0.0445003954804276,0.0434024323959434,0.0413180321232902,0.0385735520127216,0.0361425458448498,0.0353679480175811,0.0367268348968133,0.0387598630206743,0.0387234976866557,0.0349035225935897,0.0283952828138958,0.0223084795161015,0.0190389758225644,0.0183884553529853,0.0182737278218375,0.0169573893884643,0.0144811896094065,0.0121945676803722,0.0111822977633928,0.0111920780552894,0.0109611488781612,0.00947021270058018,0.0068317431493093,0.00401447427162858,0.00189915605160738,0.000718734838459571,0.00021675745614081,5.19625615131614e-05,9.88577131075918e-06,1.49111229682633e-06,1.78259861059407e-07,1.69031343999392e-08,1.27540655493739e-09,7.73232438381168e-11,3.8673664898314e-12],[9.36489463150914e-28,4.66800352126778e-26,1.84812479340124e-24,5.82149762218144e-23,1.46341009966229e-21,2.95949784720682e-20,4.96213228299685e-19,7.77353611886487e-18,1.53492938240103e-16,4.38943973471113e-15,1.35488962751377e-13,3.6075481291673e-12,7.75207759103324e-11,1.32388230034387e-09,1.79034446703209e-08,1.91544267021011e-07,1.62081399165549e-06,1.08472014115071e-05,5.74233020248137e-05,0.000240569324547931,0.000798487213064791,0.00210562789986656,0.00444109027863342,0.00760877489848662,0.0109408511112457,0.0139684551297321,0.016857239874476,0.0195994815548138,0.0210313999337401,0.0196817320199443,0.0157893518831481,0.0116618712392604,0.00972868238968334,0.0106235051129638,0.0131273252347027,0.0155280741310327,0.017097878369917,0.0188102337339409,0.0227120755843778,0.0299387807822671,0.0390333884252383,0.0468426612631219,0.051363548717738,0.052957716732379,0.052591434106276,0.0501303199462461,0.0451120787507913,0.0383202040424921,0.0317200719853646,0.0270429867436318,0.0247343620248116,0.0241089942616969,0.0243299442771155,0.0250789875895415,0.0261667254824511,0.0268920900839213,0.0264829666539474,0.0252989371090066,0.0251171173912346,0.0278567944250943,0.0339794900449802,0.0420663177531494,0.0497870357253326,0.0552864897401188,0.0578787774092541,0.0577797345040631,0.0555493826260564,0.0518806230276887,0.0476681684904104,0.0440772588732913,0.0423403348683047,0.0429217460325368,0.0445288537580024,0.0444659048285774,0.0407541228467617,0.034065480782883,0.0271796657020384,0.0223660074364474,0.0195937357528584,0.0173859327664222,0.0149186716611801,0.0128690879668745,0.0123898145353203,0.0136049649262745,0.0151791956456741,0.0152925880761526,0.0130845029582029,0.0092536952486408,0.00533572595006917,0.00248672147368617,0.000930951640049856,0.000278701253747762,6.65149053446295e-05,1.26337037657328e-05,1.91016143896235e-06,2.30826362557193e-07,2.25889158445848e-08,1.85358518906979e-09,1.37374819357664e-10,1.01710694639739e-11],[2.84085403446014e-26,1.41335816350335e-24,5.58122325107213e-23,1.75157526746989e-21,4.37637194232913e-20,8.72838470714866e-19,1.39610202783405e-17,1.81043831664079e-16,1.96884447248973e-15,2.01249289872692e-14,2.50336958197682e-13,4.30447869716975e-12,8.04181824381528e-11,1.31837392944489e-09,1.75996923202247e-08,1.87433959479943e-07,1.58322114354661e-06,1.05876413103489e-05,5.60269053239343e-05,0.000234630872671463,0.000778257606540545,0.00204920565379297,0.00430703192009205,0.00732146457749325,0.0103598470346785,0.0128703966844192,0.0150256610994434,0.0170640913410301,0.0182566571403991,0.0174154528642856,0.0146451763526686,0.0118450599968092,0.0110528403179113,0.0125904637485636,0.0150330534724795,0.0168355380957841,0.0179656464193502,0.020191454278892,0.0257623620571977,0.035274959529652,0.0465348384391563,0.0560062299018257,0.0617090971686327,0.0641984704518655,0.0646244308089893,0.0628953892815339,0.0584248907411204,0.0519641525727555,0.0457801650697422,0.0419497700530892,0.0407489634770854,0.0407919889501826,0.04061958259852,0.0398183325822348,0.0385233765590603,0.0365537917334883,0.0337815070030313,0.0311590116008578,0.0307132554001923,0.0341948502602353,0.0417006002893045,0.051503626766612,0.0610623246997454,0.0682678237661681,0.0720238496444583,0.0720553115106176,0.0686800891772604,0.0629321736492026,0.0564831948301409,0.0511344711325425,0.0482907034451796,0.0483357725256555,0.0499379288344534,0.0503578003357186,0.0472997450921735,0.0407925122622187,0.0330099830366605,0.0261381944370601,0.0207590543315198,0.016424290306183,0.0131916132987443,0.0119529946320665,0.013259525133596,0.0161719323043123,0.0184948296850489,0.0182559876085955,0.0150873935080527,0.01030897262611,0.00577578880370606,0.00263410385364528,0.000971655902092556,0.000288539576396803,6.88544074686681e-05,1.32552615083347e-05,2.09283735687997e-06,2.82930543686204e-07,3.55523030915593e-08,4.52794720658616e-09,5.85517183576179e-10,7.06376243385172e-11],[6.58097159672424e-25,3.26882982382854e-23,1.28805020671902e-21,4.03060993396788e-20,1.00304916757724e-18,1.98900492593879e-17,3.1516898024788e-16,4.00859372399649e-15,4.12531413155328e-14,3.4927373675833e-13,2.53305786282938e-12,1.74252049336111e-11,1.37184809196819e-10,1.36802274152625e-09,1.48646055732836e-08,1.46621721514966e-07,1.2029230724203e-06,7.95180522353304e-06,4.18781366294848e-05,0.000175017060242868,0.000579926645824223,0.00152575151989485,0.0032031093780286,0.00543417657304166,0.00767021655694512,0.00953259375316462,0.0112631366879509,0.0132057404095015,0.0148681413096292,0.0151608488417175,0.0138664942416844,0.0123356972002238,0.0122217415445336,0.0137227289610674,0.015521750789483,0.0165441101546909,0.0175469381247868,0.0208299746066014,0.0282905413922837,0.0394918539121265,0.0515167022334296,0.0610569306950363,0.0668910616435141,0.0701019661349574,0.0719259823738694,0.0720711685511315,0.0695730128988464,0.0648721723065472,0.0602910113565022,0.0581144715492445,0.0584581660760797,0.0594824803106499,0.0596056401319268,0.0587561062795623,0.0573042454096861,0.054882457121711,0.0511128143399758,0.0470062778978051,0.0449115414053383,0.0469674998606406,0.0535835837868205,0.0631461473912238,0.0729783242542427,0.0806710509443752,0.084734576890781,0.0844018334596698,0.0795794351860564,0.0714019734126975,0.0623032051797507,0.0550001301513651,0.051311016077315,0.0514725183224818,0.0539131995549097,0.0557722533044915,0.0543634714200358,0.0487715370293827,0.0402204751222401,0.0308743030359173,0.0224313898630064,0.0158961782308442,0.0121267173923142,0.011812548039473,0.014610409114807,0.018573151580007,0.0209473878435668,0.0199301798169388,0.0157915253434412,0.0103770078969068,0.00563339306990019,0.00251466758924998,0.000919805213704068,0.0002763004382792,6.93006369981598e-05,1.51846321419653e-05,3.14878312540884e-06,6.62386911487596e-07,1.38884902174458e-07,2.66879880968466e-08,4.37178732442225e-09,5.87571820846637e-10],[1.1640565797785e-23,5.7739943286958e-22,2.27100627433684e-20,7.08910889061958e-19,1.7583837036697e-17,3.47117075176646e-16,5.46549036060723e-15,6.88567745810091e-14,6.97530598001086e-13,5.72892104142682e-12,3.87171390781464e-11,2.21185630270361e-10,1.11989868803037e-09,5.41551843087435e-09,2.74281291319497e-08,1.53735726423846e-07,9.12696429496696e-07,5.15577249277298e-06,2.53100749534599e-05,0.000102641394714073,0.000336073555309312,0.000881626323645879,0.0018577659563892,0.00319347556558418,0.0046553085672101,0.00619235286991385,0.00817399379824115,0.0109110704676331,0.0138275894099146,0.0155909383159119,0.0155137380327733,0.0145312248848571,0.0142198025898925,0.0149773046934737,0.0158403396995246,0.0162786729933937,0.0176396719260436,0.0223224671777927,0.0314311958126619,0.0432991948174172,0.0544709639072629,0.0623835470604036,0.067176525452654,0.0708251712850427,0.0746285029535294,0.0777993123084296,0.0786147837120731,0.0768086947843085,0.0743972369100791,0.0737247295419406,0.0750219704651645,0.0766973032846624,0.0778163918392682,0.0789470641304791,0.0802727842559686,0.0804017524412951,0.0779842564688102,0.0737439307414199,0.0703157887030192,0.0703889411894983,0.0749680360420349,0.0828161512574795,0.0912338061216948,0.0975206827977031,0.0999029051299063,0.0974313908243633,0.08988796545637,0.0784652364453264,0.0660821785235786,0.0562377972354081,0.0512656429356013,0.0513760555062506,0.054799252263185,0.0585774759301944,0.0596051300760207,0.0558301754217555,0.047246355899357,0.0358752325935646,0.0246507850506096,0.0161755201997,0.0120811266122036,0.0127288198142001,0.0168568034831092,0.0216507084590046,0.0239718531869906,0.0222179142233724,0.017170540562856,0.0110731993512129,0.00596270468261241,0.00268750349390013,0.00102601300759935,0.000343589093358063,0.000107953586383254,3.40680294210301e-05,1.07730541495707e-05,3.17031871728006e-06,8.05701258731139e-07,1.69333565418867e-07,2.88499608814262e-08,3.94978458046295e-09],[1.57201968976785e-22,7.78835210352955e-21,3.05846528320308e-19,9.52726903032297e-18,2.35657757064087e-16,4.63473083888215e-15,7.26057447442124e-14,9.08204327465166e-13,9.1032982227737e-12,7.35199547203092e-11,4.82822460820471e-10,2.61949344362644e-09,1.20527250207559e-08,4.88313887184014e-08,1.81337500201658e-07,6.33811713974196e-07,2.10780629120331e-06,6.76035499654515e-06,2.12835818902018e-05,6.51011198536356e-05,0.000184104293447041,0.000455854812152539,0.000961270464870015,0.00174263403072017,0.00285283469392701,0.0045346049469492,0.00725634604855494,0.0112190069539334,0.0156080510918231,0.018711011115135,0.0193886329204163,0.0183507623404062,0.0173581430803461,0.0172294812675029,0.017437859036298,0.0178495494642575,0.0200344943658011,0.0261184111604628,0.0363294392761547,0.048054198595545,0.0576917514035807,0.0636292259076739,0.0673605719769903,0.0716552249370361,0.0777018069725078,0.0840119910946203,0.0880250837863926,0.0888106405597734,0.0880613632282899,0.0881715852474538,0.0898124202176427,0.0922874124956519,0.095710628707244,0.100969252178724,0.107297867477554,0.111826033330017,0.112405393316847,0.109816298316196,0.106899727808377,0.106405438307585,0.10955252160337,0.11551188855051,0.121771847058476,0.125403162301029,0.124355100138207,0.117760165366625,0.105702619571547,0.0895597719834877,0.0724456366420577,0.0583680923714358,0.0502838480313492,0.048727576131341,0.0519585214338889,0.0569215038248798,0.060092951603698,0.0584408350054365,0.0508418553160036,0.0389700399462523,0.0265099352546846,0.0172181625224274,0.0133560386335064,0.0150985915120377,0.020526016512648,0.0261977632573337,0.0286955225656171,0.0264918701878878,0.0206127195836584,0.0135620026325585,0.00759383335992788,0.00368331931116518,0.00161484162063034,0.000684479222179055,0.000293347317927914,0.000123072129459232,4.67472629409876e-05,1.50928806595354e-05,4.00401252081525e-06,8.59398005305947e-07,1.48185233140159e-07,2.04529393423304e-08],[1.62070929814336e-21,8.02141376466043e-20,3.14573208830131e-18,9.78155260310864e-17,2.4137323047693e-15,4.73218891563462e-14,7.38205043993759e-13,9.18115294228363e-12,9.12863010050164e-11,7.28476604330951e-10,4.69460002932626e-09,2.46832416013667e-08,1.07739376305829e-07,4.01333053236386e-07,1.32269514750101e-06,3.97907235648398e-06,1.1011268629148e-05,2.76024478451157e-05,6.18066204627857e-05,0.000125112504962558,0.000238604985160427,0.000447925150895927,0.000838656992767156,0.00154984521168848,0.00281130250114644,0.00499623661219385,0.00853354713702691,0.013462668830781,0.0188170050607162,0.0227268242616348,0.0238246954322689,0.0226749855905034,0.0212155299592452,0.020731812228701,0.0211604577718417,0.0225621206855233,0.0263127542689518,0.0339639923159975,0.0450192673658266,0.0564851139257928,0.0651195618150709,0.0702303716574536,0.0741524458763254,0.079854719847494,0.08797293592497,0.0961366701550466,0.101247841527144,0.10246096234929,0.101838098824064,0.102125325567728,0.104552355330856,0.109343559507399,0.117207833397123,0.128335462770677,0.140202981312664,0.148683402562722,0.151886724024428,0.151484425068068,0.150393939588833,0.150648592929192,0.153140691394136,0.157558642744905,0.161954903387381,0.163280200509977,0.159013405386152,0.148188862891165,0.131173859653598,0.109528848150741,0.0864503733879134,0.066358411552567,0.0529943887498461,0.0475943906806322,0.0486510224660328,0.0528989127994784,0.0564258497740472,0.055784169967343,0.0494162773887761,0.0386569665490341,0.027125419699667,0.0187595797574283,0.0159959662492844,0.01893478647252,0.0253433788341909,0.0315220631926075,0.0340676260299057,0.0315983509117154,0.0251898992150576,0.0173646564571183,0.0105217603458148,0.0058274813277511,0.00313407595823733,0.00169811122357021,0.000895581005870163,0.000426549377675843,0.000172708708491202,5.75177676103064e-05,1.55140974520387e-05,3.3648996708235e-06,5.84676901975458e-07,8.11956240452864e-08],[1.27551163414869e-20,6.30740698790185e-19,2.47068393222114e-17,7.67068354717348e-16,1.88899059200747e-14,3.69345114418319e-13,5.74113894255303e-12,7.10643650019158e-11,7.02024453696104e-10,5.55149709644793e-09,3.52961892567119e-08,1.81668820360589e-07,7.6561825860793e-07,2.69271939480363e-06,8.13727885432903e-06,2.18927724465662e-05,5.38527036413541e-05,0.000121291708962208,0.000245616541977053,0.000441712086040571,0.000717102305793076,0.00110458651466477,0.00171284640554773,0.0027478658358036,0.00449415272305219,0.00726949023999337,0.0113105365666558,0.0164961053929056,0.0219609804720003,0.0261193645022422,0.0276889988588225,0.0270113241328353,0.0259035297102161,0.0259803899374704,0.0277026685243508,0.0312902779940411,0.0376738543134935,0.0475948203575797,0.0598878039862526,0.0715333800271682,0.080000852175303,0.0855314820005326,0.0909330193882201,0.098843973309483,0.108838093447441,0.11735520861576,0.121007097483357,0.119965135764927,0.117747468135408,0.118019791672008,0.122483191788846,0.131677388514537,0.145867133854035,0.163513559946175,0.180092860208025,0.190951587718232,0.195362060617384,0.196118820209603,0.19581413385692,0.1954407048081,0.195818225760229,0.197788517214375,0.200432588722551,0.200590997602306,0.194936581110486,0.181948887514389,0.161914452010934,0.136407890290786,0.108570151175173,0.0829624622934176,0.0639121773446572,0.0534601981624365,0.0505285379530246,0.0517052115224841,0.0529282048664491,0.0510921293195124,0.045088344136743,0.0361132568316473,0.027026067102168,0.0209783235392786,0.0200165690796634,0.0240877857176606,0.0308065463189069,0.0365312157948317,0.0383495170186466,0.035440047434305,0.0289959603777556,0.0212754310042167,0.0144275515776609,0.00950407991772085,0.00629134388328321,0.00406874174100743,0.00239544146796483,0.00120731239262609,0.000502745698005985,0.000170017676526386,4.63148925423309e-05,1.01202593186284e-05,1.76915847271165e-06,2.46944807360774e-07],[7.66249744478082e-20,3.78626094286061e-18,1.48164135892639e-16,4.59392948293704e-15,1.12932313020067e-13,2.20300405700836e-12,3.41394192870527e-11,4.2088341898011e-10,4.13558588068647e-09,3.24668795788375e-08,2.04323309276367e-07,1.03578794437942e-06,4.26183130016899e-06,1.44131472026433e-05,4.0902308297127e-05,0.000100421332994146,0.000220851665108957,0.000445220307613097,0.000821929589503762,0.00137050005551206,0.00206298243881929,0.00288655288666871,0.00394396197682637,0.00545309005062019,0.00763679862714678,0.010635058577226,0.0144830605593183,0.0190684149233373,0.0239602193018579,0.0282511380754633,0.0309560086264893,0.031987688859374,0.0325296216040201,0.0341336616679223,0.0377877788790217,0.0441279373842943,0.0538337864252621,0.0668040357276829,0.0810109430063519,0.0932501348656317,0.101748174990962,0.107919018034914,0.115265148754681,0.126088633662155,0.138627792120157,0.14772576908687,0.149458987462614,0.145237285404104,0.140668095539956,0.140906248010309,0.148150430851263,0.162640655080196,0.183399718088332,0.206979174313858,0.227534189302007,0.240518440436237,0.245909861293851,0.246364147996149,0.243436792233185,0.237728968758372,0.231475781137038,0.22789033494755,0.227452030841817,0.226644568485101,0.220943659837244,0.208001974349884,0.187952910745753,0.162353933131066,0.133883827627196,0.106329520983464,0.0837035905798455,0.0685615800485425,0.0605737375263772,0.0567418834175883,0.053460045020984,0.048570448893948,0.0418353067415875,0.0343271110110788,0.0278137229818549,0.0243027214677408,0.0252659280002392,0.0303976842826665,0.037033061023765,0.0415480345586934,0.0417598605866144,0.0378777936012115,0.0315941323511699,0.024894253446793,0.0192607755246128,0.0150681414448681,0.0116648313388081,0.00835876061387872,0.00519545138334327,0.0026897942985237,0.00113623551870316,0.000387739857251465,0.000106340799635444,2.33666731870573e-05,4.10448739365119e-06,5.75302867931866e-07],[3.51358590779387e-19,1.73502333357188e-17,6.78363384129538e-16,2.1009076431002e-14,5.15684513421216e-13,1.00395602343286e-11,1.55172821973232e-10,1.90644706586687e-09,1.86480085812872e-08,1.4552160412806e-07,9.08391273505351e-07,4.55254432241111e-06,1.84154085309135e-05,6.06302862035455e-05,0.000164734026841543,0.000377716886697146,0.00075444500021989,0.00135810321891588,0.00224929828336674,0.0034272231992008,0.00477977153684681,0.00618121672402445,0.00766868649618641,0.00941375564750135,0.0115055616849788,0.0139007413555167,0.0166151579614183,0.0198729008126236,0.0239617779784824,0.0287971620644595,0.0337034672601319,0.0379601145185797,0.0416064881161843,0.0455484024071297,0.0511263052731572,0.0598143837320935,0.0726537754363698,0.0889114134270339,0.105369258845101,0.118186495749346,0.126270757840896,0.132607860157985,0.141933494792838,0.156552630615657,0.173463673279857,0.185738086246322,0.188307385872082,0.182945132816758,0.176856079423801,0.176914168143489,0.186269062453552,0.204958354007134,0.230824351954048,0.259258448111003,0.284169917051508,0.301034875203363,0.30867448322436,0.307426021717579,0.297308612525224,0.280040378672674,0.261390037658367,0.248224581110055,0.242545060109568,0.239988912667289,0.234372090234886,0.222461018995498,0.204582200343359,0.182528795685182,0.158050434180313,0.132978175827995,0.109820181108114,0.0911487665679344,0.0777523295461779,0.0679308201918898,0.0593071141929693,0.0508688277380416,0.042921904674222,0.0360327069077173,0.0308751009196539,0.0287032023387998,0.0308430842490844,0.0368766108492426,0.0436504483486871,0.0471485901126392,0.0455916851946133,0.0402764919441375,0.0338304945997752,0.0283587615304722,0.0246155267967099,0.0218485429837385,0.0185558147176321,0.0139988128897603,0.00892100136570753,0.00467543376735739,0.00198885417943205,0.000682082905917119,0.000187852537045006,4.1433869134164e-05,7.30316230632352e-06,1.02680545956527e-06],[1.23002387604029e-18,6.0695779551509e-17,2.37119898319829e-15,7.33621513123563e-14,1.79835750869129e-12,3.49506526130524e-11,5.3897745738949e-10,6.60220574911907e-09,6.43294328750194e-08,4.9945504986847e-07,3.09688449284097e-06,1.53803313533598e-05,6.14252435148569e-05,0.000198424381969882,0.000523238298158059,0.00114347180970076,0.00212128347489439,0.00345251808093816,0.00509900917217536,0.00697477447273825,0.00887912011149243,0.0105861474403361,0.0120688085855272,0.0134507603581638,0.0147071209839356,0.0157094612216293,0.0166783190648805,0.0184177631422232,0.0219779825771146,0.0279199722431067,0.0357296246284839,0.0440457098882162,0.0516583132660924,0.058481229418021,0.0659584535417861,0.0766338517926547,0.0924037895618211,0.112070880484649,0.130925115880797,0.144165059892547,0.151408922777056,0.157494149380506,0.168652369014429,0.18747290221801,0.210247138577755,0.228820213663648,0.23668612468942,0.23450556370541,0.229434888063635,0.229530016734128,0.239472498425396,0.259975707829969,0.288598399338455,0.320603929462524,0.350256673267758,0.37230602090137,0.382552360378204,0.377622335228937,0.356314846183252,0.323054309932717,0.288593011420748,0.263916088308977,0.252228002626824,0.247802348945758,0.242459341882817,0.232085718414307,0.21749216767049,0.200928421305629,0.182993993424208,0.16291171070552,0.140964830700733,0.11940411524448,0.100467090912012,0.0845350108636845,0.0709746174945884,0.059642914216659,0.0505780606045474,0.043242568207919,0.0373479538112919,0.0341209672043238,0.0355229767195749,0.0414875929997001,0.0484509991898462,0.0516662326271166,0.049092258477187,0.042571342721344,0.0356732653081218,0.0310213104054342,0.0289336557816246,0.0275458859847058,0.0244409286793968,0.0188169517894274,0.0120829528238123,0.00634791065050739,0.00270272932920645,0.000927669328679336,0.00025578269456573,5.64998369457157e-05,9.97523783514894e-06,1.40489566853395e-06],[3.29967201412295e-18,1.62262654481779e-16,6.33083735258132e-15,1.95645876546704e-13,4.78980194416454e-12,9.29420788276195e-11,1.43039347356452e-09,1.74761867181269e-08,1.69708880656304e-07,1.31187372871822e-06,8.08813723242666e-06,3.98692925517663e-05,0.000157630387373998,0.000502026086611082,0.00129612954693895,0.00274013253194407,0.00482241104455508,0.00725031965230433,0.00964132363520332,0.0117468689609699,0.0134358589363038,0.0146317544842048,0.015400761796079,0.0158649172889767,0.0159265107389487,0.0154632224080273,0.014990599459896,0.0158673836256133,0.0196460848137261,0.0270910006607748,0.0375724887711554,0.0493094641735452,0.06041168044378,0.0702120126594932,0.0802668591390883,0.0939959006626784,0.113959168536482,0.138288083889504,0.160579794484747,0.174990118125051,0.181784894487549,0.187390723491064,0.199244559261961,0.220486860054096,0.247867017843134,0.273523836548158,0.290102885646216,0.295994227174076,0.296134577123196,0.29812983018965,0.307886189290813,0.327574160854122,0.355742268875228,0.388553158702189,0.420799796250047,0.445989141386051,0.456568755079524,0.445931773837373,0.412652381267427,0.364459631021169,0.31663622373496,0.283058145669112,0.267094523102384,0.261506325947186,0.256688471871589,0.248194263871908,0.237341483716504,0.226531922046923,0.215048171605821,0.199562234295062,0.178215131607196,0.153081457972799,0.128250660149658,0.10663487300962,0.0892935619017552,0.0762459984300469,0.0663691158067592,0.0575298093816003,0.0486252099832938,0.0414521303442041,0.0392888338297829,0.0430037597161099,0.049076301368549,0.0521544251095344,0.0495007592105621,0.0427123013339317,0.0357033411481903,0.0315152373614556,0.0303226466824393,0.0296283582928288,0.0265604061076007,0.0204206236563102,0.0130274124948918,0.00679283461324186,0.00287323752358212,0.000981305546020211,0.00026966284975254,5.94461403563656e-05,1.04852082106716e-05,1.47639484197812e-06],[7.40024968024454e-18,3.3624309907042e-16,1.29721444652721e-14,3.99440991349975e-13,9.75622712856286e-12,1.88923007909751e-10,2.90135146985255e-09,3.53602488755012e-08,3.42332703154992e-07,2.63608880436603e-06,1.61723171161154e-05,7.9213213100889e-05,0.000310589870187154,0.000978194975484988,0.00248618946883015,0.00513462239323096,0.00871265065846238,0.0123706990510805,0.0151253223339498,0.0165591749925837,0.0169332362782218,0.0167546623531672,0.016420093621391,0.0160257996020149,0.0153081859768788,0.0141263413237219,0.0132693596156878,0.0145046220018422,0.019531812027147,0.028780020922036,0.0410918672945832,0.0544913866363329,0.0673993726835164,0.0797049865461231,0.0935222487192045,0.112689672341316,0.139620562458163,0.17128992538969,0.19960338194442,0.217692007252955,0.22590397923041,0.231160917185258,0.241393161384677,0.260851768791766,0.288495511670549,0.318770567166404,0.34469972797198,0.3622005514274,0.372398077535085,0.380161345865434,0.39074861899803,0.407371640538661,0.430662216924931,0.459078760825582,0.488664147143444,0.512233524621406,0.520157594160314,0.504280501322481,0.463781445392637,0.408750932615627,0.356420926368559,0.320558125321997,0.303003715260549,0.295595326147727,0.289388208689855,0.281215923213006,0.272868551161649,0.265969983945225,0.258108675249725,0.24395414863526,0.220374538058676,0.189985044486704,0.159131668112326,0.133114311130819,0.1138833785058,0.100561048289418,0.0901714879829699,0.0789262282073868,0.0652601935431234,0.0519280827254879,0.0437822774480839,0.042885528580661,0.0461816013972263,0.0481672672356077,0.0455378415760948,0.0392445354106551,0.0328213217745432,0.0291618986079274,0.0282830084430232,0.0275876692154664,0.0244026297592709,0.0183874861479293,0.0114747001818078,0.00586001813541925,0.00243460140100042,0.000819572990748334,0.000222772750933819,4.8733917564225e-05,8.55468324256789e-06,1.20193626701352e-06],[4.42571407298507e-17,7.01609939207867e-16,2.15469415808127e-14,6.37925516813952e-13,1.53745144054331e-11,2.95490107897877e-10,4.51474818385115e-09,5.48011529146846e-08,5.28558839944757e-07,4.05389130344046e-06,2.47551326332988e-05,0.000120564086963231,0.000469348204184141,0.00146461497162829,0.00367700577298408,0.00746461960494577,0.012348366124106,0.0168600221999719,0.0194238698582643,0.0195869079502575,0.0182473581396202,0.0167263881421169,0.0157930376045022,0.0153487094005649,0.0147700320422179,0.0138450955796049,0.0136779564134,0.0164104992172673,0.0236547864213936,0.0350686252537732,0.0485648188509412,0.0620666485410249,0.0751421215175662,0.0893614101437625,0.107934024621471,0.13468406170424,0.171051633749547,0.212542904452416,0.249710420604211,0.274782414053272,0.287298909247975,0.293208467759647,0.300225997255968,0.314435551225821,0.338436305342057,0.370123676620257,0.403665455249159,0.433171425298705,0.456018414041054,0.472988718705736,0.486342661554069,0.498740096796451,0.513212102475877,0.532001924210108,0.553825115470124,0.572102129574694,0.576756235247283,0.559580647398074,0.520523157950937,0.470125532172581,0.424039736884718,0.392430834588203,0.374186677470464,0.361648183030395,0.349389407439543,0.337374067413516,0.327640893596105,0.319923853871937,0.30989107934752,0.291317214490684,0.261392084263303,0.22433250973074,0.188689297702705,0.161002107149832,0.142497921995265,0.130215964060796,0.119149026144924,0.104560554971965,0.0852735395543479,0.0652691272419054,0.0506287798180097,0.0441965533924362,0.0433497150768573,0.0428177600582573,0.0392576265702217,0.0332443625011316,0.0276926222144309,0.0248274057270346,0.0242241365774285,0.0233593370175838,0.0201030145402747,0.0146055181690235,0.00875951355224517,0.0043025145781636,0.00172575551667187,0.000564256289946158,0.000150110601760554,3.24305772691942e-05,5.68161924641055e-06,8.06890507244107e-07],[1.39237124977142e-15,7.10830021656263e-15,5.49448171838906e-14,9.69907665814471e-13,2.05614508829886e-11,3.74957906524059e-10,5.55995662251599e-09,6.62456919879152e-08,6.31216847298393e-07,4.79934307730086e-06,2.9100237351479e-05,0.000140778656593799,0.00054411759516723,0.00168377296567878,0.00418385128314604,0.0083814853737311,0.0136188813471086,0.0181340612519977,0.0201750001878677,0.0194813262278273,0.0174846438477611,0.0159892984057301,0.0157785401029586,0.0163235773732818,0.0166225944442914,0.0165837972655086,0.0178482633857815,0.0229500445823233,0.0331790467661151,0.0471308335407791,0.0616857975019535,0.0748604089220457,0.0877827883015312,0.104080102408361,0.128073644783027,0.163153329821507,0.209343491427531,0.260792697503753,0.307354510881003,0.340808721945241,0.359596987620209,0.368083330286644,0.373596164274415,0.384242666892231,0.405952111870638,0.438992537006059,0.477925032555106,0.515829106177136,0.548241419688275,0.573221538765802,0.589839530998807,0.599029861558206,0.605248282225015,0.614257395863971,0.627703184605397,0.640270378982458,0.642566854683461,0.627554249088526,0.596185717572563,0.557843583422634,0.523675570538968,0.497975751737604,0.476780958729325,0.455015470599516,0.432698706338713,0.413162631283012,0.397671032360098,0.383286662580951,0.364261935058458,0.335189686726558,0.295518856552953,0.251964521359807,0.21444788709789,0.188677932564073,0.173159777876332,0.162027544890453,0.148893717733278,0.129614798064845,0.104642193332146,0.0792152843540656,0.0596886927502987,0.0487007138527138,0.043663415624341,0.0397246677649538,0.0340407977368671,0.0273912921391936,0.0223456289017486,0.0203395363760679,0.0202493966604543,0.0194604877639176,0.0163027333890151,0.0113593691575447,0.00648386481606358,0.00302743976248492,0.00116162160864586,0.000369084329772515,9.80357763522814e-05,2.19932540594784e-05,4.20507549351846e-06,6.88670632662912e-07],[4.41533840490845e-14,1.99409454906807e-13,7.82243287974697e-13,3.89351499200854e-12,3.91765075810297e-11,5.31641790973252e-10,6.68172755240901e-09,7.13629645044501e-08,6.3274054704956e-07,4.59305063141962e-06,2.70303934272894e-05,0.000128181222067808,0.000488291717131928,0.0014930962508371,0.0036687836869388,0.00726533473515205,0.0116620892692098,0.01535165712914,0.0170041086446263,0.0167535978851919,0.0161804583267338,0.0168421052795188,0.0188960255821434,0.0211589906742871,0.0225214882492599,0.0235635285227468,0.0268519753899699,0.0351891417381467,0.0490475170930887,0.065669714652582,0.0811984322769606,0.0943242829716961,0.107963790072082,0.127414067437875,0.157385172620665,0.200224261434502,0.254385917306927,0.313093679681266,0.366357871495081,0.406473827944981,0.431729982507915,0.445762851641422,0.455765734050898,0.47076862077495,0.497524517227358,0.535741246437005,0.578476699233879,0.618084578104627,0.650985853695789,0.676619321419064,0.694313040528997,0.704098329989671,0.709613587158114,0.716391773695429,0.725974347356489,0.733329301677414,0.730920182553163,0.715179406779053,0.689653886344616,0.662115257708444,0.637543686376595,0.613890860055383,0.586079394414886,0.553611124557366,0.521746901777113,0.495018390891433,0.472080387199731,0.447278224036175,0.414888268996359,0.372250478920805,0.322451047161247,0.274660324339824,0.238624760562705,0.217164786458271,0.204779504012218,0.192851045858257,0.17502435113846,0.149540180369005,0.119466510333612,0.0908950927280124,0.0691957680799117,0.0557176012412495,0.047497298848557,0.0402036391513445,0.0318238868803479,0.0237545847253636,0.0185849160627973,0.017150990092969,0.0176140242179396,0.0170960420073846,0.0141493672447665,0.00962731717108552,0.00536347636496795,0.00247958051574928,0.000976730587397613,0.000338851379862417,0.000106037642575766,2.9863586106998e-05,7.36696223161236e-06,1.53831590591339e-06],[1.08443156960414e-12,4.83411456499231e-12,1.73507650482318e-11,5.49800253760849e-11,2.21506624870632e-10,1.60098252668109e-09,1.42863974317302e-08,1.1591129298107e-07,8.05856519013943e-07,4.78474326267169e-06,2.41883765506247e-05,0.000103096297744783,0.000365721336173263,0.00106739825247397,0.00254400570887959,0.00494066773098732,0.00786130346949504,0.0104542775367545,0.0122143800269754,0.0137843466001203,0.0165999448045096,0.0213954450199207,0.0271126945145564,0.0316270333700887,0.0339520322600532,0.0359446233073494,0.041542276401029,0.0536484228897546,0.0713279725845985,0.0901841470894913,0.106088819936277,0.119191396115286,0.13442242758862,0.158083497499561,0.194215018066694,0.243417432978808,0.302619505311028,0.364812945193825,0.42120198294153,0.465884799232873,0.498544889052795,0.523268406307762,0.546632538799496,0.57601709761526,0.615693208728799,0.662465918829029,0.706902283277598,0.740848521994418,0.763673378933462,0.780593120499285,0.796281098915398,0.812160053622277,0.828355546262588,0.844053717941742,0.855186548514458,0.855166038352095,0.840323848263349,0.814269345650409,0.785820006285076,0.761610799301593,0.740064206740897,0.713622700348675,0.678000226163715,0.637748352611346,0.601002278131052,0.570169729724298,0.539898653123976,0.503029479259283,0.45619528500045,0.401134062322808,0.344472778783695,0.296089785147301,0.263473362343884,0.245624519368345,0.233644093772464,0.217655903746815,0.192885119712931,0.160899900467709,0.127342743141939,0.098307440394227,0.077153098659226,0.0632794223190003,0.0531802975934195,0.0431780104211087,0.0322675210931664,0.0225879647156983,0.0168958136363567,0.015637367593536,0.0164322075479158,0.0161593229004457,0.0134642374472145,0.00931020278156544,0.00544108786313648,0.00279862605399208,0.00132074599464293,0.000577754458667088,0.000227015198576636,7.64447936336564e-05,2.12592102463875e-05,4.77868857030343e-06],[2.03583259310696e-11,9.05221234653334e-11,3.19585671611386e-10,9.15870510147939e-10,2.41349104730206e-09,8.76230264614494e-09,5.34473588599035e-08,3.58147682794421e-07,2.05881991132303e-06,9.71405388021127e-06,3.78133994935546e-05,0.000123327816962273,0.000342437728085545,0.000818013958170309,0.00168516585276904,0.0029908926079075,0.0046149086511345,0.00644494169406338,0.0088750779633064,0.0131030673201585,0.0204284752402619,0.0306627392676001,0.0412426886112107,0.0487182233106874,0.0520357396208347,0.0544831528554469,0.0616461061079838,0.0766373021096419,0.0971041534805706,0.117177624881258,0.132873393410153,0.14611089130754,0.163616512257884,0.191944308435859,0.233678208391393,0.287451784505733,0.349221564052037,0.412732838626806,0.471339468326796,0.521816940498856,0.566044287018714,0.608509261371078,0.653278780138785,0.702984211240984,0.757456955107394,0.811086252518609,0.85350534578347,0.876850390538556,0.883839154181566,0.887072698437819,0.899347090408512,0.925065798458094,0.959047422118909,0.989704174075248,1.0036020877828,0.992075882190291,0.957526662566099,0.91313412715388,0.873936802648639,0.845681024372005,0.821405631937445,0.790077636085455,0.749030816910711,0.705980555268506,0.668480481220155,0.634520223710522,0.59520543644726,0.544402119713008,0.483712230347001,0.420066320260716,0.361816052235971,0.316278526070043,0.286559076005694,0.268541111291225,0.252608512983405,0.230093118284716,0.198655119627405,0.162486180362737,0.128432088929177,0.101506101601068,0.0826796200373975,0.0695335503500421,0.0583193030639457,0.0462807903642079,0.033496939053591,0.0226995178180029,0.0166531151951495,0.0154628037046342,0.016414290041998,0.0163180420749893,0.0139427475865773,0.010258412752295,0.0067726905696507,0.00417507371749744,0.00239863882523615,0.00122909320562412,0.000534032258767942,0.000190039703611733,5.43839285877967e-05,1.24299296614213e-05],[2.9172892590072e-10,1.29641029682379e-09,4.55992774563563e-09,1.27616549996673e-08,2.93698198910417e-08,6.6111306798029e-08,2.25906097835716e-07,1.20327171239755e-06,6.41924461224513e-06,2.8413500292265e-05,0.000100851791243434,0.00028675968270501,0.000658130304044712,0.00123722613413888,0.00195606461734631,0.00272848426337811,0.00365427709493152,0.00528213593544515,0.00881788543208576,0.0159854977822082,0.0280443915513632,0.0440544792006791,0.0600145921226681,0.0709534985367554,0.0753189738392033,0.0773705944392296,0.0841556589457213,0.0993895786420623,0.120318813773867,0.140719032885194,0.157141147912626,0.172572567234056,0.194198930846483,0.227727296919939,0.274090532477635,0.330808632650736,0.394284779265701,0.460091731065169,0.523848140858804,0.58442841744097,0.645174849781706,0.709900172838133,0.778356787385126,0.846819306134936,0.911125223305594,0.966110045735735,1.00360156280416,1.01694937975056,1.01065682049098,1.0023290394755,1.01129653841719,1.04450591627943,1.09177410313118,1.13175515630059,1.14372308362213,1.1193636978044,1.06773425074117,1.00894296511344,0.960318196722001,0.925445345458045,0.894748104147399,0.857279914309625,0.812309757180239,0.767831370667405,0.728232808134301,0.687277246608208,0.63492956070262,0.568703183010961,0.496387479409395,0.429124362256713,0.374114571072625,0.333086187174048,0.303872927355535,0.281270828421695,0.258248761364873,0.229395461931336,0.194436638691278,0.158188968110878,0.126718036369798,0.103138045783806,0.0864503339787345,0.0733982969070368,0.0608390567107966,0.047288094464247,0.0336955497246565,0.0228479011359057,0.0170942289448005,0.0161547170444827,0.0172123729940476,0.0172611853755122,0.0153061401859315,0.0122647002321861,0.00924849228638974,0.00658086027831342,0.00422335494549928,0.00231274342897753,0.00103996909489312,0.000376406695455504,0.000108872426732936,2.53538983615737e-05],[3.19003664491935e-09,1.41742669483558e-08,4.98126355004577e-08,1.38629297502959e-07,3.08000509028945e-07,5.7417597323235e-07,1.13928899517048e-06,3.72215300182883e-06,1.71326775551461e-05,7.3509283371155e-05,0.000257060050612625,0.000715863888698138,0.00158520717429386,0.00280591265890936,0.00403294617338682,0.00492090172177181,0.00570769316173898,0.00758165924372917,0.0124996828511249,0.0225439315692501,0.0387671710320052,0.0595421952271454,0.0798226566672266,0.0935648458794572,0.0986895754936018,0.0997038901358731,0.104309264441348,0.11700663131147,0.136153099079249,0.156944897949664,0.176926268197251,0.198766786035872,0.227913747094205,0.267813495074435,0.318012523030909,0.376608199904781,0.442430095279968,0.513712260656219,0.587228208753641,0.661521007309239,0.739249522811345,0.822834076057091,0.908426537746713,0.987627772642367,1.05467831311035,1.10760062905433,1.14241318471055,1.15343280555794,1.14379761733196,1.13111043319865,1.13669667058592,1.16834441982139,1.2133413249875,1.24686871422522,1.24857117107923,1.21535151256205,1.16133531918261,1.10590625583792,1.06026829132277,1.022597661142,0.98345771303916,0.936081467122491,0.882795385810255,0.830765474723043,0.781338647501416,0.726555519263779,0.658155924950549,0.578298268584925,0.499342380485985,0.433495134294303,0.384138189089893,0.346788566172877,0.315528477875802,0.286472989225435,0.256863251003944,0.224558373272362,0.189866599427923,0.156335652090044,0.128108578869419,0.106497784541673,0.0896007332595717,0.0746829623633048,0.0601353013246589,0.0457937267420381,0.0327659603178122,0.0230272648093565,0.018076695074917,0.017348527857713,0.0182602075912365,0.0182589287565941,0.0166765659121839,0.0143302963469973,0.0118454562878721,0.0091242732578155,0.00615750081308171,0.00346240562060905,0.00157771388689439,0.000576378184445068,0.000170091286297864,4.29639709545533e-05],[2.66172854912172e-08,1.18264681468507e-07,4.15532838941479e-07,1.15490173557767e-06,2.54404189679831e-06,4.49805430554829e-06,6.88599615790294e-06,1.25069614832263e-05,3.90160606967325e-05,0.000152336208360406,0.000525154815211981,0.00146022951659561,0.00322981656722076,0.00569412242519259,0.00810327988531074,0.0096716913411293,0.0107032598241561,0.0130821578505858,0.0194826842223387,0.0320212113263577,0.0510832914436224,0.0742664358689373,0.0961729929260039,0.110875695283333,0.116453611434741,0.117115187845917,0.119990744802423,0.129832057293177,0.146876144684952,0.168977433537065,0.195058916240328,0.226546182428433,0.265667864715883,0.312769488481884,0.366395257868454,0.426488043970312,0.495609653168461,0.574998911339271,0.661128576807957,0.749172176557465,0.838397527277426,0.929884806910146,1.01957062878788,1.09902523357478,1.16409746870429,1.21691848888136,1.25712481680941,1.27821446159303,1.27835769204787,1.270107666252,1.27242650535862,1.29277121224895,1.31919713108081,1.33052089738519,1.31479862717163,1.27875242777717,1.23960911655601,1.20862036416562,1.18290369295776,1.15110758852049,1.10415264724746,1.04150629455935,0.970496540017052,0.899561860840732,0.830034723376438,0.755511336249754,0.671247043868595,0.58285442000014,0.50342536056823,0.442170114621441,0.397385870009093,0.360635426408278,0.325663739157258,0.291546026062584,0.258875660859453,0.226635254107664,0.193977719512878,0.162598165193926,0.135180151896002,0.112278201162268,0.0922638766865627,0.0738625912970558,0.0573125100341264,0.0432753714497423,0.0320534654134772,0.024052208716311,0.0197682756361107,0.018669859328407,0.0188071662917211,0.0182785782330131,0.0167322450036061,0.0148466402702447,0.0128250936723412,0.0102360567386413,0.00705607609875383,0.0040135119322577,0.00184560428892112,0.000689472725087306,0.000223066576855534,7.77145146398661e-05],[1.69464042677149e-07,7.52949118781674e-07,2.64542113681208e-06,7.35016343412709e-06,1.61577516564374e-05,2.81910706557063e-05,3.98342628105903e-05,5.11910068457677e-05,8.87083417793608e-05,0.000260193634948532,0.000847156501792981,0.0023425694819913,0.00519719343364202,0.00920516048679037,0.0131670436560715,0.0157754750851551,0.0173457487016973,0.0204189952661245,0.0282273006761852,0.0425492897219325,0.0627114976961506,0.0855931367744421,0.106296764604758,0.120355148084976,0.126919709511803,0.129707017651207,0.134253901176528,0.14449355928424,0.161829336419265,0.186382736481442,0.21837916652921,0.258331937374612,0.305973591064068,0.359401000397492,0.416607126370818,0.479027028428686,0.552145415464294,0.63966521750166,0.737354137187518,0.83586896927089,0.92946319047545,1.01787350784591,1.0999385399416,1.17180017279099,1.23361872416525,1.29116888131265,1.34573356432843,1.38798500052239,1.40872285920896,1.41253878788397,1.41407709878098,1.42079487725281,1.42381605951405,1.40855932447353,1.37392814253495,1.33761638673492,1.31968934012972,1.32208996141921,1.3261466391239,1.30853826235258,1.25757755595361,1.17709623470474,1.08039062286138,0.980740959326876,0.883533026770089,0.786463806434645,0.688429535744047,0.596149879100858,0.519634773687562,0.462294850619749,0.417903908122867,0.377536109697198,0.337757659832486,0.300795824947519,0.268230794895651,0.237686810037081,0.206307443558371,0.174611640206794,0.145029307869756,0.11836482491262,0.0938461841170333,0.0717690311209702,0.0538660805933754,0.0409992248320875,0.0321124535552535,0.0258038820240313,0.0216542828560951,0.0194476597595342,0.0181515860388795,0.0166100949874159,0.014694055835967,0.0129052970200987,0.0112000243335132,0.00901330913646965,0.00625649257039873,0.00358781659856528,0.00169111153301078,0.000700905579432467,0.000322018479968861,0.000207825950808078],[8.23257367907312e-07,3.65782491709898e-06,1.28512984703684e-05,3.57039174499471e-05,7.84479953558765e-05,0.000136423636555824,0.000188755495048155,0.000214786170677299,0.000239875685238838,0.000411728110108801,0.00110608382999113,0.00296438006260289,0.00658083177093064,0.0117370431354817,0.0169632900042557,0.0206184852064041,0.0230155343317289,0.0270625184839473,0.0361549949859758,0.0514967002416365,0.0714351536836019,0.0925442415170197,0.111036623322403,0.124447909699166,0.133310933005866,0.141010233779409,0.15147655718816,0.167178886670401,0.18908330942775,0.217663416412219,0.253571593139879,0.297442756092877,0.349068017869089,0.406869796448966,0.469061053016453,0.536714127345556,0.615072810976487,0.708559233759446,0.813325789872348,0.917861538136674,1.0124042756089,1.09470845366907,1.16629818612546,1.22909850867288,1.28865355636536,1.35386394056816,1.42645272458589,1.49382140049553,1.53953511743635,1.56026469373105,1.56665232488952,1.56705274188184,1.55591816647051,1.52311042596543,1.47397929944062,1.43374489890688,1.42656721132448,1.45119176431141,1.47965378218217,1.4783710794702,1.42915285887492,1.33486648313183,1.2125183860084,1.08163744624987,0.954301155976692,0.833933191258148,0.722848435284081,0.627121482917174,0.551761645154133,0.494023205834562,0.444895996142159,0.397373253396375,0.351825418682612,0.312554276743211,0.280317141916069,0.250526089243072,0.218786784133365,0.185360755489229,0.152950776190681,0.122649399649296,0.0943113484921231,0.0693817398554967,0.0506148733881299,0.0388875271786342,0.0320011637792401,0.0270313728411695,0.0227060808928083,0.0190886310309515,0.0161158511041117,0.0134231428808464,0.011027071059912,0.00919509291515142,0.00775301249742521,0.00617005549073718,0.00428873321389929,0.00252200469774221,0.00133519657231256,0.000809411290068908,0.00069214120734363,0.000673394719539561],[3.05167033277534e-06,1.35589080354307e-05,4.7637346711147e-05,0.000132345205441764,0.000290750311098545,0.00050521119816314,0.000695278020813785,0.000764656952812119,0.000710727370444928,0.000726498371201065,0.0012627944100235,0.0030143154632646,0.00661188497720069,0.0118999378174517,0.0175115454854013,0.0219054454336016,0.0254170744185401,0.030814887130116,0.0411232812736509,0.0570153295365798,0.0765086451534,0.096522171778675,0.114334828181509,0.128674113259943,0.140760540901838,0.154098003860146,0.172329977326803,0.197069775510871,0.227710929945375,0.262934912768465,0.30237084868721,0.347247385486826,0.399768087488469,0.461473421246609,0.531855324246903,0.609655387196299,0.696010255592821,0.793592629239192,0.900544810583924,1.00778512237291,1.10484114795173,1.18662584539702,1.2538904115401,1.31169555947212,1.37025219598907,1.44171087661725,1.52876025792117,1.61712806626515,1.68561477655889,1.72490390837987,1.7422356834394,1.74660788231473,1.73472059227797,1.69736923717723,1.63967794633181,1.58825463264899,1.57182911737186,1.59452258667193,1.62998935106636,1.64010962242918,1.5982170668793,1.49999119483975,1.36057653702002,1.20322161089224,1.04695274916121,0.902374764643737,0.776057866597064,0.673232743693345,0.594033943367329,0.530944294710049,0.473787655137304,0.41774643611378,0.365764037863374,0.322839360267018,0.288725498953996,0.25762631159761,0.22466979047857,0.190087627815186,0.156375473843477,0.124332458293484,0.0939845163847048,0.0674510319631485,0.0481257706380504,0.0370147383519211,0.0313909047121313,0.0273514338633825,0.0228303262311473,0.0179456915209547,0.0134667668932475,0.00981204297080162,0.00712054906569279,0.00537081003236822,0.00424653981111233,0.00329100433464939,0.00232502198559455,0.00155049749499464,0.0012354903881891,0.00139490108068993,0.00174545373466432,0.0019083793737735],[8.63144405013926e-06,3.83504554610694e-05,0.00013473892971993,0.00037432751004449,0.000822337778211081,0.00142860854270689,0.00196337737904504,0.00213994387678856,0.00188014137522114,0.00146836781722656,0.00147885901326125,0.00260907661835473,0.00542431256222086,0.00988686776840617,0.0150805434638709,0.0199682716180022,0.024887119195878,0.0319331538995617,0.0433362142627675,0.0595964840083488,0.0793780850465394,0.100539363308073,0.120723836629059,0.138096018673565,0.153281400678357,0.170442329340187,0.194839896973952,0.228748812621937,0.270082636880491,0.314784971385869,0.360356743635474,0.408051875067671,0.462859431277176,0.530548462581125,0.612783567584595,0.705552327877998,0.803940170785817,0.906894269757444,1.01493990087655,1.12470344432602,1.22825780253165,1.31746449219465,1.38870067771779,1.44638305688686,1.50388477914855,1.57720038820996,1.67163536916928,1.77366559295176,1.85999798546726,1.91664380129027,1.94657662142567,1.95800911343181,1.94971191595775,1.91309257937188,1.84961521441476,1.78177323889612,1.74082694151967,1.74100562105919,1.76599054346839,1.77939772403429,1.74706687372388,1.65384796377446,1.50749778790564,1.33066438841266,1.14812867203021,0.978941775975882,0.835326918508653,0.722298702606671,0.636036385097146,0.565710803533077,0.500533693156211,0.436711464525842,0.378021256428524,0.329600208745904,0.291300793820947,0.25766349700671,0.223816637395619,0.189281275495366,0.155642088297096,0.123354859736304,0.0927391646664969,0.0662519244237114,0.0473098721769011,0.0367998047465104,0.0318245910927821,0.0280984217215819,0.0231234621480915,0.0170695566407205,0.0113458038415555,0.00698930165287011,0.00420421827912183,0.00266655520781229,0.00187442131403335,0.00140686784234552,0.00111882261545645,0.00114937428472042,0.00170140787051567,0.00273170137166576,0.00379044463694021,0.0042409930812954],[1.86282987539474e-05,8.27675940634664e-05,0.000290792361281689,0.000807870063110751,0.00177475127124063,0.0030830462386372,0.00423570006148893,0.00460608143115725,0.00398594897595801,0.00284090054233219,0.00200782213940702,0.00225274864929566,0.00406064478259917,0.00752210755487633,0.0122783411488578,0.0178840125240226,0.0245276928707724,0.0332837753305705,0.0454901394712139,0.0620092144025158,0.0829934933254265,0.107478135342258,0.132546137021232,0.154272071798774,0.17181407491356,0.190407579473867,0.218077086358441,0.258830716477151,0.309955003472464,0.365359455656187,0.420537488101308,0.475781772582929,0.537085758157062,0.613117544834515,0.708076435857331,0.817148583119246,0.931044701386367,1.04455559763504,1.1586756157013,1.2747469329794,1.38821592139726,1.4888664767238,1.56807085583325,1.62775929903884,1.68321140199119,1.75465685534704,1.85161623154546,1.96304052182536,2.06429248722932,2.13565877599236,2.17361945675437,2.18460793101864,2.17143606175699,2.12948092463525,2.05769127224539,1.97204341162231,1.90287864579772,1.8731576148564,1.87803169622838,1.88602826434415,1.85870804701324,1.77141354886177,1.62308230121193,1.43302519185703,1.22990033408603,1.04058927252844,0.882793692449778,0.761540371037924,0.669983724897389,0.594791632778188,0.524204578707019,0.454306582643712,0.389070631020705,0.334322941312516,0.29128643030576,0.255633267357833,0.221999357086645,0.188075065381021,0.154248523980116,0.121496787326623,0.0912835868577962,0.0662690520421123,0.0490306746295256,0.0395878627906403,0.0347743052480036,0.0304432572649845,0.0243413418869412,0.0169883832466087,0.0102360415164162,0.00539972525305541,0.00260806500258682,0.00127121657052838,0.000722420971149176,0.000547097298053929,0.0006617813546387,0.00125758793310761,0.00258142357831605,0.00454311652037086,0.00643243169706111,0.00722712325956523],[3.06765941864788e-05,0.000136299651147202,0.000478870809898544,0.00133038970706454,0.00292266424944034,0.00507725023013979,0.00697548550236242,0.00758342044783611,0.0065454367673126,0.0045754271574926,0.00289777688100012,0.00247483790247902,0.00378393974138703,0.00699696052461208,0.0121158192138591,0.0190146049112311,0.0275437063545267,0.0377906547412611,0.0505042549135474,0.0673388830885583,0.090118409493883,0.118670269481113,0.148827159721177,0.174324817850786,0.193272006592837,0.212320078677354,0.241927358951519,0.287441613558966,0.34614260859713,0.411558011169277,0.478480088041344,0.545613617100041,0.617205704508237,0.70185951620041,0.80600308511617,0.927452923292293,1.05710474532934,1.1869322158348,1.31506099753774,1.44277634043179,1.56705323404106,1.67754214980852,1.76341855733153,1.82492092634062,1.87822845107583,1.94715743655802,2.04610897631987,2.16729548775706,2.28403159514472,2.36857386011701,2.40870464350619,2.40889762796211,2.37820289606834,2.31945344682681,2.23234185068081,2.12759723064079,2.03252735112718,1.97401593662175,1.95442509580628,1.946981123686,1.91331141378667,1.82500244674998,1.67558095686276,1.48076356342678,1.26994367259343,1.07344997683037,0.91121165330936,0.787927797933386,0.695416825186577,0.619089212085431,0.546110646699172,0.472102913985996,0.401563410888695,0.341676467846955,0.295411087349041,0.259384023555435,0.227041945761311,0.193564198657333,0.158241681194623,0.123472583273949,0.0926982110406092,0.0688958490478405,0.0533552365533979,0.0447266554355509,0.0394186078852527,0.0337207627965895,0.0260752685515638,0.0174925750117984,0.0099972010528048,0.00485190361622793,0.00202585709747878,0.000766875890083143,0.000320691874875193,0.000269228397936502,0.000569752596174513,0.00147395002759985,0.00328602318830077,0.00588672436327417,0.00836521740630764,0.00940567387136758],[3.85467059387238e-05,0.000171268529319506,0.000601736998855049,0.00167177900012695,0.0036728613678146,0.00638138330155789,0.00877043756273289,0.00954560220385983,0.00827205385573567,0.00587163425311347,0.00391587889031363,0.00362287401210671,0.00553307056698334,0.00974949103886018,0.0161852146154118,0.0245941163702405,0.0345293395314594,0.0456943779010247,0.0589160468404482,0.0767319074196073,0.101924036501168,0.134056807634788,0.167352743371887,0.194249862707001,0.213440249789901,0.233411651824411,0.265721529073278,0.315524505354466,0.38011874394521,0.454246824414645,0.533610778268388,0.615250969019977,0.69939373404312,0.791536528209754,0.899306206313735,1.02582609054633,1.16684262294005,1.3139781308203,1.46026471325993,1.60219437924065,1.73576435432838,1.8523210278957,1.94238423168102,2.00590989301475,2.05855005225057,2.12579040308215,2.22649704053247,2.35691012135862,2.48876800550418,2.58581817468214,2.62624120430029,2.61178297820515,2.55728713409006,2.47377558279783,2.36458283976288,2.23857398076977,2.11991698885455,2.03463616053187,1.98685667549733,1.95347515270332,1.90075356261168,1.80359223452291,1.65543897712475,1.46916252176718,1.27042008054074,1.085643371353,0.931479370239198,0.811723029758715,0.719762446106456,0.642688642088793,0.568075460089854,0.491631226060392,0.418421846145859,0.356390522324306,0.309224079360225,0.273808855139204,0.242564643477473,0.208786167495253,0.171058221623107,0.133108286299584,0.100112310758922,0.0754249448979119,0.0594853474985358,0.0500772634178721,0.0434683196390237,0.0363836793492313,0.0277001068237938,0.0184974432556473,0.0106175559986694,0.00517871945672538,0.00213376822967446,0.000748557412265485,0.000254644761010089,0.000201059392686601,0.000517176743891506,0.00143589415032191,0.00325090535464881,0.00584219331403649,0.00830725009809669,0.00934170897021448],[3.6959510665694e-05,0.000164222250728066,0.000577022463778015,0.00160335741571937,0.00352367661283837,0.00612663452120251,0.00843538687707641,0.00922719936292529,0.00812987154114972,0.00613232722384583,0.0049389831622681,0.00595311570660778,0.00974914455343325,0.0160704503162998,0.0241708362884574,0.0333486203628426,0.0433268591676749,0.0545282188510417,0.0686659653825948,0.0888850044170141,0.117682913141123,0.153100131055824,0.187613443245035,0.213703791980534,0.232294878292008,0.253936434629186,0.289894273882677,0.343752347210414,0.412837244714413,0.494215834083041,0.585562464208048,0.682431172901064,0.779997195472462,0.878745051612486,0.985995638940727,1.11054458289807,1.25529945504633,1.41402987560995,1.57541182081424,1.73011817621316,1.87223703621582,1.99517002868194,2.09149139169026,2.16036075756783,2.21485576515893,2.27964490133143,2.37678145558829,2.50762616032711,2.64553604217223,2.7492234572585,2.78873784671927,2.76157947308799,2.68530770352162,2.577505504176,2.44663535650915,2.30221699909754,2.16504726088392,2.05675733009177,1.97992262361914,1.9152533648201,1.83719707365662,1.72879113887946,1.58714064886346,1.42281216967012,1.25404915334817,1.09715475172291,0.960574008848797,0.8462490290701,0.751611288971657,0.669150256846152,0.589961142601301,0.511213720602654,0.437892767174998,0.376728900581835,0.330112893526978,0.294463760630322,0.262308610869535,0.22704010165149,0.187379826914456,0.147322499854654,0.112117290270462,0.0849376031161583,0.0662183457384168,0.0541716529677906,0.0456808164341724,0.0377972607191321,0.0291361857311639,0.0201291679559822,0.0121341082576312,0.00625917245134837,0.00272468667161263,0.000997565119413316,0.00032868542100568,0.000186329863114319,0.000397921550753006,0.00108845242722056,0.00246348435308517,0.00442754965852591,0.00629583707535893,0.00707982325125509],[2.70468322408676e-05,0.000120201578803788,0.000422523701050891,0.0011750586481855,0.00258703516061602,0.00451554479982162,0.00627236579054091,0.00701274947952846,0.00655632780567001,0.0058107755039014,0.00635728047156414,0.00961393191787699,0.0160474575433296,0.0247430467595223,0.0339261484201143,0.0424598936843737,0.050960458578924,0.0615798505789078,0.0773314839281026,0.101393965065671,0.134965598171139,0.17401107090574,0.209603887197253,0.235082107199221,0.253904889489427,0.277948939052865,0.317117130505087,0.373182111393359,0.444225337735849,0.530426286986762,0.631743553762874,0.742389494388863,0.852603634769096,0.957411351806066,1.06248806607516,1.18073481016559,1.32175303658203,1.48296313204228,1.65167598706446,1.81562657706363,1.96817911500322,2.10372251906606,2.21443042212179,2.29623748732831,2.35745900254172,2.41920498514854,2.50409402598782,2.61876841234998,2.74277213298987,2.8367106652752,2.86734415520253,2.82794030055935,2.73548629443986,2.61129921561187,2.46830313149928,2.31656300855274,2.17211999265088,2.05024949392614,1.95124221578134,1.86021759809518,1.76055443694793,1.64403434898407,1.51230324665956,1.37436872506681,1.24079112552904,1.11646990084952,1.00004659143507,0.890323244214161,0.788693468611026,0.694904625919053,0.60642853687552,0.523529500129423,0.45054611289307,0.391240034256944,0.34511966862674,0.307610851493653,0.272411223826042,0.235033939055656,0.195384499961877,0.156646503812922,0.12207552798092,0.0935412589890772,0.0718639623769708,0.0567272217501073,0.0463456552966723,0.0381612125696755,0.0301821913638639,0.0218478307221304,0.0139283287032862,0.00761696675989003,0.00352912832543897,0.00139733961942703,0.000502623885561197,0.000225395512270778,0.000277111138805155,0.000649629572179859,0.00143361216838911,0.00256430244751525,0.00364231118005324,0.00409464216488173],[1.51360232665532e-05,6.73413328911938e-05,0.000237262898826231,0.000663009759582759,0.00147420620579301,0.00262668222007928,0.00381034198273076,0.0046685321170695,0.00524524959225739,0.00624680968250341,0.00888819097399612,0.0143512558516834,0.0228508551463061,0.0328542386694213,0.0418324775186087,0.0486893844089791,0.055393683445937,0.0659033024669187,0.0840254584701118,0.112215014767031,0.150143566047574,0.192513072616146,0.230309221102784,0.258133414326616,0.280617823068181,0.308776272152884,0.350074279155834,0.405263160685841,0.474640782197713,0.562164329900624,0.669942064483331,0.790985245401596,0.91148768011298,1.0217951521412,1.12530207449012,1.23672750647425,1.37000970799157,1.52611593456189,1.69386873388278,1.86200588724699,2.02536680511729,2.17881906312587,2.31235705000057,2.41713376074832,2.49470988146109,2.55876729281517,2.62777138681609,2.71172243744879,2.79992061346771,2.86270759058544,2.87109084197553,2.81695419640969,2.71436224934427,2.58413007270387,2.44074218228412,2.29366346592885,2.15387300491337,2.03055411711405,1.92214721230348,1.81735758176006,1.70575300073707,1.58490488005363,1.46010356121887,1.34042937150435,1.23201796214021,1.13199342111881,1.03132714485853,0.924902800806694,0.815600899529903,0.709007065698343,0.609336726867811,0.520569563452755,0.446413386656001,0.387651521590323,0.341143680098519,0.301411752346045,0.263363353857535,0.225011223674951,0.187815402457533,0.153844832236722,0.123509563728189,0.0966678794789912,0.0742710378981295,0.0574817640591286,0.045933015779683,0.0376492262900833,0.0303469943493643,0.0227650031902845,0.0151834420665697,0.00878288602252988,0.00442227623408455,0.00202053918346464,0.000907721191347488,0.000446952315231552,0.00030274786831892,0.000380647687384292,0.000680353238320262,0.00115398274317259,0.00161638106461474,0.00180989311252057],[6.63069452216347e-06,2.96437219243466e-05,0.000105671998703245,0.000302715430383023,0.000707353160073145,0.00138471371021772,0.00236819255825333,0.00372843546941915,0.00565968078240108,0.00851813436982737,0.012864037392873,0.019336225508978,0.0279177355308141,0.037078718967861,0.044548668906007,0.049961706394939,0.0563737072774159,0.0684111789722276,0.0893926588722864,0.120431334565873,0.160271351304074,0.204204027102297,0.245200576275421,0.279517895996811,0.310802070288601,0.346184494733144,0.38944642338754,0.441367338399321,0.505956449927063,0.591295811141665,0.701252023252599,0.827971150175037,0.955279295814634,1.07076388215139,1.17569081630654,1.2840950598422,1.41077744471301,1.55870320957773,1.71952959638653,1.88536797943937,2.0541733535604,2.22263877658026,2.38051153260473,2.51547017390136,2.62074370135793,2.6978620694906,2.75575229781369,2.80496487696772,2.84621518429945,2.86525728801517,2.84394618218574,2.77586238246541,2.6696464566623,2.54040310439376,2.40116398807806,2.26169928591386,2.13060633719736,2.0128781290516,1.90512070505312,1.79739825158917,1.6814992303481,1.55709556153097,1.43186612500601,1.31662898879021,1.21697964950905,1.12724341261497,1.03466354701526,0.930867411550819,0.817745901922237,0.703445766267964,0.596536189977008,0.503437666907795,0.427229334219897,0.367154055218954,0.319408460931536,0.278582486183181,0.240095751691274,0.203000547776948,0.169524324671599,0.141041351801743,0.116081180071746,0.0929982263925787,0.0725194602276577,0.0564427544930906,0.045154987479788,0.0372014245460829,0.0304728842766508,0.0235522661163205,0.0164671035605967,0.0102929187896325,0.00592706131916372,0.00334783931118753,0.00194413695374333,0.00115873939808876,0.000710516966092373,0.000485734522384129,0.000427908280865808,0.000487538001201889,0.000586025951188752,0.000623821363390101],[2.99818394361343e-06,1.34371432831918e-05,4.93630790142025e-05,0.000152533287709774,0.000410585745709146,0.000995251412543358,0.00220233843003493,0.00440273811130921,0.00781559489976422,0.0122876733393937,0.0174732367576272,0.0232701351713907,0.029678184655597,0.0361051181870662,0.0417113185070637,0.0472587032328007,0.0559330514286941,0.0713274132543478,0.0950497874451359,0.126824752772062,0.16553877105727,0.20887657243047,0.253496596780672,0.297567097767228,0.342006655015122,0.387714563036276,0.433839936238688,0.481905560282907,0.540424857657215,0.621246171693758,0.729161054121799,0.855924600067394,0.985534700537728,1.10584423816266,1.21667871208652,1.32866498023603,1.45359251884593,1.594565431621,1.74652890751241,1.90553714838171,2.07268816522891,2.24784516051776,2.42374472386238,2.5872220108477,2.7230985598168,2.81884492775038,2.87189637924004,2.89199630839379,2.89082853540597,2.87047557001036,2.82515183463489,2.75004326015264,2.64559222664974,2.51796148982806,2.37855967554468,2.2408092873415,2.11459038117249,2.00191307004136,1.89656213838896,1.7882542858088,1.66920721766844,1.53959353370391,1.40859765354525,1.28895199634941,1.18714159244313,1.09746751752145,1.00672479189657,0.905313007322029,0.793771189163173,0.680378802981953,0.574755919804817,0.483048961691636,0.406842868203854,0.345073190371858,0.295543525222438,0.254492400101628,0.217517612644142,0.182897325111121,0.152269325839009,0.126863116707469,0.105177482362479,0.0854520111894004,0.0681833974580683,0.0548415465055455,0.04555086875415,0.03886631060542,0.0329029458642115,0.0264316319404585,0.0195581430906625,0.0134138027688206,0.0089208215080119,0.00602725989304245,0.00413823869328933,0.00281198892880696,0.0018731481103909,0.00121868776430558,0.000762348125802915,0.000463654288815421,0.000296434837649369,0.000211177575822087],[4.05369081348745e-06,1.72024038400575e-05,6.04830913135428e-05,0.000182608675807248,0.000494486927049276,0.00123672523812622,0.00284140720494831,0.00581532645000376,0.0103020678221279,0.0156487767160113,0.0206825478031212,0.0247009330068359,0.0280467462423876,0.0316439290589712,0.0365757001626455,0.0445008868706331,0.0576160421207777,0.0772370906237807,0.102870979175048,0.13346907712179,0.169055988630241,0.210509309371012,0.258549355337491,0.313120145219268,0.371894351859478,0.429061672562343,0.479057014562331,0.524324056125856,0.577689237578808,0.653726207719972,0.756907683600517,0.87882694063184,1.00615488599819,1.13009559406329,1.24984602735135,1.37039914237077,1.49769449030731,1.63417522673511,1.77888996556952,1.9318425015744,2.09579314226974,2.27241097034876,2.4572641924804,2.63731448035505,2.79161838651238,2.8982156436237,2.94724753946154,2.9480602284575,2.91975000513083,2.87588895540022,2.81908568751705,2.7437542564902,2.64168841406484,2.51167200398481,2.36637645378528,2.22556931290839,2.10132328082116,1.99156066430979,1.88573233346008,1.77301351232792,1.64715961687964,1.50991441595709,1.37199135579493,1.24708492651717,1.1414831971108,1.04923465556023,0.957844441638781,0.85860442173745,0.75236938427003,0.647303691838779,0.55183857515136,0.469108319926558,0.397552175735768,0.335733779257271,0.284210689547739,0.242351345684161,0.206557016974571,0.17360890677647,0.143558793939233,0.117699807383231,0.0959098759661617,0.0776081239132926,0.0633222260089747,0.0536073089661647,0.0475011868916672,0.0429272665552242,0.0379525679181441,0.0316441803940841,0.0245070374354872,0.0180093979732696,0.0131905085826471,0.0099149239418348,0.00752826961980493,0.00564822309618721,0.00414623964488229,0.00289525422603848,0.00182214898771736,0.000984301559593024,0.000448714956874769,0.00017859940596305],[1.11619512117681e-05,4.55591630706746e-05,0.000150278100484637,0.000409365045055403,0.000955300600112854,0.00200291967940347,0.00391080716972749,0.00710172806807054,0.0116241582503537,0.0166459498630435,0.0207193337010786,0.0230150869166812,0.0243609506150093,0.0269791975680258,0.0333728774754045,0.0453835941977756,0.0635501098143719,0.0867746832852168,0.11307753308043,0.141504642839224,0.173519570232472,0.212617463861646,0.262652418770412,0.325045449059405,0.395156324206334,0.462061740998711,0.516406710356511,0.561169022649921,0.612314390771391,0.685889701533823,0.785115058513898,0.901243273794127,1.024416112797,1.15033581841605,1.2780736264944,1.40669502485633,1.5360556323396,1.66847524206237,1.8079921195906,1.95857724703982,2.1228818188338,2.30083592456057,2.48690732068619,2.66699532057586,2.81902186029355,2.92091541580201,2.96320543016297,2.95511719109437,2.9166339332213,2.86467636901675,2.804853997094,2.7299445411198,2.62647979595079,2.49093617835261,2.34037433601505,2.20048746296603,2.08291308430703,1.97876997706032,1.87168470202064,1.75068343169608,1.61316644427062,1.46490107166736,1.31942202956133,1.19116292387746,1.08492036622199,0.992723587935389,0.901650317767068,0.804515742670636,0.70439479994692,0.610581054696647,0.529945849149803,0.461412664394706,0.399096880634577,0.340178869730441,0.287431978392913,0.243759997763123,0.207357882033894,0.174101530789271,0.142387674250655,0.113523824657664,0.0891778818209184,0.0704641354988935,0.0581077681834196,0.0515656463796761,0.0484815899407206,0.045886692954832,0.0417075490187147,0.035408567989628,0.0280328919094081,0.0214039061933372,0.0166151798633755,0.0134157598721587,0.0110665748263791,0.00913280667643813,0.00736004129708433,0.00550926196906524,0.00360162299426139,0.00196216559749939,0.000868216003442488,0.000309305604548158],[2.69628637969539e-05,0.000108708865330579,0.000349727180397806,0.00090644007884131,0.00192879108463373,0.00348384731786149,0.00560252844314739,0.00838825830731799,0.0118480311257809,0.0154629414625078,0.0182438117707219,0.0197236541633123,0.0210523896732689,0.0249368690488806,0.0342401991399354,0.0502582982813952,0.0719644915359283,0.0968396247378902,0.122707914308841,0.149269693518212,0.178629672861625,0.215128400762509,0.264192580568018,0.328672315211387,0.403620676126167,0.475997376030217,0.534402044422103,0.581598132417301,0.634676467090569,0.710032047356928,0.809799061940312,0.924777643710763,1.0470410241118,1.17487005451167,1.30702797193356,1.43872863739113,1.5662125156735,1.69259782172346,1.8265199669554,1.97548951475678,2.14131878249861,2.31973017696105,2.5004714915361,2.6672243721191,2.80102932718507,2.88741002600802,2.92251901787991,2.91412528835838,2.87689305480866,2.82502124894788,2.76460628571682,2.68830289225013,2.58152888475744,2.44245952326179,2.29354724452561,2.16410894880791,2.06210732094733,1.96959351760886,1.8632268493109,1.73198934745797,1.57866965278201,1.41557866034216,1.26090691005321,1.13058794882917,1.02761446681628,0.940238014552535,0.852582435569049,0.757631925617622,0.661301825984428,0.575513164801066,0.507018621819382,0.451871449433895,0.400565732280108,0.34800655548161,0.297041288888928,0.252465360473991,0.214341265346283,0.178913240330145,0.144031865353584,0.111258697335545,0.0837027496681637,0.0637794244971153,0.052234673129265,0.047477533064513,0.0459597538577207,0.0441030968159182,0.040001735257645,0.0337069688321587,0.0266820922242153,0.0207464478742461,0.0167912827753414,0.0144618161141933,0.0130003099744217,0.0118229637108741,0.0103675074169194,0.00820637622146616,0.0055284174453397,0.00305335428312545,0.00135596444440806,0.000479920721882932],[5.04577088920836e-05,0.000202746650761582,0.000647366108799279,0.00165055571483705,0.00339298689293096,0.00572839562696535,0.0082066456872128,0.0104727488820646,0.0125382881449064,0.0145098135654196,0.01628620360487,0.0179638553194195,0.0206796997906745,0.0267615925081701,0.03848067028099,0.0562552409141901,0.0782791868878072,0.102236682816516,0.127118778198312,0.153255963607818,0.181815028592772,0.215794034715798,0.260715435408536,0.321043569482954,0.393613235705505,0.466361884536889,0.527834812460673,0.579843437323677,0.638288018666096,0.719021963909724,0.824423936298354,0.945525678627524,1.07383665226654,1.20635008692366,1.3404964871991,1.47060172380101,1.5927572020603,1.71121841621241,1.83709554695472,1.98017461045588,2.14205709884447,2.31487752055467,2.48343598286242,2.62977718392354,2.74033204400297,2.81032433103543,2.8412976413269,2.83728294614063,2.80546032833714,2.75670146106679,2.69816958291369,2.62331366756119,2.51738605537354,2.38068747710427,2.24014928973434,2.12697482474014,2.04448228536997,1.96574117545823,1.86058567614557,1.71819141489473,1.54783318608854,1.36969386965293,1.20704441376707,1.07717541945122,0.981196597410345,0.902918321493306,0.821718720159171,0.728769773433398,0.631944001878491,0.546473823490649,0.481247947394727,0.432789621320098,0.390711750857187,0.347698316167839,0.30377282176762,0.262052550273472,0.222994376871295,0.184431692370124,0.145719115825332,0.109492663790845,0.0796284176286149,0.0588118779409616,0.047364516294987,0.0428626472874234,0.0410923991458526,0.0384272200375855,0.0335551641145106,0.0272215277407582,0.0210196472298802,0.0163211027160136,0.0135965894047317,0.0124604194798446,0.0122461805688312,0.0122226884839964,0.0115044274808971,0.00949648676563929,0.00653465661776516,0.00364465588908097,0.00162534937963239,0.000575977589778423],[7.23060386900458e-05,0.000290517055427753,0.00092706735596228,0.00235857021777504,0.00481837807507161,0.0080100702279868,0.0110961890815187,0.0133241885685751,0.0146733140805371,0.0157653678998727,0.0172936514528477,0.0198258092396959,0.024209440293576,0.0318340579305347,0.0438687421276536,0.0600381699105286,0.0788963070034202,0.0997963973615837,0.123636759750654,0.150904527830174,0.180536071786086,0.212829462632041,0.252562464440251,0.305835467477779,0.372328470272133,0.442734025545113,0.506761347105357,0.564608217806946,0.62911496938888,0.715072538107764,0.8269492720752,0.957721174171516,1.09711554340736,1.23771562697715,1.37427673160463,1.50209246369566,1.61943801674278,1.73120157931835,1.84799200217314,1.97989512237261,2.12936392085636,2.28773569796352,2.43750907791346,2.56096258236411,2.65015693843628,2.70766194392275,2.73695185025376,2.73716091798361,2.71022800809259,2.66655715771075,2.61485286580714,2.54775346170999,2.44875810403551,2.31914602843616,2.18881354156293,2.08978915628248,2.02192840063983,1.95232947966821,1.84649242037764,1.6946025677453,1.51205626148106,1.32558130735974,1.16125741309276,1.03571839757981,0.9480076374136,0.879016099108005,0.80469860687194,0.713913190687149,0.614551426265934,0.523806525640254,0.453677224769602,0.40434043693527,0.367919758528845,0.336002352033078,0.303729570297691,0.269026879625727,0.230746817426669,0.189085859062397,0.146860390968344,0.108610405676963,0.0781849996791759,0.0573723841878496,0.0456735407841972,0.0402640964179016,0.0369779508409049,0.0326692799512089,0.0267554836387425,0.0204383334242825,0.0150675768974807,0.0113533357878834,0.00938391580151492,0.00887931283542475,0.00936300788357405,0.0100737503139799,0.00999834156920437,0.00849877813058468,0.00593165000420638,0.00332962415849934,0.00148901399230824,0.000528274604481363],[7.92435184195855e-05,0.000318811181075756,0.00102024169899542,0.00260812165352027,0.0053688806736295,0.00902481095599978,0.0126796681820677,0.0154436243410832,0.0171800461341491,0.0186067642069767,0.0207821504116225,0.0245504506283791,0.0303663293709356,0.0384447463885491,0.0487250416760588,0.0607293168015887,0.074373945246876,0.0913174420008797,0.114110118563067,0.142832836539506,0.174123951368724,0.205888921772086,0.242180747193048,0.290349371127471,0.352594030302599,0.422327001086122,0.490266281971763,0.554195433013765,0.622754346622158,0.709421148983314,0.8221492217611,0.957982735453807,1.10607559138143,1.25445675525812,1.39473611214242,1.52326760201185,1.64062967178777,1.75115784403325,1.86232362168368,1.98230436315641,2.11465540312328,2.25260497858794,2.37966471404249,2.48015285250959,2.55057738895959,2.59724141089003,2.62281060973161,2.62273875788746,2.5976196821964,2.5595297161258,2.51729684435793,2.46051987453592,2.3703835423966,2.24885071876401,2.12685639700003,2.03555449085479,1.97318198574135,1.90592773154225,1.79926260693787,1.64486464615412,1.46132796965128,1.27780118301756,1.11948769666242,1.00015658569805,0.917306562050535,0.852517855421179,0.782689993592159,0.695882248012876,0.597670217358813,0.503717149990407,0.427644469358398,0.374406166285565,0.340793759210412,0.318711396615958,0.298340213803643,0.271407243511787,0.234503495292998,0.190499492228075,0.146259637740506,0.108107176991905,0.0790090832292793,0.0590692732419013,0.0468912034592808,0.039849004261771,0.034600351897558,0.0288709308146167,0.0225618662705394,0.0167294690342815,0.0120780310866776,0.00871240862776239,0.00661889560755205,0.00580436190508776,0.00604729119042074,0.00668942430444825,0.00682076346895792,0.00588800641038793,0.00413888898482152,0.00233001066328805,0.00104305080205282,0.000370157392844856],[6.68198106103956e-05,0.000268243272035603,0.000862442651791191,0.00222710235600548,0.00466621851909842,0.00807286134924524,0.0118424387820083,0.0152705732357718,0.0181035436704533,0.0207980792429399,0.0243701262961166,0.0297825279472497,0.0371298903834231,0.0454425525174137,0.0534685498753619,0.0608919491514518,0.0694069758122422,0.0827313335875223,0.104221150758163,0.13325847567521,0.165177243044077,0.196906165549459,0.232251402318745,0.279178838863776,0.341429902537688,0.414246852840396,0.4884980871936,0.558738418160979,0.628715933274485,0.710086421646673,0.8143748448228,0.944132159796714,1.09081389107326,1.24085619879693,1.38401999385164,1.51700179765928,1.64106526501705,1.75838691186327,1.8715934859514,1.98507889076529,2.10248587551177,2.21994526206127,2.32432330409151,2.40311876055573,2.455720834973,2.48961518584588,2.50628306201632,2.49991551450519,2.47213156009463,2.43651711629199,2.40060711736505,2.35113631551256,2.26844284430051,2.15475562976877,2.03891249218664,1.94897504609496,1.88395591999846,1.81499739620622,1.71175857354253,1.56625354288379,1.39501671162274,1.22450780260919,1.07661639765785,0.962097132392236,0.878472011111697,0.811484976180801,0.743134335500374,0.662662166571788,0.57181533180352,0.481507377089564,0.40453678634213,0.349577832140571,0.317831326259757,0.302043487726642,0.289071983653095,0.266607101378089,0.230342158041943,0.185641529902443,0.142143997180071,0.106622887861055,0.080442406112103,0.0619346856690474,0.0491179040754067,0.0401216509535216,0.0330068588918584,0.0265657455538165,0.0207994721780046,0.0160309013498839,0.0120827076533498,0.00866357691390713,0.00595015877487658,0.00433484656245445,0.00382681558763504,0.00389953920360438,0.00384525733266858,0.00326210658370438,0.00226668999868857,0.00126571599521925,0.000563440775943304,0.000199202827911567],[4.69180434137827e-05,0.000176436997861405,0.000563686297999693,0.00147653140069181,0.00318743043873315,0.00579209903459082,0.00912745144896169,0.0128852110710767,0.0168299109631434,0.0211074020107875,0.0265086772308951,0.0340167383360327,0.043480388825993,0.0529261119395228,0.0599612923639264,0.0643226091576896,0.069176094352938,0.0797368432111172,0.0996619542980066,0.12781871865618,0.159215717086472,0.190745600859498,0.226057332992286,0.273194505154309,0.336967351862266,0.414163184963062,0.495500199467472,0.571997705366694,0.642008700662094,0.714186065213796,0.802157220341434,0.91399616459454,1.04627965760358,1.18815334602482,1.33027096023428,1.4693607805276,1.60535946741949,1.73665165659565,1.86012335821893,1.9751198573938,2.08362862943981,2.18410268133881,2.26798408919352,2.32703074019348,2.36293260930598,2.38352657479229,2.38969918267178,2.37521291314244,2.34187589295672,2.30343008872591,2.26719913952793,2.22052643495647,2.14496112106653,2.04090840877682,1.93090993010977,1.83818432485057,1.76537560160903,1.69371892527714,1.59982183509669,1.47368166781253,1.3242725027848,1.1714034006201,1.03360900275826,0.920824592133213,0.832524619936751,0.759744825619032,0.690506961433461,0.616093569415159,0.534855513367918,0.452668375086507,0.380275326818257,0.327797823253824,0.29838474468927,0.284977218038559,0.273485807663615,0.25140200713359,0.215708225167352,0.173391098113093,0.134373474094955,0.104042278136463,0.0818520009885928,0.0649566606527155,0.0514257431194225,0.040521418661526,0.0318400503602255,0.0251101907030724,0.0201413194696608,0.0163892894186399,0.0129886562827482,0.00954006006611943,0.00647725684510175,0.004406344658585,0.00336443016944425,0.00286159203128408,0.00239701357547155,0.00178721247388034,0.00112831164116285,0.000588687277500231,0.000250206744626604,8.5789771142074e-05],[5.06638003439168e-05,0.000112027305706003,0.000301791641309721,0.000779363824168918,0.00175931861448241,0.00347083703349834,0.00612185086728853,0.00983000591952232,0.0145456368975776,0.0202653805091111,0.0275487666186439,0.037338210194254,0.0493979289936594,0.0610912843389297,0.0689643639575932,0.07233326062955,0.0751060455551123,0.0836278794139368,0.102131052776849,0.129523795276914,0.160709640365183,0.192165680985268,0.226751632260575,0.27233402054504,0.335143677335873,0.414138835716786,0.500505190623696,0.582256203081688,0.652269259236285,0.714746861436323,0.783059725316742,0.869602621659422,0.977684341023564,1.10262280047391,1.2384727646394,1.38197295591533,1.53029713648365,1.67720553307302,1.81399022302975,1.93465722881654,2.03813083122621,2.12420860895778,2.1897869615474,2.23256799323501,2.25729319986753,2.27188349328947,2.27566817756609,2.25960335857173,2.22227548987177,2.17629652951299,2.13205011274058,2.08292714843296,2.01436554211,1.92317021491845,1.82212653924216,1.72784140257832,1.64740248716795,1.57417055220403,1.49282756165985,1.39012151126268,1.26459347853804,1.12763224825658,0.99560503621314,0.880460938644459,0.785226057887756,0.705371752859503,0.633134722056173,0.561498946562283,0.487210418983329,0.413194759586222,0.34817835185975,0.301281113125547,0.274659324561843,0.260739177257287,0.246840757181326,0.223572295857109,0.190493519081637,0.154694776707016,0.123896035742952,0.100733490764485,0.082976978134493,0.0675666427997822,0.05338624645456,0.041003149184298,0.0312275096458018,0.0242685885452758,0.0195910357039933,0.01613446015296,0.0129270647358456,0.00977192809418926,0.0071899556094205,0.00557616084024844,0.00464158481931309,0.00378434646501423,0.00273678984355934,0.00167133921584143,0.000850174390267464,0.000360412191960287,0.000127682313911674,3.77759065945848e-05],[0.000160584062805484,0.000168789604957589,0.000208925659815475,0.000382355910533232,0.000859211865034687,0.00192215395347416,0.00399848001140323,0.00754108803267177,0.0127625288723592,0.0196581096711001,0.0285771924176673,0.0403425162153609,0.0547456402193075,0.0688927359115731,0.0785568154637259,0.0823270369728206,0.0841641052022292,0.0912650664175217,0.108896275659405,0.136523178877207,0.168718024377331,0.20071345490378,0.233957017068679,0.276140061977018,0.335243206259158,0.412740626090824,0.500902652674064,0.58587129777423,0.655973331446775,0.71047851994029,0.760665306860024,0.821686679725008,0.903543646499371,1.0085445666465,1.13430674659816,1.27681267565022,1.43005798954361,1.58428359562835,1.72734875645858,1.84941943530089,1.9462792466338,2.01850916605395,2.06896037982393,2.10265813755483,2.12801111285551,2.15170597701143,2.168419402439,2.16236461087975,2.12557113215788,2.06872471007834,2.00805954622339,1.94794088022804,1.88189132183994,1.80484565556114,1.71902926551137,1.63166775195155,1.55065017957459,1.47888200007032,1.40910500892009,1.32659928040663,1.22082223616339,1.09492080442926,0.963421530196341,0.841541152999145,0.736849331973526,0.648630244747017,0.571698301427726,0.500054026932027,0.4299449300584,0.36284608525776,0.305486257664738,0.264498688308318,0.239818414788296,0.223802415341198,0.206878136776371,0.184024118567828,0.15697109297082,0.131249984266774,0.110902677894774,0.0955176678092074,0.081910353324852,0.0677801983740895,0.0533597237387187,0.0403784835720486,0.0302760453402467,0.0232423159563985,0.0184014383405258,0.014656619591623,0.0114639572947546,0.00901595861913069,0.00771009038498278,0.00736344921172838,0.00708283540084005,0.00605332147298955,0.00428936849083061,0.0024539163815276,0.00112509894754128,0.000413695305569896,0.000122573856067057,2.94846694691033e-05],[0.000599182788363155,0.000541047735538061,0.000412097790613915,0.000338755472547436,0.00049897167802909,0.00119279735102497,0.00294989479750987,0.00644728915859178,0.0121377064070112,0.0200381607110436,0.0302053635023309,0.043138757344402,0.0586294425285086,0.07398378927198,0.0849137992853598,0.0895611273655652,0.0914986576847699,0.0981478597958165,0.11559818668967,0.143977810965754,0.17755901696627,0.210354317950592,0.24264467716992,0.282090889134433,0.337909613226947,0.41311835329967,0.500743386066934,0.58624434554227,0.655562203457417,0.704580182746588,0.742431519480641,0.785661624024634,0.848785492425653,0.938308385265725,1.05270561723641,1.18594464221546,1.3299377821259,1.47457692461654,1.60831927681873,1.72084135207368,1.8063180019959,1.86578107641023,1.90686970994108,1.94090491430025,1.97884539652327,2.02416333260821,2.06442353046889,2.07545184840725,2.04216386491792,1.97304672342771,1.89024237927934,1.8107253035765,1.73989640244224,1.67524853174333,1.61048126730069,1.54084377555346,1.46880489005771,1.40133890169541,1.33878779367594,1.26936845479629,1.17819198922915,1.06135635479615,0.929770745240851,0.800247670030313,0.684848987381572,0.587408254244923,0.505643242273912,0.434242161809864,0.36837770071757,0.307560508851949,0.256213953758631,0.218764090219056,0.194075868350733,0.175820365671209,0.157944243888358,0.138807716286615,0.120677283550356,0.106340954419339,0.0960322636791394,0.0870965616026853,0.0765113884280873,0.0634699220123621,0.0495568916341294,0.0370972944643573,0.0275370815121415,0.0208247631886455,0.0159466195347395,0.0120547096732767,0.00912405430196314,0.00765384600689555,0.0078252255353673,0.00886964651978534,0.00934398300177369,0.00825833058048297,0.00588897626291689,0.00334474716122865,0.00150713607352395,0.00053834440257026,0.00015251690278209,3.43198289560429e-05],[0.00178067802674241,0.00158595396709971,0.00112745585580854,0.000682957812339684,0.000530030669503003,0.00099160994534354,0.00263595268830561,0.00628244100729955,0.0125564530311481,0.0213993885476596,0.0323393370601329,0.045198215395251,0.0596557334787932,0.0737930656375546,0.0843637021146599,0.0898247279415758,0.0930991480237475,0.100803420087695,0.118885949446409,0.147812232849984,0.181944924167931,0.214971573648913,0.246898986433358,0.285477271402698,0.34009306083318,0.413634718942507,0.498961960441427,0.581829390500575,0.64858012819413,0.694810293163269,0.728987754756612,0.767672155768023,0.825758109997886,0.908852158170996,1.01291539880338,1.1296881629295,1.25119218007745,1.37014529980513,1.47920522123341,1.57134534191628,1.6417963851477,1.69169226288837,1.7299714722594,1.76996701792691,1.82252183511841,1.8874695687559,1.94676237381824,1.9707131702148,1.93977040821771,1.86043040023113,1.7581640851775,1.65962645863207,1.58173706248503,1.52730540945753,1.48482844801264,1.43782575858662,1.37941578771482,1.31585930973022,1.25440429518735,1.19081853718555,1.11159269901555,1.00747305745177,0.88277145281368,0.75192635748854,0.629856781600644,0.525738735499251,0.441463778478212,0.372550250109693,0.312081110488704,0.256626219172145,0.208526052947581,0.171590938646223,0.145611994323964,0.126478266879201,0.110689872363622,0.0979249683743125,0.0893757554205108,0.0848282438620209,0.0816380973088432,0.0763212420353471,0.0671281891989536,0.055016742023913,0.0423766432819887,0.0313133235614076,0.0228282724449359,0.0167473034497438,0.0122458886408326,0.0087666598339303,0.00649607868078921,0.0059415936841323,0.00708858853402975,0.00891183042957525,0.00981225976409832,0.00880896351406875,0.00631106451988663,0.00358574836345229,0.00161267894218074,0.000573826317745067,0.000161528921084406,3.59768186259029e-05],[0.00405123938383857,0.0036035988535727,0.00254114623018417,0.00145445395332816,0.000836342097150141,0.00104839318359146,0.00264194012508379,0.00649499275390396,0.0133132214308741,0.0228431631327979,0.0338799482974181,0.0452951207951774,0.0565862200281828,0.067103921674403,0.0756120863749306,0.0816346441731672,0.0873415386783156,0.0976416313750092,0.117296385689302,0.146624979744329,0.180408087609981,0.212786457361229,0.244046516017072,0.281881017019464,0.33506189779952,0.405457426425295,0.48546971877703,0.562070599639199,0.624244191413686,0.669956215805998,0.708298490598716,0.754268786035115,0.81917127612371,0.904005422900602,1.00110798241416,1.10104905860524,1.19708586031577,1.28515706793272,1.36303019507342,1.42959669356469,1.48419478769478,1.52822518567363,1.56771548897556,1.61227223566379,1.6698253162075,1.73853434179712,1.79993734792335,1.82454690262765,1.79225022531724,1.70806029220054,1.59742748417155,1.49084151939806,1.41153149966458,1.36629513656201,1.34147697580432,1.31294692367437,1.26558002596372,1.20287709785276,1.13748793427629,1.07473310829808,1.00662591728562,0.920820572951283,0.813436703281838,0.692957260959229,0.574411681544903,0.471257799054611,0.389415974368872,0.325270282240547,0.269982647064222,0.217846579050665,0.170465141013347,0.132611465240864,0.105872891486088,0.0878237467609685,0.0758578953977041,0.0693540680421341,0.0679522797718812,0.0692659403117511,0.0692517197715041,0.0648698315607475,0.0561057087984709,0.0452326552059389,0.0345500750633618,0.025267420870251,0.0178404825226967,0.0122999896597317,0.0083130486746398,0.00554737033135804,0.00404336492749354,0.0040314335654754,0.00535624668462747,0.00711093750365929,0.00798663417747144,0.00721801223005052,0.00518235532176473,0.00294611456641795,0.00132491600074072,0.000471226832294831,0.000132539522344108,2.9480492366136e-05],[0.00703472850689818,0.00625629611008226,0.0044049665731721,0.00248529271188431,0.00127207746984325,0.00115532636078502,0.00258681588563327,0.00637346294897889,0.0131892504010672,0.0225924987221055,0.0327911507216437,0.0418529949269489,0.0491173634011092,0.0552000464402247,0.0610137228311083,0.0673945891043787,0.0758597834864288,0.0893512704438867,0.11094849408354,0.14055233455569,0.173552954706321,0.204791218129518,0.234582307382093,0.269918688718054,0.318605053073683,0.381855261228805,0.452462701856097,0.519514580874603,0.57544147644962,0.621173139277434,0.666274635361535,0.722963516174411,0.797710024196187,0.887291414182199,0.982237002135471,1.07291616041297,1.1524332788391,1.21719462293084,1.26820211818885,1.31079540312953,1.3507440218327,1.39099349470821,1.43258897571947,1.47738207858374,1.52836199064317,1.58423383014376,1.63124988106522,1.64528892790247,1.608923182856,1.52618172282685,1.41974873677763,1.3181631085108,1.24441048307794,1.20600469854276,1.18963224624223,1.16963823252915,1.12733940761614,1.06369883766873,0.994013994165299,0.931149243820336,0.87343112295471,0.807849036429211,0.723913683080447,0.623683276818948,0.520135662277941,0.428074879136186,0.354973052110538,0.297352610922311,0.245795281150518,0.194691396557874,0.146847438067628,0.108620203991064,0.0826479421824979,0.0666779169206769,0.0576233546436994,0.0541250005144571,0.0550620287472834,0.0574870883979404,0.0574810856365094,0.0530447078966612,0.0453578195899116,0.0368674357437829,0.028857453663327,0.0213824119444121,0.0146206531085308,0.00918741514036579,0.00543011082495016,0.00318964786422092,0.00219750180344298,0.00229967613210105,0.00324178763546497,0.00441172114386872,0.00499406375815053,0.00452428335467745,0.00325072400009503,0.00184840189562443,0.000831287303396383,0.000295647811781223,8.31469956300974e-05,1.84910474363709e-05],[0.00932098604085057,0.00828915985291801,0.0058332381817885,0.00327285370284039,0.00158798396077375,0.0011527494630363,0.00225233289045399,0.00549959331326965,0.011448435346396,0.019620822398191,0.0281259227234589,0.0347803435275888,0.038874585704992,0.041753362151451,0.0457056284358199,0.0524981305306936,0.0631630685213166,0.0789714267583575,0.101419983909482,0.130148391769418,0.161622466248722,0.191679681223726,0.220119489766337,0.252127416592587,0.294019500904564,0.347073037629277,0.405752758344264,0.461865358691374,0.510736344041555,0.555036838689473,0.603640860187204,0.665695009558023,0.744370129276702,0.835487245200508,0.930738814390769,1.02078384829556,1.096494556707,1.15152276612201,1.18698173693441,1.21268439995578,1.24097456360648,1.27815027628952,1.32166741682846,1.36523833987741,1.40571877041988,1.44230011448117,1.46783096719531,1.46654330779676,1.42609253354315,1.34985468728169,1.25549761628539,1.16544977541906,1.09823754125416,1.06040036805154,1.04145733405124,1.01975718478912,0.977988978638773,0.915516255951634,0.846794429340175,0.787278590811101,0.739190161455562,0.690573048864388,0.628217423563553,0.550447544478496,0.467788939469686,0.393516845600645,0.333615689164402,0.28372296784826,0.235187333596842,0.184652200432731,0.137238837589556,0.100367637662699,0.0763260760701072,0.0618299231939751,0.0529054041682129,0.047944024023526,0.0463096337841619,0.0460657633687687,0.0444975193431873,0.0405391871733981,0.0354321824299836,0.0305726467700611,0.0257051913151348,0.0199179392020577,0.0135056773747955,0.00787347738330551,0.00404953450260585,0.00201390237027318,0.00121797372597394,0.00118878035951391,0.00161165829733907,0.00214724580101144,0.00240712092827844,0.00217190008981266,0.00155803811488822,0.000885374887786369,0.000398087687331385,0.000141566495591495,3.98118213191244e-05,8.8534380172866e-06],[0.00942389607905228,0.00838062727738969,0.00589642405963465,0.00330028692270785,0.00156176354760025,0.000993980528239067,0.00174284514416624,0.00422617689040192,0.00887721232804255,0.0153347073841225,0.0220277526615918,0.0270262080109891,0.0296798855481097,0.0314534955436202,0.0350215547655607,0.0424591644442305,0.0543925373470722,0.0708187428521858,0.0919567875636474,0.117580001480354,0.146023146570011,0.174902074188851,0.203401629470047,0.233812042427894,0.269932187588261,0.313131958204908,0.360299951049833,0.406196662406562,0.448139224070647,0.489070031674571,0.536168465842329,0.595795103121765,0.669634857080102,0.755140542130735,0.847250343294883,0.937967498290701,1.01620791042031,1.07210122085918,1.10431300989437,1.12329014967329,1.14521378126683,1.18024692860605,1.22541289996473,1.2690985976162,1.30217329845088,1.32242651997756,1.3280313333039,1.31244370135023,1.27008361344178,1.20379394261566,1.12424100939764,1.04525954447266,0.979786354808828,0.934292876222037,0.903710886904788,0.873801448605924,0.831505163552063,0.775046418178708,0.714970114902641,0.664246560071809,0.625572194489595,0.588734117618559,0.541386727648347,0.481250800335273,0.417083648394293,0.359589313418235,0.312346887307217,0.270257564115267,0.226137021846705,0.179021118185981,0.135414232965038,0.102368465665232,0.0808929893742571,0.0666823213485381,0.0554791533226397,0.0461525516352097,0.0392959795668123,0.0347114090831711,0.0312189607369832,0.0282567460880474,0.026256169043602,0.0250465895481816,0.0230241981235331,0.0187813998330479,0.0129094985394386,0.00740668187313414,0.00371756572277329,0.00188235784319207,0.00117624347854315,0.000958462406045584,0.000930232676525101,0.000967057259085269,0.000957256401649825,0.000819763604516118,0.000576238599447939,0.000324952726238024,0.000145689596720014,5.17544999860823e-05,1.45488179579214e-05,3.23491543794696e-06],[0.0072718572156794,0.00646789824123726,0.00455178805249803,0.00254805737473753,0.00120367857739765,0.000759812790437949,0.0013358869872948,0.00328574681118842,0.00701660253461508,0.0123439440806999,0.0180926788729606,0.0226851481592872,0.0254883413023711,0.0277049476056182,0.0318053848699519,0.0398202029120999,0.0520864164246337,0.067675628930798,0.0857929150203003,0.10657748238881,0.130732213334522,0.158404650918746,0.18860291355123,0.220292873674306,0.253707380945874,0.289491615814011,0.326789186889793,0.363399285881449,0.398498540265794,0.435009605621775,0.478285123162983,0.53194618017698,0.596061435161053,0.669349963825766,0.750284074450796,0.834212142041875,0.911337809970659,0.970588120700106,1.00751429677047,1.02936458620389,1.05139248937735,1.08540271438299,1.13008375788586,1.17287324838933,1.20129432098429,1.21088226596286,1.20269284292284,1.17795343277558,1.13765470966591,1.08384257473751,1.019330071741,0.948815609813345,0.880375790348782,0.822171561540431,0.7762195882288,0.736699564482101,0.695356427862379,0.649162706158352,0.603167667204197,0.565042605776581,0.53581327817754,0.507059150505633,0.468826001661193,0.419432693956861,0.366309868920196,0.318372267545254,0.278550623899815,0.242798303100579,0.205690182961393,0.166964622170817,0.13193898503424,0.10555862552326,0.0874655411335474,0.0733264651367837,0.0595861174840698,0.0459906190293166,0.0342887743991546,0.0257784374072974,0.0205081482664812,0.018083014171731,0.0180118106204728,0.0189585504083818,0.0187182051672458,0.0158833136698878,0.0112098504290965,0.00675890995788633,0.00394045620028361,0.00270049419547191,0.0021998694781278,0.00177305447549903,0.00126737666671162,0.000810372045432381,0.000497016723422473,0.000306047601224562,0.00018129008564264,9.49388232971948e-05,4.1339528169975e-05,1.45234702419682e-05,4.06584231562431e-06,9.02645078622669e-07],[0.00429337286309134,0.00382633920858183,0.00270219829232642,0.00152475514631483,0.000747232079315964,0.000558508525756321,0.00114538348468894,0.00292725431102791,0.00639367028951769,0.0115560959312141,0.0175458800114147,0.0229829002839101,0.0270476386343959,0.0304125023580564,0.035105168269868,0.0431047300713257,0.0547664965361266,0.0687014098780525,0.0834257221403345,0.0993942700461488,0.119368723184429,0.145977688557301,0.178562159086335,0.213310732042882,0.246650481719759,0.277456166466816,0.306153001274405,0.333462020922564,0.361150562827675,0.393139719003248,0.433634200697813,0.483206689727905,0.538524992768742,0.596988433266135,0.659363217838716,0.726113654976737,0.792717819007413,0.85064305675484,0.893648873034787,0.923633319784107,0.950149835109075,0.982584688255022,1.02148056227764,1.05772391555251,1.08027123636873,1.08387286659268,1.07018658195178,1.04438521945736,1.01119962623518,0.971355793917484,0.921236288452991,0.858395745363347,0.787469440778949,0.718699322952914,0.660526355003814,0.614359983532733,0.576007381273561,0.541294783612898,0.510057705906361,0.484448853322573,0.46339190050503,0.440154033865414,0.407161046157688,0.363042932979769,0.313915255997799,0.268094971816892,0.230030916071684,0.198515850299278,0.169964715803812,0.143087190465858,0.119819528886877,0.101951548165987,0.0882100345086657,0.0752554503030883,0.0608369915007247,0.0454716638270176,0.0314472300355572,0.0207763023178546,0.0141691047170702,0.0113319334049357,0.0113414335193433,0.0125335446819936,0.0128740287910387,0.0112607537700935,0.00837338172988156,0.00584910535187327,0.00467826745425778,0.00453097469632026,0.00441260127952517,0.00369633745043512,0.00251728584021988,0.00138140923577413,0.000620554148369681,0.000238501413734641,8.47482899117586e-05,2.99224274289681e-05,1.04136746347335e-05,3.30274986806499e-06,8.87095188608002e-07,1.93838415071201e-07],[0.00199641669837071,0.00181918224578792,0.00133196836219917,0.000799648625720073,0.000449471275109268,0.000445312268518883,0.00104703232023328,0.00275008011430482,0.00614983665392725,0.0114816386267004,0.0181951429257213,0.0250664821937934,0.0309591852484595,0.0358188222487764,0.0410736147165235,0.0486588163798628,0.0591947501245275,0.071294943821185,0.0832050053937317,0.0955543236592492,0.112277656852409,0.137642103383172,0.171650149545097,0.20912307222086,0.243670720287982,0.271849992560854,0.29393251536733,0.312750899943823,0.333095167146062,0.360939922659954,0.400151067304997,0.448286559649498,0.497559287608381,0.542134825199533,0.583492185766853,0.627239431076856,0.675876715102482,0.725951830915516,0.771434794808027,0.808877043305828,0.839678304301383,0.867797425404906,0.895079263328676,0.918727259872075,0.933269334435673,0.93479746015758,0.923826904454646,0.904864231159777,0.882360481851239,0.855489314389054,0.817711676944091,0.763575067374868,0.695939264023265,0.62557591411153,0.564014972621668,0.516930468164924,0.483081305079603,0.457971359752524,0.437894729483794,0.420783446379394,0.403969265621519,0.382479158593084,0.351119381727144,0.308869956890968,0.260687012143397,0.214546100675345,0.17657367164861,0.14832614844809,0.127749660682391,0.112092317113648,0.0996822905239713,0.0894546698435487,0.0798923776612858,0.0691792275052657,0.0564268184454258,0.0424846799063541,0.0293520934463386,0.0188258589030599,0.0117222611997845,0.00797894503736897,0.00688793622627332,0.00715419509329089,0.00731104471649508,0.00661531476579518,0.00553654012659334,0.00512926043748927,0.00584376236152708,0.0069781701988329,0.00730848729981883,0.00623405207738865,0.00423908981302838,0.00228667392705272,0.000979169045096203,0.00033459642024659,9.25647213711536e-05,2.14552154759455e-05,4.45462254587106e-06,9.00121312566948e-07,1.8189576814201e-07,3.45838410489191e-08],[0.000958441349923669,0.001028508132319,0.000930197794738929,0.000716532608250522,0.000504511672908255,0.000473299777175351,0.000918550568482933,0.00232632664316243,0.00531276330307873,0.0103149747708335,0.0171789494809991,0.0249892811360634,0.0324566150463832,0.0389105956248915,0.0451581020050933,0.0529028683680245,0.0628338029755149,0.0736333252120724,0.0835665624233175,0.0933814030249689,0.107338736151569,0.130338896082787,0.163240354867934,0.201257473578331,0.237077109306002,0.265240845679593,0.28449500226034,0.298133749137132,0.313127203288914,0.337375367811822,0.374631191176955,0.420236410823593,0.463376587950675,0.496014386876614,0.519743890221643,0.543247079201179,0.574026634255519,0.613163529249846,0.655996863600106,0.695648978495018,0.726698988853642,0.747768497744285,0.761396683823247,0.770975784702634,0.777596358442316,0.779920337264994,0.776777625960349,0.768956400070532,0.757389194984447,0.739654479210907,0.710070017532283,0.664843222717209,0.606977035435144,0.545653026589112,0.491043093627256,0.44926999720318,0.420709378946596,0.401572876209436,0.386753830580226,0.371897081745936,0.353762466501362,0.329489871751867,0.296704335441116,0.255439182111991,0.209745113440634,0.166363453198928,0.131291223734122,0.10716947201054,0.0928877799955782,0.0848959768082189,0.0792237559244758,0.0731472683162797,0.0656149192280384,0.0566016290151268,0.0465178090014725,0.0361222332298103,0.0263576362899675,0.0179770515090482,0.011446164850962,0.00704197657853241,0.00470301399152643,0.00382699955637925,0.00354163475251567,0.00335908938733905,0.00353045055095127,0.00463623238166776,0.00671060975577167,0.00877256255738947,0.00942812570961361,0.00809475266943174,0.00551019646983936,0.00296827501369488,0.00126499781818045,0.000426686888731197,0.000114075431492301,2.42688404750406e-05,4.150977362734e-06,5.85479109673981e-07,7.18877925969507e-08,8.34770562035567e-09],[0.00109400875279384,0.0015143975260812,0.00169800433752312,0.0015339798738374,0.00113357267487948,0.000783090007479231,0.000831252220194534,0.00168057544401699,0.00383367360718701,0.00779387001990991,0.0137448853131432,0.0211974851079582,0.029064417072423,0.0365265689343878,0.0440103219669063,0.0527603397165366,0.0630423005746087,0.0733397247936195,0.0820578290264415,0.0901129864230207,0.101537905921429,0.120984031849717,0.150041566111943,0.185630420448706,0.221500835067017,0.251242843496859,0.271428282985875,0.284117486509224,0.296821613350748,0.318237985711943,0.35160549558347,0.391154777974657,0.426029099971495,0.449148753450302,0.462722827752751,0.475462289494363,0.495335362619904,0.524807222421734,0.560555502453902,0.595409851056174,0.621544387356151,0.634831800615538,0.637509883486659,0.636078077114798,0.636248902634123,0.639834965625156,0.645232215972448,0.649029898781398,0.646779391674983,0.633829244175634,0.607437833137963,0.568881495598055,0.523264087851792,0.477117161412902,0.436006215420539,0.403304534821477,0.379563651998835,0.362274765263951,0.346798146172368,0.328585911552373,0.305124955651896,0.275946570899152,0.241525058363856,0.203232179711906,0.164119777396985,0.128515647874719,0.100390444676227,0.0819250638463349,0.0725867474848462,0.0688920147495737,0.0659425555047993,0.0603764051335678,0.0520508758785723,0.0429016047868094,0.0347119589883043,0.0280298559422965,0.0223947731034113,0.0170969479080652,0.0119437619133789,0.00745226751343854,0.00426175107644304,0.00248513747496406,0.00173400455364858,0.00165429864497702,0.00230035216642802,0.00393028892151934,0.00636911844597308,0.00861178361917017,0.00933810505698624,0.00803554202199468,0.00547269521256933,0.00294799423430788,0.00125581520562873,0.000423060765791204,0.000112723525470359,2.37643600526099e-05,3.96811557343832e-06,5.26242445654738e-07,5.5832306387644e-08,4.82693841396055e-09],[0.0021973932757295,0.00322467564418634,0.00375156166165595,0.0034588869874848,0.00253771198558285,0.00153426624102001,0.000957191337552727,0.00112785275234976,0.00233503755347768,0.00495952967518127,0.00930346098581369,0.0152169679056406,0.0220257755932058,0.0291932806575821,0.0370797164046574,0.0464426331532077,0.0569302466135227,0.0668027426770817,0.0747902315775634,0.0820293148727362,0.0918772339302361,0.107864317682873,0.131669905368562,0.16224821310062,0.195736551911005,0.226205706935749,0.248576354868389,0.263023164605191,0.276270853162521,0.296492290560087,0.325764341529418,0.357978608559154,0.384582995612605,0.401980751067213,0.413461550030466,0.425300608172461,0.441947665693037,0.464139782490072,0.489549651329819,0.513696060137736,0.530997004370979,0.537470175514287,0.533924521540386,0.526163397979353,0.521630493921505,0.525403756352321,0.537396412184827,0.551250302222869,0.556706116475719,0.545932605898507,0.519140334978333,0.483795278799029,0.448281392560408,0.416687198056617,0.389051919806641,0.364647569822575,0.343384552045048,0.324335021350277,0.304613867971162,0.280971932409175,0.252315827515716,0.220105509724878,0.186769856416633,0.154518240959644,0.125189628910618,0.100263386791985,0.0810243297524816,0.0687047037557253,0.0633816688347056,0.0622447182391196,0.0602427879042188,0.0537607567106352,0.0434571457096247,0.0329944718520921,0.0254770004862407,0.0213986246869993,0.0191413208989358,0.0166776267194886,0.0130598181995965,0.00879623048402426,0.00503470956743442,0.00251272631128536,0.00124764988060399,0.000946741166909144,0.00146409538628851,0.00281086128699533,0.00475199756017104,0.00650153864976997,0.00707151140780999,0.00608984491536964,0.00414834899404019,0.00223467889958638,0.000951919909919127,0.000320646668615753,8.54079508738848e-05,1.79899740101598e-05,2.99685735450236e-06,3.94930094515837e-07,4.12006286997947e-08,3.40919215277599e-09],[0.00387829663511781,0.00572389567611933,0.0066815887879604,0.0061692070240791,0.00451021268843582,0.00263425865667558,0.00132162514936193,0.000868403148686129,0.00133996119233536,0.00289546254823683,0.00575791149657816,0.00989744102040205,0.0149340958877604,0.0206360052950446,0.0274104360767142,0.0357278404744821,0.0449606119227753,0.0535579094199715,0.0608198451941469,0.0680174656590288,0.0774487467070722,0.0909118710873241,0.109436612810723,0.133507575047433,0.161931253775267,0.190499910576134,0.214023302819823,0.231481930125882,0.248091886943278,0.270088703570404,0.297598310125756,0.324537149967335,0.345569363407437,0.361136415903968,0.37531664881999,0.390854386457427,0.407307662619897,0.42281256720316,0.436277800598956,0.447391054854872,0.454929436665762,0.456500244027821,0.451102361954888,0.441785220089214,0.43543010119476,0.439322310005311,0.455510693636216,0.476324842047207,0.487127871632057,0.477148924435932,0.448584100787595,0.413891973800244,0.3843591822173,0.362273714063556,0.343140802505716,0.322774767948932,0.300763065937384,0.278201731828375,0.2545440714184,0.228007482261292,0.198210460445991,0.167157103829955,0.137934895099128,0.113070497110985,0.0934941698372749,0.0784841711452742,0.0671205313371642,0.0598256029831765,0.0573325771757595,0.0578191036623491,0.0565893426962572,0.0499460764081966,0.0388636946570195,0.0279112787880518,0.0209815072530043,0.0186052038427568,0.0185467853872984,0.017981347967944,0.0153744658720532,0.0111004378010637,0.00665067025300227,0.00329905239725073,0.00141449713615734,0.000718651894290387,0.00085190566031997,0.00160478474702395,0.00273546804179931,0.00375556780067078,0.00408891477974728,0.00352222732589237,0.00239947260565592,0.00129259500424701,0.000550614722987121,0.000185468290068954,4.94001180402068e-05,1.04045705500229e-05,1.73285562063188e-06,2.28220495612898e-07,2.37704289874632e-08,1.95852763275784e-09],[0.00529227880933611,0.00781457983644472,0.00912460580399053,0.00842522487534138,0.00615388888635336,0.00356652898520069,0.00168902826351701,0.000835741777742187,0.000937069111201284,0.00199571976243785,0.00412070421715363,0.00721837941538168,0.0108949954759185,0.0149298253862767,0.0197092624062641,0.0256913389021871,0.0324557810230188,0.0389938672283029,0.0451531097181737,0.0520994281829386,0.0610268163219266,0.0721808887895439,0.0857945915709765,0.103103787576212,0.124905440821764,0.14926662431854,0.172619503689949,0.194044054850791,0.216749717292969,0.243485714346183,0.271626955986907,0.295402061094291,0.312849083535384,0.327874659217293,0.344762819889976,0.362850471064496,0.377623125076778,0.385718114734707,0.387990420063891,0.388073435113555,0.388378499878145,0.3879302362683,0.38442945047713,0.378193551842857,0.374070494818242,0.379226872405597,0.396722186556961,0.41915416428699,0.430777196129734,0.419888008224589,0.389636635359242,0.354730392244023,0.327658350913349,0.309522516034808,0.293277869549809,0.273034582434495,0.248898696525057,0.224162192549995,0.200319549693453,0.176121611951385,0.150400314046354,0.124217806371407,0.100427832291399,0.0818282216265287,0.0692359503734239,0.0609944055054437,0.0549619665175606,0.0509227916496823,0.0499265019018971,0.0510698301224277,0.0504920220015116,0.044846422427095,0.0350928542797066,0.0256897211425758,0.0203903859634409,0.0195376750563734,0.0207049873511878,0.0208917902938524,0.01841274892309,0.0136479895780225,0.00835597019633088,0.00418767703147066,0.00173126424054275,0.000672341287924354,0.000463302825985782,0.000723188999236945,0.00120831046594883,0.00165716966563251,0.00180450538994177,0.00155452996188114,0.00105902710466581,0.000570500807372204,0.0002430200519753,8.18584876686224e-05,2.18032478932017e-05,4.59215316277264e-06,7.64822240234854e-07,1.00744879491766e-07,1.05059258161996e-08,8.72699553646678e-10],[0.00551669829158837,0.00814629414610069,0.00951213328344177,0.00878295764117442,0.00641409467187689,0.00371281416476639,0.00174446282243346,0.000832354123069971,0.000904370521244924,0.00196492791308026,0.00409621886219036,0.00708221405794878,0.010301443183423,0.0133099808146039,0.0164294462274829,0.0202935048944725,0.0248703758176886,0.0295806941447652,0.0344253419788189,0.0402104719531218,0.0473886510955866,0.0555059157896428,0.064464294362005,0.0756663252928398,0.0908469491381377,0.110123909022929,0.132461016066824,0.157867891442755,0.187234667029251,0.218990034687342,0.247630916063084,0.268106427156186,0.281653186963244,0.294854894258826,0.311925932797888,0.329614932590553,0.340772327145914,0.3417963307666,0.335770270831925,0.329154204374966,0.326304570229088,0.327037814309649,0.328596733664792,0.32928137784608,0.330771246530951,0.337540275168627,0.352207752332379,0.369412603284873,0.376225802154643,0.362519236011198,0.33131323089358,0.296482876868954,0.269888006301942,0.252233030144086,0.236098012896665,0.215528148367316,0.191395443436214,0.168416586677779,0.149049517593422,0.13155535221282,0.113141476098061,0.0934161764699198,0.0748075939510467,0.0604664689069744,0.0516704282752343,0.046952439549752,0.0439737065143226,0.0420245486715622,0.0418380275550679,0.0429201221567384,0.0424612912444927,0.0380281256300523,0.0306558105926536,0.0240701361886263,0.0210924470120304,0.0215311471626767,0.0230056261557118,0.0229041369744873,0.0199192632798234,0.0146420855627971,0.00892392863474966,0.00445502151870857,0.00181413823795334,0.00062719736112979,0.000260260854582597,0.000264966528129135,0.000410321375602335,0.000558479336915749,0.000607734115058489,0.00052352353808413,0.000356652079135514,0.000192129781204115,8.18429708998284e-05,2.75681186529136e-05,7.34328427129669e-06,1.54720238407308e-06,2.58287839931413e-07,3.4519302767575e-08,3.92400877495059e-09,4.93090541353782e-10],[0.00438835110054179,0.00648013034905974,0.00756662906440032,0.00698661173069183,0.00510247779412894,0.00295566289611579,0.00140147469932968,0.000725224465472547,0.000939079344274803,0.00215485018507223,0.00450439046513846,0.00770196597716251,0.010941128189387,0.0136024143810806,0.01600559878314,0.0189870591931548,0.0227616134490967,0.0268006990585829,0.0308279618653477,0.035174089641324,0.0399516567689194,0.0446822856074298,0.0493344949673606,0.055252289399751,0.0644702319331024,0.0785810810264692,0.098770952654505,0.125875761530117,0.158690984527074,0.192122700775437,0.218850216445239,0.234919750050931,0.24399571416589,0.254284251431953,0.269872641522571,0.286014388208505,0.294139089387792,0.290760823199212,0.280475937101246,0.271216604418837,0.26815801039351,0.271830301008323,0.27985933713068,0.289080912107527,0.297236429529325,0.304501809287809,0.312438604241789,0.319346837642107,0.31789197064803,0.300872096092126,0.269925229715363,0.235833492381888,0.208948873893916,0.190671660162983,0.174913287391176,0.156398322215416,0.136075591198848,0.118632226009137,0.10631492313853,0.0965890953742009,0.0854630648910758,0.0716828541868714,0.0574645484676357,0.0460929722419185,0.0392102865518532,0.0360357369373031,0.0347917415013398,0.0345438380002728,0.0352661989559793,0.0362369612097737,0.0354566745196909,0.0316059353397596,0.0260338995201515,0.0217179619497486,0.0203821172269535,0.0212486788899628,0.0221664213207699,0.0212561399473951,0.0178719703340415,0.0128013983713975,0.00765566559191145,0.00376790983951064,0.00151259578314853,0.000498916956568903,0.000154551685717121,8.62987634540599e-05,0.000108450555895477,0.00014390522155939,0.000156209195891745,0.000134532880914278,9.16493009231683e-05,4.9372535854477e-05,2.10337179313193e-05,7.08952301301867e-06,1.89592506680704e-06,4.09361803569825e-07,7.86660933454866e-08,1.90181652461165e-08,7.63181779422863e-09,3.54521644053058e-09],[0.00266361148084255,0.00393326690394972,0.00459274820071655,0.00424074606085633,0.00309757908118787,0.00179752692998132,0.00086967822512554,0.000521107725717248,0.00084161136771837,0.00202964278302723,0.00426049842735968,0.00727720099691938,0.0103224472848647,0.0128493481654921,0.0152645264911315,0.0184926286170745,0.0227629972175985,0.0273601501315301,0.0316161338024462,0.0354638668698406,0.0387908738929808,0.0410286654176863,0.0420608526475612,0.0432110478701361,0.0469119164279586,0.0558338841906759,0.0723822204670074,0.0975402035182409,0.128758250039636,0.159403500749595,0.182022184400147,0.193838998726627,0.199596901883425,0.207710894483717,0.221953223558216,0.237177238608707,0.244542936413147,0.240632260083543,0.230256734773168,0.221272744693246,0.218862895431939,0.224474389576873,0.236942483860657,0.25248046397505,0.265386300358047,0.271728341113939,0.272189140929898,0.269068437383897,0.260828190243341,0.242729813773693,0.213948986276921,0.181351230419069,0.154003200765092,0.135047263750418,0.120616967545355,0.10608595784764,0.091541185232515,0.0804734006899615,0.0743682509052301,0.0703503310077879,0.0643009791213104,0.054966924185876,0.0444611320874123,0.035706156256147,0.030195017448367,0.0277452051095898,0.0274594128598391,0.0285573445120509,0.0303428981119589,0.0315654360355048,0.0305467891414311,0.0267316801314795,0.0217743326200045,0.0182062115408442,0.0170830897944622,0.0173937580101449,0.0173818878656065,0.0158907952004557,0.0127999400096214,0.00885659449010804,0.00515743115632875,0.00248728818144224,0.000982071671582379,0.000316165659065916,8.64332457481886e-05,2.85088120501028e-05,2.31780844986328e-05,2.84683385556012e-05,3.06554765947957e-05,2.63818092598295e-05,1.79741183984364e-05,9.69322959054246e-06,4.15736803946915e-06,1.46006515869918e-06,4.88565419040614e-07,2.34479418161703e-07,1.76402455313675e-07,1.36605011214768e-07,8.8225007659066e-08,4.54575375441412e-08],[0.00123362883616278,0.00182165920787918,0.00212709646530397,0.00196411343167763,0.00143503014300342,0.000835304132174496,0.00041773732138484,0.000304644190917357,0.000602139272438076,0.00150663507924162,0.0031855290367342,0.00549009891328195,0.00793952527845988,0.010280869720166,0.0130260303153706,0.0170066357921889,0.0222892513740434,0.0279723721099998,0.0331840832744439,0.0376622307995064,0.0409990831506992,0.0421089452660531,0.0404101847911006,0.0373398041515796,0.0361270852314058,0.0403598260005925,0.0527587684675624,0.0738599601532869,0.100558976207179,0.126432783449195,0.145077291663903,0.15461548228908,0.159546557293034,0.16719151006204,0.180656573341805,0.195239235617654,0.20307346516047,0.201189167527747,0.193652245721663,0.186655648529083,0.184207195981326,0.188377147724535,0.199810671983475,0.215575515375126,0.228701745940042,0.233142814895959,0.229194757616396,0.221685207363827,0.212502675663888,0.197680537740925,0.173568770652247,0.143619425581145,0.116245435265582,0.0967058087091518,0.0834419023323494,0.072328915747145,0.0622671825311329,0.0552757981471606,0.0522472567921146,0.0507131551700243,0.04731246426207,0.0411689238185401,0.0340150793925254,0.0278782136474567,0.0236592168119878,0.0214953912567166,0.021350078103735,0.0229338832616562,0.0253517199400399,0.0269852173137367,0.0261415656572084,0.0224749736410194,0.0176392137281191,0.0139017477921734,0.0121523504883305,0.0115775130834694,0.010896267447738,0.00942572626488182,0.00722951362565186,0.00480333619657542,0.00270891622561684,0.00127442978492637,0.000493491848143073,0.000155942503660361,4.05172908270818e-05,9.90691286357389e-06,4.39302300800203e-06,4.38074629240721e-06,4.60072625190179e-06,3.9567224035779e-06,2.72596773084103e-06,1.57426600586033e-06,9.53143221647268e-07,9.17575220506346e-07,1.2402608148985e-06,1.57586552357233e-06,1.63476534775184e-06,1.34803777219101e-06,8.79728314345353e-07,4.54034288270212e-07],[0.000435955332579479,0.000643761103572831,0.000751702773446496,0.000694131147529493,0.000507368164273295,0.000296808817915985,0.000156307147849341,0.000144640584718526,0.00033838895683898,0.000875308897933086,0.00189079659795455,0.00338198411062429,0.00523345720221901,0.00754386749811321,0.0108574418261911,0.0157243195054187,0.021906626454381,0.028375509866528,0.0342798663020722,0.0393594430809629,0.0429488767915628,0.0433984603270715,0.0396930710553532,0.0335120437933857,0.0289060701076165,0.0300918081822724,0.0396512238384914,0.0575662320838157,0.080676766660524,0.103414113540703,0.120543415389967,0.130574715232968,0.13700599880951,0.14542773224737,0.158054106598287,0.17104600540216,0.178387716506681,0.178193958868118,0.173626943918591,0.168385677332865,0.164311779748928,0.16337335951291,0.168000965498446,0.177366077792118,0.185799694744622,0.187697443737834,0.183436431491913,0.178093381056556,0.173824980336529,0.165935947366917,0.14862242863378,0.123132460084773,0.0974207742161474,0.0781141705299669,0.065333010649437,0.0555499716890902,0.0470069022593198,0.0407706741358923,0.0376458674302743,0.0361485270069922,0.0340431193018362,0.0306513584227446,0.0267829251087796,0.0231607929076403,0.0199464880505368,0.0174887172328683,0.0165319904577448,0.0174485903578996,0.0195554379598479,0.0212071612471246,0.020711775072807,0.0176531034003419,0.0133630080649691,0.00973108186311982,0.00759929176301896,0.0065022394285086,0.00561200904313613,0.00451467740793856,0.00325337531400851,0.00205317767785163,0.00111213604912923,0.000507341455332464,0.000191885684566612,5.94865892376811e-05,1.50540705433744e-05,3.23944722468781e-06,8.44476730731318e-07,5.46513601506967e-07,5.42003290573806e-07,5.17664790588703e-07,5.91256589766428e-07,1.12526016091985e-06,2.63335910364006e-06,5.43469276573439e-06,9.03967700321501e-06,1.19263428750757e-05,1.24483428880965e-05,1.02750846837838e-05,6.70656473485249e-06,3.4613943849408e-06],[0.000117555594578622,0.000173590610628456,0.000202698192658341,0.000187185155637544,0.000136918143358683,8.07611480984499e-05,4.61276691426009e-05,5.65695560294709e-05,0.000154576823099771,0.000426334151971567,0.00100042287863514,0.00203324993726202,0.00374636088075558,0.00651060916478938,0.01076776559969,0.0166091410602309,0.0233617339878832,0.0298941224968905,0.0355128702037799,0.0400796834765938,0.0428544727925256,0.0420582139937346,0.0367461440136749,0.0289172944409794,0.0229704615851474,0.0232117345817392,0.0319980806938016,0.0490978842754532,0.071550375122911,0.0943792549653857,0.11285652018069,0.125330339666251,0.134193236266446,0.143506645573485,0.154783997387449,0.165094758050758,0.17022438243365,0.169387155159513,0.165140518286969,0.159263822975791,0.151793052843468,0.144249808253527,0.14012180173601,0.140598817067283,0.142415385456106,0.141853542441771,0.13955448414554,0.139248959513947,0.141505110745826,0.140746736609544,0.13055542755704,0.111238557029149,0.0898184670077793,0.0726859694315639,0.0605381884307867,0.0506150754235033,0.0414029392155226,0.0338168019677083,0.0290017173453663,0.02663854966674,0.0255605383340663,0.0249399503878132,0.0242384911219787,0.022708385284198,0.0198901767099406,0.0164837039845746,0.014019420481885,0.0134855445524686,0.0144529479525047,0.0154248135808764,0.0149446968399651,0.0126616672235514,0.00951276756202775,0.00677491416707398,0.00498618306326604,0.00385678545775436,0.00293723789046913,0.00206894217203964,0.0013137802635535,0.000744984541621252,0.000372150936828073,0.000160401685618941,5.83630923937195e-05,1.76110781901534e-05,4.35644096696194e-06,8.88697908842605e-07,1.72240623470207e-07,7.05371072084035e-08,1.191596148308e-07,4.26693934166697e-07,1.68050779650418e-06,5.59834671115971e-06,1.4914996465328e-05,3.14783403101431e-05,5.25487131783663e-05,6.93693884970496e-05,7.24122832487631e-05,5.97712737500447e-05,3.90129007978561e-05,2.013535867784e-05],[2.41873583655685e-05,3.57167291356002e-05,4.17060482175129e-05,3.85181343748026e-05,2.82098739396575e-05,1.6897970894866e-05,1.11832060330786e-05,2.0211980283166e-05,6.89505226836272e-05,0.000226725309495492,0.000655370509882736,0.00166820358958401,0.0037437287938784,0.0073860450018228,0.0127836618298206,0.0194517069471064,0.0262664201790396,0.0321219064590791,0.0366471940853352,0.0398895752524136,0.0411128432696229,0.0387191239471058,0.0322050232281582,0.0238584750527299,0.0179336326758789,0.0184032159242825,0.027508951355001,0.0452413787700153,0.06895903386083,0.0937620264266327,0.11465005350013,0.129440303053222,0.139776278996054,0.148970194852654,0.158405922399053,0.165932985959563,0.168305341373929,0.164983219392571,0.158081591957572,0.148905261092921,0.137282210385586,0.124650874539951,0.114596598670778,0.109094904224444,0.10659455675285,0.105045087390453,0.105098662807097,0.108702957116298,0.114801347628742,0.11797102690567,0.112870142700465,0.099813653056224,0.0843045394762088,0.0710954446225447,0.0605164520025379,0.0505941563359282,0.0406174055790072,0.0317896067116912,0.02562271560282,0.0227077263533056,0.0226752751669238,0.024418911033861,0.0261168972724237,0.0257927406355683,0.0226766498643586,0.0180179375750705,0.0140812126804195,0.0121979013433644,0.0119043390168373,0.0117804309690449,0.0108147965228385,0.00904856549284888,0.00720731886447972,0.00584474428597672,0.00487121544869326,0.00388080354185319,0.00272823144763647,0.00162644285385758,0.000820100308590134,0.000357209161610068,0.000138458089728556,4.86448391556312e-05,1.53770108507214e-05,4.25448690231401e-06,9.99229954670386e-07,1.95835547715287e-07,3.82021174364412e-08,5.3336235610299e-08,3.21775409983542e-07,1.72170697093228e-06,7.34226946453238e-06,2.4786198366373e-05,6.61758124369738e-05,0.000139712696275407,0.000233243601118584,0.000307906803277945,0.000321413608860121,0.000265304506099557,0.000173165102445105,8.9374063361114e-05],[3.79732190134851e-06,5.60739584748505e-06,6.54780453888151e-06,6.04862850271709e-06,4.44358665347532e-06,2.7821787014034e-06,2.72266771348401e-06,9.3071695839275e-06,4.34319471722934e-05,0.000179110016542217,0.000621647612009167,0.00179770923023676,0.00432274566217116,0.00868324730171983,0.0147305037511226,0.0214662976383086,0.0275372311785666,0.0321610760544004,0.0355065159086708,0.0378275689467653,0.0382539791707775,0.0351792836149601,0.0283415096010122,0.0201097011972561,0.0144314279980535,0.0149246314591892,0.0238684798174419,0.0416811519609627,0.0660810548799522,0.0920264847280191,0.113949741924354,0.129120990460074,0.138911347902557,0.146640135509334,0.154059579718742,0.159619554035591,0.160217855745068,0.15466589076047,0.144541654228963,0.131702893324898,0.117093616807602,0.102544746060785,0.0911462018109479,0.084554558867678,0.0817488596070374,0.0813188494745235,0.0834211963194728,0.0884782135532956,0.0946704086826885,0.0978363439449157,0.0946805511014211,0.0859896778995806,0.0756444190143487,0.066441509907894,0.0581384846130217,0.049464159506668,0.040419483601302,0.0322693790652758,0.0264299041641235,0.0238173125739767,0.0245121280456064,0.0273085051182293,0.0297353098967857,0.0293064394433526,0.0253797682386016,0.0197661295565775,0.0151416897644746,0.0127504919259603,0.0117705328232381,0.0107329408509546,0.00913307072444393,0.00760436505244923,0.00688736201651339,0.00689187511783552,0.00676681261593208,0.00579602358792948,0.00408332801430739,0.00231552822806952,0.00105180300510867,0.000384369904699848,0.000114520999076207,2.85440502793953e-05,6.19415621549702e-06,1.22257399233644e-06,2.24228169477436e-07,3.9153255630227e-08,2.38426207973669e-08,1.58690950199588e-07,1.07840010782764e-06,5.82235382776856e-06,2.48612292332348e-05,8.39439396493342e-05,0.000224126183885133,0.000473185474418651,0.000789960947164031,0.00104283410294957,0.00108857964763161,0.000898546541771506,0.000586484211396037,0.000302696538354945],[4.54894058060694e-07,6.71731157652761e-07,7.84426114394071e-07,7.2523606910881e-07,5.40681474339264e-07,4.22762789075709e-07,1.11015289340605e-06,6.6850879586769e-06,3.70777320550607e-05,0.00016791682815546,0.000614873231332351,0.00182136177822548,0.00438554835529829,0.00866235109188592,0.0142381585014339,0.0199009409598224,0.0244428041396097,0.0276427476213512,0.0302518654671327,0.0326801757666428,0.0337981254355766,0.0316611982912474,0.0257460246624863,0.018147285251863,0.0125069726159144,0.0122534691098836,0.0197423175361631,0.0357368897478441,0.0583595178896286,0.0827356947695727,0.103160769709678,0.116705771617029,0.124707897256357,0.130631647046627,0.136534424988605,0.14122054864859,0.141519043506181,0.135506398547645,0.124178139319228,0.109917962343231,0.0947866046869345,0.0809818733099747,0.0710274870916886,0.066066229908401,0.0650827271552642,0.0665707598966011,0.0698891004759151,0.07445565638147,0.0785215559544883,0.0795763321474719,0.076262844336122,0.0697567193260766,0.0626265294534865,0.0562930378483096,0.0503581224496352,0.0442066328200711,0.0381417039112466,0.0329515441771155,0.0293410103584896,0.0279022848166709,0.0287875176758632,0.0309466592596933,0.032117567264655,0.0302497150244705,0.0252702506289113,0.0193213336505018,0.0149372856430669,0.0128842242331859,0.0119127715021926,0.0105328066773891,0.00865612669028414,0.00739148253811652,0.00754812509532403,0.00859687326025223,0.00909085690279444,0.00802853289343783,0.00570326201907843,0.00322192690127976,0.0014429300007589,0.000512122359958311,0.000144234777765243,3.23466226880019e-05,5.82007588282404e-06,8.53520088992107e-07,1.05454576001588e-07,1.57427959056945e-08,4.83970605831866e-08,4.08122913751533e-07,2.78633403091452e-06,1.50462494124925e-05,6.42481770353299e-05,0.000216934621481313,0.000579205030862141,0.00122284430806322,0.00204148122000607,0.00269497656629235,0.00281319591824088,0.00232209693547532,0.00151564012178288,0.000782252973467214],[4.1580264812894e-08,6.14015944844893e-08,7.17248968893827e-08,6.67049739685644e-08,5.53434327640253e-08,1.06563444741541e-07,7.23102071365735e-07,5.14092541321126e-06,2.9655980727413e-05,0.000136636905759456,0.000503108368537112,0.00148528155675038,0.00353565970196013,0.00684771239496428,0.0109451563773418,0.0147840059249917,0.0175777833299471,0.0196070788663614,0.0219460204836269,0.025045255179544,0.0276098006234399,0.02735889595493,0.0232449136264011,0.016794469362662,0.0112628468968619,0.0098986117958263,0.0149869063306692,0.0273989346436201,0.0457218213845658,0.0658548841719237,0.0828244210094687,0.0940472804683885,0.100753401964181,0.106020670510214,0.111577665282605,0.116274545553655,0.11719273761192,0.112316974166399,0.102229876023633,0.0892303255605991,0.0756688722248657,0.0637286276854251,0.0555039692830476,0.0518986519604124,0.0519727100463084,0.0540658462314573,0.0569835427673822,0.059810149402159,0.0613653747807386,0.0604989874013596,0.0569889472557972,0.0519383723138423,0.046889858204287,0.0425561804219955,0.0388265913135888,0.0357120638698904,0.0335274017524616,0.0323145360664515,0.0318235801612297,0.0319901230361782,0.0327418782174351,0.0332501903500176,0.0319916336987079,0.027995117307521,0.0220037219822132,0.016191534137337,0.012487200669522,0.0110379799316515,0.0103890218986759,0.00919801374427692,0.00759573024084114,0.00678830011712079,0.00752003267108203,0.00908748708220357,0.00986875380161108,0.00880277462998193,0.0062737340600293,0.00354582897513605,0.00158609315603367,0.000561239680701909,0.000157100170356431,3.47970170376608e-05,6.10329005013088e-06,8.49145282941832e-07,9.4669163122151e-08,1.68935997183638e-08,9.37673849014035e-08,8.04586459699852e-07,5.49432739389926e-06,2.96695990571198e-05,0.000126690593788611,0.000427772094554138,0.00114213097621418,0.00241131946462061,0.00402558475424659,0.00531420836612052,0.00554732440768076,0.00457892922552916,0.00298868180005433,0.00154252001595851],[2.90008468050288e-09,4.28311674381091e-09,5.0162266637565e-09,4.90511452266019e-09,7.56516363684993e-09,5.0528298434802e-08,4.47860278904453e-07,3.26463037562494e-06,1.89283165173426e-05,8.72334260028276e-05,0.000320150749365886,0.000938639754623915,0.00220942480559373,0.00420895989265683,0.00657940298059997,0.00866420929541026,0.0101269385606087,0.0114834384872913,0.0137801421167682,0.017397423409975,0.0210707245318269,0.02245756902835,0.0201228284677405,0.0150087760992729,0.00989166537931148,0.0076936411150635,0.0104057603436194,0.0187653762113304,0.0317846840226466,0.046513547879189,0.0593823728541537,0.0686384265171172,0.0752907853949192,0.0813837886593743,0.0876010738683545,0.0925804269062755,0.0940817845742941,0.0907205754120616,0.0829271339143959,0.0724638023893201,0.0613591363513078,0.0515314207349467,0.044640605447654,0.0413062545298265,0.0406709828450908,0.0412613750728851,0.042035408408048,0.0424514799553477,0.0420754247088559,0.0405687365864395,0.0380093367289103,0.0349677519388011,0.0320717137458332,0.0296428958197424,0.0279602534483129,0.0274999868319546,0.0284488223780919,0.0302423986713038,0.0320276329004653,0.0333441579836693,0.0338993581267853,0.0329467990396533,0.0295921579044858,0.0238847726341246,0.017279247930245,0.0118081547711793,0.00870080800462945,0.00763114568766676,0.00723705817987598,0.00646338369708081,0.00545153335206364,0.00513445906800757,0.00603949524179182,0.00753737969056228,0.00828165862874923,0.00741527818106654,0.00529127254092665,0.00299155348959176,0.00133812571144837,0.000473368116662763,0.000132423964181594,2.92955803350213e-05,5.12545926592841e-06,7.09343026719303e-07,7.85941915272397e-08,1.95681330909204e-08,1.40632646295783e-07,1.21056728914791e-06,8.26688353562368e-06,4.46415306396244e-05,0.000190621452365124,0.000643635297336704,0.00171847537488055,0.00362812427584017,0.00605698331791636,0.00799587473287761,0.00834662625372995,0.0068895575738921,0.00449683633822453,0.00232090952609101],[1.54348274153405e-10,2.28225185063257e-10,2.73610296968468e-10,3.84779593307694e-10,2.22440521802017e-09,2.39225856223847e-08,2.19780438038439e-07,1.60598585654065e-06,9.3052402117057e-06,4.27894320798907e-05,0.000156424049605625,0.000455804273817374,0.00106317319607697,0.00199974975555567,0.00307767895552128,0.0040059179338387,0.00475568029706622,0.0058564288414688,0.00814564431245884,0.0118844377105148,0.015934441418926,0.0181138817960536,0.0168932641355026,0.0128563458420053,0.00834588289397545,0.00586875982580964,0.00700673273353594,0.0122245274670356,0.0207599499755572,0.0306487697475306,0.0397577873972709,0.0473596377695314,0.0543419189386049,0.0615631004823007,0.0684104564777742,0.0732235825943847,0.0746251596578535,0.0721797534154954,0.0663567519421785,0.0583568047903013,0.049834395389767,0.04244571172988,0.0372372737243877,0.0341145432842443,0.0320477383834297,0.0300674896359447,0.0279682951819347,0.0260539501176391,0.0245619669836083,0.0234954713279976,0.0227701299804758,0.0222661290109376,0.0218065468447191,0.0214091235561748,0.0215813507769744,0.0229282562894806,0.0253213878863128,0.0278582450591161,0.029776667610547,0.0309467509553455,0.0312026054062695,0.0297114184680087,0.0256588920655045,0.0194837357380102,0.0129560681455587,0.00794357656159898,0.00521405280919555,0.00424819224359794,0.00394240801320578,0.00353422088094068,0.0030600153148717,0.00304400338857577,0.00376602620663608,0.00480774795172135,0.00532014310262506,0.0047732237307876,0.00340796141010046,0.00192709185612972,0.0008620219731314,0.000304939599358933,8.53015989850477e-05,1.88686790979291e-05,3.30040974586576e-06,4.56561017300882e-07,5.0998286181024e-08,1.90535955368779e-08,1.61220881698038e-07,1.38981196140176e-06,9.49102269411072e-06,5.12519385700316e-05,0.000218848207751458,0.000738943227648102,0.00197294297780845,0.00416536798680319,0.00695388649640685,0.00917988417888631,0.00958257412145799,0.0079097462985563,0.00516271679276949,0.00266458409504394],[6.27130169605588e-12,9.37415322573704e-12,1.36163110360908e-11,6.22781173255572e-11,7.7754773289646e-10,8.98119885903207e-09,8.28096075065406e-08,6.04811145125669e-07,3.49971517887513e-06,1.60584788931376e-05,5.85114929427028e-05,0.000169672494955749,0.000393099477771927,0.000733438079497606,0.00112395256559701,0.00149332024700549,0.00195544711887039,0.0029658491694499,0.00515133533948879,0.0086649461745051,0.0125018041605647,0.014738179446191,0.0139790495376942,0.0106790426271933,0.00684373536881034,0.00457759176190738,0.00509217856193727,0.00858587079273385,0.0143043253523041,0.0207857067294748,0.0268408793278508,0.0325974603611206,0.0390551043294581,0.0463403452145563,0.0529479473348943,0.0570350146341766,0.0578824976923026,0.0557653091593094,0.0512143295651421,0.0451047132277721,0.038936844807247,0.0341851530185747,0.031188642201134,0.0289128054430426,0.0259936402468296,0.0220280364730512,0.0178003663368163,0.0144368773733906,0.0126034687482542,0.0123861799382642,0.0134727579152744,0.0152258125548701,0.0169247448680592,0.0183812188530306,0.0201341074854705,0.0225505408531534,0.0249510257963175,0.0262500462825943,0.0263216024037693,0.0260120540389636,0.0256834494027995,0.0243847646463963,0.020927806121625,0.0154985263787773,0.00974115429212498,0.00535522274873364,0.00293220712073641,0.00198791206555988,0.00169081558145557,0.00149324454854126,0.00132636251788799,0.00139430562673379,0.00180470714927938,0.0023464376165433,0.00261037853914021,0.00234532964463918,0.00167512386282208,0.00094732085303065,0.000423763997354782,0.000149906855137862,4.19336980026153e-05,9.27561399062908e-06,1.62240499761611e-06,2.24447487026679e-07,2.54760535199272e-08,1.50301100547805e-08,1.41119312116606e-07,1.21749975641312e-06,8.31434488641504e-06,4.48978282545588e-05,0.000191715855469626,0.000647330560701402,0.00172834155084088,0.00364895420045603,0.00609175790013032,0.00804178095197662,0.00839454622075568,0.00692911216298314,0.00452265374546156,0.00233423441983598],[1.95346731754541e-13,3.21127152998561e-13,1.14392529154149e-12,1.53742122931753e-11,2.22114659629615e-10,2.58564496964447e-09,2.38394085636582e-08,1.73986686058001e-07,1.00559134396568e-06,4.60609798855106e-06,1.67404609797761e-05,4.83776030194023e-05,0.000111673452695087,0.000208489615800618,0.000327310129938314,0.0004835696341518,0.000819470220721488,0.00169211741690926,0.00355747498070558,0.00649610114175704,0.0096747479753571,0.0115307056373325,0.0109478449382984,0.00832597858620434,0.00530856997411819,0.0035801510856127,0.00405880249590227,0.00678126187314332,0.0109536960876332,0.0152852730918155,0.0190004483810128,0.0226785542342991,0.0275150913145574,0.0335383965415517,0.0391148651071698,0.0424730300295886,0.0430976187598693,0.0413538149776282,0.0376712961607429,0.0328351116316191,0.0283777388292841,0.0256557874758196,0.024499545594593,0.0232765795445505,0.0204684962659687,0.0160522801675957,0.0113486085414586,0.00783262858512225,0.00629418291532237,0.00682460223214619,0.0090227276663704,0.0120547520338823,0.0150190072452568,0.0176938839537458,0.0205572526847377,0.0235701607458475,0.0254553651292767,0.0249959104291696,0.0227349137449893,0.0205171792301376,0.0193401365999355,0.018302279934811,0.0158775544417531,0.0117872899017223,0.00725981725764046,0.0037274469198828,0.00171498846513034,0.000871032806060882,0.000595798326479117,0.000491341381464783,0.000443161703451029,0.000491486929265219,0.000662670947375285,0.000875044505367267,0.000977717390091609,0.000879424491863559,0.000628295308104409,0.000355340652661552,0.00015895702127376,5.62314242938225e-05,1.57297217451632e-05,3.47936659298791e-06,6.08578146820479e-07,8.4207406799478e-08,9.83027002859435e-09,9.42405385011988e-09,9.42864364578872e-08,8.13816533562744e-07,5.55759483880661e-06,3.00112572170119e-05,0.000128149491309299,0.000432698077369237,0.0011552831142035,0.00243908686349514,0.00407194112437577,0.00537540380107272,0.0056112042758687,0.00463165759940324,0.00302309777889615,0.00156028280898363],[4.84515952688479e-15,1.43393709675011e-14,1.85886523701094e-13,3.320940503431e-12,4.88038757112149e-11,5.68468810111474e-10,5.23927398706786e-09,3.8213720258912e-08,2.20659274027949e-07,1.00939624423011e-06,3.66238486616447e-06,1.05697052051193e-05,2.44717105904531e-05,4.68141763804988e-05,8.1478218379354e-05,0.000158691430332564,0.00039004500314551,0.00101993155000345,0.00234991738723354,0.00441942176578777,0.00663652096885158,0.00791227955509183,0.00748725277271691,0.00567014023812918,0.0036315100738555,0.002563850381918,0.00311828559510545,0.00527883992899119,0.00833758779997035,0.0111845267788038,0.013221224059496,0.0150854312404904,0.0179924018036937,0.0222017391849993,0.0265454031790746,0.0295703875432384,0.0306073994715138,0.0295845331936571,0.0266530447601037,0.0226079442537091,0.0190399874114801,0.0172136472744332,0.0168181266480342,0.0162448935808516,0.01415929692523,0.0106523286331265,0.00694974818136051,0.00433610588456199,0.00349441472068504,0.00452288678622445,0.00705231840872391,0.0102740443731098,0.0133673134779578,0.0162339111893902,0.0193508144056484,0.0224528256686321,0.0239752026034921,0.0226189864242676,0.0191231220524507,0.0156803948999411,0.0136746503014255,0.0125440721143433,0.0108743108176675,0.00811829488601519,0.00498819165786927,0.00249270360286564,0.00103798909451045,0.000404276943785234,0.000192184377345775,0.00013012749227004,0.000114698027804587,0.000133215496651549,0.000186260899248046,0.000249237599780924,0.000279499660480912,0.000251633434229333,0.000179818170479798,0.000101704336695577,4.54967600504252e-05,1.60946440722192e-05,4.50218876230156e-06,9.95870583976863e-07,1.74188666585642e-07,2.41099856077637e-08,2.95344528265344e-09,4.62844345677212e-09,4.80774956725233e-08,4.15076830121733e-07,2.83458542891711e-06,1.53068864713053e-05,6.53611310170764e-05,0.000220692532110945,0.000589238476234369,0.00124402738097666,0.00207684536711803,0.00274166107506232,0.00286192831584158,0.00236232212931917,0.00154189523489434,0.00079580377619736],[1.25462030063351e-16,1.39149333378787e-15,3.00206810002949e-14,5.56378442015254e-13,8.19050599663408e-12,9.53904323269074e-11,8.78870177471571e-10,6.40708048361004e-09,3.69716951734966e-08,1.68993124200955e-07,6.13028543997015e-07,1.77587819669264e-06,4.20457454215081e-06,8.82927207406569e-06,2.01148788179385e-05,5.87248388420407e-05,0.000189868628867323,0.000550442656961891,0.00130699836868125,0.00247723716554361,0.00372357332775156,0.00443239689878669,0.00418329255523597,0.00316375199808529,0.00205055098764805,0.00154073427376882,0.00203085517824281,0.00350739662209067,0.00547925718895923,0.00716288033657341,0.00813755948420396,0.00889148962681774,0.0104195228769634,0.0131664182619598,0.0165526919675168,0.0195051083072408,0.0211087594132443,0.0207758311355052,0.0184287105536927,0.0149040172807044,0.0117415024029224,0.0100539127135556,0.00962008809354671,0.00925473547099067,0.00800494015065878,0.00591100592540169,0.00376868065343398,0.00243613158691643,0.00242872259959484,0.00386314808364347,0.00639191213581239,0.00920836170923426,0.0115764919330176,0.0135740199103883,0.0158691130801224,0.0184132330458586,0.0198565419968391,0.018860957473874,0.0157229241182044,0.0121534307012456,0.00956830546651138,0.00799079814560808,0.00657921847344081,0.00481306804770659,0.00293313779245368,0.00144931574051106,0.00057984109552105,0.000195631070435034,6.54554293249539e-05,3.03017287004179e-05,2.34040890489928e-05,2.77930414225343e-05,4.00586299128895e-05,5.42094151491444e-05,6.09788651507051e-05,5.49419448213519e-05,3.92692756055368e-05,2.22115784520782e-05,9.93631873956491e-06,3.5150190218787e-06,9.83264393516035e-07,2.17495161675292e-07,3.80424256196664e-08,5.2686637666547e-09,6.99434916056727e-10,1.76236647480306e-09,1.87079652437304e-08,1.61537959965549e-07,1.10315372877806e-06,5.95707887585098e-06,2.54370092590008e-05,8.58883237689536e-05,0.000229317705224845,0.000484146089823525,0.000808259190299256,0.00106698977000868,0.0011137949410584,0.000919360007104955,0.000600069227017781,0.000309708043733144],[6.60266166466156e-18,1.64286937857504e-16,3.82960176799728e-15,7.12563943989506e-14,1.04905494530636e-12,1.22156960640311e-11,1.1251910758349e-10,8.19999777637911e-10,4.73021832710415e-09,2.16274894609409e-08,7.87491416831938e-08,2.3260873973124e-07,5.97075032034138e-07,1.60731440245123e-06,5.54940450244256e-06,2.20412698324876e-05,8.01945434016162e-05,0.000240331466239023,0.000575421035902095,0.00109237485299361,0.00164129203866534,0.00195146100955913,0.00183949475013411,0.00139272672116134,0.000918301373706035,0.00073962163989741,0.00105199656418364,0.00185280838332605,0.00288273834929521,0.00371844238441618,0.00414276346890369,0.00448264608650287,0.00544051081215921,0.00749044034710958,0.0104190189039566,0.0133581280165942,0.0151742135931463,0.0150117201225625,0.0128423290654504,0.00963373945042345,0.00677466070179592,0.0051149548435827,0.00450262927989317,0.00418633550932086,0.00357269340782179,0.00263211708727082,0.00177104649415246,0.00150912564727694,0.00226801049979344,0.00418940086801586,0.00685899844746291,0.00930236383666377,0.0106984676631038,0.0112625771587108,0.0120469714022259,0.0136030153517397,0.0151282206598178,0.0152308151631672,0.0133753039257466,0.0103465347270477,0.00740200908293104,0.00521641306837139,0.00367959274382197,0.0024521004328057,0.00142857739993825,0.000690734695782898,0.000270791579229602,8.63133655918149e-05,2.37392059766768e-05,7.17822104046926e-06,3.95724009557266e-06,4.48390662442058e-06,6.59174201939498e-06,9.00255933259756e-06,1.01529455807387e-05,9.15379405181792e-06,6.54365545091104e-06,3.70138537263133e-06,1.65582587937342e-06,5.85757532949071e-07,1.63855405989786e-07,3.62443356294713e-08,6.33959638396826e-09,8.78917982112255e-10,1.3271457198265e-10,5.16858263608825e-10,5.55497606462651e-09,4.79694438707835e-08,3.27586761481834e-07,1.76898299121318e-06,7.55364125020971e-06,2.55049474852493e-05,6.80969865581626e-05,0.000143769491058589,0.00024001642247097,0.00031684770242549,0.000330746721259208,0.000273008340043146,0.000178193419675689,9.19692810913658e-05],[5.46011350016751e-19,1.5913852719219e-17,3.74195110370895e-16,6.96512154308707e-15,1.02534639722147e-13,1.19380255769073e-12,1.09943219189072e-11,8.01146004138378e-11,4.62364664777141e-10,2.1212141320562e-09,7.85157843884137e-09,2.48320792272337e-08,7.95652176630632e-08,3.23463642110072e-07,1.5676326982965e-06,7.13902846963075e-06,2.69878455253856e-05,8.16478187695689e-05,0.000195898741277604,0.000371958918201129,0.000558645030721616,0.000663835519053694,0.000625619618873847,0.000475154619845793,0.000320396904446348,0.000278293214288509,0.000424248582068522,0.000759746776771632,0.00118188451037537,0.00152441163829326,0.00173263659858151,0.00204977304201491,0.00298324738281403,0.00496915355520989,0.00790012578559175,0.0108757112652541,0.0125553158435739,0.0120526326055967,0.00963259069842867,0.00650296401441625,0.00390861493898696,0.00239438780082667,0.0017594578203037,0.0014991645742669,0.00124771645751541,0.000949007610164959,0.000803662981171365,0.00117006573277689,0.00245299094528684,0.0048148555242046,0.00773982455870338,0.0100268016638335,0.010683131645095,0.00999160369970439,0.00937791512330585,0.0100064054532169,0.0116093874098561,0.0127453276200804,0.0121302307182257,0.00972593437298902,0.00661451293330358,0.00395505691765715,0.00219919968614908,0.00118057338236454,0.000598369381535504,0.000269154314186764,0.000101772010216261,3.14555616345231e-05,7.9885486645638e-06,1.84095182111052e-06,6.17461843823732e-07,5.67536405068309e-07,8.30458242079548e-07,1.14147843973405e-06,1.29005794034569e-06,1.16374210438334e-06,8.32023108251599e-07,4.70645486499041e-07,2.10546418445009e-07,7.44821079583143e-08,2.08350750485229e-08,4.60865844925499e-09,8.06122572612806e-10,1.11968654350951e-10,2.05364768059936e-11,1.16288544838515e-10,1.25862646467553e-09,1.08692276700426e-08,7.4226753481828e-08,4.00827750296024e-07,1.71155349934793e-06,5.77907801986952e-06,1.54298611461651e-05,3.25762327558229e-05,5.43844927464333e-05,7.17934272866986e-05,7.49427579915019e-05,6.18600174768793e-05,4.03762319263249e-05,2.08390019687633e-05],[3.99339797726196e-20,1.18593435361242e-18,2.79111345643328e-17,5.19524641285704e-16,7.64748946654536e-15,8.90323523986107e-14,8.19946182743429e-13,5.97791083286805e-12,3.46015837080924e-11,1.60920846719778e-10,6.30524564894772e-10,2.42038688122395e-09,1.15515265248813e-08,6.78443679262063e-08,3.85593250880622e-07,1.83740992545007e-06,7.02391661776603e-06,2.13048538208689e-05,5.11421868275424e-05,9.71026858024022e-05,0.000145827394095026,0.000173352765770913,0.000163823779367848,0.000126130496835941,8.99254835914549e-05,8.79154770139351e-05,0.000141718689795786,0.000251272377784501,0.000386481867172886,0.000508751344108674,0.000652552851937535,0.00103520381354303,0.00207741636289168,0.00417680653620487,0.00721340273514753,0.0101867362170179,0.0116262653938967,0.010713338398323,0.0079977118170351,0.00488284088409847,0.00250935737064433,0.00118908253011619,0.000635658113951844,0.000440355174039575,0.000347806466860565,0.000303806175520066,0.000428277054904231,0.0010069675199064,0.00242162152850919,0.00483215212318861,0.00770006833025295,0.00978073881354884,0.0100437046140023,0.00876757290142801,0.00746501507569825,0.0075440625974634,0.00904584414452683,0.0106193779279425,0.0107010339077735,0.0088384519525966,0.00593056728037934,0.00326622774311579,0.00152208389110675,0.000632758117930361,0.000247947040278039,9.26195191286431e-05,3.15340052624478e-05,9.22824681614042e-06,2.23968104681518e-06,4.57255153199226e-07,1.00372568147205e-07,5.86466097077945e-08,8.03091427837283e-08,1.10512798829967e-07,1.25090757912288e-07,1.1289344485688e-07,8.07229838161797e-08,4.56633799666774e-08,2.04279624703788e-08,7.22653148397594e-09,2.02149742645512e-09,4.47149499412778e-10,7.82146976864771e-11,1.08998604806619e-11,2.62550928930837e-12,2.00254956048367e-11,2.17602500455527e-10,1.87921538206891e-09,1.28333017727247e-08,6.93003969886578e-08,2.95915981079822e-07,9.9916335810602e-07,2.66771824586995e-06,5.6322094982698e-06,9.40270960429872e-06,1.24125962049804e-05,1.29570941044687e-05,1.06951770822591e-05,6.98077640420662e-06,3.60292197390295e-06],[2.26822202514162e-21,6.74965518775406e-20,1.58865902983027e-18,2.95696607862696e-17,4.35257302946191e-16,5.06752756829032e-15,4.6691824223088e-14,3.41252204420025e-13,1.99745468905622e-12,9.73599482617859e-12,4.50598875029888e-11,2.52162883004078e-10,1.78261233930089e-09,1.26030822564405e-08,7.56336056306036e-08,3.65275406952344e-07,1.40076552229577e-06,4.25199076729781e-06,1.02106140066102e-05,1.94068916823701e-05,2.92717729454026e-05,3.54170083941396e-05,3.58379127324295e-05,3.46731714766679e-05,4.07091828547795e-05,6.09550924293667e-05,9.45566668617938e-05,0.000132120114552995,0.000162986601047765,0.000194730032320958,0.000296202248630662,0.000666712482236486,0.00166718231398122,0.00364704398314769,0.00648549222741882,0.00922357096632662,0.0104616661476307,0.00946913350787943,0.00685343664185543,0.00398214931152604,0.00187641100598846,0.000741909470445167,0.000276397962398458,0.00012544522220898,8.53980093920395e-05,0.00010575837925726,0.000263349824479764,0.000770905899134107,0.00192851969386565,0.00386259401157068,0.00613598552198897,0.00774138850052531,0.00784197292001653,0.00665418671719665,0.00540809760003323,0.00530011499063202,0.00645783951504838,0.00783532174244854,0.00810793334922344,0.00679457825278164,0.00455368397417124,0.0024420600935922,0.00105806350691846,0.000379080281773011,0.000117365640952791,3.33321497587132e-05,9.02802498051057e-06,2.28759985421128e-06,5.12596477874741e-07,9.75030573151016e-08,1.68828827336412e-08,5.40178571455182e-09,6.00943977247418e-09,8.17281920098884e-09,9.25642155135523e-09,8.35671754008469e-09,5.97592906060359e-09,3.38054449590552e-09,1.51232877649117e-09,5.34997427973808e-10,1.49656348085562e-10,3.31035704944329e-11,5.79064045981538e-12,8.11723867620902e-13,2.77878048032033e-13,2.6359080805497e-12,2.87064515815593e-11,2.47912416655751e-10,1.69301250182478e-09,9.14234237030661e-09,3.90382354134132e-08,1.31813003974525e-07,3.51934398807744e-07,7.43020094720109e-07,1.24043720017125e-06,1.6375116037108e-06,1.70934360516191e-06,1.41094387400712e-06,9.20927594519858e-07,4.75309632417067e-07],[9.84937160801783e-23,2.93152588674777e-21,6.89985922354513e-20,1.28425941260435e-18,1.89051480603459e-17,2.20197612026437e-16,2.03302594226712e-15,1.49945908918376e-14,9.12097534252132e-14,5.12091410566865e-13,3.36256478268063e-12,2.84243527744042e-11,2.49064282673739e-10,1.88039548018703e-09,1.14708111792958e-08,5.56183512459834e-08,2.13577533097541e-07,6.49705909893469e-07,1.57260543726053e-06,3.08382045348429e-06,5.22516052263168e-06,9.05607672905778e-06,1.93110826888007e-05,4.67413790352178e-05,0.000104350039188871,0.000193079761123209,0.000286745520173873,0.000339885766175145,0.000324839719317478,0.000268398465919223,0.000266952418395372,0.000505042881224935,0.00127340606232142,0.00285896333203771,0.00519609257608735,0.00753889454809909,0.00872167799829492,0.00805248941390446,0.00594103422648129,0.00350823982337289,0.00166231580453728,0.000636284016755964,0.000201779565247207,5.90572990438072e-05,2.60710966149008e-05,4.45629617986965e-05,0.000150555781019179,0.000470993414513049,0.00119006706063415,0.00238541367254316,0.00378555889426879,0.0047656117406581,0.00480539679677212,0.0040363761195317,0.00322205958630294,0.00311651067270247,0.00381950706623734,0.00469366426083072,0.00490635855254835,0.00413542861672296,0.0027735420218966,0.00147693218609982,0.000625820701332067,0.000212513097442748,5.87945299458487e-05,1.37057808504012e-05,2.84327397389396e-06,5.54917624974596e-07,1.03063741778488e-07,1.74736276558233e-08,2.6374914646211e-09,4.99150798321689e-10,3.56114103016951e-10,4.62292782151852e-10,5.2274299231384e-10,4.72017189654009e-10,3.37566826543433e-10,1.90963168304888e-10,8.5430181325164e-11,3.02215920154435e-11,8.45397422917619e-12,1.86999664322961e-12,3.27130727274665e-13,4.63349101177935e-14,2.41029254385041e-14,2.65001210849336e-13,2.88962608872134e-12,2.49553596548775e-11,1.70422032646463e-10,9.20286512178052e-10,3.92966704320222e-09,1.32685612476789e-08,3.54264221658137e-08,7.47938923913403e-08,1.24864895481424e-07,1.64835201023268e-07,1.72065954302979e-07,1.42028439113025e-07,9.27024180021412e-08,4.78456205319201e-08],[3.26413590888702e-24,9.71539381363752e-23,2.28669681970116e-21,4.25646472038653e-20,6.26803744688605e-19,7.31289750846273e-18,6.80191430069709e-17,5.17664392905848e-16,3.54627271802102e-15,2.73883074631745e-14,2.75151253914445e-13,2.975642452458e-12,2.82279577135738e-11,2.17471496576944e-10,1.33405064500294e-09,6.49826173490998e-09,2.531335682778e-08,8.1333754199881e-08,2.38661657753256e-07,7.85277566280882e-07,3.18946498730647e-06,1.34087446375006e-05,4.90030255242503e-05,0.000145354159689397,0.000343220812982674,0.000641963952565151,0.000950017289337947,0.00111234087334185,0.00103241158078624,0.000770928630315488,0.000515800441627271,0.000495667853298722,0.000957904636367597,0.00214276724798956,0.00407302848586456,0.00624307559027917,0.00766865234598618,0.00754463793688253,0.00594428516644022,0.00374940916278232,0.001892421133488,0.000764079004717657,0.000247147032236588,6.50315186876301e-05,1.74363724334099e-05,2.00104481499513e-05,6.99714491354459e-05,0.00022216791987149,0.00056268144542055,0.00112802329233654,0.00178955511593404,0.00225130005246714,0.00226664563839574,0.00189726036428013,0.00150469236023126,0.0014479438055002,0.00177770554889547,0.0021942585656928,0.00230187779496873,0.00194430627516451,0.0013047266262565,0.000693589556231845,0.000292109077683278,9.76462794364683e-05,2.60340831903118e-05,5.5989614957453e-06,9.95170403185374e-07,1.528918273239e-07,2.15598371584953e-08,2.90156395167159e-09,3.68930424265204e-10,4.87167809712369e-11,1.77616749582941e-11,2.00825272848671e-11,2.25346020415296e-11,2.03441071775908e-11,1.4549903697502e-11,8.23108053309862e-12,3.68231017843599e-12,1.30264725002378e-12,3.64393415407272e-13,8.06029201177726e-14,1.41020583734771e-14,2.03414653554777e-15,1.68455075708894e-15,2.03399291070783e-14,2.21946915138774e-13,1.9167841715675e-12,1.30898639896263e-11,7.06858443765522e-11,3.01831907120266e-10,1.01913854331677e-09,2.72105103236479e-09,5.74480813087671e-09,9.59068774051136e-09,1.26607477270805e-08,1.32161311802682e-08,1.0908994113625e-08,7.12033546675387e-09,3.67495127035854e-09],[8.25439543076298e-26,2.45686659383056e-24,5.78302826319767e-23,1.07677544733437e-21,1.58780847622416e-20,1.86360904378033e-19,1.77816962412852e-18,1.49427752182487e-17,1.36256061011827e-16,1.61813568582198e-15,2.14981397942484e-14,2.55930078629983e-13,2.49216621820216e-12,1.94332890826012e-11,1.22378308474177e-10,6.55108937343535e-10,3.45916634745934e-09,2.20573235870127e-08,1.64801089772382e-07,1.16891741311609e-06,6.93578824271968e-06,3.3028304768832e-05,0.00012483471241603,0.000373443074318359,0.000883588415032553,0.00165324651549875,0.00244608813433523,0.00286202130160133,0.00264931086469359,0.00194761998828635,0.00117432160781393,0.000729338294674227,0.000884648587463372,0.00185857062743247,0.00374109752694037,0.00615711027468161,0.00811047986530361,0.00852226547031815,0.00713392082259133,0.00475233711356999,0.00251697437069194,0.00105897042966339,0.00035373393701624,9.39705889485898e-05,2.09777536666192e-05,9.51545041509605e-06,2.54800281962444e-05,8.02286112079972e-05,0.000203228850815175,0.000407422701273614,0.000646290839140722,0.000812867930031504,0.000817991983618994,0.000683851550420422,0.000541063418770228,0.00051957291920037,0.000638143807652351,0.00078881173809553,0.000828501447348697,0.00070032858374646,0.000470081959094342,0.000249798454323671,0.000105035055942984,3.49603107083934e-05,9.22321999512832e-06,1.93489396448102e-06,3.25226649300832e-07,4.45468630324879e-08,5.14482297764073e-09,5.2942650193612e-10,5.1422304620176e-11,4.99274033879729e-12,8.53866603131659e-13,6.78700307832598e-13,7.42018369142355e-13,6.69101539176775e-13,4.78527619020461e-13,2.70712523132968e-13,1.21108136546679e-13,4.28430278131245e-14,1.19846111123257e-14,2.65096989556797e-15,4.63903638585795e-16,6.90677880014255e-17,9.32427313659585e-17,1.19159812185054e-15,1.30077218216644e-14,1.12337930279347e-13,7.67164228951895e-13,4.14272076067367e-12,1.7689614078889e-11,5.97291641437078e-11,1.59474003629167e-10,3.36688853614077e-10,5.6208625025577e-10,7.4201479684183e-10,7.74564433646053e-10,6.39348893561499e-10,4.17305074605365e-10,2.15379713667789e-10],[1.592775048999e-27,4.74103359968854e-26,1.11622891540508e-24,2.08066290596563e-23,3.08300190341575e-22,3.69413927364445e-21,3.82634609569025e-20,4.13985612811683e-19,5.78694512634111e-18,9.40099529299544e-17,1.40489135117851e-15,1.74316780697227e-14,1.78599432743651e-13,1.63340401582773e-12,1.61533796603145e-11,1.98336823852261e-10,2.61766057100364e-09,3.06681004792455e-08,2.93547283387066e-07,2.24050379500515e-06,1.35506352967224e-05,6.48388717313718e-05,0.000245359469822553,0.000734208724638513,0.00173730128772301,0.00325062704781923,0.00480945423863258,0.00562689420302309,0.00520663617404738,0.00381610990705814,0.00224678069625181,0.00119713140389576,0.00101428451171561,0.00187668903167476,0.00386639708905823,0.00662138650381781,0.00904373785258351,0.00980204935033944,0.0084221084929968,0.00573378676697434,0.00309181016058764,0.00132007920618443,0.000446170364291022,0.000119400451593761,2.55988179737899e-05,5.93569355825789e-06,7.45712902086025e-06,2.21598214122701e-05,5.60280696847425e-05,0.000112314956594027,0.000178157996044726,0.000224060558503594,0.000225432648632564,0.000188378519559827,0.000148901654891113,0.000142845480751816,0.000175430508456015,0.00021694135490658,0.000227947155408178,0.000192732685957688,0.00012938259028383,6.87477617896658e-05,2.88949731620392e-05,9.60642222692793e-06,2.52708242078564e-06,5.26473145238948e-07,8.70468093177969e-08,1.14796258355333e-08,1.22151613179415e-09,1.07492695266784e-10,8.18841445051169e-12,5.79328880533638e-13,4.96755016955202e-14,1.86841270321744e-14,1.87050372168823e-14,1.67943827352069e-14,1.20088817402029e-14,6.7936655619158e-15,3.03927627938653e-15,1.07517045489357e-15,3.00760775958063e-16,6.65277880618378e-17,1.16463173418522e-17,1.83017281946507e-18,4.03213044091297e-18,5.32757799424863e-17,5.81698120799143e-16,5.02369705496008e-15,3.43072077403312e-14,1.85260438887427e-13,7.91070858339093e-13,2.67105890136e-12,7.13159916158106e-12,1.50565602637738e-11,2.51362212011785e-11,3.31825374833074e-11,3.4638141263611e-11,2.8591368684037e-11,1.86616780945658e-11,9.63167507217362e-12],[2.34524420012915e-29,6.98222157586253e-28,1.64535957878468e-26,3.07894973824912e-25,4.63923300130645e-24,5.94786524313155e-23,7.67968206088567e-22,1.26070299668674e-20,2.49940914298929e-19,4.74965856701628e-18,7.94628826108768e-17,1.28310108412172e-15,2.44486460144908e-14,5.61019456391704e-13,1.26342867868531e-11,2.41243601504874e-10,3.71107942706502e-09,4.53554709641336e-08,4.3883911674227e-07,3.35848348896791e-06,2.03258144080064e-05,9.72737999634566e-05,0.000368112975220016,0.00110154497211879,0.0026065067044122,0.00487697941249042,0.00721570642939807,0.00844202477225442,0.00781074502978964,0.00571985572114064,0.00334248574313242,0.00167891512893943,0.0011349236319826,0.00179488228357558,0.00365041162103294,0.00632130452258155,0.00873293893281032,0.00955571035981037,0.00827425707494002,0.00566851053665009,0.00307208501017808,0.00131699539405199,0.000446573881348688,0.000119776690033487,2.54731494992866e-05,4.61922839557679e-06,2.01566811150577e-06,4.70839763064012e-06,1.17901344023458e-05,2.36271602842939e-05,3.74774466503573e-05,4.71322904983037e-05,4.74175718436619e-05,3.96156676508878e-05,3.12987500809266e-05,3.00074018547407e-05,3.68442706296803e-05,4.55658394134469e-05,4.78831056763465e-05,4.04893634657992e-05,2.71819182367727e-05,1.44430086157563e-05,6.0698125378321e-06,2.01734926592565e-06,5.30276215372572e-07,1.10265268022063e-07,1.81485029195507e-08,2.36761083575606e-09,2.45629595309741e-10,2.04220303813594e-11,1.38435509127304e-12,7.93163265970977e-14,4.2595862431166e-15,5.06189807662538e-16,3.64474650563602e-16,3.21827249912491e-16,2.29961044988214e-16,1.30090214864339e-16,5.81983875031344e-17,2.05881973554236e-17,5.75920149691559e-18,1.27393125255657e-18,2.23162405444542e-19,3.83512429832765e-20,1.34950758088609e-19,1.81767488159417e-18,1.98489786632103e-17,1.7142110297844e-16,1.17064770334557e-15,6.32154936515097e-15,2.69933155311297e-14,9.11432079270668e-14,2.43347993900668e-13,5.13767480787797e-13,8.57710713258054e-13,1.13227114229824e-12,1.18193998259977e-12,9.75608983973277e-13,6.3678311473213e-13,3.28656834689079e-13],[2.63532122613071e-31,7.8514780450738e-30,1.85602349631901e-28,3.52050203154319e-27,5.60745236117888e-26,8.69839613529742e-25,1.6831224690406e-23,4.15423499609872e-22,1.10217250225656e-20,3.23545646439486e-19,1.19146404819787e-17,4.90712086671323e-16,1.83909426624304e-14,5.67738421386949e-13,1.40061605903054e-11,2.73953284538255e-10,4.23989993890611e-09,5.18968671527683e-08,5.02319090607384e-07,3.84466035307009e-06,2.32687332091451e-05,0.000111358443352602,0.000421414049805756,0.00126104408169269,0.0029839182057972,0.0055831458310045,0.00826050681933294,0.00966434795555827,0.00894130155936214,0.00654526852930028,0.00381112804943326,0.00185513448443759,0.00106738758445811,0.00141629986506362,0.00278364071178556,0.00481797953030909,0.00667408703588309,0.00732106376016254,0.00635214476656885,0.0043588033507546,0.00236536397938154,0.00101508504156166,0.000344487252238438,9.24509548587837e-05,1.96307412593252e-05,3.34992497340386e-06,6.69721203540901e-07,7.92105677435591e-07,1.89554034707635e-06,3.79277310685352e-06,6.01577603646064e-06,7.56544795394862e-06,7.61097409314475e-06,6.35796831348171e-06,5.02159452164882e-06,4.81210236029019e-06,5.90688909511256e-06,7.30482416944285e-06,7.67648986462351e-06,6.49131320403931e-06,4.35791096778778e-06,2.31555861824827e-06,9.7310976560968e-07,3.23394221910539e-07,8.49890473632944e-08,1.76635662429438e-08,2.90365775939789e-09,3.77682727490888e-10,3.89059484873603e-11,3.18090731168586e-12,2.07467977482695e-13,1.09235587237107e-14,4.79000834823128e-16,2.2511588692945e-17,5.81815926531227e-18,4.717321090783e-18,3.36040722048336e-18,1.90077619789839e-18,8.50346025976104e-19,3.00817542737318e-19,8.41486552581143e-20,1.86137615501257e-20,3.2645595215775e-21,6.4642485206211e-22,3.47515268195125e-21,4.73227861348976e-20,5.16800155828031e-19,4.46322669947412e-18,3.04797134588118e-17,1.64591800520507e-16,7.02814792490537e-16,2.37306138596834e-15,6.33596008756501e-15,1.33767704445883e-14,2.23318908809177e-14,2.94805173895605e-14,3.07737262823143e-14,2.54015637624189e-14,1.6579682185607e-14,8.55711425320175e-15]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</center>
</div>
<div id="exercises-6" class="section level2 hasAnchor" number="6.6">
<h2 class="hasAnchor"><span class="header-section-number">6.6</span> Exercises<a href="#exercises-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="the-boston-housing-data-set" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">1. The Boston Housing Data Set<a href="#the-boston-housing-data-set" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For the course of this section, you will work with <tt>Boston</tt>, the Boston Housing data set which contains 506 observations on housing values in suburbs of Boston. <tt>Boston</tt> comes with the package <tt>MASS</tt> which is already installed for the interactive <tt>R</tt> exercises below.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Load both the package and the data set.</p></li>
<li><p>Get yourself an overview over the data using function(s) known from the previous chapters.</p></li>
<li><p>Estimate a simple linear regression model that explains the median house value of districts (<tt>medv</tt>) by the percent of households with low socioeconomic status, <tt>lstat</tt>, and a constant. Save the model to <tt>bh_mod</tt>.</p></li>
<li><p>Print a coefficient summary to the console that reports robust standard errors.</p></li>
</ul>
<iframe src="DCL/ex6_1.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hint:</strong></p>
<p>You only need basic <tt>R</tt> functions here: <tt>library()</tt>, <tt>data()</tt>, <tt>lm()</tt> and <tt>coeftest()</tt>.</p>
</div>
<div id="a-multiple-regression-model-of-housing-prices-i" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">2. A Multiple Regression Model of Housing Prices I<a href="#a-multiple-regression-model-of-housing-prices-i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now, let us expand the approach from the previous exercise by adding additional regressors to the model and estimating it again.</p>
<p>As has been discussed in Chapter @ref(mofimr), adding regressors to the model improves the fit so the <span class="math inline">\(SER\)</span> decreases and the <span class="math inline">\(R^2\)</span> increases.</p>
<p>The packages <tt>AER</tt> and <tt>MASS</tt> have been loaded. The model object <tt>bh_mod</tt> is available in the environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Regress the median housing value in a district, <tt>medv</tt>, on the average age of the buildings, <tt>age</tt>, the per-capita crime rate, <tt>crim</tt>, the percentage of individuals with low socioeconomic status, <tt>lstat</tt>, and a constant. Put differently, estimate the model <span class="math display">\[medv_i = \beta_0 + \beta_1 lstat_i + \beta_2 age_i + \beta_3 crim_i + u_i.\]</span></p></li>
<li><p>Print a coefficient summary to the console that reports robust standard errors for the augmented model.</p></li>
<li><p>The <span class="math inline">\(R^2\)</span> of the simple regression model is stored in <tt>R2_res</tt>. Save the multiple regression models <span class="math inline">\(R^2\)</span> to <tt>R2_unres</tt> and check whether the augmented model yields a higher <span class="math inline">\(R^2\)</span>. Use <tt>&lt;</tt> or <tt>&gt;</tt> for the comparison.</p></li>
</ul>
<iframe src="DCL/ex6_2.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="a-multiple-regression-model-of-housing-prices-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">3. A Multiple Regression Model of Housing Prices II<a href="#a-multiple-regression-model-of-housing-prices-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The equation below describes estimated model from Exercise 2 (heteroskedasticity-robust standard errors in parentheses).</p>
<p><span class="math display">\[ \widehat{medv}_i = \underset{(0.74)}{32.828} \underset{(0.08)}{-0.994} \times lstat_i \underset{(0.03)}{-0.083} \times crim_i + \underset{(0.02)}{0.038} \times age_i\]</span></p>
<p>This model is saved in <tt>bh_mult_mod</tt> which is available in the working environment.</p>
<p><strong>Instructions:</strong></p>
<p>As has been stressed in Chapter @ref(mofimr), it is not meaningful to use <span class="math inline">\(R^2\)</span> when comparing regression models with a different number of regressors. Instead, the <span class="math inline">\(\bar{R}^2\)</span> should be used. <span class="math inline">\(\bar{R}^2\)</span> adjusts for the circumstance that the <span class="math inline">\(SSR\)</span> reduces when a regressor is added to the model.</p>
<ul>
<li><p>Use the model object to compute the correction factor <span class="math inline">\(CF = \frac{n-1}{n-k-1}\)</span> where <span class="math inline">\(n\)</span> is the number of observations and <span class="math inline">\(k\)</span> is the number of regressors, excluding the intercept. Save it to <tt>CF</tt>.</p></li>
<li><p>Use <tt>summary()</tt> to obtain <span class="math inline">\(R^2\)</span> and <span class="math inline">\(\bar{R}^2\)</span> for <tt>bh_mult_mod</tt>. It is sufficient if you print both values to the console.</p></li>
<li><p>Check that <span class="math display">\[\bar{R}^2 = 1 - (1-R^2) \cdot CF.\]</span> Use the <tt>==</tt> operator.</p></li>
</ul>
<iframe src="DCL/ex6_3.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="a-fully-fledged-model-for-housing-values" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">4. A Fully-Fledged Model for Housing Values?<a href="#a-fully-fledged-model-for-housing-values" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Have a look at the <a href="https://stat.ethz.ch/R-manual/R-devel/library/MASS/html/Boston.html">description</a> of the variables contained in the <tt>Boston</tt> data set.
Which variable would you expect to have the highest <span class="math inline">\(p\)</span>-value in a multiple regression model which uses <em>all</em> remaining variables as regressors to explain <tt>medv</tt>?</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Regress <tt>medv</tt> on all remaining variables that you find in the Boston data set.</p></li>
<li><p>Obtain a heteroskedasticity-robust summary of the coefficients.</p></li>
<li><p>The <span class="math inline">\(\bar{R}^2\)</span> for the model in exercise 3 is <span class="math inline">\(0.5533\)</span>. What can you say about the <span class="math inline">\(\bar{R}^2\)</span> of the large regression model? Does this model improve on the previous one (no code submission needed)?</p></li>
</ul>
<p>The packages <tt>AER</tt> and <tt>MASS</tt> as well as the data set <tt>Boston</tt> are loaded to the working environment.</p>
<iframe src="DCL/ex6_4.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>For brevity, use the regression formula <tt>medv ~.</tt> in your call of <tt>lm()</tt>. This is a shortcut that specifies a regression of <tt>medv</tt> on all the remaining variables in the data set supplied to the argument <tt>data</tt>.</p></li>
<li><p>Use <tt>summary</tt> on both models for a comparison of both <span class="math inline">\(\bar{R}^2\)</span>s.</p></li>
</ul>
</div>
<div id="model-selection" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">5. Model Selection<a href="#model-selection" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Maybe we can improve the model by dropping a variable?</p>
<p>In this exercise, you have to estimate several models, each time dropping one of the explanatory variables used in the large regression model of Exercise 4 and compare the <span class="math inline">\(\bar{R}^2\)</span>.</p>
<p>The full regression model from the previous exercise, <tt>full_mod</tt>, is available in your environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>You are completely free in solving this exercise. We recommend the following approach:</p>
<ol style="list-style-type: decimal">
<li><p>Start by estimating a model <tt>mod_new</tt>, say, where, e.g., <tt>lstat</tt> is excluded from the explanatory variables.
Next, access the <span class="math inline">\(\bar{R}^2\)</span> of this model.</p></li>
<li><p>Compare the <span class="math inline">\(\bar{R}^2\)</span> of this model to the <span class="math inline">\(\bar{R}^2\)</span> of the full model (this was about <span class="math inline">\(0.7338\)</span>).</p></li>
<li><p>Repeat Steps 1 and 2 for all explanatory variables used in the full regression model. Save the model with the highest improvement in <span class="math inline">\(\bar{R}^2\)</span> to <tt>better_mod</tt>.</p></li>
</ol></li>
</ul>
<iframe src="DCL/ex6_5.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<!--chapter:end:06-ch6.Rmd-->
</div>
</div>
<div id="htaciimr" class="section level1 hasAnchor" number="7">
<h1 class="hasAnchor"><span class="header-section-number">7</span> Hypothesis Tests and Confidence Intervals in Multiple Regression<a href="#htaciimr" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter discusses methods that allow to quantify the sampling uncertainty in the OLS estimator of the coefficients in multiple regression models. The basis for this are hypothesis tests and confidence intervals which, just as for the simple linear regression model, can be computed using basic <tt>R</tt> functions. We will also tackle the issue of testing joint hypotheses on these coefficients.</p>
<p>Make sure the packages <tt>AER</tt> <span class="citation">(<a href="#ref-R-AER" role="doc-biblioref">Christian Kleiber and Zeileis 2022</a>)</span> and <tt>stargazer</tt> <span class="citation">(<a href="#ref-R-stargazer" role="doc-biblioref">Hlavac 2022</a>)</span> are installed before you go ahead and replicate the examples. The safest way to do so is by checking whether the following code chunk executes without any issues.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span></code></pre></div>
<div id="hypothesis-tests-and-confidence-intervals-for-a-single-coefficient" class="section level2 hasAnchor" number="7.1">
<h2 class="hasAnchor"><span class="header-section-number">7.1</span> Hypothesis Tests and Confidence Intervals for a Single Coefficient<a href="#hypothesis-tests-and-confidence-intervals-for-a-single-coefficient" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We first discuss how to compute standard errors, how to test hypotheses and how to construct confidence intervals for a single regression coefficient <span class="math inline">\(\beta_j\)</span> in a multiple regression model. The basic idea is summarized in Key Concept 7.1.</p>
<div id="KC7.1" class="keyconcept">
<h3 class="right">
Key Concept 7.1
</h3>
<h3 class="left">
Testing the Hypothesis <span class="math inline">\(\beta_j = \beta_{j,0}\)</span> <br>
Against the Alternative <span class="math inline">\(\beta_j \neq \beta_{j,0}\)</span>
</h3>
<p>
<ol style="list-style-type: decimal">
<li>Compute the standard error of <span class="math inline">\(\hat{\beta_j}\)</span></li>
<li>Compute the <span class="math inline">\(t\)</span>-statistic,
<span class="math display">\[t^{act} = \frac{\hat{\beta}_j - \beta_{j,0}} {SE(\hat{\beta_j})}\]</span></li>
<li>Compute the <span class="math inline">\(p\)</span>-value,
<span class="math display">\[p\text{-value} = 2 \Phi(-|t^{act}|)\]</span></li>
</ol>
where <span class="math inline">\(t^{act}\)</span> is the value of the <span class="math inline">\(t\)</span>-statistic actually computed. Reject the hypothesis at the <span class="math inline">\(5\%\)</span> significance level if the <span class="math inline">\(p\)</span>-value is less than <span class="math inline">\(0.05\)</span> or, equivalently, if <span class="math inline">\(|t^{act}| &gt; 1.96\)</span>. The standard error and (typically) the <span class="math inline">\(t\)</span>-statistic and the corresponding <span class="math inline">\(p\)</span>-value for testing <span class="math inline">\(\beta_j = 0\)</span> are computed automatically by suitable <tt>R</tt> functions, e.g., by <tt>summary</tt>.
</p>
</div>
<p>Testing a single hypothesis about the significance of a coefficient in the multiple regression model proceeds as in in the simple regression model.</p>
<p>You can easily see this by inspecting the coefficient summary of the regression model</p>
<p><span class="math display">\[ TestScore = \beta_0 + \beta_1 \times size  \beta_2 \times english + u \]</span></p>
<p>already discussed in Chapter @ref(rmwmr). Let us review this:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> size <span class="sc">+</span> english, <span class="at">data =</span> CASchools)</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(model, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error  t value Pr(&gt;|t|)    </span></span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 686.032245   8.728225  78.5993  &lt; 2e-16 ***</span></span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; size         -1.101296   0.432847  -2.5443  0.01131 *  </span></span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; english      -0.649777   0.031032 -20.9391  &lt; 2e-16 ***</span></span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>You may check that these quantities are computed as in the simple regression model by computing the <span class="math inline">\(t\)</span>-statistics or <span class="math inline">\(p\)</span>-values by hand using the output above and <tt>R</tt> as a calculator.</p>
<p>For example, using the definition of the <span class="math inline">\(p\)</span>-value for a two-sided test as given in Key Concept 7.1, we can confirm the <span class="math inline">\(p\)</span>-value for a test of the hypothesis that the coefficient <span class="math inline">\(\beta_1\)</span>, the coefficient on <tt>size</tt>, to be approximately zero.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute two-sided p-value</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(<span class="fu">coeftest</span>(model, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)[<span class="dv">2</span>, <span class="dv">3</span>]),</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">df =</span> model<span class="sc">$</span>df.residual))</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.01130921</span></span></code></pre></div>
<div id="KC7.2" class="keyconcept">
<h3 class="right">
Key Concept 7.2
</h3>
<h3 class="left">
Confidence Intervals for a Single Coefficient in Multiple Regression
</h3>
<p>
A <span class="math inline">\(95\%\)</span> two-sided confidence interval for the coefficient <span class="math inline">\(\beta_j\)</span> is an interval that contains the true value of <span class="math inline">\(\beta_j\)</span> with a <span class="math inline">\(95 \%\)</span> probability; that is, it contains the true value of <span class="math inline">\(\beta_j\)</span> in <span class="math inline">\(95 \%\)</span> of all repeated samples. Equivalently, it is the set of values of <span class="math inline">\(\beta_j\)</span> that cannot be rejected by a <span class="math inline">\(5 \%\)</span> two-sided hypothesis test. When the sample size is large, the <span class="math inline">\(95 \%\)</span> confidence interval for <span class="math inline">\(\beta_j\)</span> is
<span class="math display">\[\left[\hat{\beta_j}- 1.96 \times SE(\hat{\beta}_j), \hat{\beta_j} + 1.96 \times SE(\hat{\beta_j})\right].\]</span>
</p>
</div>
</div>
<div id="an-application-to-test-scores-and-the-student-teacher-ratio" class="section level2 hasAnchor" number="7.2">
<h2 class="hasAnchor"><span class="header-section-number">7.2</span> An Application to Test Scores and the Student-Teacher Ratio<a href="#an-application-to-test-scores-and-the-student-teacher-ratio" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let us take a look at the regression from Section @ref(mofimr) again.</p>
<p>Computing confidence intervals for individual coefficients in the multiple regression model proceeds as in the simple regression model using the function <tt>confint()</tt>.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> size <span class="sc">+</span> english, <span class="at">data =</span> CASchools)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(model)</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   2.5 %      97.5 %</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 671.4640580 700.6004311</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; size         -1.8487969  -0.3537944</span></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; english      -0.7271113  -0.5724424</span></span></code></pre></div>
<p>To obtain confidence intervals at another level, say <span class="math inline">\(90\%\)</span>, just set the argument <tt>level</tt> in our call of <tt>confint()</tt> accordingly.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(model, <span class="at">level =</span> <span class="fl">0.9</span>)</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     5 %        95 %</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 673.8145793 698.2499098</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; size         -1.7281904  -0.4744009</span></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; english      -0.7146336  -0.5849200</span></span></code></pre></div>
<p>The output now reports the desired <span class="math inline">\(90\%\)</span> confidence intervals for all coefficients.</p>
<p>A disadvantage of <tt>confint()</tt> is that is does not use robust standard errors to compute the confidence interval. For large-sample confidence intervals, this is quickly done manually as follows.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute robust standard errors</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>rob_se <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">vcovHC</span>(model, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))<span class="sc">^</span><span class="fl">0.5</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="co"># compute robust 95% confidence intervals</span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="st">&quot;lower&quot;</span> <span class="ot">=</span> <span class="fu">coef</span>(model) <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> rob_se,</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;upper&quot;</span> <span class="ot">=</span> <span class="fu">coef</span>(model) <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> rob_se)</span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       (Intercept)       size    english</span></span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lower    668.9252 -1.9496606 -0.7105980</span></span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; upper    703.1393 -0.2529307 -0.5889557</span></span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a><span class="co"># compute robust 90% confidence intervals</span></span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-13"><a href="#cb157-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="st">&quot;lower&quot;</span> <span class="ot">=</span> <span class="fu">coef</span>(model) <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="fl">0.95</span>) <span class="sc">*</span> rob_se,</span>
<span id="cb157-14"><a href="#cb157-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;upper&quot;</span> <span class="ot">=</span> <span class="fu">coef</span>(model) <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="fl">0.95</span>) <span class="sc">*</span> rob_se)</span>
<span id="cb157-15"><a href="#cb157-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       (Intercept)       size    english</span></span>
<span id="cb157-16"><a href="#cb157-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lower    671.6756 -1.8132659 -0.7008195</span></span>
<span id="cb157-17"><a href="#cb157-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; upper    700.3889 -0.3893254 -0.5987341</span></span></code></pre></div>
<p>Knowing how to use <tt>R</tt> to make inference about the coefficients in multiple regression models, you can now answer the following question:</p>
<p>Can the null hypothesis that a change in the student-teacher ratio, <tt>size</tt>, has no significant influence on test scores, <tt>scores</tt>, — if we control for the percentage of students learning English in the district, <tt>english</tt>, — be rejected at the <span class="math inline">\(10\%\)</span> and the <span class="math inline">\(5\%\)</span> level of significance?</p>
<p>The output above shows that zero is not an element of the confidence interval for the coefficient on <tt>size</tt> such that we can reject the null hypothesis at significance levels of <span class="math inline">\(5\%\)</span> and <span class="math inline">\(10\%\)</span>. The same conclusion can be made via the <span class="math inline">\(p\)</span>-value for <tt>size</tt>: <span class="math inline">\(0.00398 &lt; 0.05 = \alpha\)</span>.</p>
<p>Note that rejection at the <span class="math inline">\(5\%\)</span>-level implies rejection at the <span class="math inline">\(10\%\)</span> level (why?).</p>
<p>Recall from Chapter @ref(cifrc) the <span class="math inline">\(95\%\)</span> confidence interval computed above <em>does not</em> tell us that a one-unit decrease in the student-teacher ratio has an effect on test scores that lies in the interval with a lower bound of <span class="math inline">\(-1.9497\)</span> and an upper bound of <span class="math inline">\(-0.2529\)</span>. Once a confidence interval has been computed, a probabilistic statement like this is wrong: either the interval contains the true parameter or it does not. We do not know which is true.</p>
<div id="another-augmentation-of-the-model" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Another Augmentation of the Model<a href="#another-augmentation-of-the-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>What is the average effect on test scores of reducing the student-teacher ratio when the expenditures per pupil and the percentage of english learning pupils are held constant?</p>
<p>Let us augment our model by an additional regressor that is a measure for expenditure per pupil. Using <tt>?CASchools</tt> we find that <tt>CASchools</tt> contains the variable <tt>expenditure</tt>, which provides expenditure per student.</p>
<p>Our model now is <span class="math display">\[ TestScore = \beta_0 + \beta_1 \times size + \beta_2 \times english + \beta_3 \times expenditure + u \]</span></p>
<p>with <span class="math inline">\(expenditure\)</span> the total amount of expenditure per pupil in the district (thousands of dollars).</p>
<p>Let us now estimate the model:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scale expenditure to thousands of dollars</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>CASchools<span class="sc">$</span>expenditure <span class="ot">&lt;-</span> CASchools<span class="sc">$</span>expenditure<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model</span></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> size <span class="sc">+</span> english <span class="sc">+</span> expenditure, <span class="at">data =</span> CASchools)</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(model, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error  t value Pr(&gt;|t|)    </span></span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 649.577947  15.458344  42.0212  &lt; 2e-16 ***</span></span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; size         -0.286399   0.482073  -0.5941  0.55277    </span></span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; english      -0.656023   0.031784 -20.6398  &lt; 2e-16 ***</span></span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; expenditure   3.867901   1.580722   2.4469  0.01482 *  </span></span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The estimated effect of a one unit change in the student-teacher ratio on test scores with expenditure and the share of english learning pupils held constant is <span class="math inline">\(-0.29\)</span>, which is rather small. What is more, the coefficient on <span class="math inline">\(size\)</span> is not significantly different from zero anymore even at <span class="math inline">\(10\%\)</span> since <span class="math inline">\(p\text{-value}=0.55\)</span>. Can you come up with an interpretation for these findings (see Chapter 7.1 of the book)? The insignificance of <span class="math inline">\(\hat\beta_1\)</span> could be due to a larger standard error of <span class="math inline">\(\hat{\beta}_1\)</span> resulting from adding <span class="math inline">\(expenditure\)</span> to the model so that we estimate the coefficient on <span class="math inline">\(size\)</span> less precisely. This illustrates the issue of strongly correlated regressors (imperfect multicollinearity). The correlation between <span class="math inline">\(size\)</span> and <span class="math inline">\(expenditure\)</span> can be computed using <tt>cor()</tt>.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the sample correlation between &#39;size&#39; and &#39;expenditure&#39;</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(CASchools<span class="sc">$</span>size, CASchools<span class="sc">$</span>expenditure)</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -0.6199822</span></span></code></pre></div>
<p>Altogether, we conclude that the new model provides no evidence that changing the student-teacher ratio, e.g., by hiring new teachers, has any effect on the test scores while keeping expenditures per student and the share of English learners constant.</p>
</div>
</div>
<div id="joint-hypothesis-testing-using-the-f-statistic" class="section level2 hasAnchor" number="7.3">
<h2 class="hasAnchor"><span class="header-section-number">7.3</span> Joint Hypothesis Testing Using the F-Statistic<a href="#joint-hypothesis-testing-using-the-f-statistic" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The estimated model is</p>
<p><span class="math display">\[ \widehat{TestScore} = \underset{(15.21)}{649.58} -\underset{(0.48)}{0.29} \times size - \underset{(0.04)}{0.66} \times english + \underset{(1.41)}{3.87} \times expenditure. \]</span></p>
<p>Now, can we reject the hypothesis that the coefficient on <span class="math inline">\(size\)</span> <em>and</em> the coefficient on <span class="math inline">\(expenditure\)</span> are zero? To answer this, we have to resort to joint hypothesis tests. A joint hypothesis imposes restrictions on multiple regression coefficients. This is different from conducting individual <span class="math inline">\(t\)</span>-tests where a restriction is imposed on a single coefficient. Chapter 7.2 of the book explains why testing hypotheses about the model coefficients one at a time is different from testing them jointly.</p>
<p>The homoskedasticity-only <span class="math inline">\(F\)</span>-Statistic is given by</p>
<p><span class="math display">\[ F = \frac{(SSR_{\text{restricted}} - SSR_{\text{unrestricted}})/q}{SSR_{\text{unrestricted}} / (n-k-1)} \]</span></p>
<p>with <span class="math inline">\(SSR_{restricted}\)</span> being the sum of squared residuals from the restricted regression, i.e., the regression where we impose the restriction. <span class="math inline">\(SSR_{unrestricted}\)</span> is the sum of squared residuals from the full model, <span class="math inline">\(q\)</span> is the number of restrictions under the null and <span class="math inline">\(k\)</span> is the number of regressors in the unrestricted regression.</p>
<p>It is fairly easy to conduct <span class="math inline">\(F\)</span>-tests in <tt>R</tt>. We can use the function <tt>linearHypothesis()</tt>contained in the package <tt>car</tt>.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the multiple regression model</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> size <span class="sc">+</span> english <span class="sc">+</span> expenditure, <span class="at">data =</span> CASchools)</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a><span class="co"># execute the function on the model object and provide both linear restrictions </span></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a><span class="co"># to be tested as strings</span></span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(model, <span class="fu">c</span>(<span class="st">&quot;size=0&quot;</span>, <span class="st">&quot;expenditure=0&quot;</span>))</span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; size = 0</span></span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; expenditure = 0</span></span>
<span id="cb160-12"><a href="#cb160-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb160-13"><a href="#cb160-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb160-14"><a href="#cb160-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: score ~ size + english + expenditure</span></span>
<span id="cb160-15"><a href="#cb160-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb160-16"><a href="#cb160-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df   RSS Df Sum of Sq      F   Pr(&gt;F)    </span></span>
<span id="cb160-17"><a href="#cb160-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    418 89000                                 </span></span>
<span id="cb160-18"><a href="#cb160-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    416 85700  2    3300.3 8.0101 0.000386 ***</span></span>
<span id="cb160-19"><a href="#cb160-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb160-20"><a href="#cb160-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The output reveals that the <span class="math inline">\(F\)</span>-statistic for this joint hypothesis test is about <span class="math inline">\(8.01\)</span> and the corresponding <span class="math inline">\(p\)</span>-value is <span class="math inline">\(0.0004\)</span>. Thus, we can reject the null hypothesis that both coefficients are zero at any level of significance commonly used in practice.</p>
<p>A heteroskedasticity-robust version of this <span class="math inline">\(F\)</span>-test (which leads to the same conclusion) can be conducted as follows.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># heteroskedasticity-robust F-test</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(model, <span class="fu">c</span>(<span class="st">&quot;size=0&quot;</span>, <span class="st">&quot;expenditure=0&quot;</span>), <span class="at">white.adjust =</span> <span class="st">&quot;hc1&quot;</span>)</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; size = 0</span></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; expenditure = 0</span></span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: score ~ size + english + expenditure</span></span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F   Pr(&gt;F)   </span></span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    418                      </span></span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    416  2 5.4337 0.004682 **</span></span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The standard output of a model summary also reports an <span class="math inline">\(F\)</span>-statistic and the corresponding <span class="math inline">\(p\)</span>-value. The null hypothesis belonging to this <span class="math inline">\(F\)</span>-test is that <em>all</em> of the population coefficients in the model except for the intercept are zero, so the hypotheses are <span class="math display">\[H_0: \beta_1=0, \ \beta_2 =0, \ \beta_3 =0 \quad \text{vs.} \quad H_1: \beta_j \neq 0 \ \text{for at least one} \ j=1,2,3.\]</span></p>
<p>This is also called the <em>overall regression <span class="math inline">\(F\)</span>-statistic</em> and the null hypothesis is obviously different from testing if only <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_3\)</span> are zero.</p>
<p>We now check whether the <span class="math inline">\(F\)</span>-statistic belonging to the <span class="math inline">\(p\)</span>-value listed in the model’s summary coincides with the result reported by <tt>linearHypothesis()</tt>.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># execute the function on the model object and provide the restrictions </span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="co"># to be tested as a character vector</span></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(model, <span class="fu">c</span>(<span class="st">&quot;size=0&quot;</span>, <span class="st">&quot;english=0&quot;</span>, <span class="st">&quot;expenditure=0&quot;</span>))</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; size = 0</span></span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; english = 0</span></span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; expenditure = 0</span></span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: score ~ size + english + expenditure</span></span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    </span></span>
<span id="cb162-15"><a href="#cb162-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    419 152110                                  </span></span>
<span id="cb162-16"><a href="#cb162-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    416  85700  3     66410 107.45 &lt; 2.2e-16 ***</span></span>
<span id="cb162-17"><a href="#cb162-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb162-18"><a href="#cb162-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb162-19"><a href="#cb162-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-20"><a href="#cb162-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Access the overall F-statistic from the model&#39;s summary</span></span>
<span id="cb162-21"><a href="#cb162-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>fstatistic</span>
<span id="cb162-22"><a href="#cb162-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    value    numdf    dendf </span></span>
<span id="cb162-23"><a href="#cb162-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 107.4547   3.0000 416.0000</span></span></code></pre></div>
<p>The entry <tt>value</tt> is the overall <span class="math inline">\(F\)</span>-statistics and it equals the result of <tt>linearHypothesis()</tt>. The <span class="math inline">\(F\)</span>-test rejects the null hypothesis that the model has no power in explaining test scores. It is important to know that the <span class="math inline">\(F\)</span>-statistic reported by <tt>summary</tt> is <em>not</em> robust to heteroskedasticity!</p>
</div>
<div id="confidence-sets-for-multiple-coefficients" class="section level2 hasAnchor" number="7.4">
<h2 class="hasAnchor"><span class="header-section-number">7.4</span> Confidence Sets for Multiple Coefficients<a href="#confidence-sets-for-multiple-coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Based on the <span class="math inline">\(F\)</span>-statistic that we have previously encountered, we can specify confidence sets. Confidence sets are analogous to confidence intervals for single coefficients. As such, confidence sets consist of <em>combinations</em> of coefficients that contain the true combination of coefficients in, say, <span class="math inline">\(95\%\)</span> of all cases if we could repeatedly draw random samples, just like in the univariate case. Put differently, a confidence set is the set of all coefficient combinations for which we cannot reject the corresponding joint null hypothesis tested using an <span class="math inline">\(F\)</span>-test.</p>
<p>The confidence set for two coefficients an ellipse which is centered around the point defined by both coefficient estimates. Again, there is a very convenient way to plot the confidence set for two coefficients of model objects, namely the function <tt>confidenceEllipse()</tt> from the <tt>car</tt> package.</p>
<p>We now plot the <span class="math inline">\(95\%\)</span> confidence ellipse for the coefficients on <tt>size</tt> and <tt>expenditure</tt> from the regression conducted above. By specifying the additional argument <tt>fill</tt>, the confidence set is colored.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># draw the 95% confidence set for coefficients on size and expenditure</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confidenceEllipse</span>(model, </span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> T,</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">lwd =</span> <span class="dv">0</span>,</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">which.coef =</span> <span class="fu">c</span>(<span class="st">&quot;size&quot;</span>, <span class="st">&quot;expenditure&quot;</span>),</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">main =</span> <span class="st">&quot;95% Confidence Set&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-293-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>We see that the ellipse is centered around <span class="math inline">\((-0.29, 3.87)\)</span>, the pair of coefficients estimates on <span class="math inline">\(size\)</span> and <span class="math inline">\(expenditure\)</span>. What is more, <span class="math inline">\((0,0)\)</span> is not element of the <span class="math inline">\(95\%\)</span> confidence set so that we can reject <span class="math inline">\(H_0: \beta_1 = 0, \ \beta_3 = 0\)</span>.</p>
<p>By default, <tt>confidenceEllipse()</tt> uses homoskedasticity-only standard errors. The following code chunk shows how compute a robust confidence ellipse and how to overlay it with the previous plot.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># draw the robust 95% confidence set for coefficients on size and expenditure </span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confidenceEllipse</span>(model, </span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> T,</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">lwd =</span> <span class="dv">0</span>,</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">which.coef =</span> <span class="fu">c</span>(<span class="st">&quot;size&quot;</span>, <span class="st">&quot;expenditure&quot;</span>),</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">main =</span> <span class="st">&quot;95% Confidence Sets&quot;</span>,</span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">vcov. =</span> <span class="fu">vcovHC</span>(model, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>),</span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a><span class="co"># draw the 95% confidence set for coefficients on size and expenditure</span></span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a><span class="fu">confidenceEllipse</span>(model, </span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> T,</span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">lwd =</span> <span class="dv">0</span>,</span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">which.coef =</span> <span class="fu">c</span>(<span class="st">&quot;size&quot;</span>, <span class="st">&quot;expenditure&quot;</span>),</span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">add =</span> T)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-294-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>As the robust standard errors are slightly larger than those valid under homoskedasticity only in this case, the robust confidence set is slightly larger. This is analogous to the confidence intervals for the individual coefficients.</p>
</div>
<div id="model-specification-for-multiple-regression" class="section level2 hasAnchor" number="7.5">
<h2 class="hasAnchor"><span class="header-section-number">7.5</span> Model Specification for Multiple Regression<a href="#model-specification-for-multiple-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Choosing a regression specification, i.e., selecting the variables to be included in a regression model, is a difficult task. However, there are some guidelines on how to proceed. The goal is clear: obtaining an unbiased and precise estimate of the causal effect of interest. As a starting point, think about omitted variables, that is, to avoid possible bias by using suitable control variables. Omitted variables bias in the context of multiple regression is explained in Key Concept 7.3. A second step could be to compare different specifications by measures of fit. However, as we shall see one should not rely solely on <span class="math inline">\(\bar{R}^2\)</span>.</p>
<div id="KC7.3" class="keyconcept">
<h3 class="right">
Key Concept 7.3
</h3>
<h3 class="left">
Omitted Variable Bias in Multiple Regression
</h3>
<p>
<p>Omitted variable bias is the bias in the OLS estimator that arises when regressors correlate with an omitted variable. For omitted variable bias to arise, two things must be true:</p>
<ol style="list-style-type: decimal">
<li>At least one of the included regressors must be correlated with the omitted variable.</li>
<li>The omitted variable must be a determinant of the dependent variable, <span class="math inline">\(Y\)</span>.</li>
</ol>
</p>
</div>
<p>We now discuss an example were we face a potential omitted variable bias in a multiple regression model:</p>
<p>Consider again the estimated regression equation</p>
<p><span class="math display">\[ \widehat{TestScore} = \underset{(8.7)}{686.0} - \underset{(0.43)}{1.10} \times size - \underset{(0.031)}{0.650} \times english. \]</span></p>
<p>We are interested in estimating the causal effect of class size on test score. There might be a bias due to omitting “outside learning opportunities” from our regression since such a measure could be a determinant of the students’ test scores and could also be correlated with both regressors already included in the model (so that both conditions of Key Concept 7.3 are fulfilled). “Outside learning opportunities” are a complicated concept that is difficult to quantify. A surrogate we can consider instead is the students’ economic background which likely are strongly related to outside learning opportunities: think of wealthy parents that are able to provide time and/or money for private tuition of their children. We thus augment the model with the variable <tt>lunch</tt>, the percentage of students that qualify for a free or subsidized lunch in school due to family incomes below a certain threshold, and reestimate the model.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model and print the summary to console</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> size <span class="sc">+</span> english <span class="sc">+</span> lunch, <span class="at">data =</span> CASchools)</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(model, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error  t value  Pr(&gt;|t|)    </span></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 700.149957   5.568453 125.7351 &lt; 2.2e-16 ***</span></span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; size         -0.998309   0.270080  -3.6963 0.0002480 ***</span></span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; english      -0.121573   0.032832  -3.7029 0.0002418 ***</span></span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lunch        -0.547345   0.024107 -22.7046 &lt; 2.2e-16 ***</span></span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Thus, the estimated regression line is</p>
<p><span class="math display">\[ \widehat{TestScore} = \underset{(5.56)}{700.15} - \underset{(0.27)}{1.00} \times size - \underset{(0.03)}{0.12} \times english - \underset{(0.02)}{0.55} \times lunch. \]</span></p>
<p>We observe no substantial changes in the conclusion about the effect of <span class="math inline">\(size\)</span> on <span class="math inline">\(TestScore\)</span>: the coefficient on <span class="math inline">\(size\)</span> changes by only <span class="math inline">\(0.1\)</span> and retains its significance.</p>
<p>Although the difference in estimated coefficients is not big in this case, it is useful to keep <tt>lunch</tt> to make the assumption of conditional mean independence more credible (see Chapter 7.5 of the book).</p>
<div id="model-specification-in-theory-and-in-practice" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Model Specification in Theory and in Practice<a href="#model-specification-in-theory-and-in-practice" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Key Concept 7.4 lists some common pitfalls when using <span class="math inline">\(R^2\)</span> and <span class="math inline">\(\bar{R}^2\)</span> to evaluate the predictive ability of regression models.</p>
<div id="KC7.4" class="keyconcept">
<h3 class="right">
Key Concept 7.4
</h3>
<h3 class="left">
<span class="math inline">\(R^2\)</span> and <span class="math inline">\(\bar{R}^2\)</span>: what they tell you — and what they do not
</h3>
<p>
<p>The <span class="math inline">\(R^2\)</span> and <span class="math inline">\(\bar{R}^2\)</span> tell you whether the regressors are good at explaining the variation of the independent variable in the sample. If the <span class="math inline">\(R^2\)</span> (or <span class="math inline">\(\bar{R}^2\)</span>) is nearly <span class="math inline">\(1\)</span>, then the regressors produce a good prediction of the dependent variable in that sample, in the sense that the variance of OLS residuals is small compared to the variance of the dependent variable. If the <span class="math inline">\(R^2\)</span> (or <span class="math inline">\(\bar{R}^2\)</span>) is nearly <span class="math inline">\(0\)</span>, the opposite is true.</p>
<p>The <span class="math inline">\(R^2\)</span> and <span class="math inline">\(\bar{R}^2\)</span> do <em>not</em> tell you whether:</p>
<ol style="list-style-type: decimal">
<li>An included variable is statistically significant.</li>
<li>The regressors are the true cause of the movements in the dependent variable.</li>
<li>There is omitted variable bias.</li>
<li>You have chosen the most appropriate set of regressors.</li>
</ol>
</p>
</div>
<p>For example, think of regressing <span class="math inline">\(TestScore\)</span> on <span class="math inline">\(PLS\)</span> which measures the available parking lot space in thousand square feet. You are likely to observe a significant coefficient of reasonable magnitude and moderate to high values for <span class="math inline">\(R^2\)</span> and <span class="math inline">\(\bar{R}^2\)</span>. The reason for this is that parking lot space is correlated with many determinants of the test score like location, class size, financial endowment and so on. Although we do not have observations on <span class="math inline">\(PLS\)</span>, we can use <tt>R</tt> to generate some relatively realistic data.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for reproducibility</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a><span class="co"># generate observations for parking lot space</span></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>CASchools<span class="sc">$</span>PLS <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">22</span> <span class="sc">*</span> CASchools<span class="sc">$</span>income </span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>                   <span class="sc">-</span> <span class="dv">15</span> <span class="sc">*</span> CASchools<span class="sc">$</span>size </span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>                   <span class="sc">+</span> <span class="fl">0.2</span> <span class="sc">*</span> CASchools<span class="sc">$</span>expenditure</span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a>                   <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(CASchools), <span class="at">sd =</span> <span class="dv">80</span>) <span class="sc">+</span> <span class="dv">3000</span>)</span></code></pre></div>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot parking lot space against test score</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(CASchools<span class="sc">$</span>PLS, </span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>     CASchools<span class="sc">$</span>score,</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Parking Lot Space&quot;</span>,</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Test Score&quot;</span>,</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-301-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="co"># regress test score on PLS</span></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(score <span class="sc">~</span> PLS, <span class="at">data =</span> CASchools))</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = score ~ PLS, data = CASchools)</span></span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -42.608 -11.049   0.342  12.558  37.105 </span></span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb168-14"><a href="#cb168-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 4.897e+02  1.227e+01   39.90   &lt;2e-16 ***</span></span>
<span id="cb168-15"><a href="#cb168-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PLS         4.002e-02  2.981e-03   13.43   &lt;2e-16 ***</span></span>
<span id="cb168-16"><a href="#cb168-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb168-17"><a href="#cb168-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb168-18"><a href="#cb168-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb168-19"><a href="#cb168-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 15.95 on 418 degrees of freedom</span></span>
<span id="cb168-20"><a href="#cb168-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.3013, Adjusted R-squared:  0.2996 </span></span>
<span id="cb168-21"><a href="#cb168-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 180.2 on 1 and 418 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p><span class="math inline">\(PLS\)</span> is generated as a linear function of <span class="math inline">\(expenditure\)</span>, <span class="math inline">\(income\)</span>, <span class="math inline">\(size\)</span> and a random disturbance. Therefore the data suggest that there is some positive relationship between parking lot space and test score. In fact, when estimating the model
<span class="math display">\[\begin{align}
TestScore = \beta_0 + \beta_1 \times PLS + u (\#eq:plsmod)
\end{align}\]</span>
using <tt>lm()</tt> we find that the coefficient on <span class="math inline">\(PLS\)</span> is positive and significantly different from zero. Also <span class="math inline">\(R^2\)</span> and <span class="math inline">\(\bar{R}^2\)</span> are about <span class="math inline">\(0.3\)</span> which is a lot more than the roughly <span class="math inline">\(0.05\)</span> observed when regressing the test scores on the class sizes only. This suggests that increasing the parking lot space boosts a school’s test scores and that model @ref(eq:plsmod) does even better in explaining heterogeneity in the dependent variable than a model with <span class="math inline">\(size\)</span> as the only regressor. Keeping in mind how <span class="math inline">\(PLS\)</span> is constructed this comes as no surprise. It is evident that the high <span class="math inline">\(R^2\)</span> <it>cannot</it> be used to the conclude that the estimated relation between parking lot space and test scores is causal: the (relatively) high <span class="math inline">\(R^2\)</span> is due to correlation between <span class="math inline">\(PLS\)</span> and other determinants and/or control variables. Increasing parking lot space is <em>not</em> an appropriate measure to generate more learning success!</p>
</div>
</div>
<div id="analysis-of-the-test-score-data-set" class="section level2 hasAnchor" number="7.6">
<h2 class="hasAnchor"><span class="header-section-number">7.6</span> Analysis of the Test Score Data Set<a href="#analysis-of-the-test-score-data-set" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Chapter @ref(rmwmr) and some of the previous sections have stressed that it is important to include control variables in regression models if it is plausible that there are omitted factors. In our example of test scores we want to estimate the causal effect of a change in the student-teacher ratio on test scores. We now provide an example how to use multiple regression in order to alleviate omitted variable bias and demonstrate how to report results using <tt>R</tt>.</p>
<p>So far we have considered two variables that control for unobservable student characteristics which correlate with the student-teacher ratio <em>and</em> are assumed to have an impact on test scores:</p>
<ul>
<li><p><span class="math inline">\(English\)</span>, the percentage of English learning students</p></li>
<li><p><span class="math inline">\(lunch\)</span>, the share of students that qualify for a subsidized or even a free lunch at school</p></li>
</ul>
<p>Another new variable provided with <tt>CASchools</tt> is <tt>calworks</tt>, the percentage of students that qualify for the <em>CalWorks</em> income assistance program. Students eligible for <em>CalWorks</em> live in families with a total income below the threshold for the subsidized lunch program so both variables are indicators for the share of economically disadvantaged children. Both indicators are highly correlated:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the correlation between &#39;calworks&#39; and &#39;lunch&#39;</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(CASchools<span class="sc">$</span>calworks, CASchools<span class="sc">$</span>lunch)</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.7394218</span></span></code></pre></div>
<p>There is no unambiguous way to proceed when deciding which variable to use. In any case it may not a good idea to use both variables as regressors in view of collinearity. Therefore, we also consider alternative model specifications.</p>
<p>For a start, we plot student characteristics against test scores.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up arrangement of plots</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">0</span>))</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>graphics<span class="sc">::</span><span class="fu">layout</span>(<span class="at">mat =</span> m)</span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a><span class="co"># scatterplots</span></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(score <span class="sc">~</span> english, </span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> CASchools, </span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, </span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.main =</span> <span class="fl">0.9</span>,</span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Percentage of English language learners&quot;</span>)</span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-14"><a href="#cb170-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(score <span class="sc">~</span> lunch, </span>
<span id="cb170-15"><a href="#cb170-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> CASchools, </span>
<span id="cb170-16"><a href="#cb170-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb170-17"><a href="#cb170-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb170-18"><a href="#cb170-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.main =</span> <span class="fl">0.9</span>,</span>
<span id="cb170-19"><a href="#cb170-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Percentage qualifying for reduced price lunch&quot;</span>)</span>
<span id="cb170-20"><a href="#cb170-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-21"><a href="#cb170-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(score <span class="sc">~</span> calworks, </span>
<span id="cb170-22"><a href="#cb170-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> CASchools, </span>
<span id="cb170-23"><a href="#cb170-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb170-24"><a href="#cb170-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, </span>
<span id="cb170-25"><a href="#cb170-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb170-26"><a href="#cb170-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.main =</span> <span class="fl">0.9</span>,</span>
<span id="cb170-27"><a href="#cb170-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Percentage qualifying for income assistance&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-303-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>We divide the plotting area up using <tt>layout()</tt>. The matrix <tt>m</tt> specifies the location of the plots, see <code>?layout</code>.</p>
<p>We see that all relationships are negative. Here are the correlation coefficients.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate correlation between student characteristics and test scores</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(CASchools<span class="sc">$</span>score, CASchools<span class="sc">$</span>english)</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -0.6441238</span></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(CASchools<span class="sc">$</span>score, CASchools<span class="sc">$</span>lunch)</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -0.868772</span></span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(CASchools<span class="sc">$</span>score, CASchools<span class="sc">$</span>calworks)</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -0.6268533</span></span></code></pre></div>
<p>We shall consider five different model equations:</p>
<p><span class="math display">\[\begin{align*}
  (I) \quad TestScore=&amp; \, \beta_0 + \beta_1 \times size + u, \\
  (II) \quad TestScore=&amp; \, \beta_0 + \beta_1 \times size + \beta_2 \times english + u, \\
  (III) \quad TestScore=&amp; \, \beta_0 + \beta_1 \times size + \beta_2 \times english + \beta_3 \times lunch + u, \\
  (IV) \quad TestScore=&amp; \, \beta_0 + \beta_1 \times size + \beta_2 \times english + \beta_4 \times calworks + u, \\
  (V) \quad TestScore=&amp; \, \beta_0 + \beta_1 \times size + \beta_2 \times english + \beta_3 \times lunch + \beta_4 \times calworks + u
\end{align*}\]</span></p>
<p>The best way to communicate regression results is in a table. The <tt>stargazer</tt> package is very convenient for this purpose. It provides a function that generates professionally looking HTML and LaTeX tables that satisfy scientific standards. One simply has to provide one or multiple object(s) of class <tt>lm</tt>. The rest is done by the function <tt>stargazer()</tt>.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the stargazer library</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate different model specifications</span></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>spec1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> size, <span class="at">data =</span> CASchools)</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>spec2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> size <span class="sc">+</span> english, <span class="at">data =</span> CASchools)</span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>spec3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> size <span class="sc">+</span> english <span class="sc">+</span> lunch, <span class="at">data =</span> CASchools)</span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a>spec4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> size <span class="sc">+</span> english <span class="sc">+</span> calworks, <span class="at">data =</span> CASchools)</span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a>spec5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> size <span class="sc">+</span> english <span class="sc">+</span> lunch <span class="sc">+</span> calworks, <span class="at">data =</span> CASchools)</span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-11"><a href="#cb172-11" aria-hidden="true" tabindex="-1"></a><span class="co"># gather robust standard errors in a list</span></span>
<span id="cb172-12"><a href="#cb172-12" aria-hidden="true" tabindex="-1"></a>rob_se <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(spec1, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb172-13"><a href="#cb172-13" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(spec2, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb172-14"><a href="#cb172-14" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(spec3, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb172-15"><a href="#cb172-15" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(spec4, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb172-16"><a href="#cb172-16" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(spec5, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))))</span>
<span id="cb172-17"><a href="#cb172-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-18"><a href="#cb172-18" aria-hidden="true" tabindex="-1"></a><span class="co"># generate a LaTeX table using stargazer</span></span>
<span id="cb172-19"><a href="#cb172-19" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(spec1, spec2, spec3, spec4, spec5,</span>
<span id="cb172-20"><a href="#cb172-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">se =</span> rob_se,</span>
<span id="cb172-21"><a href="#cb172-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb172-22"><a href="#cb172-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">header =</span> F,</span>
<span id="cb172-23"><a href="#cb172-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">column.labels =</span> <span class="fu">c</span>(<span class="st">&quot;(I)&quot;</span>, <span class="st">&quot;(II)&quot;</span>, <span class="st">&quot;(III)&quot;</span>, <span class="st">&quot;(IV)&quot;</span>, <span class="st">&quot;(V)&quot;</span>))</span></code></pre></div>



<table style="text-align:center"><tr><td colspan="6" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"></td><td colspan="5">Dependent Variable: Test Score</td></tr>
<tr><td></td><td colspan="5" style="border-bottom: 1px solid black"></td></tr>
<tr><td style="text-align:left"></td><td colspan="5">score</td></tr>
<tr><td style="text-align:left"></td><td>(I)</td><td>(II)</td><td>(III)</td><td>(IV)</td><td>(V)</td></tr>
<tr><td style="text-align:left"></td><td>spec1</td><td>spec2</td><td>spec3</td><td>spec4</td><td>spec5</td></tr>
<tr><td colspan="6" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">size</td><td>-2.280<sup>***</sup></td><td>-1.101<sup>**</sup></td><td>-0.998<sup>***</sup></td><td>-1.308<sup>***</sup></td><td>-1.014<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.519)</td><td>(0.433)</td><td>(0.270)</td><td>(0.339)</td><td>(0.269)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">english</td><td></td><td>-0.650<sup>***</sup></td><td>-0.122<sup>***</sup></td><td>-0.488<sup>***</sup></td><td>-0.130<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(0.031)</td><td>(0.033)</td><td>(0.030)</td><td>(0.036)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">lunch</td><td></td><td></td><td>-0.547<sup>***</sup></td><td></td><td>-0.529<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td>(0.024)</td><td></td><td>(0.038)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">calworks</td><td></td><td></td><td></td><td>-0.790<sup>***</sup></td><td>-0.048</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td>(0.068)</td><td>(0.059)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">Constant</td><td>698.933<sup>***</sup></td><td>686.032<sup>***</sup></td><td>700.150<sup>***</sup></td><td>697.999<sup>***</sup></td><td>700.392<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(10.364)</td><td>(8.728)</td><td>(5.568)</td><td>(6.920)</td><td>(5.537)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td colspan="6" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">Observations</td><td>420</td><td>420</td><td>420</td><td>420</td><td>420</td></tr>
<tr><td style="text-align:left">R<sup>2</sup></td><td>0.051</td><td>0.426</td><td>0.775</td><td>0.629</td><td>0.775</td></tr>
<tr><td style="text-align:left">Adjusted R<sup>2</sup></td><td>0.049</td><td>0.424</td><td>0.773</td><td>0.626</td><td>0.773</td></tr>
<tr><td style="text-align:left">Residual Std. Error</td><td>18.581 (df = 418)</td><td>14.464 (df = 417)</td><td>9.080 (df = 416)</td><td>11.654 (df = 416)</td><td>9.084 (df = 415)</td></tr>
<tr><td style="text-align:left">F Statistic</td><td>22.575<sup>***</sup> (df = 1; 418)</td><td>155.014<sup>***</sup> (df = 2; 417)</td><td>476.306<sup>***</sup> (df = 3; 416)</td><td>234.638<sup>***</sup> (df = 3; 416)</td><td>357.054<sup>***</sup> (df = 4; 415)</td></tr>
<tr><td colspan="6" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"><em>Note:</em></td><td colspan="5" style="text-align:right"><sup>*</sup>p<0.1; <sup>**</sup>p<0.05; <sup>***</sup>p<0.01</td></tr>
</table>
<caption><p style='text-align:center'>(#tab:rotsostracv) Regressions of Test Scores on the Student-Teacher Ratio and Control Variables</p></caption>


<p>Table @ref(tab:rotsostracv) states that <span class="math inline">\(score\)</span> is the dependent variable and that we consider five models. We see that the columns of Table @ref(tab:rotsostracv) contain most of the information provided by <tt>coeftest()</tt> and <tt>summary()</tt> for the regression models under consideration: the coefficients estimates equipped with significance codes (the asterisks) and standard errors in parentheses below. Although there are no <span class="math inline">\(t\)</span>-statistics, it is straightforward for the reader to compute them simply by dividing a coefficient estimate by the corresponding standard error. The bottom of the table reports summary statistics for each model and a legend. For an in-depth discussion of the tabular presentation of regression results, see Chapter 7.6 of the book.</p>
<p>What can we conclude from the model comparison?</p>
<ol style="list-style-type: decimal">
<li><p>We see that adding control variables roughly halves the coefficient on <tt>size</tt>. Also, the estimate is not sensitive to the set of control variables used. The conclusion is that decreasing the student-teacher ratio ceteris paribus by one unit leads to an estimated average increase in test scores of about <span class="math inline">\(1\)</span> point.</p></li>
<li><p>Adding student characteristics as controls increases <span class="math inline">\(R^2\)</span> and <span class="math inline">\(\bar{R}^2\)</span> from <span class="math inline">\(0.049\)</span> (<tt>spec1</tt>) up to <span class="math inline">\(0.773\)</span> (<tt>spec3</tt> and <tt>spec5</tt>), so we can consider these variables as suitable predictors for test scores. Moreover, the estimated coefficients on all control variables are consistent with the impressions gained from Figure 7.2 of the book.</p></li>
<li><p>We see that the control variables are not statistically significant in all models. For example in <tt>spec5</tt>, the coefficient on <span class="math inline">\(calworks\)</span> is not significantly different from zero at <span class="math inline">\(5\%\)</span> since <span class="math inline">\(\lvert-0.048/0.059\rvert=0.81 &lt; 1.64\)</span>. We also observe that the effect on the estimate (and its standard error) of the coefficient on <span class="math inline">\(size\)</span> of adding <span class="math inline">\(calworks\)</span> to the base specification <tt>spec3</tt> is negligible. We can therefore consider <tt>calworks</tt> as a superfluous control variable, given the inclusion of <tt>lunch</tt> in this model.</p></li>
</ol>
</div>
<div id="exercises-7" class="section level2 hasAnchor" number="7.7">
<h2 class="hasAnchor"><span class="header-section-number">7.7</span> Exercises<a href="#exercises-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="hypothesis-testing-in-a-multiple-regression-model-t-statistics-and-p-values" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">1. Hypothesis Testing in a Multiple Regression Model — <span class="math inline">\(t\)</span>-statistics and <span class="math inline">\(p\)</span>-values<a href="#hypothesis-testing-in-a-multiple-regression-model-t-statistics-and-p-values" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Reconsider the <tt>Boston</tt> data set and the following estimated model (homoscedasticity-only standard errors in parentheses) from the previous chapter:</p>
<p><span class="math display">\[\widehat{medv}_i = \underset{(0.75)}{32.828} -\underset{(0.05)}{0.994} \times lstat_i -\underset{(0.04)}{0.083} \times crim_i + \underset{(0.01)}{0.038} \times age_i.\]</span></p>
<p>Just as in the simple linear regression framework we can conduct hypothesis tests about the coefficients in multiple regression models. The most common hypothesis is <span class="math inline">\(H_0:\beta_j=0\)</span> against the alternative <span class="math inline">\(H_1:\beta_j\ne 0\)</span> for some <span class="math inline">\(j\)</span> in <span class="math inline">\(0,1,\dots,k\)</span>.</p>
<p>The packages <tt>AER</tt> and <tt>MASS</tt> have been loaded. The coefficient estimates as well as the corresponding standard errors are available in <tt>coefs</tt> and <tt>SEs</tt>, respectively.</p>
<p><strong>Instructions:</strong></p>
<p>Use vector arithmetics to solve the following tasks:</p>
<ul>
<li><p>Compute <span class="math inline">\(t\)</span>-statistics for each coefficient by using the predefined objects <tt>coefs</tt> and <tt>SEs</tt>. Assign them to <tt>tstats</tt>.</p></li>
<li><p>Compute <span class="math inline">\(p\)</span>-values for each coefficient and assign them to <tt>pval</tt>.</p></li>
<li><p>Check with the help of logical operators whether the hypotheses are rejected at the <span class="math inline">\(1\%\)</span> significance level.</p></li>
</ul>
<iframe src="DCL/ex7_1.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>The <span class="math inline">\(t\)</span>-statistic for each coefficient is defined as <span class="math inline">\(t=\frac{\widehat{\beta}_j-\beta_{j,0}}{SE(\widehat{\beta}_j)}\)</span>.</p></li>
<li><p>The <span class="math inline">\(p\)</span>-value for a two-sided test using is computed as <span class="math inline">\(2\cdot\Phi(-|t^{act}|)\)</span> where <span class="math inline">\(t^{act}\)</span> denotes the computed <span class="math inline">\(t\)</span>-statistic.</p></li>
</ul>
</div>
<div id="hypothesis-testing-in-a-multiple-regression-model---confidence-intervals" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">2. Hypothesis Testing in a Multiple Regression Model - Confidence Intervals<a href="#hypothesis-testing-in-a-multiple-regression-model---confidence-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider again the estimated model</p>
<p><span class="math display">\[\widehat{medv}_i = \underset{(0.75)}{32.828} -\underset{(0.05)}{0.994} \times lstat_i -\underset{(0.04)}{0.083} \times crim_i + \underset{(0.01)}{0.038} \times age_i.\]</span></p>
<p>which is available as the object <tt>mod</tt> in your working environment. The packages <tt>AER</tt> and <tt>MASS</tt> have been loaded.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Construct <span class="math inline">\(99\%\)</span> confidence intervals for all model coefficients. Use the intervals to decide whether the individual null hypotheses <span class="math inline">\(H_0:\beta_j=0\)</span>, <span class="math inline">\(j=0,1,2,3,4\)</span> are rejected at the <span class="math inline">\(1\%\)</span> level.</li>
</ul>
<iframe src="DCL/ex7_2.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hint:</strong></p>
<ul>
<li>You may use <tt>confint()</tt> to construct confidence intervals. The confidence level can be set via the argument <tt>level</tt>.</li>
</ul>
</div>
<div id="robust-hypothesis-testing-in-multiple-regression-models" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">3. Robust Hypothesis Testing in Multiple Regression Models<a href="#robust-hypothesis-testing-in-multiple-regression-models" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <tt>lm</tt> object <tt>mod</tt> from the previous exercises is available in your working environment. The packages <tt>AER</tt> and <tt>MASS</tt> have been loaded.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Print a coefficient summary that reports heteroscedasticity-robust standard errors.</p></li>
<li><p>Access entries of the matrix generated by <tt>coeftest()</tt> to check whether the hypotheses are rejected at a 1% significance level. Use logical operators <tt>&lt;,&gt;</tt>.</p></li>
</ul>
<iframe src="DCL/ex7_3.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>Using the argument <tt>vcov.</tt> in <tt>coeftest()</tt> forces the function to use robust standard errors.</p></li>
<li><p>The <span class="math inline">\(p\)</span>-values are contained in the fourth column of the output generated by <tt>coeftest()</tt>. Use square brackets to subset the matrix accordingly.</p></li>
</ul>
</div>
<div id="joint-hypothesis-testing-f-test-i" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">4. Joint Hypothesis Testing — <span class="math inline">\(F\)</span>-Test I<a href="#joint-hypothesis-testing-f-test-i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Sometimes we are interested in testing joint hypotheses which impose restrictions on <em>multiple</em> regression coefficients. For example, in the model</p>
<p><span class="math display">\[medv_i = \beta_0 + \beta_1\times lstat_i + \beta_2\times crim_i + \beta_3\times age_i + u_i\]</span></p>
<p>we may test the null <span class="math inline">\(H_0: \beta_2=\beta_3\)</span> vs. the alternative <span class="math inline">\(H_1: \beta_2\ne\beta_3\)</span> (which is a joint hypothesis as we impose a restriction on <em>two</em> regression coefficients).</p>
<p>The basic idea behind testing such a hypothesis is to conduct two regressions and to compare the outcomes: for one of the regressions we impose the restrictions of formalized by the null (we call this the restricted regression model), whereas for the other regression the restriction is left out (we call this the unrestricted model). From this starting point we construct a test-statistic which, under the null, follows a well known distribution, an <span class="math inline">\(F\)</span> distribution (see the next exercise).</p>
<p>However, in this exercise we start with the initial computations necessary to construct the test statistic.</p>
<p>The packages <tt>AER</tt> and <tt>MASS</tt> have been loaded.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Estimate the restricted model, that is, the model where the restriction formalized by <span class="math inline">\(H_0: \beta_2=\beta_3\)</span> is assumed to be true. Save the model in <tt>model_res</tt>.</p></li>
<li><p>Compute the <span class="math inline">\(SSR\)</span> of the restricted model and assign it to <tt>RSSR</tt>.</p></li>
<li><p>Estimate the unrestricted model, that is, the model where the restriction is assumed to be false. Save it in <tt>model_unres</tt>.</p></li>
<li><p>Compute the <span class="math inline">\(SSR\)</span> of the unrestricted model and assign it to <tt>USSR</tt>.</p></li>
</ul>
<iframe src="DCL/ex7_4.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>The restricted model can be written as <span class="math display">\[medv_i = \beta_0 + \beta_1\times lstat_i + \beta_2\times crim_i + \beta_2\times age_i + u_i\]</span> which, after rearranging, can be expressed as <span class="math display">\[medv_i = \beta_0 + \beta_1\times lstat_i + \beta_2\times(crim_i+age_i) + u_i.\]</span></p></li>
<li><p>The <span class="math inline">\(SSR\)</span> is defined as the sum of the squared residuals.</p></li>
<li><p>Note that the residuals of a regression model are available as <tt>residuals</tt> in the corresponding <tt>lm</tt> object. So you can access them as usual via the <tt>$</tt>-operator.</p></li>
</ul>
</div>
<div id="joint-hypothesis-testing-f-test-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">5. Joint Hypothesis Testing — F-Test II<a href="#joint-hypothesis-testing-f-test-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>After estimating the models and computing the <span class="math inline">\(SSR\)</span>s you now have to compute the test-statistic and conduct the <span class="math inline">\(F\)</span>-test. As mentioned in the last exercise, the test-statistic follows an <span class="math inline">\(F\)</span> distribution. More precisely, we deal with the <span class="math inline">\(F_{q,n-k-1}\)</span> distribution where <span class="math inline">\(q\)</span> denotes the number of restrictions under the null and <span class="math inline">\(k\)</span> is the of regressors in the unrestricted model, excluding the intercept.</p>
<p>The packages <tt>AER</tt> and <tt>MASS</tt> have been loaded. Both models (<tt>model_res</tt> and <tt>model_unres</tt>) as well as their SSR (<tt>RSSR</tt> and <tt>USSR</tt>) are available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Compute the <span class="math inline">\(F\)</span>-statistic and assign it to <tt>Fstat</tt>.</p></li>
<li><p>Compute the <span class="math inline">\(p\)</span>-value and assign it to <tt>pval</tt>.</p></li>
<li><p>Check whether the null is rejected at the <span class="math inline">\(1\%\)</span> level using logical operators.</p></li>
<li><p>Verify your result by using <tt>linearHypothesis()</tt> and printing the results.</p></li>
</ul>
<iframe src="DCL/ex7_5.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>The <span class="math inline">\(F\)</span>-statistic is defined as <span class="math inline">\(\frac{RSSR-USSR/q}{USSR/(n-k-1)}\)</span>.</p></li>
<li><p>The <span class="math inline">\(p\)</span>-value can be computed as <span class="math inline">\(1-F_{q,n-k-1}(F^{act})\)</span> where <span class="math inline">\(F_{q,n-k-1}\)</span> denotes the CDF of the <span class="math inline">\(F\)</span>-distribution (<tt>pf()</tt>) with degrees of freedom <span class="math inline">\(q\)</span> and <span class="math inline">\(n-k-1\)</span> and <span class="math inline">\(F^{act}\)</span> the computed <span class="math inline">\(F\)</span>-statistic.</p></li>
<li><p><tt>linearHypothesis()</tt> expects the unrestricted model as well as the null hypothesis as arguments.</p></li>
</ul>
</div>
<div id="joint-hypothesis-testing---confidence-set" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">6. Joint Hypothesis Testing - Confidence Set<a href="#joint-hypothesis-testing---confidence-set" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As you know from previous chapters constructing a confidence set for a single regression coefficient results in a simple confidence interval on the real line. However if we consider <span class="math inline">\(n\)</span> regression coefficients jointly (as we do in a joint hypothesis testing setting) we move from <span class="math inline">\(\mathbb{R}\)</span> to <span class="math inline">\(\mathbb{R}^n\)</span> resulting in a n-dimensional confidence set. For the sake of illustration we then often choose <span class="math inline">\(n=2\)</span>, so that we end up with a representable two-dimensional plane.</p>
<p>Recall the estimated model</p>
<p><span class="math display">\[\widehat{medv}_i = \underset{(0.75)}{32.828} -\underset{(0.05)}{0.994} \times lstat_i -\underset{(0.04)}{0.083} \times crim_i + \underset{(0.01)}{0.038} \times age_i.\]</span></p>
<p>which is available as <tt>mod</tt> in your working environment. Assume you want to test the null <span class="math inline">\(H_0: \beta_2=\beta_3=0\)</span> vs. <span class="math inline">\(H_1: \beta_2\ne 0\)</span> or <span class="math inline">\(\beta_3\ne 0\)</span>.</p>
<p>The packages <tt>AER</tt> and <tt>MASS</tt> have been loaded.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Construct a <span class="math inline">\(99\%\)</span> confidence set for the coefficients of <tt>crim</tt> and <tt>lstat</tt>, that is a two-dimensional confidence set. Can you reject the null stated above?</p></li>
<li><p>Verify your visual inspection by conducting a corresponding <span class="math inline">\(F\)</span>-test.</p></li>
</ul>
<iframe src="DCL/ex7_6.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>Use <tt>confidenceEllipse()</tt> to construct a two-dimensional confidence set. Besides the coefficients for which the confidence set shall be constructed (<tt>which.coef</tt>), you have to specify the confidence level (<tt>levels</tt>).</p></li>
<li><p>As usual you can use <tt>linearHypothesis()</tt> to conduct the <span class="math inline">\(F\)</span>-test. Note that there are two restrictions now, hence you have to pass a vector containing both restrictions.</p></li>
</ul>
</div>
<!--chapter:end:07-ch7.Rmd-->
</div>
</div>
<div id="nrf" class="section level1 hasAnchor" number="8">
<h1 class="hasAnchor"><span class="header-section-number">8</span> Nonlinear Regression Functions<a href="#nrf" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Until now we assumed the regression function to be linear, i.e., we have treated the slope parameter of the regression function as a constant. This implies that the effect on <span class="math inline">\(Y\)</span> of a one unit change in <span class="math inline">\(X\)</span> does not depend on the level of <span class="math inline">\(X\)</span>. If, however, the effect of a change in <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> does depend on the value of <span class="math inline">\(X\)</span>, we should use a nonlinear regression function.</p>
<p>Just like for the previous chapter, the packages <tt>AER</tt> <span class="citation">(<a href="#ref-R-AER" role="doc-biblioref">Christian Kleiber and Zeileis 2022</a>)</span> and <tt>stargazer</tt> <span class="citation">(<a href="#ref-R-stargazer" role="doc-biblioref">Hlavac 2022</a>)</span> are required for reproduction of the code presented in this chapter. Check whether the code chunk below executes without any error messages.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span></code></pre></div>
<div id="a-general-strategy-for-modelling-nonlinear-regression-functions" class="section level2 hasAnchor" number="8.1">
<h2 class="hasAnchor"><span class="header-section-number">8.1</span> A General Strategy for Modelling Nonlinear Regression Functions<a href="#a-general-strategy-for-modelling-nonlinear-regression-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let us have a look at an example where using a nonlinear regression function is better suited for estimating the population relationship between the regressor, <span class="math inline">\(X\)</span>, and the regressand, <span class="math inline">\(Y\)</span>: the relationship between the income of schooling districts and their test scores.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare the data</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)                                                     </span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(CASchools)</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>CASchools<span class="sc">$</span>size <span class="ot">&lt;-</span> CASchools<span class="sc">$</span>students<span class="sc">/</span>CASchools<span class="sc">$</span>teachers</span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>CASchools<span class="sc">$</span>score <span class="ot">&lt;-</span> (CASchools<span class="sc">$</span>read <span class="sc">+</span> CASchools<span class="sc">$</span>math) <span class="sc">/</span> <span class="dv">2</span>       </span></code></pre></div>
<p>We start our analysis by computing the correlation between both variables.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(CASchools<span class="sc">$</span>income, CASchools<span class="sc">$</span>score)</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.7124308</span></span></code></pre></div>
<p>Here, income and test scores are positively related: school districts with above average income tend to achieve above average test scores. Does a linear regression function model the data adequately? Let us plot the data and add a linear regression line.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit a simple linear model</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>linear_model<span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> income, <span class="at">data =</span> CASchools)</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the observations</span></span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(CASchools<span class="sc">$</span>income, CASchools<span class="sc">$</span>score,</span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;District Income (thousands of dollars)&quot;</span>, </span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Test Score&quot;</span>,</span>
<span id="cb176-10"><a href="#cb176-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.main =</span> <span class="fl">0.9</span>,</span>
<span id="cb176-11"><a href="#cb176-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Test Score vs. District Income and a Linear OLS Regression Function&quot;</span>)</span>
<span id="cb176-12"><a href="#cb176-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-13"><a href="#cb176-13" aria-hidden="true" tabindex="-1"></a><span class="co"># add the regression line to the plot</span></span>
<span id="cb176-14"><a href="#cb176-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(linear_model, </span>
<span id="cb176-15"><a href="#cb176-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb176-16"><a href="#cb176-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-316-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>As pointed out in the book, the linear regression line seems to overestimate the true relationship when income is very high or very low and underestimates it for the middle income group.</p>
<p>Fortunately, OLS does not only handle linear functions of the regressors. We can for example model test scores as a function of income and the square of income. The corresponding regression model is</p>
<p><span class="math display">\[TestScore_i = \beta_0 + \beta_1 \times income_i + \beta_2 \times income_i^2 + u_i,\]</span> called a <em>quadratic regression model</em>. That is, <span class="math inline">\(income^2\)</span> is treated as an additional explanatory variable. Hence, the quadratic model is a special case of a multivariate regression model. When fitting the model with <tt>lm()</tt> we have to use the <tt>^</tt> operator in conjunction with the function <tt>I()</tt> to add the quadratic term as an additional regressor to the argument <tt>formula</tt>. This is because the regression formula we pass to <tt>formula</tt> is converted to an object of the class <tt>formula</tt>. For objects of this class, the operators <tt>+</tt>, <tt>-</tt>, <tt>*</tt> and <tt>^</tt> have a nonarithmetic interpretation. <tt>I()</tt> ensures that they are used as arithmetical operators, see <tt>?I</tt>,</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the quadratic Model</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>quadratic_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> income <span class="sc">+</span> <span class="fu">I</span>(income<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> CASchools)</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain the model summary</span></span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(quadratic_model, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                Estimate  Std. Error  t value  Pr(&gt;|t|)    </span></span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 607.3017435   2.9017544 209.2878 &lt; 2.2e-16 ***</span></span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; income        3.8509939   0.2680942  14.3643 &lt; 2.2e-16 ***</span></span>
<span id="cb177-12"><a href="#cb177-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I(income^2)  -0.0423084   0.0047803  -8.8505 &lt; 2.2e-16 ***</span></span>
<span id="cb177-13"><a href="#cb177-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb177-14"><a href="#cb177-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The output tells us that the estimated regression function is</p>
<p><span class="math display">\[\widehat{TestScore}_i = \underset{(2.90)}{607.3} + \underset{(0.27)}{3.85} \times income_i - \underset{(0.0048)}{0.0423} \times income_i^2.\]</span></p>
<p>This model allows us to test the hypothesis that the relationship between test scores and district income is linear against the alternative that it is quadratic. This corresponds to testing</p>
<p><span class="math display">\[H_0: \beta_2 = 0 \ \ \text{vs.} \ \  H_1: \beta_2\neq0,\]</span></p>
<p>since <span class="math inline">\(\beta_2=0\)</span> corresponds to a simple linear equation and <span class="math inline">\(\beta_2\neq0\)</span> implies a quadratic relationship. We find that <span class="math inline">\(t=(\hat\beta_2 - 0)/SE(\hat\beta_2) = -0.0423/0.0048 = -8.81\)</span> so the null is rejected at any common level of significance and we conclude that the relationship is nonlinear. This is consistent with the impression gained from the plot.</p>
<p>We now draw the same scatter plot as for the linear model and add the regression line for the quadratic model. Because <tt>abline()</tt> can only draw straight lines, it cannot be used here. <tt>lines()</tt> is a function which allows to draw nonstraight lines, see <code>?lines</code>. The most basic call of <tt>lines()</tt> is <tt>lines(x_values, y_values)</tt> where <tt>x_values</tt> and <tt>y_values</tt> are vectors of the same length that provide coordinates of the points to be <em>sequentially</em> connected by a line. This makes it necessary to sort the coordinate pairs according to the X-values. Here we use the function <tt>order()</tt> to sort the fitted values of <tt>score</tt> according to the observations of <tt>income</tt>.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># draw a scatterplot of the observations for income and test score</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(CASchools<span class="sc">$</span>income, CASchools<span class="sc">$</span>score,</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col  =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;District Income (thousands of dollars)&quot;</span>,</span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Test Score&quot;</span>,</span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Estimated Linear and Quadratic Regression Functions&quot;</span>)</span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a><span class="co"># add a linear function to the plot</span></span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(linear_model, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb178-11"><a href="#cb178-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-12"><a href="#cb178-12" aria-hidden="true" tabindex="-1"></a><span class="co"># add quatratic function to the plot</span></span>
<span id="cb178-13"><a href="#cb178-13" aria-hidden="true" tabindex="-1"></a>order_id <span class="ot">&lt;-</span> <span class="fu">order</span>(CASchools<span class="sc">$</span>income)</span>
<span id="cb178-14"><a href="#cb178-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-15"><a href="#cb178-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> CASchools<span class="sc">$</span>income[order_id], </span>
<span id="cb178-16"><a href="#cb178-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">fitted</span>(quadratic_model)[order_id],</span>
<span id="cb178-17"><a href="#cb178-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb178-18"><a href="#cb178-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>) </span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-318-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>We see that the quadratic function does fit the data much better than the linear function.</p>
</div>
<div id="nfoasiv" class="section level2 hasAnchor" number="8.2">
<h2 class="hasAnchor"><span class="header-section-number">8.2</span> Nonlinear Functions of a Single Independent Variable<a href="#nfoasiv" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="polynomials" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Polynomials<a href="#polynomials" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The approach used to obtain a quadratic model can be generalized to polynomial models of arbitrary degree <span class="math inline">\(r\)</span>,
<span class="math display">\[Y_i = \beta_0 + \beta_1 X_i + \beta_2 X_i^2 + \cdots + \beta_r X_i^r + u_i.\]</span></p>
<p>A cubic model for instance can be estimated in the same way as the quadratic model; we just have to use a polynomial of degree <span class="math inline">\(r=3\)</span> in <tt>income</tt>. This is conveniently done using the function <tt>poly()</tt>.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate a cubic model</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>cubic_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> <span class="fu">poly</span>(income, <span class="at">degree =</span> <span class="dv">3</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>), <span class="at">data =</span> CASchools)</span></code></pre></div>
<p><tt>poly()</tt> generates orthogonal polynomials which are orthogonal to the constant by default. Here, we set <tt>raw = TRUE</tt> such that raw polynomials are evaluated, see <code>?poly</code>.</p>
<p>In practice the question will arise which polynomial order should be chosen. First, similarly as for <span class="math inline">\(r=2\)</span>, we can test the null hypothesis that the true relation is linear against the alternative hypothesis that the relationship is a polynomial of degree <span class="math inline">\(r\)</span>:</p>
<p><span class="math display">\[ H_0: \beta_2=0, \ \beta_3=0,\dots,\beta_r=0 \ \ \ \text{vs.} \ \ \ H_1: \text{at least one} \ \beta_j\neq0, \ j=2,\dots,r \]</span></p>
<p>This is a joint null hypothesis with <span class="math inline">\(r-1\)</span> restrictions so it can be tested using the <span class="math inline">\(F\)</span>-test presented in Chapter @ref(htaciimr). <tt>linearHypothesis()</tt> can be used to conduct such tests. For example, we may test the null of a linear model against the alternative of a polynomial of a maximal degree <span class="math inline">\(r=3\)</span> as follows.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test the hypothesis of a linear model against quadratic or polynomial</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="co"># alternatives</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set up hypothesis matrix</span></span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a><span class="co"># do the test</span></span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(cubic_model,</span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">hypothesis.matrix =</span> R,</span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">white.adj =</span> <span class="st">&quot;hc1&quot;</span>)</span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb180-13"><a href="#cb180-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb180-14"><a href="#cb180-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb180-15"><a href="#cb180-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(income, degree = 3, raw = TRUE)2 = 0</span></span>
<span id="cb180-16"><a href="#cb180-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(income, degree = 3, raw = TRUE)3 = 0</span></span>
<span id="cb180-17"><a href="#cb180-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb180-18"><a href="#cb180-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb180-19"><a href="#cb180-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: score ~ poly(income, degree = 3, raw = TRUE)</span></span>
<span id="cb180-20"><a href="#cb180-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb180-21"><a href="#cb180-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb180-22"><a href="#cb180-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb180-23"><a href="#cb180-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F    Pr(&gt;F)    </span></span>
<span id="cb180-24"><a href="#cb180-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    418                        </span></span>
<span id="cb180-25"><a href="#cb180-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    416  2 37.691 9.043e-16 ***</span></span>
<span id="cb180-26"><a href="#cb180-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb180-27"><a href="#cb180-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>We provide a hypothesis matrix as the argument <tt>hypothesis.matrix</tt>. This is useful when the coefficients have long names, as is the case here due to using <tt>poly()</tt>, or when the restrictions include multiple coefficients. How the hypothesis matrix <span class="math inline">\(\mathbf{R}\)</span> is interpreted by <tt>linearHypothesis()</tt> is best seen using matrix algebra:</p>
<p>For the two linear constrains above, we have
<span class="math display">\[\begin{align*}
  \mathbf{R}\boldsymbol{\beta} =&amp; \mathbf{s} \\
  \begin{pmatrix}
    0 &amp; 0 &amp; 1 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; 1
  \end{pmatrix}
  \begin{pmatrix}
    \beta_0 \\
    \beta_1 \\
    \beta_2 \\
    \beta_3 \\
  \end{pmatrix} =&amp;
  \begin{pmatrix}
   0 \\
   0
  \end{pmatrix} \\
  \begin{pmatrix}
    \beta_2 \\
    \beta_3
  \end{pmatrix}= &amp;
  \begin{pmatrix}
    0 \\
    0
  \end{pmatrix}.
\end{align*}\]</span>
<tt>linearHypothesis()</tt> uses the zero vector for <span class="math inline">\(\mathbf{s}\)</span> by default, see <code>?linearHypothesis</code>.</p>
<p>The <span class="math inline">\(p\)</span>-value for is very small so that we reject the null hypothesis. However, this does not tell us <em>which</em> <span class="math inline">\(r\)</span> to choose. In practice, one approach to determine the degree of the polynomial is to use <em>sequential testing</em>:</p>
<ol style="list-style-type: decimal">
<li>Estimate a polynomial model for some maximum value <span class="math inline">\(r\)</span>.</li>
<li>Use a <span class="math inline">\(t\)</span>-test to test <span class="math inline">\(\beta_r = 0\)</span>. <em>Rejection</em> of the null means that <span class="math inline">\(X^r\)</span> belongs in the regression equation.</li>
<li><em>Acceptance</em> of the null in step 2 means that <span class="math inline">\(X^r\)</span> can be eliminated from the model. Continue by repeating step 1 with order <span class="math inline">\(r-1\)</span> and test whether <span class="math inline">\(\beta_{r-1}=0\)</span>. If the test rejects, use a polynomial model of order <span class="math inline">\(r-1\)</span>.</li>
<li>If the tests from step 3 rejects, continue with the procedure until the coefficient on the highest power is statistically significant.</li>
</ol>
<p>There is no unambiguous guideline how to choose <span class="math inline">\(r\)</span> in step one. However, as pointed out in <span class="citation">Stock and Watson (<a href="#ref-stock2015" role="doc-biblioref">2015</a>)</span>, economic data is often smooth such that it is appropriate to choose small orders like <span class="math inline">\(2\)</span>, <span class="math inline">\(3\)</span>, or <span class="math inline">\(4\)</span>.</p>
<p>We will demonstrate how to apply sequential testing by the example of the cubic model.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cubic_model)</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = score ~ poly(income, degree = 3, raw = TRUE), data = CASchools)</span></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -44.28  -9.21   0.20   8.32  31.16 </span></span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                         Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                            6.001e+02  5.830e+00 102.937  &lt; 2e-16</span></span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(income, degree = 3, raw = TRUE)1  5.019e+00  8.595e-01   5.839 1.06e-08</span></span>
<span id="cb181-14"><a href="#cb181-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(income, degree = 3, raw = TRUE)2 -9.581e-02  3.736e-02  -2.564   0.0107</span></span>
<span id="cb181-15"><a href="#cb181-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(income, degree = 3, raw = TRUE)3  6.855e-04  4.720e-04   1.452   0.1471</span></span>
<span id="cb181-16"><a href="#cb181-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                          </span></span>
<span id="cb181-17"><a href="#cb181-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                           ***</span></span>
<span id="cb181-18"><a href="#cb181-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(income, degree = 3, raw = TRUE)1 ***</span></span>
<span id="cb181-19"><a href="#cb181-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(income, degree = 3, raw = TRUE)2 *  </span></span>
<span id="cb181-20"><a href="#cb181-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(income, degree = 3, raw = TRUE)3    </span></span>
<span id="cb181-21"><a href="#cb181-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb181-22"><a href="#cb181-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb181-23"><a href="#cb181-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-24"><a href="#cb181-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 12.71 on 416 degrees of freedom</span></span>
<span id="cb181-25"><a href="#cb181-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.5584, Adjusted R-squared:  0.5552 </span></span>
<span id="cb181-26"><a href="#cb181-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 175.4 on 3 and 416 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>The estimated cubic model stored in <tt>cubic_model</tt> is</p>
<p><span class="math display">\[ \widehat{TestScore}_i = \underset{(5.83)}{600.1} + \underset{(0.86)}{5.02} \times income -\underset{(0.03)}{0.96} \times income^2 - \underset{(0.00047)}{0.00069} \times income^3. \]</span></p>
<p>The <span class="math inline">\(t\)</span>-statistic on <span class="math inline">\(income^3\)</span> is <span class="math inline">\(1.42\)</span> so the null that the relationship is quadratic cannot be rejected, even at the <span class="math inline">\(10\%\)</span> level. This is contrary to the result presented book which reports robust standard errors throughout so we will also use robust variance-covariance estimation to reproduce these results.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test the hypothesis using robust standard errors</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cubic_model, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                          Estimate  Std. Error  t value</span></span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                            6.0008e+02  5.1021e+00 117.6150</span></span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(income, degree = 3, raw = TRUE)1  5.0187e+00  7.0735e-01   7.0950</span></span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(income, degree = 3, raw = TRUE)2 -9.5805e-02  2.8954e-02  -3.3089</span></span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(income, degree = 3, raw = TRUE)3  6.8549e-04  3.4706e-04   1.9751</span></span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                        Pr(&gt;|t|)    </span></span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                           &lt; 2.2e-16 ***</span></span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(income, degree = 3, raw = TRUE)1 5.606e-12 ***</span></span>
<span id="cb182-14"><a href="#cb182-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(income, degree = 3, raw = TRUE)2  0.001018 ** </span></span>
<span id="cb182-15"><a href="#cb182-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(income, degree = 3, raw = TRUE)3  0.048918 *  </span></span>
<span id="cb182-16"><a href="#cb182-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb182-17"><a href="#cb182-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The reported standard errors have changed. Furthermore, the coefficient for <code>income^3</code> is now significant at the <span class="math inline">\(5\%\)</span> level. This means we reject the hypothesis that the regression function is quadratic against the alternative that it is cubic. Furthermore, we can also test if the coefficients for <tt>income^2</tt> and <tt>income^3</tt> are jointly significant using a robust version of the <span class="math inline">\(F\)</span>-test.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># perform robust F-test </span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(cubic_model, </span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">hypothesis.matrix =</span> R,</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(income, degree = 3, raw = TRUE)2 = 0</span></span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(income, degree = 3, raw = TRUE)3 = 0</span></span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: score ~ poly(income, degree = 3, raw = TRUE)</span></span>
<span id="cb183-13"><a href="#cb183-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb183-14"><a href="#cb183-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb183-15"><a href="#cb183-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb183-16"><a href="#cb183-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F    Pr(&gt;F)    </span></span>
<span id="cb183-17"><a href="#cb183-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    418                        </span></span>
<span id="cb183-18"><a href="#cb183-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    416  2 29.678 8.945e-13 ***</span></span>
<span id="cb183-19"><a href="#cb183-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb183-20"><a href="#cb183-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>With a <span class="math inline">\(p\)</span>-value of <span class="math inline">\(9.043e^{-16}\)</span>, i.e., much less than <span class="math inline">\(0.05\)</span>, the null hypothesis of linearity is rejected in favor of the alternative that the relationship is quadratic <em>or</em> cubic.</p>
<div id="interpretation-of-coefficients-in-nonlinear-regression-models" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Interpretation of Coefficients in Nonlinear Regression Models<a href="#interpretation-of-coefficients-in-nonlinear-regression-models" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The coefficients in polynomial regression do not have a simple interpretation. Why? Think of a quadratic model: it is not helpful to think of the coefficient on <span class="math inline">\(X\)</span> as the expected change in <span class="math inline">\(Y\)</span> associated with a change in <span class="math inline">\(X\)</span> holding the other regressors constant because <span class="math inline">\(X^2\)</span> changes as <span class="math inline">\(X\)</span> varies. This is also the case for other deviations from linearity, for example in models where regressors and/or the dependent variable are log-transformed. A way to approach this is to calculate the estimated effect on <span class="math inline">\(Y\)</span> associated with a change in <span class="math inline">\(X\)</span> for one or more values of <span class="math inline">\(X\)</span>. This idea is summarized in Key Concept 8.1.</p>
<div id="KC8.1" class="keyconcept">
<h3 class="right">
Key Concept 8.1
</h3>
<h3 class="left">
The Expected Effect on <span class="math inline">\(Y\)</span> of a Change in <span class="math inline">\(X_1\)</span> in a Nonlinear Regression Model
</h3>
<p>Consider the nonlinear population regression model</p>
<p><span class="math display">\[ Y_i = f(X_{1i}, X_{2i}, \dots, X_{ki}) + u_i \ , \ i=1,\dots,n,\]</span></p>
<p>where <span class="math inline">\(f(X_{1i}, X_{2i}, \dots, X_{ki})\)</span> is the population regression function and <span class="math inline">\(u_i\)</span> is the error term.</p>
<p>Denote by <span class="math inline">\(\Delta Y\)</span> the expected change in <span class="math inline">\(Y\)</span> associated with <span class="math inline">\(\Delta X_1\)</span>, the change in <span class="math inline">\(X_1\)</span> while holding <span class="math inline">\(X_2, \cdots , X_k\)</span> constant. That is, the expected change in <span class="math inline">\(Y\)</span> is the difference</p>
<p><span class="math display">\[\Delta Y = f(X_1 + \Delta X_1, X_2, \cdots, X_k) - f(X_1, X_2, \cdots, X_k).\]</span></p>
<p>The estimator of this unknown population difference is the difference between the predicted values for these two cases. Let <span class="math inline">\(\hat{f}(X_1, X_2, \cdots, X_k)\)</span> be the predicted value of of <span class="math inline">\(Y\)</span> based on the estimator <span class="math inline">\(\hat{f}\)</span> of the population regression function. Then the predicted change in <span class="math inline">\(Y\)</span> is</p>
<span class="math display">\[\Delta \widehat{Y} = \hat{f}(X_1 + \Delta X_1, X_2, \cdots, X_k) - \hat{f}(X_1, X_2, \cdots, X_k).\]</span>
</p>
</div>
<p>For example, we may ask the following: what is the predicted change in test scores associated with a one unit change (i.e., <span class="math inline">\(\$1000\)</span>) in income, based on the estimated quadratic regression function</p>
<p><span class="math display">\[\widehat{TestScore} = 607.3 + 3.85 \times income - 0.0423 \times income^2\ ?\]</span></p>
<p>Because the regression function is quadratic, this effect depends on the <em>initial</em> district income. We therefore consider two cases:</p>
<ol style="list-style-type: decimal">
<li><p>An increase in district income form <span class="math inline">\(10\)</span> to <span class="math inline">\(11\)</span> (from <span class="math inline">\(\$10000\)</span> per capita to <span class="math inline">\(\$11000\)</span>).</p></li>
<li><p>An increase in district income from <span class="math inline">\(40\)</span> to <span class="math inline">\(41\)</span> (that is from <span class="math inline">\(\$40000\)</span> to <span class="math inline">\(\$41000\)</span>).</p></li>
</ol>
<p>In order to obtain the <span class="math inline">\(\Delta \widehat{Y}\)</span> associated with a change in income form <span class="math inline">\(10\)</span> to <span class="math inline">\(11\)</span>, we use the following formula:</p>
<p><span class="math display">\[\Delta \widehat{Y} = \left(\hat{\beta}_0 + \hat{\beta}_1 \times 11 + \hat{\beta}_2 \times 11^2\right) - \left(\hat{\beta}_0 + \hat{\beta}_1 \times 10 + \hat{\beta}_2 \times 10^2\right) \]</span>
To compute <span class="math inline">\(\widehat{Y}\)</span> using <tt>R</tt> we may use <tt>predict()</tt>.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute and assign the quadratic model</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>quadriatic_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> income <span class="sc">+</span> <span class="fu">I</span>(income<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> CASchools)</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set up data for prediction</span></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">income =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">11</span>))</span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a><span class="co"># do the prediction</span></span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a>Y_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(quadriatic_model, <span class="at">newdata =</span> new_data)</span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the difference</span></span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(Y_hat)</span>
<span id="cb184-12"><a href="#cb184-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        2 </span></span>
<span id="cb184-13"><a href="#cb184-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2.962517</span></span></code></pre></div>
<p>Analogously we can compute the effect of a change in district income from <span class="math inline">\(40\)</span> to <span class="math inline">\(41\)</span>:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up data for prediction</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">income =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">41</span>))</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="co"># do the prediction</span></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>Y_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(quadriatic_model, <span class="at">newdata =</span> new_data)</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the difference</span></span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(Y_hat)</span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         2 </span></span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.4240097</span></span></code></pre></div>
<p>So for the quadratic model, the expected change in <span class="math inline">\(TestScore\)</span> induced by an increase in <span class="math inline">\(income\)</span> from <span class="math inline">\(10\)</span> to <span class="math inline">\(11\)</span> is about <span class="math inline">\(2.96\)</span> points but an increase in <span class="math inline">\(income\)</span> from <span class="math inline">\(40\)</span> to <span class="math inline">\(41\)</span> increases the predicted score by only <span class="math inline">\(0.42\)</span>. Hence, the slope of the estimated quadratic regression function is <em>steeper</em> at low levels of income than at higher levels.</p>
</div>
</div>
<div id="logarithms" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Logarithms<a href="#logarithms" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another way to specify a nonlinear regression function is to use the natural logarithm of <span class="math inline">\(Y\)</span> and/or <span class="math inline">\(X\)</span>.
Logarithms convert changes in variables into percentage changes. This is convenient as many relationships are naturally expressed in terms of percentages.</p>
<p>There are three different cases in which logarithms might be used.</p>
<ol style="list-style-type: decimal">
<li><p>Transform <span class="math inline">\(X\)</span> with its logarithm, but not <span class="math inline">\(Y\)</span>.</p></li>
<li><p>Analogously we could transform <span class="math inline">\(Y\)</span> to its logarithm but leave <span class="math inline">\(X\)</span> at level.</p></li>
<li><p>Both <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span> are transformed to their logarithms.</p></li>
</ol>
<p>The interpretation of the regression coefficients is different in each case.</p>
<div id="case-i-x-is-in-logarithm-y-is-not." class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Case I: <span class="math inline">\(X\)</span> is in Logarithm, <span class="math inline">\(Y\)</span> is not.<a href="#case-i-x-is-in-logarithm-y-is-not." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The regression model then is <span class="math display">\[Y_i = \beta_0 + \beta_1 \times \ln(X_i) + u_i \text{, } i=1,...,n. \]</span> Similar as for polynomial regression we do not have to create a new variable before using <tt>lm()</tt>. We can simply adjust the
<tt>formula</tt> argument of <tt>lm()</tt> to tell <tt>R</tt> that the log-transformation of a variable should be used.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate a level-log model</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>LinearLog_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> <span class="fu">log</span>(income), <span class="at">data =</span> CASchools)</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a><span class="co"># compute robust summary</span></span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(LinearLog_model, </span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb186-10"><a href="#cb186-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb186-11"><a href="#cb186-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 557.8323     3.8399 145.271 &lt; 2.2e-16 ***</span></span>
<span id="cb186-12"><a href="#cb186-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; log(income)  36.4197     1.3969  26.071 &lt; 2.2e-16 ***</span></span>
<span id="cb186-13"><a href="#cb186-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb186-14"><a href="#cb186-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Hence, the estimated regression function is</p>
<p><span class="math display">\[\widehat{TestScore} = 557.8 + 36.42 \times \ln(income).\]</span></p>
<p>Let us draw a plot of this function.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># draw a scatterplot</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(score <span class="sc">~</span> income, </span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> CASchools,</span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Linear-Log Regression Line&quot;</span>)</span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a><span class="co"># add the linear-log regression line</span></span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a>order_id  <span class="ot">&lt;-</span> <span class="fu">order</span>(CASchools<span class="sc">$</span>income)</span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(CASchools<span class="sc">$</span>income[order_id],</span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fitted</span>(LinearLog_model)[order_id], </span>
<span id="cb187-13"><a href="#cb187-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb187-14"><a href="#cb187-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-326-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>We can interpret <span class="math inline">\(\hat{\beta}_1\)</span> as follows: a <span class="math inline">\(1\%\)</span> increase in income is associated with an increase in test scores of <span class="math inline">\(0.01 \times 36.42 = 0.36\)</span> points. In order to get the estimated effect of a one unit change in income (that is, a change in the original units, thousands of dollars) on test scores, the method presented in Key Concept 8.1 can be used.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up new data</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">income =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">40</span>, <span class="dv">41</span>))</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a><span class="co"># predict the outcomes </span></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>Y_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(LinearLog_model, <span class="at">newdata =</span> new_data)</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the expected difference</span></span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>Y_hat_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(Y_hat, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a>Y_hat_matrix[, <span class="dv">2</span>] <span class="sc">-</span> Y_hat_matrix[, <span class="dv">1</span>]</span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3.471166 0.899297</span></span></code></pre></div>
<p>By setting <tt>nrow = 2</tt> and <tt>byrow = TRUE</tt> in <tt>matrix()</tt> we ensure that <tt>Y_hat_matrix</tt> is a <span class="math inline">\(2\times2\)</span> matrix filled row-wise with the entries of <tt>Y_hat</tt>.</p>
<p>The estimated model states that for an income increase from <span class="math inline">\(\$10000\)</span> to <span class="math inline">\(\$11000\)</span>, test scores increase by an expected amount of <span class="math inline">\(3.47\)</span> points. When income increases from <span class="math inline">\(\$40000\)</span> to <span class="math inline">\(\$41000\)</span>, the expected increase in test scores is only about <span class="math inline">\(0.90\)</span> points.</p>
</div>
<div id="case-ii-y-is-in-logarithm-x-is-not" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Case II: <span class="math inline">\(Y\)</span> is in Logarithm, <span class="math inline">\(X\)</span> is not<a href="#case-ii-y-is-in-logarithm-x-is-not" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are cases where it is useful to regress <span class="math inline">\(\ln(Y)\)</span>.</p>
<p>The corresponding regression model then is</p>
<p><span class="math display">\[ \ln(Y_i) = \beta_0 + \beta_1 \times X_i + u_i , \ \ i=1,...,n. \]</span></p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate a log-linear model </span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>LogLinear_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(score) <span class="sc">~</span> income, <span class="at">data =</span> CASchools)</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain a robust coefficient summary</span></span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(LogLinear_model, </span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error  t value  Pr(&gt;|t|)    </span></span>
<span id="cb189-11"><a href="#cb189-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 6.43936234 0.00289382 2225.210 &lt; 2.2e-16 ***</span></span>
<span id="cb189-12"><a href="#cb189-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; income      0.00284407 0.00017509   16.244 &lt; 2.2e-16 ***</span></span>
<span id="cb189-13"><a href="#cb189-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb189-14"><a href="#cb189-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The estimated regression function is <span class="math display">\[\widehat{\ln(TestScore)} = 6.439 + 0.00284 \times income.\]</span> An increase in district income by <span class="math inline">\(\$1000\)</span> is expected to increase test scores by <span class="math inline">\(100\times 0.00284 \% = 0.284\%\)</span>.</p>
<p>When the dependent variable in logarithm, one cannot simply use <span class="math inline">\(e^{\log(\cdot)}\)</span> to transform predictions back to the original scale, see page of the book.</p>
</div>
<div id="case-iii-x-and-y-are-in-logarithms" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Case III: <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are in Logarithms<a href="#case-iii-x-and-y-are-in-logarithms" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The log-log regression model is <span class="math display">\[\ln(Y_i) = \beta_0 + \beta_1 \times \ln(X_i) + u_i, \ \ i=1,...,n.\]</span></p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the log-log model</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>LogLog_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(score) <span class="sc">~</span> <span class="fu">log</span>(income), <span class="at">data =</span> CASchools)</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print robust coefficient summary to the console</span></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(LogLog_model, </span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error  t value  Pr(&gt;|t|)    </span></span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 6.3363494  0.0059246 1069.501 &lt; 2.2e-16 ***</span></span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; log(income) 0.0554190  0.0021446   25.841 &lt; 2.2e-16 ***</span></span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The estimated regression function hence is <span class="math display">\[\widehat{\ln(TestScore)} = 6.336 + 0.0554 \times \ln(income).\]</span> In a log-log model, a <span class="math inline">\(1\%\)</span> change in <span class="math inline">\(X\)</span> is associated with an estimated <span class="math inline">\(\hat\beta_1 \%\)</span> change in <span class="math inline">\(Y\)</span>.</p>
<p>We now reproduce Figure 8.5 of the book.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate a scatterplot</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(score) <span class="sc">~</span> income, </span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, </span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> CASchools,</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Log-Linear Regression Function&quot;</span>)</span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a><span class="co"># add the log-linear regression line</span></span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>order_id  <span class="ot">&lt;-</span> <span class="fu">order</span>(CASchools<span class="sc">$</span>income)</span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(CASchools<span class="sc">$</span>income[order_id], </span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fitted</span>(LogLinear_model)[order_id], </span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb191-15"><a href="#cb191-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-16"><a href="#cb191-16" aria-hidden="true" tabindex="-1"></a><span class="co"># add the log-log regression line</span></span>
<span id="cb191-17"><a href="#cb191-17" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">sort</span>(CASchools<span class="sc">$</span>income), </span>
<span id="cb191-18"><a href="#cb191-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fitted</span>(LogLog_model)[<span class="fu">order</span>(CASchools<span class="sc">$</span>income)], </span>
<span id="cb191-19"><a href="#cb191-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;green&quot;</span>, </span>
<span id="cb191-20"><a href="#cb191-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb191-21"><a href="#cb191-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-22"><a href="#cb191-22" aria-hidden="true" tabindex="-1"></a><span class="co"># add a legend</span></span>
<span id="cb191-23"><a href="#cb191-23" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>,</span>
<span id="cb191-24"><a href="#cb191-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;log-linear model&quot;</span>, <span class="st">&quot;log-log model&quot;</span>),</span>
<span id="cb191-25"><a href="#cb191-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb191-26"><a href="#cb191-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>))</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-329-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Key Concept 8.2 summarizes the three logarithmic regression models.</p>
<div id="KC8.2" class="keyconcept">
<h3 class="right">
Key Concept 8.2
</h3>
<h3 class="left">
Logarithms in Regression: Three Cases
</h3>
<p>
Logarithms can be used to transform the dependent variable <span class="math inline">\(Y\)</span> or the independent variable <span class="math inline">\(X\)</span>, or both
(the variable being transformed must be positive). The following table summarizes these three cases and the interpretation of the regression coefficient <span class="math inline">\(\beta_1\)</span>. In each case, <span class="math inline">\(\beta_1\)</span>, can be estimated by applying OLS after taking the logarithm(s) of the dependent and/or the independent variable.
</p>
<table>
<thead>
<tr class="header">
<th align="left">
Case
</th>
<th align="left">
Model Specification
</th>
<th align="left">
Interpretation of <span class="math inline">\(\beta_1\)</span>
</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">
<span class="math inline">\((I)\)</span>
</td>
<td align="left">
<span class="math inline">\(Y_i = \beta_0 + \beta_1 \ln(X_i) + u_i\)</span>
</td>
<td align="left">
A <span class="math inline">\(1 \%\)</span> change in <span class="math inline">\(X\)</span> is associated with a change in <span class="math inline">\(Y\)</span> of <span class="math inline">\(0.01 \times \beta_1\)</span>.
</td>
</tr>
<tr class="even">
<td align="left">
<span class="math inline">\((II)\)</span>
</td>
<td align="left">
<span class="math inline">\(\ln(Y_i) = \beta_0 + \beta_1 X_i + u_i\)</span>
</td>
<td align="left">
A change in <span class="math inline">\(X\)</span> by one unit (<span class="math inline">\(\Delta X = 1\)</span>) is associated with a <span class="math inline">\(100 \times \beta_1 \%\)</span> change in <span class="math inline">\(Y\)</span>.
</td>
</tr>
<tr class="odd">
<td align="left">
<span class="math inline">\((III)\)</span>
</td>
<td align="left">
<span class="math inline">\(\ln(Y_i) = \beta_0 + \beta_1 \ln(X_i) + u_i\)</span>
</td>
<td align="left">
A <span class="math inline">\(1\%\)</span> change in <span class="math inline">\(X\)</span> is associated with a <span class="math inline">\(\beta_1\%\)</span> change in <span class="math inline">\(Y\)</span>, so <span class="math inline">\(\beta_1\)</span> is the elasticity of <span class="math inline">\(Y\)</span> with respect to <span class="math inline">\(X\)</span>.
</td>
</tr>
</tbody>
</table>
</div>
<p>Of course we can also estimate a <em>polylog</em> model like</p>
<p><span class="math display">\[ TestScore_i = \beta_0 + \beta_1 \times \ln(income_i) + \beta_2 \times \ln(income_i)^2 + \beta_3 \times \ln(income_i)^3 + u_i \]</span></p>
<p>which models the dependent variable <span class="math inline">\(TestScore\)</span> by a third-degree polynomial of the log-transformed regressor <span class="math inline">\(income\)</span>.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the polylog model</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>polyLog_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> <span class="fu">log</span>(income) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">log</span>(income)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">log</span>(income)<span class="sc">^</span><span class="dv">3</span>), </span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> CASchools)</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print robust summary to the console</span></span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(polyLog_model, </span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)      486.1341    79.3825  6.1239 2.115e-09 ***</span></span>
<span id="cb192-13"><a href="#cb192-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; log(income)      113.3820    87.8837  1.2901    0.1977    </span></span>
<span id="cb192-14"><a href="#cb192-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I(log(income)^2) -26.9111    31.7457 -0.8477    0.3971    </span></span>
<span id="cb192-15"><a href="#cb192-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I(log(income)^3)   3.0632     3.7369  0.8197    0.4128    </span></span>
<span id="cb192-16"><a href="#cb192-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb192-17"><a href="#cb192-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Comparing by <span class="math inline">\(\bar{R}^2\)</span> we find that, leaving out the log-linear model, all models have a similar adjusted fit. In the class of polynomial models, the cubic specification has the highest <span class="math inline">\(\bar{R}^2\)</span> whereas the linear-log specification is the best of the log-models.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the adj. R^2 for the nonlinear models</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>adj_R2 <span class="ot">&lt;-</span><span class="fu">rbind</span>(<span class="st">&quot;quadratic&quot;</span> <span class="ot">=</span> <span class="fu">summary</span>(quadratic_model)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;cubic&quot;</span> <span class="ot">=</span> <span class="fu">summary</span>(cubic_model)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;LinearLog&quot;</span> <span class="ot">=</span> <span class="fu">summary</span>(LinearLog_model)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;LogLinear&quot;</span> <span class="ot">=</span> <span class="fu">summary</span>(LogLinear_model)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;LogLog&quot;</span> <span class="ot">=</span> <span class="fu">summary</span>(LogLog_model)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;polyLog&quot;</span> <span class="ot">=</span> <span class="fu">summary</span>(polyLog_model)<span class="sc">$</span>adj.r.squared)</span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a><span class="co"># assign column names</span></span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(adj_R2) <span class="ot">&lt;-</span> <span class="st">&quot;adj_R2&quot;</span></span>
<span id="cb193-11"><a href="#cb193-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-12"><a href="#cb193-12" aria-hidden="true" tabindex="-1"></a>adj_R2</span>
<span id="cb193-13"><a href="#cb193-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              adj_R2</span></span>
<span id="cb193-14"><a href="#cb193-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; quadratic 0.5540444</span></span>
<span id="cb193-15"><a href="#cb193-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cubic     0.5552279</span></span>
<span id="cb193-16"><a href="#cb193-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; LinearLog 0.5614605</span></span>
<span id="cb193-17"><a href="#cb193-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; LogLinear 0.4970106</span></span>
<span id="cb193-18"><a href="#cb193-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; LogLog    0.5567251</span></span>
<span id="cb193-19"><a href="#cb193-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; polyLog   0.5599944</span></span></code></pre></div>
<p>Let us now compare the cubic and the linear-log model by plotting the corresponding estimated regression functions.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate a scatterplot</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(score <span class="sc">~</span> income, </span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> CASchools,</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Linear-Log and Cubic Regression Functions&quot;</span>)</span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a><span class="co"># add the linear-log regression line</span></span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a>order_id  <span class="ot">&lt;-</span> <span class="fu">order</span>(CASchools<span class="sc">$</span>income)</span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(CASchools<span class="sc">$</span>income[order_id],</span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fitted</span>(LinearLog_model)[order_id], </span>
<span id="cb194-13"><a href="#cb194-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, </span>
<span id="cb194-14"><a href="#cb194-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb194-15"><a href="#cb194-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-16"><a href="#cb194-16" aria-hidden="true" tabindex="-1"></a><span class="co"># add the cubic regression line</span></span>
<span id="cb194-17"><a href="#cb194-17" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> CASchools<span class="sc">$</span>income[order_id], </span>
<span id="cb194-18"><a href="#cb194-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">fitted</span>(cubic_model)[order_id],</span>
<span id="cb194-19"><a href="#cb194-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>, </span>
<span id="cb194-20"><a href="#cb194-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>) </span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-333-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Both regression lines look nearly identical. Altogether the linear-log model may be preferable since it is more parsimonious in terms of regressors: it does not include higher-degree polynomials.</p>
</div>
</div>
</div>
<div id="interactions-between-independent-variables" class="section level2 hasAnchor" number="8.3">
<h2 class="hasAnchor"><span class="header-section-number">8.3</span> Interactions Between Independent Variables<a href="#interactions-between-independent-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are research questions where it is interesting to learn how the effect on <span class="math inline">\(Y\)</span> of a change in an independent variable depends on the value of another independent variable. For example, we may ask if districts with many English learners benefit differentially from a decrease in class sizes to those with few English learning students. To assess this using a multiple regression model, we include an interaction term. We consider three cases:</p>
<ol style="list-style-type: decimal">
<li><p>Interactions between two binary variables.</p></li>
<li><p>Interactions between a binary and a continuous variable.</p></li>
<li><p>Interactions between two continuous variables.</p></li>
</ol>
<p>The following subsections discuss these cases briefly and demonstrate how to perform such regressions in <tt>R</tt>.</p>
<div id="interactions-between-two-binary-variables" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Interactions Between Two Binary Variables<a href="#interactions-between-two-binary-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Take two binary variables <span class="math inline">\(D_1\)</span> and <span class="math inline">\(D_2\)</span> and the population regression model</p>
<p><span class="math display">\[ Y_i = \beta_0 + \beta_1 \times D_{1i} + \beta_2 \times D_{2i} + u_i. \]</span></p>
<p>Now assume that</p>
<p><span class="math display">\[\begin{align*}
  Y_i=&amp; \, \ln(Earnings_i),\\
  D_{1i} =&amp; \,
   \begin{cases}
      1 &amp; \text{if $i^{th}$ person has a college degree,} \\
      0 &amp; \text{else}.
    \end{cases} \\
  D_{2i} =&amp; \,
    \begin{cases}
      1 &amp; \text{if $i^{th}$ person is female,} \\
      0 &amp; \text{if $i^{th}$ person is male}.
    \end{cases}
\end{align*}\]</span></p>
<p>We know that <span class="math inline">\(\beta_1\)</span> measures the average difference in <span class="math inline">\(\ln(Earnings)\)</span> between individuals with and without a college degree and <span class="math inline">\(\beta_2\)</span> is the gender differential in <span class="math inline">\(\ln(Earnings)\)</span>, ceteris paribus. This model <em>does not</em> allow us to determine if there is a gender specific effect of having a college degree and, if so, <em>how strong</em> this effect is. It is easy to come up with a model specification that allows to investigate this:</p>
<p><span class="math display">\[ Y_i = \beta_0 + \beta_1 \times D_{1i} + \beta_2 \times D_{2i} + \beta_3 \times (D_{1i} \times D_{2i}) + u_i \]</span></p>
<p><span class="math inline">\((D_{1i} \times D_{2i})\)</span> is called an interaction term and <span class="math inline">\(\beta_3\)</span> measures the difference in the effect of having a college degree for women versus men.</p>
<div id="KC8.3" class="keyconcept">
<h3 class="right">
Key Concept 8.3
</h3>
<h3 class="left">
A Method for Interpreting Coefficients in Regression with Binary Variables
</h3>
<p>Compute expected values of <span class="math inline">\(Y\)</span> for each possible set described by the set of binary variables. Compare the expected values.
The coefficients can be expressed either as expected values or as the difference between at least two expected values.</p>
</div>
<p>Following Key Concept 8.3 we have</p>
<p><span class="math display">\[\begin{align*}
  E(Y_i\vert D_{1i}=0, D_{2i} = d_2) =&amp; \, \beta_0 + \beta_1 \times 0 + \beta_2 \times d_2 + \beta_3 \times (0 \times d_2) \\
  =&amp; \, \beta_0 + \beta_2 \times d_2.
\end{align*}\]</span></p>
<p>If <span class="math inline">\(D_{1i}\)</span> switches from <span class="math inline">\(0\)</span> to <span class="math inline">\(1\)</span> we obtain</p>
<p><span class="math display">\[\begin{align*}
  E(Y_i\vert D_{1i}=1, D_{2i} = d_2) =&amp; \, \beta_0 + \beta_1 \times 1 + \beta_2 \times d_2 + \beta_3 \times (1 \times d_2) \\
  =&amp; \, \beta_0 + \beta_1 + \beta_2 \times d_2 + \beta_3 \times d_2.
\end{align*}\]</span></p>
<p>Hence, the overall effect is</p>
<p><span class="math display">\[ E(Y_i\vert D_{1i}=1, D_{2i} = d_2) - E(Y_i\vert D_{1i}=0, D_{2i} = d_2) = \beta_1 + \beta_3 \times d_2 \]</span>
so the effect is a difference of expected values.</p>
</div>
<div id="application-to-the-student-teacher-ratio-and-the-percentage-of-english-learners" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Application to the Student-Teacher Ratio and the Percentage of English Learners<a href="#application-to-the-student-teacher-ratio-and-the-percentage-of-english-learners" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now let</p>
<p><span class="math display">\[\begin{align*}
  HiSTR =&amp; \,
    \begin{cases}
      1, &amp; \text{if $STR \geq 20$} \\
      0, &amp; \text{else},
    \end{cases} \\
  \\
  HiEL =&amp; \,
    \begin{cases}
      1, &amp; \text{if $PctEL \geq 10$} \\
      0, &amp; \text{else}.
    \end{cases}
\end{align*}\]</span></p>
<p>We may use <tt>R</tt> to construct the variables above as follows.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># append HiSTR to CASchools</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>CASchools<span class="sc">$</span>HiSTR <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(CASchools<span class="sc">$</span>size <span class="sc">&gt;=</span> <span class="dv">20</span>)</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a><span class="co"># append HiEL to CASchools</span></span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a>CASchools<span class="sc">$</span>HiEL <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(CASchools<span class="sc">$</span>english <span class="sc">&gt;=</span> <span class="dv">10</span>)</span></code></pre></div>
<p>We proceed by estimating the model</p>
<p><span class="math display">\[\begin{align}
TestScore = \beta_0 + \beta_1 \times HiSTR + \beta_2 \times HiEL + \beta_3 \times (HiSTR \times HiEL) + u_i. (\#eq:im)
\end{align}\]</span></p>
<p>There are several ways to add the interaction term to the <tt>formula</tt> argument when using <tt>lm()</tt> but the most intuitive way is to use <tt>HiEL * HiSTR</tt>.<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a></p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model with a binary interaction term</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>bi_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> HiSTR <span class="sc">*</span> HiEL, <span class="at">data =</span> CASchools)</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print a robust summary of the coefficients</span></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(bi_model, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error  t value  Pr(&gt;|t|)    </span></span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 664.1433     1.3881 478.4589 &lt; 2.2e-16 ***</span></span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; HiSTR        -1.9078     1.9322  -0.9874    0.3240    </span></span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; HiEL        -18.3155     2.3340  -7.8472 3.634e-14 ***</span></span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; HiSTR:HiEL   -3.2601     3.1189  -1.0453    0.2965    </span></span>
<span id="cb196-14"><a href="#cb196-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb196-15"><a href="#cb196-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The estimated regression model is <span class="math display">\[\widehat{TestScore} = \underset{(1.39)}{664.1} - \underset{(1.93)}{1.9} \times HiSTR - \underset{(2.33)}{18.3} \times HiEL - \underset{(3.12)}{3.3} \times (HiSTR \times HiEL)\]</span> and it predicts that the effect of moving from a school district with a low student-teacher ratio to a district with a high student-teacher ratio, depending on high or low percentage of english learners is <span class="math inline">\(-1.9-3.3\times HiEL\)</span>. So for districts with a low share of english learners (<span class="math inline">\(HiEL = 0\)</span>), the estimated effect is a decrease of <span class="math inline">\(1.9\)</span> points in test scores while for districts with a large fraction of English learners (<span class="math inline">\(HiEL = 1\)</span>), the predicted decrease in test scores amounts to <span class="math inline">\(1.9 + 3.3 = 5.2\)</span> points.</p>
<p>We can also use the model to estimate the mean test score for each possible combination of the included binary variables.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate means for all combinations of HiSTR and HiEL</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bi_model, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="st">&quot;HiSTR&quot;</span> <span class="ot">=</span> <span class="dv">0</span>, <span class="st">&quot;HiEL&quot;</span> <span class="ot">=</span> <span class="dv">0</span>))</span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        1 </span></span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 664.1433</span></span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.</span></span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bi_model, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="st">&quot;HiSTR&quot;</span> <span class="ot">=</span> <span class="dv">0</span>, <span class="st">&quot;HiEL&quot;</span> <span class="ot">=</span> <span class="dv">1</span>))</span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        1 </span></span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 645.8278</span></span>
<span id="cb197-12"><a href="#cb197-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-13"><a href="#cb197-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 3.</span></span>
<span id="cb197-14"><a href="#cb197-14" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bi_model, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="st">&quot;HiSTR&quot;</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">&quot;HiEL&quot;</span> <span class="ot">=</span> <span class="dv">0</span>))</span>
<span id="cb197-15"><a href="#cb197-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        1 </span></span>
<span id="cb197-16"><a href="#cb197-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 662.2354</span></span>
<span id="cb197-17"><a href="#cb197-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-18"><a href="#cb197-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.</span></span>
<span id="cb197-19"><a href="#cb197-19" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bi_model, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="st">&quot;HiSTR&quot;</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">&quot;HiEL&quot;</span> <span class="ot">=</span> <span class="dv">1</span>))</span>
<span id="cb197-20"><a href="#cb197-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        1 </span></span>
<span id="cb197-21"><a href="#cb197-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 640.6598</span></span></code></pre></div>
<p>We now verify that these predictions are differences in the coefficient estimates presented in equation @ref(eq:im):</p>
<p><span class="math display">\[\begin{align*}
\widehat{TestScore} = \hat\beta_0 = 664.1 \quad &amp;\Leftrightarrow \quad HiSTR = 0, \, HIEL = 0\\
\widehat{TestScore} = \hat\beta_0 + \hat\beta_2 = 664.1 - 18.3 = 645.8 \quad &amp;\Leftrightarrow \quad HiSTR = 0, \, HIEL = 1\\
\widehat{TestScore} = \hat\beta_0 + \hat\beta_1 = 664.1 - 1.9 = 662.2 \quad &amp;\Leftrightarrow \quad HiSTR = 1, \, HIEL = 0\\
\widehat{TestScore} = \hat\beta_0 + \hat\beta_1 + \hat\beta_2 + \hat\beta_3  = 664.1 - 1.9 - 18.3 - 3.3 = 640.6 \quad &amp;\Leftrightarrow \quad HiSTR = 1, \, HIEL = 1
\end{align*}\]</span></p>
</div>
<div id="interactions-between-a-continuous-and-a-binary-variable" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Interactions Between a Continuous and a Binary Variable<a href="#interactions-between-a-continuous-and-a-binary-variable" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now let <span class="math inline">\(X_i\)</span> denote the years of working experience of person <span class="math inline">\(i\)</span>, which is a continuous variable. We have
<span class="math display">\[\begin{align*}
  Y_i =&amp; \, \ln(Earnings_i), \\
  \\
  X_i =&amp; \, \text{working experience of person }i, \\
  \\
  D_i =&amp; \,  
    \begin{cases}
      1, &amp; \text{if $i^{th}$ person has a college degree} \\
      0, &amp; \text{else}.
    \end{cases}
\end{align*}\]</span></p>
<p>The baseline model thus is</p>
<p><span class="math display">\[ Y_i = \beta_0 + \beta_1 X_i + \beta_2 D_i + u_i, \]</span></p>
<p>a multiple regression model that allows us to estimate the average benefit of having a college degree holding working experience constant as well as the average effect on earnings of a change in working experience holding college degree constant.</p>
<p>By adding the interaction term <span class="math inline">\(X_i \times D_i\)</span> we allow the effect of an additional year of work experience to differ between individuals with and without college degree,</p>
<p><span class="math display">\[ Y_i = \beta_0 + \beta_1 X_i + \beta_2 D_i + \beta_3  (X_i \times D_i) + u_i. \]</span></p>
<p>Here, <span class="math inline">\(\beta_3\)</span> is the expected difference in the effect of an additional year of work experience for college graduates versus non-graduates. Another possible specification is</p>
<p><span class="math display">\[ Y_i = \beta_0 + \beta_1 X_i + \beta_2 (X_i \times D_i) + u_i. \]</span></p>
<p>This model states that the expected impact of an additional year of work experience on earnings differs for college graduates and non-graduates but that graduating on its own does not increase earnings.</p>
<p>All three regression functions can be visualized by straight lines. Key Concept 8.4 summarizes the differences.</p>
<div id="KC8.4" class="keyconcept">
<h3 class="right">
Key Concept 8.4
</h3>
<h3 class="left">
Interactions Between Binary and Continuous Variables
</h3>
<p>An interaction term like <span class="math inline">\(X_i \times D_i\)</span> (where <span class="math inline">\(X_i\)</span> is continuous and <span class="math inline">\(D_i\)</span> is binary) allows for the slope to depend on the binary
variable <span class="math inline">\(D_i\)</span>. There are three possibilities:</p>
<ol style="list-style-type: decimal">
<li><p>Different intercept and same slope:
<span class="math display">\[ Y_i = \beta_0 + \beta_1 X_i + \beta_2 D_i + u_i \]</span></p></li>
<li><p>Different intercept and different slope:
<span class="math display">\[ Y_i = \beta_0 + \beta_1 X_i + \beta_2 D_i + \beta_3 \times (X_i \times D_i) + u_i \]</span></p></li>
<li><p>Same intercept and different slope:
<span class="math display">\[ Y_i = \beta_0 + \beta_1 X_i + \beta_2 (X_i \times D_i) + u_i \]</span></p></li>
</ol>
</div>
<p>The following code chunk demonstrates how to replicate the results shown in Figure 8.8 of the book using artificial data.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate artificial data</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">200</span>,<span class="dv">0</span>, <span class="dv">15</span>)</span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">200</span>, <span class="at">replace =</span> T)</span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">450</span> <span class="sc">+</span>  <span class="dv">150</span> <span class="sc">*</span> X <span class="sc">+</span> <span class="dv">500</span> <span class="sc">*</span> D <span class="sc">+</span> <span class="dv">50</span> <span class="sc">*</span> (X <span class="sc">*</span> D) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="at">sd =</span> <span class="dv">300</span>)</span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a><span class="co"># divide plotting area accordingly</span></span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">0</span>))</span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a>graphics<span class="sc">::</span><span class="fu">layout</span>(m)</span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the models and plot the regression lines</span></span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-14"><a href="#cb198-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. (baseline model)</span></span>
<span id="cb198-15"><a href="#cb198-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X, <span class="fu">log</span>(Y),</span>
<span id="cb198-16"><a href="#cb198-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb198-17"><a href="#cb198-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb198-18"><a href="#cb198-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Different Intercepts, Same Slope&quot;</span>)</span>
<span id="cb198-19"><a href="#cb198-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-20"><a href="#cb198-20" aria-hidden="true" tabindex="-1"></a>mod1_coef <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Y) <span class="sc">~</span> X <span class="sc">+</span> D)<span class="sc">$</span>coefficients</span>
<span id="cb198-21"><a href="#cb198-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-22"><a href="#cb198-22" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">coef =</span> <span class="fu">c</span>(mod1_coef[<span class="dv">1</span>], mod1_coef[<span class="dv">2</span>]), </span>
<span id="cb198-23"><a href="#cb198-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb198-24"><a href="#cb198-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb198-25"><a href="#cb198-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-26"><a href="#cb198-26" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">coef =</span> <span class="fu">c</span>(mod1_coef[<span class="dv">1</span>] <span class="sc">+</span> mod1_coef[<span class="dv">3</span>], mod1_coef[<span class="dv">2</span>]), </span>
<span id="cb198-27"><a href="#cb198-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;green&quot;</span>,</span>
<span id="cb198-28"><a href="#cb198-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb198-29"><a href="#cb198-29" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb198-30"><a href="#cb198-30" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. (baseline model + interaction term)</span></span>
<span id="cb198-31"><a href="#cb198-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X, <span class="fu">log</span>(Y),</span>
<span id="cb198-32"><a href="#cb198-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb198-33"><a href="#cb198-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb198-34"><a href="#cb198-34" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Different Intercepts, Different Slopes&quot;</span>)</span>
<span id="cb198-35"><a href="#cb198-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-36"><a href="#cb198-36" aria-hidden="true" tabindex="-1"></a>mod2_coef <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Y) <span class="sc">~</span> X <span class="sc">+</span> D <span class="sc">+</span> X<span class="sc">:</span>D)<span class="sc">$</span>coefficients</span>
<span id="cb198-37"><a href="#cb198-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-38"><a href="#cb198-38" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">coef =</span> <span class="fu">c</span>(mod2_coef[<span class="dv">1</span>], mod2_coef[<span class="dv">2</span>]), </span>
<span id="cb198-39"><a href="#cb198-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb198-40"><a href="#cb198-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb198-41"><a href="#cb198-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-42"><a href="#cb198-42" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">coef =</span> <span class="fu">c</span>(mod2_coef[<span class="dv">1</span>] <span class="sc">+</span> mod2_coef[<span class="dv">3</span>], mod2_coef[<span class="dv">2</span>] <span class="sc">+</span> mod2_coef[<span class="dv">4</span>]), </span>
<span id="cb198-43"><a href="#cb198-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;green&quot;</span>,</span>
<span id="cb198-44"><a href="#cb198-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb198-45"><a href="#cb198-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-46"><a href="#cb198-46" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. (omission of D as regressor + interaction term)</span></span>
<span id="cb198-47"><a href="#cb198-47" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X, <span class="fu">log</span>(Y),</span>
<span id="cb198-48"><a href="#cb198-48" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb198-49"><a href="#cb198-49" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb198-50"><a href="#cb198-50" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Same Intercept, Different Slopes&quot;</span>)</span>
<span id="cb198-51"><a href="#cb198-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-52"><a href="#cb198-52" aria-hidden="true" tabindex="-1"></a>mod3_coef <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Y) <span class="sc">~</span> X <span class="sc">+</span> X<span class="sc">:</span>D)<span class="sc">$</span>coefficients</span>
<span id="cb198-53"><a href="#cb198-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-54"><a href="#cb198-54" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">coef =</span> <span class="fu">c</span>(mod3_coef[<span class="dv">1</span>], mod3_coef[<span class="dv">2</span>]), </span>
<span id="cb198-55"><a href="#cb198-55" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb198-56"><a href="#cb198-56" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb198-57"><a href="#cb198-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-58"><a href="#cb198-58" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">coef =</span> <span class="fu">c</span>(mod3_coef[<span class="dv">1</span>], mod3_coef[<span class="dv">2</span>] <span class="sc">+</span> mod3_coef[<span class="dv">3</span>]), </span>
<span id="cb198-59"><a href="#cb198-59" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;green&quot;</span>,</span>
<span id="cb198-60"><a href="#cb198-60" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-341-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="application-to-the-student-teacher-ratio-and-the-percentage-of-english-learners-1" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Application to the Student-Teacher Ratio and the Percentage of English Learners<a href="#application-to-the-student-teacher-ratio-and-the-percentage-of-english-learners-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Using a model specification like the second one discussed in Key Concept 8.3 (different slope, different intercept) we may answer the question whether the effect on test scores of decreasing the student-teacher ratio depends on whether there are many or few English learners. We estimate the regression model</p>
<p><span class="math display">\[ \widehat{TestScore_i} = \beta_0 + \beta_1 \times size_i + \beta_2 \times HiEL_i + \beta_2 (size_i \times HiEL_i) + u_i. \]</span></p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>bci_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> size <span class="sc">+</span> HiEL <span class="sc">+</span> size <span class="sc">*</span> HiEL, <span class="at">data =</span> CASchools)</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print robust summary of coefficients to the console</span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(bci_model, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 682.24584   11.86781 57.4871   &lt;2e-16 ***</span></span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; size         -0.96846    0.58910 -1.6440   0.1009    </span></span>
<span id="cb199-12"><a href="#cb199-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; HiEL          5.63914   19.51456  0.2890   0.7727    </span></span>
<span id="cb199-13"><a href="#cb199-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; size:HiEL    -1.27661    0.96692 -1.3203   0.1875    </span></span>
<span id="cb199-14"><a href="#cb199-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb199-15"><a href="#cb199-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The estimated regression model is <span class="math display">\[ \widehat{TestScore} = \underset{(11.87)}{682.2} - \underset{(0.59)}{0.97} \times size + \underset{(19.51)}{5.6} \times HiEL - \underset{(0.97)}{1.28} \times (size \times HiEL). \]</span> The estimated regression line for districts with a low fraction of English learners (<span class="math inline">\(HiEL_i=0\)</span>) is <span class="math display">\[ \widehat{TestScore} = 682.2 - 0.97\times size_i. \]</span></p>
<p>For districts with a high fraction of English learners we have</p>
<p><span class="math display">\[\begin{align*}
  \widehat{TestScore} =&amp; \, 682.2 + 5.6 - 0.97\times size_i - 1.28 \times size_i \\
   =&amp; \, 687.8 - 2.25 \times size_i.
\end{align*}\]</span></p>
<p>The predicted increase in test scores following a reduction of the student-teacher ratio by <span class="math inline">\(1\)</span> unit is about <span class="math inline">\(0.97\)</span> points in districts where the fraction of English learners is low but <span class="math inline">\(2.25\)</span> in districts with a high share of English learners. From the coefficient on the interaction term <span class="math inline">\(size \times HiEL\)</span> we see that the difference between both effects is <span class="math inline">\(1.28\)</span> points.</p>
<p>The next code chunk draws both lines belonging to the model. In order to make observations with <span class="math inline">\(HiEL = 0\)</span> distinguishable from those with <span class="math inline">\(HiEL = 1\)</span>, we use different colors.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># identify observations with PctEL &gt;= 10</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> CASchools<span class="sc">$</span>english <span class="sc">&gt;=</span> <span class="dv">10</span></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot observations with HiEL = 0 as red dots</span></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(CASchools<span class="sc">$</span>size[<span class="sc">!</span>id], CASchools<span class="sc">$</span>score[<span class="sc">!</span>id],</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">27</span>),</span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">600</span>, <span class="dv">720</span>),</span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Class Size&quot;</span>,</span>
<span id="cb200-12"><a href="#cb200-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Test Score&quot;</span>)</span>
<span id="cb200-13"><a href="#cb200-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-14"><a href="#cb200-14" aria-hidden="true" tabindex="-1"></a><span class="co"># plot observations with HiEL = 1 as green dots</span></span>
<span id="cb200-15"><a href="#cb200-15" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(CASchools<span class="sc">$</span>size[id], CASchools<span class="sc">$</span>score[id],</span>
<span id="cb200-16"><a href="#cb200-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb200-17"><a href="#cb200-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;green&quot;</span>)</span>
<span id="cb200-18"><a href="#cb200-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-19"><a href="#cb200-19" aria-hidden="true" tabindex="-1"></a><span class="co"># read out estimated coefficients of bci_model</span></span>
<span id="cb200-20"><a href="#cb200-20" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">&lt;-</span> bci_model<span class="sc">$</span>coefficients</span>
<span id="cb200-21"><a href="#cb200-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-22"><a href="#cb200-22" aria-hidden="true" tabindex="-1"></a><span class="co"># draw the estimated regression line for HiEL = 0</span></span>
<span id="cb200-23"><a href="#cb200-23" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">coef =</span> <span class="fu">c</span>(coefs[<span class="dv">1</span>], coefs[<span class="dv">2</span>]),</span>
<span id="cb200-24"><a href="#cb200-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb200-25"><a href="#cb200-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb200-26"><a href="#cb200-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-27"><a href="#cb200-27" aria-hidden="true" tabindex="-1"></a><span class="co"># draw the estimated regression line for HiEL = 1</span></span>
<span id="cb200-28"><a href="#cb200-28" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">coef =</span> <span class="fu">c</span>(coefs[<span class="dv">1</span>] <span class="sc">+</span> coefs[<span class="dv">3</span>], coefs[<span class="dv">2</span>] <span class="sc">+</span> coefs[<span class="dv">4</span>]),</span>
<span id="cb200-29"><a href="#cb200-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;green&quot;</span>, </span>
<span id="cb200-30"><a href="#cb200-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fl">1.5</span> )</span>
<span id="cb200-31"><a href="#cb200-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-32"><a href="#cb200-32" aria-hidden="true" tabindex="-1"></a><span class="co"># add a legend to the plot</span></span>
<span id="cb200-33"><a href="#cb200-33" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, </span>
<span id="cb200-34"><a href="#cb200-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">20</span>), </span>
<span id="cb200-35"><a href="#cb200-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>), </span>
<span id="cb200-36"><a href="#cb200-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;HiEL = 0&quot;</span>, <span class="st">&quot;HiEL = 1&quot;</span>))</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-343-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="interactions-between-two-continuous-variables" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Interactions Between Two Continuous Variables<a href="#interactions-between-two-continuous-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider a regression model with <span class="math inline">\(Y\)</span> the log earnings and two continuous regressors <span class="math inline">\(X_1\)</span>, the years of work experience, and <span class="math inline">\(X_2\)</span>, the years of schooling. We want to estimate the effect on wages of an additional year of work experience depending on a given level of schooling. This effect can be assessed by including the interaction term <span class="math inline">\((X_{1i} \times X_{2i})\)</span> in the model:</p>
<p><span class="math display">\[ \Delta Y_i = \beta_0 + \beta_1 \times X_{1i} + \beta_2 \times X_{2i} + \beta_3 \times (X_{1i} \times X_{2i}) + u_i \]</span></p>
<p>Following Key Concept 8.1 we find that the effect on <span class="math inline">\(Y\)</span> of a change on <span class="math inline">\(X_1\)</span> given <span class="math inline">\(X_2\)</span> is
<span class="math display">\[ \frac{\Delta Y}{\Delta X_1} = \beta_1 + \beta_3 X_2. \]</span></p>
<p>In the earnings example, a positive <span class="math inline">\(\beta_3\)</span> implies that the effect on log earnings of an additional year of work experience grows linearly with years of schooling. Vice versa we have <span class="math display">\[ \frac{\Delta Y}{\Delta X_2} = \beta_2 + \beta_3 X_1 \]</span> as the effect on log earnings of an additional year of schooling holding work experience constant.</p>
<p>Altogether we find that <span class="math inline">\(\beta_3\)</span> measures the effect of a unit increase in <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> <em>beyond</em> the effects of increasing <span class="math inline">\(X_1\)</span> alone and <span class="math inline">\(X_2\)</span> alone by one unit. The overall change in <span class="math inline">\(Y\)</span> is thus</p>
<p><span class="math display">\[\begin{align}
Y_i = (\beta_1 + \beta_3 X_2) \Delta X_1 + (\beta_2 + \beta_3 X_1) \Delta X_2 + \beta_3\Delta X_1 \Delta X_2. (\#eq:generalinteraction)
\end{align}\]</span></p>
<p>Key Concept 8.5 summarizes interactions between two regressors in multiple regression.</p>
<div id="KC8.5" class="keyconcept">
<h3 class="right">
Key Concept 8.5
</h3>
<h3 class="left">
Interactions in Multiple Regression
</h3>
<p>The interaction term between the two regressors <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> is given by their product <span class="math inline">\(X_1 \times X_2\)</span>. Adding this
interaction term as a regressor to the model <span class="math display">\[ Y_i = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + u_i \]</span> allows the effect on <span class="math inline">\(Y\)</span> of a change in <span class="math inline">\(X_2\)</span> to depend on the value of <span class="math inline">\(X_1\)</span> and vice versa. Thus the coefficient <span class="math inline">\(\beta_3\)</span> in the model <span class="math display">\[ Y_i = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \beta_3 (X_1 \times X_2) + u_i \]</span> measures the effect of a one-unit increase in both <span class="math inline">\(X_1\)</span> <it>and</it> <span class="math inline">\(X_2\)</span> above and beyond the sum of both individual effects. This holds for continuous <em>and</em> binary regressors.</p>
</div>
</div>
<div id="application-to-the-student-teacher-ratio-and-the-percentage-of-english-learners-2" class="section level4 hasAnchor" number="8.3.0.1">
<h4 class="hasAnchor"><span class="header-section-number">8.3.0.1</span> Application to the Student-Teacher Ratio and the Percentage of English Learners<a href="#application-to-the-student-teacher-ratio-and-the-percentage-of-english-learners-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We now examine the interaction between the continuous variables student-teacher ratio and the percentage of English learners.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate regression model including the interaction between &#39;PctEL&#39; and &#39;size&#39;</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>cci_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> size <span class="sc">+</span> english <span class="sc">+</span> english <span class="sc">*</span> size, <span class="at">data =</span> CASchools) </span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print a summary to the console</span></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cci_model, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 Estimate  Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb201-10"><a href="#cb201-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  686.3385268  11.7593466 58.3654  &lt; 2e-16 ***</span></span>
<span id="cb201-11"><a href="#cb201-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; size          -1.1170184   0.5875136 -1.9013  0.05796 .  </span></span>
<span id="cb201-12"><a href="#cb201-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; english       -0.6729119   0.3741231 -1.7986  0.07280 .  </span></span>
<span id="cb201-13"><a href="#cb201-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; size:english   0.0011618   0.0185357  0.0627  0.95005    </span></span>
<span id="cb201-14"><a href="#cb201-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb201-15"><a href="#cb201-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The estimated model equation is <span class="math display">\[ \widehat{TestScore} = \underset{(11.76)}{686.3} - \underset{(0.59)}{1.12} \times STR - \underset{(0.37)}{0.67} \times PctEL + \underset{(0.02)}{0.0012} \times (STR\times PctEL). \]</span></p>
<p>For the interpretation, let us consider the quartiles of <span class="math inline">\(PctEL\)</span>.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(CASchools<span class="sc">$</span>english)</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0.000   1.941   8.778  15.768  22.970  85.540</span></span></code></pre></div>
<p>According to @ref(eq:generalinteraction), if <span class="math inline">\(PctEL\)</span> is at its median value of <span class="math inline">\(8.78\)</span>, the slope of the regression function relating test scores and the student teacher ratio is predicted to be <span class="math inline">\(-1.12 + 0.0012 \times 8.78 = -1.11\)</span>. This means that increasing the student-teacher ratio by one unit is expected to deteriorate test scores by <span class="math inline">\(1.11\)</span> points. For the <span class="math inline">\(75\%\)</span> quantile, the estimated change on <span class="math inline">\(TestScore\)</span> of a one-unit increase in <span class="math inline">\(STR\)</span> is estimated by <span class="math inline">\(-1.12 + 0.0012 \times 23.0 = -1.09\)</span> so the slope is somewhat lower. The interpretation is that for a school district with a share of <span class="math inline">\(23\%\)</span> English learners, a reduction of the student-teacher ratio by one unit is expected to increase test scores by only <span class="math inline">\(1.09\)</span> points.</p>
<p>However, the output of <tt>summary()</tt> indicates that the difference of the effect for the median and the <span class="math inline">\(75\%\)</span> quantile is not statistically significant. <span class="math inline">\(H_0: \beta_3 = 0\)</span> cannot be rejected at the <span class="math inline">\(5\%\)</span> level of significance (the <span class="math inline">\(p\)</span>-value is <span class="math inline">\(0.95\)</span>).</p>
</div>
<div id="example-the-demand-for-economic-journals" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Example: The Demand for Economic Journals<a href="#example-the-demand-for-economic-journals" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this section we replicate the empirical example presented at pages 336 - 337 of the book. The central question is: how elastic is the demand by libraries for economic journals? The idea here is to analyze the relationship between the number of subscription to a journal at U.S. libraries and the journal’s subscription price. The study uses the data set <tt>Journals</tt> which is provided with the <tt>AER</tt> package and contains observations for <span class="math inline">\(180\)</span> economic journals for the year 2000. You can use the help function (<code>?Journals</code>) to get more information on the data after loading the package.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load package and the data set</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Journals&quot;</span>)</span></code></pre></div>
<p>We measure the price as “price per citation” and compute journal age and the number of characters manually. For consistency with the book we also rename the variables.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define and rename variables</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>Journals<span class="sc">$</span>PricePerCitation <span class="ot">&lt;-</span> Journals<span class="sc">$</span>price<span class="sc">/</span>Journals<span class="sc">$</span>citations</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>Journals<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="dv">2000</span> <span class="sc">-</span> Journals<span class="sc">$</span>foundingyear</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>Journals<span class="sc">$</span>Characters <span class="ot">&lt;-</span> Journals<span class="sc">$</span>charpp <span class="sc">*</span> Journals<span class="sc">$</span>pages<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>Journals<span class="sc">$</span>Subscriptions <span class="ot">&lt;-</span> Journals<span class="sc">$</span>subs</span></code></pre></div>
<p>The range of “price per citation” is quite large:</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute summary statistics for price per citation</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Journals<span class="sc">$</span>PricePerCitation)</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0.005223  0.464495  1.320513  2.548455  3.440171 24.459459</span></span></code></pre></div>
<p>The lowest price observed is a mere <span class="math inline">\(0.5\)</span>¢ per citation while the highest price is more than <span class="math inline">\(20\)</span>¢ per citation.</p>
<p>We now estimate four different model specifications. All models are log-log models. This is useful because it allows us to directly interpret the coefficients as elasticities, see Key Concept 8.2. <span class="math inline">\((I)\)</span> is a linear model. To alleviate a possible omitted variable bias, <span class="math inline">\((II)\)</span> augments <span class="math inline">\((I)\)</span> by the covariates <span class="math inline">\(\ln(Age)\)</span> and <span class="math inline">\(\ln(Characters)\)</span>. The largest model <span class="math inline">\((III)\)</span> attempts to capture nonlinearities in the relationship of <span class="math inline">\(\ln(Subscriptions)\)</span> and <span class="math inline">\(\ln(PricePerCitation)\)</span> using a cubic regression function of <span class="math inline">\(\ln(PricePerCitation)\)</span> and also adds the interaction term <span class="math inline">\((PricePerCitation \times Age)\)</span> while specification <span class="math inline">\((IV)\)</span> does not include the cubic term.</p>
<p><span class="math display">\[\begin{align*}
  (I)\quad \ln(Subscriptions_i) =&amp; \, \beta_0 + \beta_1 \ln(PricePerCitation_i) + u_i \\
  \\
  (II)\quad \ln(Subscriptions_i) =&amp; \, \beta_0 + \beta_1 \ln(PricePerCitation_i) + \beta_4 \ln(Age_i) + \beta_6 \ln(Characters_i) + u_i \\
  \\
  (III)\quad \ln(Subscriptions_i) =&amp; \, \beta_0 + \beta_1 \ln(PricePerCitation_i) + \beta_2 \ln(PricePerCitation_i)^2 \\
  +&amp; \, \beta_3 \ln(PricePerCitation_i)^3 + \beta_4 \ln(Age_i) + \beta_5 \left[\ln(Age_i) \times \ln(PricePerCitation_i)\right] \\ +&amp; \, \beta_6 \ln(Characters_i) + u_i \\
  \\
  (IV)\quad \ln(Subscriptions_i) =&amp; \, \beta_0 + \beta_1 \ln(PricePerCitation_i) + \beta_4 \ln(Age_i) + \beta_6 \ln(Characters_i) + u_i
\end{align*}\]</span></p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate models (I) - (IV)</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>Journals_mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Subscriptions) <span class="sc">~</span> <span class="fu">log</span>(PricePerCitation), </span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> Journals)</span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a>Journals_mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Subscriptions) <span class="sc">~</span> <span class="fu">log</span>(PricePerCitation) </span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a>                    <span class="sc">+</span> <span class="fu">log</span>(Age) <span class="sc">+</span> <span class="fu">log</span>(Characters), </span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> Journals)</span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a>Journals_mod3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Subscriptions) <span class="sc">~</span> </span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">log</span>(PricePerCitation) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">log</span>(PricePerCitation)<span class="sc">^</span><span class="dv">2</span>) </span>
<span id="cb206-11"><a href="#cb206-11" aria-hidden="true" tabindex="-1"></a>                    <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">log</span>(PricePerCitation)<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">log</span>(Age) </span>
<span id="cb206-12"><a href="#cb206-12" aria-hidden="true" tabindex="-1"></a>                    <span class="sc">+</span> <span class="fu">log</span>(Age)<span class="sc">:</span><span class="fu">log</span>(PricePerCitation) <span class="sc">+</span> <span class="fu">log</span>(Characters), </span>
<span id="cb206-13"><a href="#cb206-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> Journals)</span>
<span id="cb206-14"><a href="#cb206-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-15"><a href="#cb206-15" aria-hidden="true" tabindex="-1"></a>Journals_mod4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Subscriptions) <span class="sc">~</span> </span>
<span id="cb206-16"><a href="#cb206-16" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">log</span>(PricePerCitation) <span class="sc">+</span> <span class="fu">log</span>(Age) </span>
<span id="cb206-17"><a href="#cb206-17" aria-hidden="true" tabindex="-1"></a>                    <span class="sc">+</span> <span class="fu">log</span>(Age)<span class="sc">:</span><span class="fu">log</span>(PricePerCitation) <span class="sc">+</span> </span>
<span id="cb206-18"><a href="#cb206-18" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">log</span>(Characters), </span>
<span id="cb206-19"><a href="#cb206-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> Journals)</span></code></pre></div>
<p>Using <tt>summary()</tt>, we obtain the following estimated models:</p>
<p><span class="math display">\[\begin{align*}
  (I)\quad \widehat{\ln(Subscriptions_i)} =&amp; \, 4.77 - 0.53 \ln(PricePerCitation_i) \\
  \\
  (II)\quad \widehat{\ln(Subscriptions_i)} =&amp; \, 3.21 - 0.41 \ln(PricePerCitation_i) + 0.42 \ln(Age_i) + 0.21 \ln(Characters_i) \\
  \\
  (III)\quad \widehat{\ln(Subscriptions_i)} =&amp; \, 3.41 - 0.96 \ln(PricePerCitation_i) + 0.02 \ln(PricePerCitation_i)^2 \\
  &amp;+ 0.004 \ln(PricePerCitation_i)^3 + 0.37 \ln(Age_i) \\
  &amp;+ 0.16 \left[\ln(Age_i) \times \ln(PricePerCitation_i)\right] \\ &amp;+ 0.23 \ln(Characters_i) \\
  \\
  (IV)\quad \widehat{\ln(Subscriptions_i)} =&amp; \, 3.43 - 0.90 \ln(PricePerCitation_i) + 0.37 \ln(Age_i) \\
  &amp;+ 0.14 \left[\ln(Age_i) \times \ln(PricePerCitation_i)\right] + 0.23 \ln(Characters_i)
\end{align*}\]</span></p>
<p>We use an <span class="math inline">\(F\)</span>-Test to test if the transformations of <span class="math inline">\(\ln(PricePerCitation)\)</span> in Model <span class="math inline">\((III)\)</span> are statistically significant.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># F-Test for significance of cubic terms</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(Journals_mod3, </span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">&quot;I(log(PricePerCitation)^2)=0&quot;</span>, <span class="st">&quot;I(log(PricePerCitation)^3)=0&quot;</span>),</span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I(log(PricePerCitation)^2) = 0</span></span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I(log(PricePerCitation)^3) = 0</span></span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb207-11"><a href="#cb207-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb207-12"><a href="#cb207-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: log(Subscriptions) ~ log(PricePerCitation) + I(log(PricePerCitation)^2) + </span></span>
<span id="cb207-13"><a href="#cb207-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     I(log(PricePerCitation)^3) + log(Age) + log(Age):log(PricePerCitation) + </span></span>
<span id="cb207-14"><a href="#cb207-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     log(Characters)</span></span>
<span id="cb207-15"><a href="#cb207-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb207-16"><a href="#cb207-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb207-17"><a href="#cb207-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb207-18"><a href="#cb207-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F Pr(&gt;F)</span></span>
<span id="cb207-19"><a href="#cb207-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    175                 </span></span>
<span id="cb207-20"><a href="#cb207-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    173  2 0.1943 0.8236</span></span></code></pre></div>
<p>Clearly, we cannot reject the null hypothesis <span class="math inline">\(H_0: \beta_3=\beta_4=0\)</span> in model <span class="math inline">\((III)\)</span>.</p>
<p>We now demonstrate how the function <tt>stargazer()</tt> can be used to generate a tabular representation of all four models.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the stargazer package</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a><span class="co"># gather robust standard errors in a list</span></span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>rob_se <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(Journals_mod1, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(Journals_mod2, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(Journals_mod3, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(Journals_mod4, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))))</span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a><span class="co"># generate a Latex table using stargazer</span></span>
<span id="cb208-11"><a href="#cb208-11" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(Journals_mod1, Journals_mod2, Journals_mod3, Journals_mod4,</span>
<span id="cb208-12"><a href="#cb208-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">se =</span> rob_se,</span>
<span id="cb208-13"><a href="#cb208-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb208-14"><a href="#cb208-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">column.labels =</span> <span class="fu">c</span>(<span class="st">&quot;(I)&quot;</span>, <span class="st">&quot;(II)&quot;</span>, <span class="st">&quot;(III)&quot;</span>, <span class="st">&quot;(IV)&quot;</span>))</span></code></pre></div>



<table style="text-align:center"><tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"></td><td colspan="4">Dependent Variable: Logarithm of Subscriptions</td></tr>
<tr><td></td><td colspan="4" style="border-bottom: 1px solid black"></td></tr>
<tr><td style="text-align:left"></td><td colspan="4">log(Subscriptions)</td></tr>
<tr><td style="text-align:left"></td><td>(I)</td><td>(II)</td><td>(III)</td><td>(IV)</td></tr>
<tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">log(PricePerCitation)</td><td>-0.533<sup>***</sup></td><td>-0.408<sup>***</sup></td><td>-0.961<sup>***</sup></td><td>-0.899<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.034)</td><td>(0.044)</td><td>(0.160)</td><td>(0.145)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">I(log(PricePerCitation)2)</td><td></td><td></td><td>0.017</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td>(0.025)</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">I(log(PricePerCitation)3)</td><td></td><td></td><td>0.004</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td>(0.006)</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">log(Age)</td><td></td><td>0.424<sup>***</sup></td><td>0.373<sup>***</sup></td><td>0.374<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(0.119)</td><td>(0.118)</td><td>(0.118)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">log(Characters)</td><td></td><td>0.206<sup>**</sup></td><td>0.235<sup>**</sup></td><td>0.229<sup>**</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(0.098)</td><td>(0.098)</td><td>(0.096)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">log(PricePerCitation):log(Age)</td><td></td><td></td><td>0.156<sup>***</sup></td><td>0.141<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td>(0.052)</td><td>(0.040)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">Constant</td><td>4.766<sup>***</sup></td><td>3.207<sup>***</sup></td><td>3.408<sup>***</sup></td><td>3.434<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.055)</td><td>(0.380)</td><td>(0.374)</td><td>(0.367)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">Observations</td><td>180</td><td>180</td><td>180</td><td>180</td></tr>
<tr><td style="text-align:left">R<sup>2</sup></td><td>0.557</td><td>0.613</td><td>0.635</td><td>0.634</td></tr>
<tr><td style="text-align:left">Adjusted R<sup>2</sup></td><td>0.555</td><td>0.607</td><td>0.622</td><td>0.626</td></tr>
<tr><td style="text-align:left">Residual Std. Error</td><td>0.750 (df = 178)</td><td>0.705 (df = 176)</td><td>0.691 (df = 173)</td><td>0.688 (df = 175)</td></tr>
<tr><td style="text-align:left">F Statistic</td><td>224.037<sup>***</sup> (df = 1; 178)</td><td>93.009<sup>***</sup> (df = 3; 176)</td><td>50.149<sup>***</sup> (df = 6; 173)</td><td>75.749<sup>***</sup> (df = 4; 175)</td></tr>
<tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"><em>Note:</em></td><td colspan="4" style="text-align:right"><sup>*</sup>p<0.1; <sup>**</sup>p<0.05; <sup>***</sup>p<0.01</td></tr>
</table>
<caption><p style='text-align:center'>(#tab:nrmojs) Nonlinear Regression Models of Journal Subscribtions</p></caption>


<p>The subsequent code chunk reproduces Figure 8.9 of the book.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># divide plotting area</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">0</span>))</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>graphics<span class="sc">::</span><span class="fu">layout</span>(m)</span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a><span class="co"># scatterplot</span></span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Journals<span class="sc">$</span>PricePerCitation, </span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a>     Journals<span class="sc">$</span>Subscriptions, </span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, </span>
<span id="cb209-9"><a href="#cb209-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb209-10"><a href="#cb209-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Subscriptions&quot;</span>,</span>
<span id="cb209-11"><a href="#cb209-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;ln(Price per ciation)&quot;</span>,</span>
<span id="cb209-12"><a href="#cb209-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;(a)&quot;</span>)</span>
<span id="cb209-13"><a href="#cb209-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-14"><a href="#cb209-14" aria-hidden="true" tabindex="-1"></a><span class="co"># log-log scatterplot and estimated regression line (I)</span></span>
<span id="cb209-15"><a href="#cb209-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(Journals<span class="sc">$</span>PricePerCitation), </span>
<span id="cb209-16"><a href="#cb209-16" aria-hidden="true" tabindex="-1"></a>     <span class="fu">log</span>(Journals<span class="sc">$</span>Subscriptions), </span>
<span id="cb209-17"><a href="#cb209-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, </span>
<span id="cb209-18"><a href="#cb209-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb209-19"><a href="#cb209-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;ln(Subscriptions)&quot;</span>,</span>
<span id="cb209-20"><a href="#cb209-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;ln(Price per ciation)&quot;</span>,</span>
<span id="cb209-21"><a href="#cb209-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;(b)&quot;</span>)</span>
<span id="cb209-22"><a href="#cb209-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-23"><a href="#cb209-23" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(Journals_mod1,</span>
<span id="cb209-24"><a href="#cb209-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb209-25"><a href="#cb209-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-26"><a href="#cb209-26" aria-hidden="true" tabindex="-1"></a><span class="co"># log-log scatterplot and regression lines (IV) for Age = 5 and Age = 80</span></span>
<span id="cb209-27"><a href="#cb209-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(Journals<span class="sc">$</span>PricePerCitation), </span>
<span id="cb209-28"><a href="#cb209-28" aria-hidden="true" tabindex="-1"></a>     <span class="fu">log</span>(Journals<span class="sc">$</span>Subscriptions), </span>
<span id="cb209-29"><a href="#cb209-29" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, </span>
<span id="cb209-30"><a href="#cb209-30" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb209-31"><a href="#cb209-31" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;ln(Subscriptions)&quot;</span>,</span>
<span id="cb209-32"><a href="#cb209-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;ln(Price per ciation)&quot;</span>,</span>
<span id="cb209-33"><a href="#cb209-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;(c)&quot;</span>)</span>
<span id="cb209-34"><a href="#cb209-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-35"><a href="#cb209-35" aria-hidden="true" tabindex="-1"></a>JM4C <span class="ot">&lt;-</span>Journals_mod4<span class="sc">$</span>coefficients</span>
<span id="cb209-36"><a href="#cb209-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-37"><a href="#cb209-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Age = 80</span></span>
<span id="cb209-38"><a href="#cb209-38" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">coef =</span> <span class="fu">c</span>(JM4C[<span class="dv">1</span>] <span class="sc">+</span> JM4C[<span class="dv">3</span>] <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">80</span>), </span>
<span id="cb209-39"><a href="#cb209-39" aria-hidden="true" tabindex="-1"></a>                JM4C[<span class="dv">2</span>] <span class="sc">+</span> JM4C[<span class="dv">5</span>] <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">80</span>)),</span>
<span id="cb209-40"><a href="#cb209-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>,</span>
<span id="cb209-41"><a href="#cb209-41" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb209-42"><a href="#cb209-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-43"><a href="#cb209-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Age = 5</span></span>
<span id="cb209-44"><a href="#cb209-44" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">coef =</span> <span class="fu">c</span>(JM4C[<span class="dv">1</span>] <span class="sc">+</span> JM4C[<span class="dv">3</span>] <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">5</span>), </span>
<span id="cb209-45"><a href="#cb209-45" aria-hidden="true" tabindex="-1"></a>                JM4C[<span class="dv">2</span>] <span class="sc">+</span> JM4C[<span class="dv">5</span>] <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">5</span>)),</span>
<span id="cb209-46"><a href="#cb209-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>,</span>
<span id="cb209-47"><a href="#cb209-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-356-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>As can be seen from plots (a) and (b), the relation between subscriptions and the citation price is adverse and nonlinear. Log-transforming both variables makes it approximately linear. Plot (c) shows that the price elasticity of journal subscriptions depends on the journal’s age: the red line shows the estimated relationship for <span class="math inline">\(Age=80\)</span> while the green line represents the prediction from model <span class="math inline">\((IV)\)</span> for <span class="math inline">\(Age=5\)</span>.</p>
<p>Which conclusion can be drawn?</p>
<ol style="list-style-type: decimal">
<li><p>We conclude that the demand for journals is more elastic for young journals than for old journals.</p></li>
<li><p>For model <span class="math inline">\((III)\)</span> we cannot reject the null hypothesis that the coefficients on <span class="math inline">\(\ln(PricePerCitation)^2\)</span> and <span class="math inline">\(\ln(PricePerCitation)^3\)</span> are both zero using an <span class="math inline">\(F\)</span>-test. This is evidence compatible with a linear relation between log-subscriptions and log-price.</p></li>
<li><p>Demand is greater for Journals with more characters, holding price and age constant.</p></li>
</ol>
<p>Altogether our estimates suggest that the demand is very inelastic, i.e., the libraries’ demand for economic journals is quite insensitive to the price: using model <span class="math inline">\((IV)\)</span>, even for a young journal (<span class="math inline">\(Age=5\)</span>) we estimate the price elasticity to be <span class="math inline">\(-0.899+0.374\times\ln(5)+0.141\times\left[\ln(1)\times\ln(5)\right] \approx -0.3\)</span> so a one percent increase in price is predicted to reduce the demand by only <span class="math inline">\(0.3\)</span> percent.</p>
<p>This finding comes at no surprise since providing the most recent publications is a necessity for libraries.</p>
</div>
</div>
<div id="nonlinear-effects-on-test-scores-of-the-student-teacher-ratio" class="section level2 hasAnchor" number="8.4">
<h2 class="hasAnchor"><span class="header-section-number">8.4</span> Nonlinear Effects on Test Scores of the Student-Teacher Ratio<a href="#nonlinear-effects-on-test-scores-of-the-student-teacher-ratio" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this section we will discuss three specific questions about the relationship between test scores and the student-teacher ratio:</p>
<ol style="list-style-type: decimal">
<li><p>Does the effect on test scores of decreasing the student-teacher ratio depend on the fraction of English learners when we control for economic idiosyncrasies of the different districts?</p></li>
<li><p>Does this effect depend on the the student-teacher ratio?</p></li>
<li><p><em>How strong</em> is the effect of decreasing the student-teacher ratio (by two students per teacher) if we take into account economic characteristics and nonlinearities?</p></li>
</ol>
<p>Too answer these questions we consider a total of seven models, some of which are nonlinear regression specifications of the types that have been discussed before. As measures for the students’ economic backgrounds, we additionally consider the regressors <span class="math inline">\(lunch\)</span> and <span class="math inline">\(\ln(income)\)</span>. We use the logarithm of <span class="math inline">\(income\)</span> because the analysis in Chapter @ref(nfoasiv) showed that the nonlinear relationship between <span class="math inline">\(income\)</span> and <span class="math inline">\(TestScores\)</span> is approximately logarithmic. We do not include expenditure per pupil (<span class="math inline">\(expenditure\)</span>) because doing so would imply that expenditure varies with the student-teacher ratio (see Chapter 7.2 of the book for a detailed argument).</p>
<div id="nonlinear-regression-models-of-test-scores" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Nonlinear Regression Models of Test Scores<a href="#nonlinear-regression-models-of-test-scores" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The considered model specifications are:</p>
<p><span class="math display">\[\begin{align}
TestScore_i =&amp; \beta_0 + \beta_1 size_i + \beta_4 english_i + \beta_9 lunch_i + u_i \\
TestScore_i =&amp; \beta_0 + \beta_1 size_i + \beta_4 english_i + \beta_9 lunch_i + \beta_{10} \ln(income_i) + u_i \\
  TestScore_i =&amp; \beta_0 + \beta_1 size_i + \beta_5 HiEL_i + \beta_6 (HiEL_i\times size_i) + u_i \\
  TestScore_i =&amp; \beta_0 + \beta_1 size_i + \beta_5 HiEL_i + \beta_6 (HiEL_i\times size_i) + \beta_9 lunch_i + \beta_{10} \ln(income_i) + u_i \\
  TestScore_i =&amp; \beta_0 + \beta_1 size_i + \beta_2 size_i^2 + \beta_5 HiEL_i + \beta_9 lunch_i + \beta_{10} \ln(income_i) + u_i \\
  TestScore_i =&amp; \beta_0 + \beta_1 size_i + \beta_2 size_i^2 + \beta_3 size_i^3 + \beta_5 HiEL_i + \beta_6 (HiEL\times size) \\  &amp;+ \beta_7 (HiEL_i\times size_i^2) + \beta_8 (HiEL_i\times size_i^3) + \beta_9 lunch_i + \beta_{10} \ln(income_i) + u_i \\
  TestScore_i =&amp; \beta_0 + \beta_1 size_i + \beta_2 size_i^2 + \beta_3 size_i^3 + \beta_4 english + \beta_9 lunch_i + \beta_{10} \ln(income_i) + u_i
\end{align}\]</span></p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate all models</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>TestScore_mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> size <span class="sc">+</span> english <span class="sc">+</span> lunch, <span class="at">data =</span> CASchools)</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a>TestScore_mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> size <span class="sc">+</span> english <span class="sc">+</span> lunch <span class="sc">+</span> <span class="fu">log</span>(income), <span class="at">data =</span> CASchools)</span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a>TestScore_mod3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> size <span class="sc">+</span> HiEL <span class="sc">+</span> HiEL<span class="sc">:</span>size, <span class="at">data =</span> CASchools)</span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a>TestScore_mod4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> size <span class="sc">+</span> HiEL <span class="sc">+</span> HiEL<span class="sc">:</span>size <span class="sc">+</span> lunch <span class="sc">+</span> <span class="fu">log</span>(income), <span class="at">data =</span> CASchools)</span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-10"><a href="#cb210-10" aria-hidden="true" tabindex="-1"></a>TestScore_mod5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> size <span class="sc">+</span> <span class="fu">I</span>(size<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(size<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> HiEL <span class="sc">+</span> lunch <span class="sc">+</span> <span class="fu">log</span>(income),</span>
<span id="cb210-11"><a href="#cb210-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> CASchools)</span>
<span id="cb210-12"><a href="#cb210-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-13"><a href="#cb210-13" aria-hidden="true" tabindex="-1"></a>TestScore_mod6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> size <span class="sc">+</span> <span class="fu">I</span>(size<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(size<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> HiEL <span class="sc">+</span> HiEL<span class="sc">:</span>size <span class="sc">+</span> HiEL<span class="sc">:</span><span class="fu">I</span>(size<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb210-14"><a href="#cb210-14" aria-hidden="true" tabindex="-1"></a>    HiEL<span class="sc">:</span><span class="fu">I</span>(size<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> lunch <span class="sc">+</span> <span class="fu">log</span>(income), <span class="at">data =</span> CASchools)</span>
<span id="cb210-15"><a href="#cb210-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-16"><a href="#cb210-16" aria-hidden="true" tabindex="-1"></a>TestScore_mod7 <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> size <span class="sc">+</span> <span class="fu">I</span>(size<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(size<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> english <span class="sc">+</span> lunch <span class="sc">+</span> <span class="fu">log</span>(income),</span>
<span id="cb210-17"><a href="#cb210-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> CASchools)</span></code></pre></div>
<p>We may use <tt>summary()</tt> to assess the models’ fit. Using <tt>stargazer()</tt> we may also obtain a tabular representation of all regression outputs and which is more convenient for comparison of the models.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gather robust standard errors in a list</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>rob_se <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(TestScore_mod1, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(TestScore_mod2, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(TestScore_mod3, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(TestScore_mod4, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(TestScore_mod5, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(TestScore_mod6, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(TestScore_mod7, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))))</span>
<span id="cb211-9"><a href="#cb211-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-10"><a href="#cb211-10" aria-hidden="true" tabindex="-1"></a><span class="co"># generate a LaTeX table of regression outputs</span></span>
<span id="cb211-11"><a href="#cb211-11" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(TestScore_mod1, </span>
<span id="cb211-12"><a href="#cb211-12" aria-hidden="true" tabindex="-1"></a>          TestScore_mod2, </span>
<span id="cb211-13"><a href="#cb211-13" aria-hidden="true" tabindex="-1"></a>          TestScore_mod3, </span>
<span id="cb211-14"><a href="#cb211-14" aria-hidden="true" tabindex="-1"></a>          TestScore_mod4, </span>
<span id="cb211-15"><a href="#cb211-15" aria-hidden="true" tabindex="-1"></a>          TestScore_mod5, </span>
<span id="cb211-16"><a href="#cb211-16" aria-hidden="true" tabindex="-1"></a>          TestScore_mod6, </span>
<span id="cb211-17"><a href="#cb211-17" aria-hidden="true" tabindex="-1"></a>          TestScore_mod7,</span>
<span id="cb211-18"><a href="#cb211-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb211-19"><a href="#cb211-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">dep.var.caption =</span> <span class="st">&quot;Dependent Variable: Test Score&quot;</span>,</span>
<span id="cb211-20"><a href="#cb211-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">se =</span> rob_se,</span>
<span id="cb211-21"><a href="#cb211-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">column.labels =</span> <span class="fu">c</span>(<span class="st">&quot;(1)&quot;</span>, <span class="st">&quot;(2)&quot;</span>, <span class="st">&quot;(3)&quot;</span>, <span class="st">&quot;(4)&quot;</span>, <span class="st">&quot;(5)&quot;</span>, <span class="st">&quot;(6)&quot;</span>, <span class="st">&quot;(7)&quot;</span>))</span></code></pre></div>



<table style="text-align:center"><tr><td colspan="8" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"></td><td colspan="7">Dependent Variable: Test Score</td></tr>
<tr><td></td><td colspan="7" style="border-bottom: 1px solid black"></td></tr>
<tr><td style="text-align:left"></td><td colspan="7">score</td></tr>
<tr><td style="text-align:left"></td><td>(1)</td><td>(2)</td><td>(3)</td><td>(4)</td><td>(5)</td><td>(6)</td><td>(7)</td></tr>
<tr><td colspan="8" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">size</td><td>-0.998<sup>***</sup></td><td>-0.734<sup>***</sup></td><td>-0.968</td><td>-0.531</td><td>64.339<sup>***</sup></td><td>83.702<sup>***</sup></td><td>65.285<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.270)</td><td>(0.257)</td><td>(0.589)</td><td>(0.342)</td><td>(24.861)</td><td>(28.497)</td><td>(25.259)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">english</td><td>-0.122<sup>***</sup></td><td>-0.176<sup>***</sup></td><td></td><td></td><td></td><td></td><td>-0.166<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.033)</td><td>(0.034)</td><td></td><td></td><td></td><td></td><td>(0.034)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">I(size2)</td><td></td><td></td><td></td><td></td><td>-3.424<sup>***</sup></td><td>-4.381<sup>***</sup></td><td>-3.466<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td>(1.250)</td><td>(1.441)</td><td>(1.271)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">I(size3)</td><td></td><td></td><td></td><td></td><td>0.059<sup>***</sup></td><td>0.075<sup>***</sup></td><td>0.060<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td>(0.021)</td><td>(0.024)</td><td>(0.021)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">lunch</td><td>-0.547<sup>***</sup></td><td>-0.398<sup>***</sup></td><td></td><td>-0.411<sup>***</sup></td><td>-0.420<sup>***</sup></td><td>-0.418<sup>***</sup></td><td>-0.402<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.024)</td><td>(0.033)</td><td></td><td>(0.029)</td><td>(0.029)</td><td>(0.029)</td><td>(0.033)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">log(income)</td><td></td><td>11.569<sup>***</sup></td><td></td><td>12.124<sup>***</sup></td><td>11.748<sup>***</sup></td><td>11.800<sup>***</sup></td><td>11.509<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(1.819)</td><td></td><td>(1.798)</td><td>(1.771)</td><td>(1.778)</td><td>(1.806)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">HiEL</td><td></td><td></td><td>5.639</td><td>5.498</td><td>-5.474<sup>***</sup></td><td>816.076<sup>**</sup></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td>(19.515)</td><td>(9.795)</td><td>(1.034)</td><td>(327.674)</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">size:HiEL</td><td></td><td></td><td>-1.277</td><td>-0.578</td><td></td><td>-123.282<sup>**</sup></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td>(0.967)</td><td>(0.496)</td><td></td><td>(50.213)</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">I(size2):HiEL</td><td></td><td></td><td></td><td></td><td></td><td>6.121<sup>**</sup></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td>(2.542)</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">I(size3):HiEL</td><td></td><td></td><td></td><td></td><td></td><td>-0.101<sup>**</sup></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td>(0.043)</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">Constant</td><td>700.150<sup>***</sup></td><td>658.552<sup>***</sup></td><td>682.246<sup>***</sup></td><td>653.666<sup>***</sup></td><td>252.050</td><td>122.353</td><td>244.809</td></tr>
<tr><td style="text-align:left"></td><td>(5.568)</td><td>(8.642)</td><td>(11.868)</td><td>(9.869)</td><td>(163.634)</td><td>(185.519)</td><td>(165.722)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td colspan="8" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">Observations</td><td>420</td><td>420</td><td>420</td><td>420</td><td>420</td><td>420</td><td>420</td></tr>
<tr><td style="text-align:left">R<sup>2</sup></td><td>0.775</td><td>0.796</td><td>0.310</td><td>0.797</td><td>0.801</td><td>0.803</td><td>0.801</td></tr>
<tr><td style="text-align:left">Adjusted R<sup>2</sup></td><td>0.773</td><td>0.794</td><td>0.305</td><td>0.795</td><td>0.798</td><td>0.799</td><td>0.798</td></tr>
<tr><td style="text-align:left">Residual Std. Error</td><td>9.080 (df = 416)</td><td>8.643 (df = 415)</td><td>15.880 (df = 416)</td><td>8.629 (df = 414)</td><td>8.559 (df = 413)</td><td>8.547 (df = 410)</td><td>8.568 (df = 413)</td></tr>
<tr><td style="text-align:left">F Statistic</td><td>476.306<sup>***</sup> (df = 3; 416)</td><td>405.359<sup>***</sup> (df = 4; 415)</td><td>62.399<sup>***</sup> (df = 3; 416)</td><td>325.803<sup>***</sup> (df = 5; 414)</td><td>277.212<sup>***</sup> (df = 6; 413)</td><td>185.777<sup>***</sup> (df = 9; 410)</td><td>276.515<sup>***</sup> (df = 6; 413)</td></tr>
<tr><td colspan="8" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"><em>Note:</em></td><td colspan="7" style="text-align:right"><sup>*</sup>p<0.1; <sup>**</sup>p<0.05; <sup>***</sup>p<0.01</td></tr>
</table>
<caption><p style='text-align:center'>(#tab:nmots) Nonlinear Models of Test Scores</p></caption>


<p>Let us summarize what can be concluded from the results presented in Table @ref(tab:nmots).</p>
<p>First of all, the coefficient on <span class="math inline">\(size\)</span> is statistically significant in all seven models. Adding <span class="math inline">\(\ln(income)\)</span> to model (1) we find that the corresponding coefficient is statistically significant at <span class="math inline">\(1\%\)</span> while all other coefficients remain at their significance level. Furthermore, the estimate for the coefficient on <span class="math inline">\(size\)</span> is roughly <span class="math inline">\(0.27\)</span> points larger, which may be a sign of attenuated omitted variable bias. We consider this a reason to include <span class="math inline">\(\ln(income)\)</span> as a regressor in other models, too.</p>
<p>Regressions (3) and (4) aim to assess the effect of allowing for an interaction between <span class="math inline">\(size\)</span> and <span class="math inline">\(HiEL\)</span>, without and with economic control variables. In both models, both the coefficient on the interaction term and the coefficient on the dummy are not statistically significant. Thus, even with economic controls we cannot reject the null hypotheses, that the effect of the student-teacher ratio on test scores is the same for districts with high and districts with low share of English learning students.</p>
<p>Regression (5) includes a cubic term for the student-teacher ratio and omits the interaction between <span class="math inline">\(size\)</span> and <span class="math inline">\(HiEl\)</span>. The results indicate that there is a nonlinear effect of the student-teacher ratio on test scores (Can you verify this using an <span class="math inline">\(F\)</span>-test of <span class="math inline">\(H_0: \beta_2=\beta_3=0\)</span>?)</p>
<p>Consequently, regression (6) further explores whether the fraction of English learners impacts the student-teacher ratio by using <span class="math inline">\(HiEL \times size\)</span> and the interactions <span class="math inline">\(HiEL \times size^2\)</span> and <span class="math inline">\(HiEL \times size^3\)</span>. All individual <span class="math inline">\(t\)</span>-tests indicate that that there are significant effects. We check this using a robust <span class="math inline">\(F\)</span>-test of <span class="math inline">\(H_0: \beta_6=\beta_7=\beta_8=0\)</span>.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check joint significance of the interaction terms</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(TestScore_mod6, </span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">&quot;size:HiEL=0&quot;</span>, <span class="st">&quot;I(size^2):HiEL=0&quot;</span>, <span class="st">&quot;I(size^3):HiEL=0&quot;</span>),</span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; size:HiEL = 0</span></span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I(size^2):HiEL = 0</span></span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I(size^3):HiEL = 0</span></span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb212-13"><a href="#cb212-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: score ~ size + I(size^2) + I(size^3) + HiEL + HiEL:size + HiEL:I(size^2) + </span></span>
<span id="cb212-14"><a href="#cb212-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     HiEL:I(size^3) + lunch + log(income)</span></span>
<span id="cb212-15"><a href="#cb212-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb212-16"><a href="#cb212-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb212-17"><a href="#cb212-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb212-18"><a href="#cb212-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F  Pr(&gt;F)  </span></span>
<span id="cb212-19"><a href="#cb212-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    413                    </span></span>
<span id="cb212-20"><a href="#cb212-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    410  3 2.1885 0.08882 .</span></span>
<span id="cb212-21"><a href="#cb212-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb212-22"><a href="#cb212-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>We find that the null can be rejected at the level of <span class="math inline">\(5\%\)</span> and conclude that the regression function differs for districts with high and low percentage of English learners.</p>
<p>Specification (7) uses a continuous measure for the share of English learners instead of a dummy variable (and thus does not include interaction terms). We observe only small changes to the coefficient estimates on the other regressors and thus conclude that the results observed for specification (5) are not sensitive to the way the percentage of English learners is measured.</p>
<p>We continue by reproducing Figure 8.10 of the book for interpretation of the nonlinear specifications (2), (5) and (7).</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scatterplot</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(CASchools<span class="sc">$</span>size, </span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>     CASchools<span class="sc">$</span>score, </span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">28</span>),</span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">600</span>, <span class="dv">740</span>),</span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, </span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, </span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Student-Teacher Ratio&quot;</span>, </span>
<span id="cb213-9"><a href="#cb213-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Test Score&quot;</span>)</span>
<span id="cb213-10"><a href="#cb213-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-11"><a href="#cb213-11" aria-hidden="true" tabindex="-1"></a><span class="co"># add a legend</span></span>
<span id="cb213-12"><a href="#cb213-12" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;top&quot;</span>, </span>
<span id="cb213-13"><a href="#cb213-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Linear Regression (2)&quot;</span>, </span>
<span id="cb213-14"><a href="#cb213-14" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;Cubic Regression (5)&quot;</span>, </span>
<span id="cb213-15"><a href="#cb213-15" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;Cubic Regression (7)&quot;</span>),</span>
<span id="cb213-16"><a href="#cb213-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb213-17"><a href="#cb213-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb213-18"><a href="#cb213-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb213-19"><a href="#cb213-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>))</span>
<span id="cb213-20"><a href="#cb213-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-21"><a href="#cb213-21" aria-hidden="true" tabindex="-1"></a><span class="co"># data for use with predict()</span></span>
<span id="cb213-22"><a href="#cb213-22" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;size&quot;</span> <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">16</span>, <span class="dv">24</span>, <span class="fl">0.05</span>), </span>
<span id="cb213-23"><a href="#cb213-23" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;english&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(CASchools<span class="sc">$</span>english),</span>
<span id="cb213-24"><a href="#cb213-24" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;lunch&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(CASchools<span class="sc">$</span>lunch),</span>
<span id="cb213-25"><a href="#cb213-25" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;income&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(CASchools<span class="sc">$</span>income),</span>
<span id="cb213-26"><a href="#cb213-26" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;HiEL&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(CASchools<span class="sc">$</span>HiEL))</span>
<span id="cb213-27"><a href="#cb213-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-28"><a href="#cb213-28" aria-hidden="true" tabindex="-1"></a><span class="co"># add estimated regression function for model (2)</span></span>
<span id="cb213-29"><a href="#cb213-29" aria-hidden="true" tabindex="-1"></a>fitted <span class="ot">&lt;-</span> <span class="fu">predict</span>(TestScore_mod2, <span class="at">newdata =</span> new_data)</span>
<span id="cb213-30"><a href="#cb213-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-31"><a href="#cb213-31" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(new_data<span class="sc">$</span>size, </span>
<span id="cb213-32"><a href="#cb213-32" aria-hidden="true" tabindex="-1"></a>      fitted,</span>
<span id="cb213-33"><a href="#cb213-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="fl">1.5</span>,</span>
<span id="cb213-34"><a href="#cb213-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb213-35"><a href="#cb213-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-36"><a href="#cb213-36" aria-hidden="true" tabindex="-1"></a><span class="co"># add estimated regression function for model (5)</span></span>
<span id="cb213-37"><a href="#cb213-37" aria-hidden="true" tabindex="-1"></a>fitted <span class="ot">&lt;-</span> <span class="fu">predict</span>(TestScore_mod5, <span class="at">newdata =</span> new_data)</span>
<span id="cb213-38"><a href="#cb213-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-39"><a href="#cb213-39" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(new_data<span class="sc">$</span>size, </span>
<span id="cb213-40"><a href="#cb213-40" aria-hidden="true" tabindex="-1"></a>      fitted, </span>
<span id="cb213-41"><a href="#cb213-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="fl">1.5</span>,</span>
<span id="cb213-42"><a href="#cb213-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb213-43"><a href="#cb213-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-44"><a href="#cb213-44" aria-hidden="true" tabindex="-1"></a><span class="co"># add estimated regression function for model (7)</span></span>
<span id="cb213-45"><a href="#cb213-45" aria-hidden="true" tabindex="-1"></a>fitted <span class="ot">&lt;-</span> <span class="fu">predict</span>(TestScore_mod7, <span class="at">newdata =</span> new_data)</span>
<span id="cb213-46"><a href="#cb213-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-47"><a href="#cb213-47" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(new_data<span class="sc">$</span>size, </span>
<span id="cb213-48"><a href="#cb213-48" aria-hidden="true" tabindex="-1"></a>      fitted, </span>
<span id="cb213-49"><a href="#cb213-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb213-50"><a href="#cb213-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="fl">1.5</span>,</span>
<span id="cb213-51"><a href="#cb213-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-362-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>For the above figure all regressors except <span class="math inline">\(size\)</span> are set to their sample averages. We see that the cubic regressions (5) and (7) are almost identical. They indicate that the relation between test scores and the student-teacher ratio only has a small amount of nonlinearity since they do not deviate much from the regression function of (2).</p>
<p>The next code chunk reproduces Figure 8.11 of the book. We use <tt>plot()</tt> and <tt>points()</tt> to color observations depending on <span class="math inline">\(HiEL\)</span>. Again, the regression lines are drawn based on predictions using average sample averages of all regressors except for <span class="math inline">\(size\)</span>.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co"># draw scatterplot</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a><span class="co"># observations with HiEL = 0</span></span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(CASchools<span class="sc">$</span>size[CASchools<span class="sc">$</span>HiEL <span class="sc">==</span> <span class="dv">0</span>], </span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a>     CASchools<span class="sc">$</span>score[CASchools<span class="sc">$</span>HiEL <span class="sc">==</span> <span class="dv">0</span>], </span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">28</span>),</span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">600</span>, <span class="dv">730</span>),</span>
<span id="cb214-8"><a href="#cb214-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, </span>
<span id="cb214-9"><a href="#cb214-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, </span>
<span id="cb214-10"><a href="#cb214-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Student-Teacher Ratio&quot;</span>, </span>
<span id="cb214-11"><a href="#cb214-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Test Score&quot;</span>)</span>
<span id="cb214-12"><a href="#cb214-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-13"><a href="#cb214-13" aria-hidden="true" tabindex="-1"></a><span class="co"># observations with HiEL = 1</span></span>
<span id="cb214-14"><a href="#cb214-14" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(CASchools<span class="sc">$</span>size[CASchools<span class="sc">$</span>HiEL <span class="sc">==</span> <span class="dv">1</span>], </span>
<span id="cb214-15"><a href="#cb214-15" aria-hidden="true" tabindex="-1"></a>       CASchools<span class="sc">$</span>score[CASchools<span class="sc">$</span>HiEL <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb214-16"><a href="#cb214-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb214-17"><a href="#cb214-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb214-18"><a href="#cb214-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-19"><a href="#cb214-19" aria-hidden="true" tabindex="-1"></a><span class="co"># add a legend</span></span>
<span id="cb214-20"><a href="#cb214-20" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;top&quot;</span>, </span>
<span id="cb214-21"><a href="#cb214-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Regression (6) with HiEL=0&quot;</span>, <span class="st">&quot;Regression (6) with HiEL=1&quot;</span>),</span>
<span id="cb214-22"><a href="#cb214-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.7</span>,</span>
<span id="cb214-23"><a href="#cb214-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb214-24"><a href="#cb214-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb214-25"><a href="#cb214-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>))</span>
<span id="cb214-26"><a href="#cb214-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-27"><a href="#cb214-27" aria-hidden="true" tabindex="-1"></a><span class="co"># data for use with &#39;predict()&#39;</span></span>
<span id="cb214-28"><a href="#cb214-28" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;size&quot;</span> <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">12</span>, <span class="dv">28</span>, <span class="fl">0.05</span>), </span>
<span id="cb214-29"><a href="#cb214-29" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;english&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(CASchools<span class="sc">$</span>english),</span>
<span id="cb214-30"><a href="#cb214-30" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;lunch&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(CASchools<span class="sc">$</span>lunch),</span>
<span id="cb214-31"><a href="#cb214-31" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;income&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(CASchools<span class="sc">$</span>income),</span>
<span id="cb214-32"><a href="#cb214-32" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;HiEL&quot;</span> <span class="ot">=</span> <span class="dv">0</span>)</span>
<span id="cb214-33"><a href="#cb214-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-34"><a href="#cb214-34" aria-hidden="true" tabindex="-1"></a><span class="co"># add estimated regression function for model (6) with HiEL=0</span></span>
<span id="cb214-35"><a href="#cb214-35" aria-hidden="true" tabindex="-1"></a>fitted <span class="ot">&lt;-</span> <span class="fu">predict</span>(TestScore_mod6, <span class="at">newdata =</span> new_data)</span>
<span id="cb214-36"><a href="#cb214-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-37"><a href="#cb214-37" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(new_data<span class="sc">$</span>size, </span>
<span id="cb214-38"><a href="#cb214-38" aria-hidden="true" tabindex="-1"></a>      fitted, </span>
<span id="cb214-39"><a href="#cb214-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="fl">1.5</span>,</span>
<span id="cb214-40"><a href="#cb214-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;green&quot;</span>)</span>
<span id="cb214-41"><a href="#cb214-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-42"><a href="#cb214-42" aria-hidden="true" tabindex="-1"></a><span class="co"># add estimated regression function for model (6) with HiEL=1</span></span>
<span id="cb214-43"><a href="#cb214-43" aria-hidden="true" tabindex="-1"></a>new_data<span class="sc">$</span>HiEL <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb214-44"><a href="#cb214-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-45"><a href="#cb214-45" aria-hidden="true" tabindex="-1"></a>fitted <span class="ot">&lt;-</span> <span class="fu">predict</span>(TestScore_mod6, <span class="at">newdata =</span> new_data)</span>
<span id="cb214-46"><a href="#cb214-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-47"><a href="#cb214-47" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(new_data<span class="sc">$</span>size, </span>
<span id="cb214-48"><a href="#cb214-48" aria-hidden="true" tabindex="-1"></a>      fitted, </span>
<span id="cb214-49"><a href="#cb214-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="fl">1.5</span>,</span>
<span id="cb214-50"><a href="#cb214-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-363-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The regression output shows that model (6) finds statistically significant coefficients on the interaction terms <span class="math inline">\(HiEL:size\)</span>, <span class="math inline">\(HiEL:size^2\)</span> and <span class="math inline">\(HiEL:size^3\)</span>, i.e., there is evidence that the nonlinear relationship connecting test scores and student-teacher ratio depends on the fraction of English learning students in the district. However, the above figure shows that this difference is not of practical importance and is a good example for why one should be careful when interpreting nonlinear models: although the two regression functions look different, we see that the slope of both functions is almost identical for student-teacher ratios between <span class="math inline">\(17\)</span> and <span class="math inline">\(23\)</span>. Since this range includes almost <span class="math inline">\(90\%\)</span> of all observations, we can be confident that nonlinear interactions between the fraction of English learners and the student-teacher ratio can be neglected.</p>
<p>One might be tempted to object since both functions show opposing slopes for student-teacher ratios below <span class="math inline">\(15\)</span> and beyond <span class="math inline">\(24\)</span>. There are at least to possible objections:</p>
<ol style="list-style-type: decimal">
<li><p>There are only few observations with low and high values of the student-teacher ratio, so there is only little information to be exploited when estimating the model. This means the estimated function is less precise in the tails of the data set.</p></li>
<li><p>The above described behavior of the regression function, is a typical caveat when using cubic functions since they generally show extreme behavior for extreme regressor values. Think of the graph of <span class="math inline">\(f(x) = x^3\)</span>.</p></li>
</ol>
<p>We thus find no clear evidence for a relation between class size and test scores on the percentage of English learners in the district.</p>
</div>
<div id="summary" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Summary<a href="#summary" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We are now able to answer the three question posed at the beginning of this section.</p>
<ol style="list-style-type: decimal">
<li><p>In the linear models, the percentage of English learners has only little influence on the effect on test scores from changing the student-teacher ratio. This result stays valid if we control for economic background of the students. While the cubic specification (6) provides evidence that the effect the student-teacher ratio on test score depends on the share of English learners, the strength of this effect is negligible.</p></li>
<li><p>When controlling for the students’ economic background we find evidence of nonlinearities in the relationship between student-teacher ratio and test scores.</p></li>
<li><p>The linear specification (2) predicts that a reduction of the student-teacher ratio by two students per teacher leads to an improvement in test scores of about <span class="math inline">\(-0.73 \times (-2) = 1.46\)</span> points. Since the model is linear, this effect is independent of the class size. Assume that the student-teacher ratio is <span class="math inline">\(20\)</span>. For example, the nonlinear model (5) predicts that the reduction increases test scores by <span class="math display">\[64.33\cdot18+18^2\cdot(-3.42)+18^3\cdot(0.059) - (64.33\cdot20+20^2\cdot(-3.42)+20^3\cdot(0.059)) \approx 3.3\]</span> points. If the ratio is <span class="math inline">\(22\)</span>, a reduction to <span class="math inline">\(20\)</span> leads to a predicted improvement in test scores of <span class="math display">\[64.33\cdot20+20^2\cdot(-3.42)+20^3\cdot(0.059) - (64.33\cdot22+22^2\cdot(-3.42)+22^3\cdot(0.059)) \approx 2.4\]</span> points. This suggests that the effect is stronger in smaller classes.</p></li>
</ol>
</div>
</div>
<div id="exercises-8" class="section level2 hasAnchor" number="8.5">
<h2 class="hasAnchor"><span class="header-section-number">8.5</span> Exercises<a href="#exercises-8" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="correlation-and-nonlinearity-i" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">1. Correlation and (Non)linearity I<a href="#correlation-and-nonlinearity-i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider the estimated simple linear regression model <span class="math display">\[\widehat{medv_i} = 34.554 - 0.95\times lstat_i,\]</span></p>
<p>with <tt>medv</tt> (the median house value in the suburb) and <tt>lstat</tt> (the percent of households with low socioeconomic status in the suburb) being variables from the already known <tt>Boston</tt> dataset.</p>
<p>The <tt>lm()</tt> object for the above model is available as <tt>mod</tt> in your working environment. The package <tt>MASS</tt> has been loaded.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Compute the correlation coefficient between <tt>medv</tt> and <tt>lstat</tt> and save it to <tt>corr</tt>.</p></li>
<li><p>Plot <tt>medv</tt> against <tt>lstat</tt> and add the regression line using the model object <tt>mod</tt>. What do you notice?</p></li>
</ul>
<iframe src="DCL/ex8_1.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>You can use <tt>cor()</tt> to compute the correlation between variables.</p></li>
<li><p>You may use <tt>plot()</tt> and <tt>abline()</tt> to visualize regression results.</p></li>
</ul>
</div>
<div id="correlation-and-nonlinearity-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">2. Correlation and (Non)linearity II<a href="#correlation-and-nonlinearity-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the previous exercise we saw an example where the correlation between the dependent variable <tt>medv</tt> and the regressor <tt>medv</tt> is not useful for choosing the functional form of the regression since correlation captures only the linear relationship.</p>
<p>As an alternative, consider the nonlinear specification</p>
<p><span class="math display">\[medv_i = \beta_0 + \beta_1\times\log(lstat_i) + u_i.\]</span></p>
<p>The package <tt>MASS</tt> has been loaded.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Conduct the regression from above and assign the result to <tt>log_mod</tt>.</p></li>
<li><p>Visualize your results using a scatterplot and add the regression line. In comparison to the previous exercise, what do you notice now?</p></li>
</ul>
<iframe src="DCL/ex8_2.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>Use <tt>lm()</tt> to conduct the regression.</p></li>
<li><p>Use <tt>plot()</tt> and <tt>abline()</tt> to visualize regression results.</p></li>
</ul>
</div>
<div id="the-optimal-polynomial-order-sequential-testing" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">3. The Optimal Polynomial Order — Sequential Testing<a href="#the-optimal-polynomial-order-sequential-testing" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Recall the following model from the previous exercise <span class="math display">\[medv_i = \beta_0 + \beta_1\times\log(lstat_i) + u_i.\]</span></p>
<p>We saw that this model specification seems to be a reasonable choice. However, a higher order polynomial in <span class="math inline">\(\log(lstat_i)\)</span> may be more suited for explaining <span class="math inline">\(medv\)</span>.</p>
<p>The packages <tt>AER</tt> and <tt>MASS</tt> have been loaded.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Determine the optimal order of a polylog model using sequential testing. Use a maximum polynomial order of <span class="math inline">\(r=4\)</span> and the significance level <span class="math inline">\(\alpha=0.05\)</span>. We would like you to use a <tt>for()</tt> loop and recommend the following approach:</p>
<ol style="list-style-type: decimal">
<li>Estimate a model, say <tt>mod</tt>, which starts with the highest polynomial order</li>
<li>Save the <span class="math inline">\(p\)</span>-value (use robust standard errors) of the relevant parameter and compare it to the significance level <span class="math inline">\(\alpha\)</span></li>
<li>If you cannot reject the null, repeat steps 1 and 2 for the next lowest polynomial order, otherwise stop the loop and print out the polynomial order</li>
</ol></li>
<li><p>Compute the <span class="math inline">\(R^2\)</span> of the selected model and assign it to <tt>R2</tt>.</p></li>
</ul>
<iframe src="DCL/ex8_3.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>The index for the <tt>for()</tt> loop should start at 4 and end at 1.</p></li>
<li><p>Using <tt>poly()</tt> in the argument <tt>formula</tt> of <tt>lm()</tt> is a generic way to incorporate higher orders of a certain variable in the model. Besides the variable, you have to specify the degree of the polynomial via the argument <tt>degree</tt> and set <tt>raw = TRUE</tt>.</p></li>
<li><p>Use <tt>coeftest()</tt> together with the argument <tt>vcov.</tt> to obtain <span class="math inline">\(p\)</span>-values (use robust standard errors!). Use the structure of the resulting object to extract the relevant <span class="math inline">\(p\)</span>-value.</p></li>
<li><p>An <tt>if()</tt> statement may be useful to check whether the condition for acceptance of the null in step 3 is fulfilled.</p></li>
<li><p>A <tt>for()</tt> loop is stopped using <tt>break</tt>.</p></li>
<li><p>Use <tt>summary()</tt> to obtain the <span class="math inline">\(R^2\)</span>. You may extract it by appending <tt>$r.squared</tt> to the function call.</p></li>
</ul>
</div>
<div id="the-estimated-effect-of-a-unit-change" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">4. The Estimated Effect of a Unit Change<a href="#the-estimated-effect-of-a-unit-change" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Reconsider the polylog model from the previous exercise that was selected by the sequential testing approach. As this model is logarithmic and of quadratic form, we cannot simply read off the estimated effect of a unit change (that is, one percent) in <tt>lstat</tt> from the coefficient summary because this effect depends on the level of <tt>lstat</tt>. We may compute this manually.</p>
<p>The selected polylog model <tt>mod_pl</tt> is available in your working environment. The package <tt>MASS</tt> has been loaded.</p>
<p><strong>Instructions:</strong></p>
<p>Assume that we are interested in the effect on <tt>medv</tt> of an increase in <tt>lstat</tt> from <span class="math inline">\(10\%\)</span> to <span class="math inline">\(11\%\)</span>.</p>
<ul>
<li><p>Set up a <tt>data.frame</tt> with the relevant observations of <tt>lstat</tt>.</p></li>
<li><p>Use the new observations to predict the corresponding values of <tt>medv</tt>.</p></li>
<li><p>Compute the expected effect with the help of <tt>diff()</tt>.</p></li>
</ul>
<iframe src="DCL/ex8_4.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>You may use <tt>predict()</tt> together with the new data to obtain the predicted values of <tt>medv</tt>. Note that the column names of the <tt>data.frame</tt> must match the names of the regressors when using <tt>predict()</tt>.</p></li>
<li><p><tt>diff()</tt> expects a vector. It computes the differences between all entries of this vector.</p></li>
</ul>
</div>
<div id="interactions-between-independent-variables-i" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">5. Interactions between Independent Variables I<a href="#interactions-between-independent-variables-i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider the following regression model</p>
<p><span class="math display">\[medv_i=\beta_0+\beta_1\times chas_i+\beta_2\times old_i+\beta_3\times (chas_i\cdot old_i)+u_i\]</span></p>
<p>where <span class="math inline">\(chas_i\)</span> and <span class="math inline">\(old_i\)</span> are dummy variables. The former takes the value <span class="math inline">\(1\)</span>, if the Charles River (a short river in the proximity of Boston) passes through suburb <span class="math inline">\(i\)</span> and is <span class="math inline">\(0\)</span> otherwise. The latter indicates for a high proportion of old buildings and is constructed as</p>
<p><span class="math display">\[\begin{align}
old_i = &amp; \,
    \begin{cases}
      1 &amp; \text{if $age_i\geq 95$},\\
      0 &amp; \text{else},
    \end{cases}
\end{align}\]</span></p>
<p>with <span class="math inline">\(age_i\)</span> being the proportion of owner-occupied units built prior to 1940 in suburb <span class="math inline">\(i\)</span>.</p>
<p>The packages <tt>MASS</tt> and <tt>AER</tt> have been loaded.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Generate an append the binary variable <tt>old</tt> to the dataset <tt>Boston</tt>.</p></li>
<li><p>Conduct the regression stated above and assign the result to <tt>mod_bb</tt>.</p></li>
<li><p>Obtain a robust coefficient summary of the model. How do you interpret the results?</p></li>
</ul>
<iframe src="DCL/ex8_5.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>The operator <tt>&gt;=</tt> can be used to generate a logical vector. Transform a logical vector to the numeric type via <tt>as.numeric()</tt>.</p></li>
<li><p>In <tt>lm()</tt> there are two ways to include interaction terms using the argument <tt>formula</tt>:</p>
<ol style="list-style-type: decimal">
<li><p><tt>Var1*Var2</tt> to add <tt>Var1</tt>, <tt>Var2</tt> and the corresponding interaction term at once</p></li>
<li><p><tt>Var1:Var2</tt> to manually add the interaction term (which of course requires you to add the remaining terms manually as well)</p></li>
</ol></li>
</ul>
</div>
<div id="interactions-between-independent-variables-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">6. Interactions between Independent Variables II<a href="#interactions-between-independent-variables-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now consider the regression model</p>
<p><span class="math display">\[medv_i=\beta_0+\beta_1\times indus_i+\beta_2\times old_i+\beta_3\times (indus_i\cdot old_i)+u_i\]</span></p>
<p>with <span class="math inline">\(old_i\)</span> defined as in the previous exercise and <span class="math inline">\(indus_i\)</span> being the proportion of non-retail business acres in suburb <span class="math inline">\(i\)</span>.</p>
<p>The vector <tt>old</tt> from the previous exercise has been appended to the dataset. The package <tt>MASS</tt> has been loaded.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Estimate the above regression model and assign the result to <tt>mod_bc</tt>.</p></li>
<li><p>Extract the estimated coefficients of the model and assign them to <tt>params</tt>.</p></li>
<li><p>Plot <tt>medv</tt> against <tt>indus</tt> and add the regression lines for both states of the binary variable <span class="math inline">\(old\)</span>.</p></li>
</ul>
<iframe src="DCL/ex8_6.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>Make use the structure of <tt>mod_bc</tt> the output generated by <tt>coef()</tt> to extract the estimated coefficients.</p></li>
<li><p>Apart from passing an <tt>lm()</tt> object to <tt>abline()</tt> one may also specify intercept and slope manually using the arguments <tt>a</tt> and <tt>b</tt>, respectively.</p></li>
</ul>
</div>
<!--chapter:end:08-ch8.Rmd-->
</div>
</div>
<div id="asbomr" class="section level1 hasAnchor" number="9">
<h1 class="hasAnchor"><span class="header-section-number">9</span> Assessing Studies Based on Multiple Regression<a href="#asbomr" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The majority of Chapter 9 of the book is of a theoretical nature. Therefore this section briefly reviews the concepts of internal and external validity in general and discusses examples of threats to internal and external validity of multiple regression models. We discuss consequences of</p>
<ul>
<li>misspecification of the functional form of the regression function</li>
<li>measurement errors</li>
<li>missing data and sample selection</li>
<li>simultaneous causality</li>
</ul>
<p>as well as sources of inconsistency of OLS standard errors. We also review concerns regarding internal validity and external validity in the context of forecasting using regression models.</p>
<p>The chapter closes with an application in <tt>R</tt> where we assess whether results found by multiple regression using the <tt>CASchools</tt> data can be generalized to school districts of another federal state of the United States.</p>
<p>For a more detailed treatment of these topics we encourage you to work through Chapter 9 of the book.</p>
<p>The following packages and their dependencies are needed for reproduction of the code chunks presented throughout this chapter:</p>
<ul>
<li><tt>AER</tt></li>
<li><tt>mvtnorm</tt></li>
<li><tt>stargazer</tt></li>
</ul>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span></code></pre></div>
<div id="internal-and-external-validity" class="section level2 hasAnchor" number="9.1">
<h2 class="hasAnchor"><span class="header-section-number">9.1</span> Internal and External Validity<a href="#internal-and-external-validity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="KC9.1" class="keyconcept">
<h3 class="right">
Key Concept 9.1
</h3>
<h3 class="left">
Internal and External Validity
</h3>
<p>A statistical analysis has <em>internal</em> validity if the statistical inference made about causal effects are valid for the considered population.</p>
<p>An analysis is said to have <em>external</em> validity if inferences and conclusion are valid for the studies’ population and can be generalized to other populations and settings.</p>
</div>
<div id="threats-to-internal-validity" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Threats to Internal Validity<a href="#threats-to-internal-validity" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are two conditions for internal validity to exist:</p>
<ol style="list-style-type: decimal">
<li><p>The estimator of the causal effect, which is measured the coefficient(s) of interest, should be unbiased and consistent.</p></li>
<li><p>Statistical inference is valid, that is, hypothesis tests should have the desired size and confidence intervals should have the desired coverage probability.</p></li>
</ol>
<p>In multiple regression, we estimate the model coefficients using OLS. Thus for condition 1. to be fulfilled we need the OLS estimator to be unbiased and consistent. For the second condition to be valid, the standard errors must be valid such that hypothesis testing and computation of confidence intervals yield results that are trustworthy. Remember that a sufficient condition for conditions 1. and 2. to be fulfilled is that the assumptions of Key Concept 6.4 hold.</p>
</div>
<div id="threats-to-external-validity" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Threats to External Validity<a href="#threats-to-external-validity" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>External validity might be invalid</p>
<ul>
<li><p>if there are differences between the population studied and the population of interest.</p></li>
<li><p>if there are differences in the <em>settings</em> of the considered populations, e.g., the legal framework or the time of the investigation.</p></li>
</ul>
</div>
</div>
<div id="ttivomra" class="section level2 hasAnchor" number="9.2">
<h2 class="hasAnchor"><span class="header-section-number">9.2</span> Threats to Internal Validity of Multiple Regression Analysis<a href="#ttivomra" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section treats five sources that cause the OLS estimator in (multiple) regression models to be biased and inconsistent for the causal effect of interest and discusses possible remedies. All five sources imply a violation of the first least squares assumption presented in Key Concept 6.4.</p>
<p>This sections treats:</p>
<ul>
<li><p>omitted variable Bias</p></li>
<li><p>misspecification of the functional form</p></li>
<li><p>measurement errors</p></li>
<li><p>missing data and sample selection</p></li>
<li><p>simultaneous causality bias</p></li>
</ul>
<p>Beside these threats for consistency of the estimator, we also briefly discuss causes of inconsistent estimation of OLS standard errors.</p>
<div id="omitted-variable-bias-1" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Omitted Variable Bias<a href="#omitted-variable-bias-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="KC9.2" class="keyconcept">
<h3 class="right">
Key Concept 9.2
</h3>
<h3 class="left">
Omitted Variable Bias: Should I include More Variables in My Regression?
</h3>
<p>Inclusion of additional variables reduces the risk of omitted variable bias but may increase the variance of the estimator of the coefficient of interest.</p>
<p>We present some guidelines that help deciding whether to include an additional variable:</p>
<ol style="list-style-type: decimal">
<li><p>Specify the coefficient(s) of interest</p></li>
<li><p>Identify the most important potential sources of omitted variable bias by using knowledge available <em>before</em> estimating the model. You should end up with a baseline specification and a set of regressors that are questionable</p></li>
<li><p>Use different model specifications to test whether questionable regressors have coefficients different from zero</p></li>
<li><p>Use tables to provide full disclosure of your results, i.e., present different model specifications that both support your argument and enable the reader to see the effect of including questionable regressors</p></li>
</ol>
</div>
<p>By now you should be aware of omitted variable bias and its consequences. Key Concept 9.2 gives some guidelines on how to proceed if there are control variables that possibly allow to reduce omitted variable bias. If including additional variables to mitigate the bias is not an option because there are no adequate controls, there are different approaches to solve the problem:</p>
<ul>
<li><p>usage of panel data methods (discussed in Chapter @ref(rwpd))</p></li>
<li><p>usage of instrumental variables regression (discussed in Chapter @ref(ivr))</p></li>
<li><p>usage of a randomized control experiment (discussed in Chapter @ref(eaqe))</p></li>
</ul>
</div>
<div id="misspecification-of-the-functional-form-of-the-regression-function" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Misspecification of the Functional Form of the Regression Function<a href="#misspecification-of-the-functional-form-of-the-regression-function" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If the population regression function is nonlinear but the regression function is linear, the functional form of the regression model is misspecified. This leads to a bias of the OLS estimator.</p>
<div id="KC9.3" class="keyconcept">
<h3 class="right">
Key Concept 9.3
</h3>
<h3 class="left">
Functional Form Misspecification
</h3>
<p>A regression suffers from misspecification of the functional form when the functional form of the estimated regression model differs from the functional form of the population regression function. Functional form misspecification leads to biased and inconsistent coefficient estimators. A way to detect functional form misspecification is to plot the estimated regression function and the data. This may also be helpful to choose the correct functional form.</p>
</div>
<p>It is easy to come up with examples of misspecification of the functional form: consider the case where the population regression function is <span class="math display">\[Y_i = X_i^2\]</span> but the model used is <span class="math display">\[Y_i = \beta_0 + \beta_1 X_i + u_i.\]</span> Clearly, the regression function is misspecified here. We now simulate data and visualize this.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for reproducibility</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate data set</span></span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> X<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the regression function</span></span>
<span id="cb216-9"><a href="#cb216-9" aria-hidden="true" tabindex="-1"></a>ms_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X)</span>
<span id="cb216-10"><a href="#cb216-10" aria-hidden="true" tabindex="-1"></a>ms_mod</span>
<span id="cb216-11"><a href="#cb216-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb216-12"><a href="#cb216-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb216-13"><a href="#cb216-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = Y ~ X)</span></span>
<span id="cb216-14"><a href="#cb216-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb216-15"><a href="#cb216-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb216-16"><a href="#cb216-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)            X  </span></span>
<span id="cb216-17"><a href="#cb216-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     8.11363     -0.04684</span></span></code></pre></div>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the data</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X, Y, </span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Misspecification of Functional Form&quot;</span>,</span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>)</span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the linear regression line</span></span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(ms_mod, </span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>,</span>
<span id="cb217-10"><a href="#cb217-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-379-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>It is evident that the regression errors are relatively small for observations close to <span class="math inline">\(X=-3\)</span> and <span class="math inline">\(X=3\)</span> but that the errors increase for <span class="math inline">\(X\)</span> values closer to zero and even more for values beyond <span class="math inline">\(-4\)</span> and <span class="math inline">\(4\)</span>. Consequences are drastic: the intercept is estimated to be <span class="math inline">\(8.1\)</span> and for the slope parameter we obtain an estimate obviously very close to zero. This issue does not disappear as the number of observations is increased because OLS is biased <em>and</em> inconsistent due to the misspecification of the regression function.</p>
</div>
<div id="measurement-error-and-errors-in-variables-bias" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Measurement Error and Errors-in-Variables Bias<a href="#measurement-error-and-errors-in-variables-bias" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="KC9.4" class="keyconcept">
<h3 class="right">
Key Concept 9.4
</h3>
<h3 class="left">
Errors-in-Variable Bias
</h3>
<p>When independent variables are measured imprecisely, we speak of errors-in-variables bias. This bias does not disappear if the sample size is large. If the measurement error has mean zero and is independent of the affected variable, the OLS estimator of the respective coefficient is biased towards zero.</p>
</div>
<p>Suppose you are incorrectly measuring the single regressor <span class="math inline">\(X_i\)</span> so that there is a measurement error and you observe <span class="math inline">\(\overset{\sim}{X}_i\)</span> instead of <span class="math inline">\(X_i\)</span>. Then, instead of estimating the population the regression model <span class="math display">\[ Y_i = \beta_0 + \beta_1 X_i + u_i \]</span> you end up estimating
<span class="math display">\[\begin{align*}
  Y_i =&amp; \, \beta_0 + \beta_1 \overset{\sim}{X}_i + \underbrace{\beta_1 (X_i - \overset{\sim}{X}_i) + u_i}_{=v_i} \\
  Y_i =&amp; \, \beta_0 + \beta_1 \overset{\sim}{X}_i + v_i
\end{align*}\]</span>
where <span class="math inline">\(\overset{\sim}{X}_i\)</span> and the error term <span class="math inline">\(v_i\)</span> are correlated. Thus OLS would be biased and inconsistent for the true <span class="math inline">\(\beta_1\)</span> in this example. One can show that direction and strength of the bias depend on the correlation between the observed regressor, <span class="math inline">\(\overset{\sim}{X}_i\)</span>, and the measurement error, <span class="math inline">\(w_i =X_i - \overset{\sim}{X}_i\)</span>. This correlation in turn depends on the type of the measurement error made.</p>
<p>The classical measurement error model assumes that the measurement error, <span class="math inline">\(w_i\)</span>, has zero mean and that it is uncorrelated with the variable, <span class="math inline">\(X_i\)</span>, and the error term of the population regression model, <span class="math inline">\(u_i\)</span>:</p>
<p><span class="math display">\[\begin{equation}
  \overset{\sim}{X}_i = X_i + w_i, \ \ \rho_{w_i,u_i}=0, \ \ \rho_{w_i,X_i}=0
\end{equation}\]</span>
Then it holds that
<span class="math display">\[\begin{equation}
  \widehat{\beta}_1 \xrightarrow{p}{\frac{\sigma_{X}^2}{\sigma_{X}^2 + \sigma_{w}^2}} \beta_1 (\#eq:cmembias)
\end{equation}\]</span></p>
<p>which implies inconsistency as <span class="math inline">\(\sigma_{X}^2, \sigma_{w}^2 &gt; 0\)</span> such that the fraction in @ref(eq:cmembias) is smaller than <span class="math inline">\(1\)</span>. Note that there are two extreme cases:</p>
<ol style="list-style-type: decimal">
<li><p>If there is no measurement error, <span class="math inline">\(\sigma_{w}^2=0\)</span> such that <span class="math inline">\(\widehat{\beta}_1 \xrightarrow{p}{\beta_1}\)</span>.</p></li>
<li><p>if <span class="math inline">\(\sigma_{w}^2 \gg \sigma_{X}^2\)</span> we have <span class="math inline">\(\widehat{\beta}_1 \xrightarrow{p}{0}\)</span>. This is the case if the measurement error is so large that there essentially is no information on <span class="math inline">\(X\)</span> in the data that can be used to estimate <span class="math inline">\(\beta_1\)</span>.</p></li>
</ol>
<p>The most obvious way to deal with errors-in-variables bias is to use an accurately measured <span class="math inline">\(X\)</span>. If this not possible, instrumental variables regression is an option. One might also deal with the issue by using a mathematical model of the measurement error and adjust the estimates appropriately: if it is plausible that the classical measurement error model applies and if there is information that can be used to estimate the ratio in equation @ref(eq:cmembias), one could compute an estimate that corrects for the downward bias.</p>
<p>For example, consider two bivariate normally distributed random variables <span class="math inline">\(X,Y\)</span>. It is a <a href="https://en.wikipedia.org/wiki/Multivariate_normal_distribution#Bivariate_case">well known result</a> that the conditional expectation function of <span class="math inline">\(Y\)</span> given <span class="math inline">\(X\)</span> has the form
<span class="math display">\[\begin{align}
  E(Y\vert X) = E(Y) + \rho_{X,Y} \frac{\sigma_{Y}}{\sigma_{X}}\left[X-E(X)\right]. (\#eq:bnormexpfn)
\end{align}\]</span> Thus for
<span class="math display">\[\begin{align}
  (X, Y) \sim \mathcal{N}\left[\begin{pmatrix}50\\ 100\end{pmatrix},\begin{pmatrix}10 &amp; 5 \\ 5 &amp; 10 \end{pmatrix}\right] (\#eq:bvnormd)
\end{align}\]</span> according to @ref(eq:bnormexpfn), the population regression function is
<span class="math display">\[\begin{align*}
  Y_i =&amp; \, 100 + 0.5 (X_i - 50) \\
      =&amp; \, 75 + 0.5 X_i. (\#eq:bnormregfun)
\end{align*}\]</span>
Now suppose you gather data on <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, but that you can only measure <span class="math inline">\(\overset{\sim}{X_i} = X_i + w_i\)</span> with <span class="math inline">\(w_i \overset{i.i.d.}{\sim} \mathcal{N}(0,10)\)</span>. Since the <span class="math inline">\(w_i\)</span> are independent of the <span class="math inline">\(X_i\)</span>, there is no correlation between the <span class="math inline">\(X_i\)</span> and the <span class="math inline">\(w_i\)</span> so that we have a case of the classical measurement error model. We now illustrate this example in <tt>R</tt> using the package <tt>mvtnorm</tt> <span class="citation">(<a href="#ref-R-mvtnorm" role="doc-biblioref">Genz et al. 2021</a>)</span>.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a><span class="co"># load the package &#39;mvtnorm&#39; and simulate bivariate normal data</span></span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rmvnorm</span>(<span class="dv">1000</span>, <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">100</span>), </span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">sigma =</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">5</span>), <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>))))</span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true" tabindex="-1"></a><span class="co"># set columns names</span></span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span></code></pre></div>
<p>We now estimate a simple linear regression of <span class="math inline">\(Y\)</span> on <span class="math inline">\(X\)</span> using this sample data and run the same regression again but this time we add i.i.d. <span class="math inline">\(\mathcal{N}(0,10)\)</span> errors added to <span class="math inline">\(X\)</span>.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model (without measurement error)</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>noerror_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> dat)</span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model (with measurement error in X)</span></span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>X <span class="ot">&lt;-</span> dat<span class="sc">$</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">10</span>))</span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a>error_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> dat)</span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true" tabindex="-1"></a><span class="co"># print estimated coefficients to console</span></span>
<span id="cb219-9"><a href="#cb219-9" aria-hidden="true" tabindex="-1"></a>noerror_mod<span class="sc">$</span>coefficients</span>
<span id="cb219-10"><a href="#cb219-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)           X </span></span>
<span id="cb219-11"><a href="#cb219-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  76.3002047   0.4755264</span></span>
<span id="cb219-12"><a href="#cb219-12" aria-hidden="true" tabindex="-1"></a>error_mod<span class="sc">$</span>coefficients</span>
<span id="cb219-13"><a href="#cb219-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)           X </span></span>
<span id="cb219-14"><a href="#cb219-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   87.276004    0.255212</span></span></code></pre></div>
<p>Next, we visualize the results and compare with the population regression function.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot sample data</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>X, dat<span class="sc">$</span>Y, </span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, </span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>,</span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a><span class="co"># add population regression function</span></span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">coef =</span> <span class="fu">c</span>(<span class="dv">75</span>, <span class="fl">0.5</span>), </span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>,</span>
<span id="cb220-11"><a href="#cb220-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd  =</span> <span class="fl">1.5</span>)</span>
<span id="cb220-12"><a href="#cb220-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-13"><a href="#cb220-13" aria-hidden="true" tabindex="-1"></a><span class="co"># add estimated regression functions</span></span>
<span id="cb220-14"><a href="#cb220-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(noerror_mod, </span>
<span id="cb220-15"><a href="#cb220-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>,</span>
<span id="cb220-16"><a href="#cb220-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd  =</span> <span class="fl">1.5</span>)</span>
<span id="cb220-17"><a href="#cb220-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-18"><a href="#cb220-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(error_mod, </span>
<span id="cb220-19"><a href="#cb220-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>,</span>
<span id="cb220-20"><a href="#cb220-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd  =</span> <span class="fl">1.5</span>)</span>
<span id="cb220-21"><a href="#cb220-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-22"><a href="#cb220-22" aria-hidden="true" tabindex="-1"></a><span class="co"># add legend</span></span>
<span id="cb220-23"><a href="#cb220-23" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb220-24"><a href="#cb220-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">bg =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb220-25"><a href="#cb220-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb220-26"><a href="#cb220-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb220-27"><a href="#cb220-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;purple&quot;</span>, <span class="st">&quot;darkred&quot;</span>), </span>
<span id="cb220-28"><a href="#cb220-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Population&quot;</span>, <span class="st">&quot;No Errors&quot;</span>, <span class="st">&quot;Errors&quot;</span>))</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-384-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>In the situation without measurement error, the estimated regression function is close to the population regression function. Things are different when we use the mismeasured regressor <span class="math inline">\(X\)</span>: both the estimate for the intercept and the estimate for the coefficient on <span class="math inline">\(X\)</span> differ considerably from results obtained using the “clean” data on <span class="math inline">\(X\)</span>. In particular <span class="math inline">\(\widehat{\beta}_1 = 0.255\)</span>, so there is a downward bias. We are in the comfortable situation to know <span class="math inline">\(\sigma_X^2\)</span> and <span class="math inline">\(\sigma^2_w\)</span>. This allows us to correct for the bias using @ref(eq:cmembias). Using this information we obtain the biased-corrected estimate <span class="math display">\[\frac{\sigma_X^2 + \sigma_w^2}{\sigma_X^2} \cdot \widehat{\beta}_1 = \frac{10+10}{10} \cdot 0.255 = 0.51\]</span> which is quite close to <span class="math inline">\(\beta_1=0.5\)</span>, the true coefficient from the population regression function.</p>
<p>Bear in mind that the above analysis uses a single sample. Thus one may argue that the results are just a coincidence. Can you show the contrary using a simulation study?</p>
</div>
<div id="missing-data-and-sample-selection" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Missing Data and Sample Selection<a href="#missing-data-and-sample-selection" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="KC9.5" class="keyconcept">
<h3 class="right">
Key Concept 9.5
</h3>
<h3 class="left">
Sample Selection Bias
</h3>
<p>When the sampling process influences the availability of data and when there is a relation of this sampling process to the dependent variable that goes beyond the dependence on the regressors, we say that there is a sample selection bias. This bias is due to correlation between one or more regressors and the error term. Sample selection implies both bias and inconsistency of the OLS estimator.</p>
</div>
<p>There are three cases of sample selection. Only one of them poses a threat to internal validity of a regression study. The three cases are:</p>
<ol style="list-style-type: decimal">
<li><p>Data are missing at random.</p></li>
<li><p>Data are missing based on the value of a regressor.</p></li>
<li><p>Data are missing due to a selection process which is related to the dependent variable.</p></li>
</ol>
<p>Let us jump back to the example of variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> distributed as stated in equation @ref(eq:bvnormd) and illustrate all three cases using <tt>R</tt>.</p>
<p>If data are missing at random, this is nothing but loosing observations. For example, loosing <span class="math inline">\(50\%\)</span> of the sample would be the same as never having seen the (randomly chosen) half of the sample observed. Therefore, missing data do not introduce an estimation bias and “only” lead to less efficient estimators.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate data</span></span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rmvnorm</span>(<span class="dv">1000</span>, <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">100</span>), </span>
<span id="cb221-7"><a href="#cb221-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">sigma =</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">5</span>), <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>))))</span>
<span id="cb221-8"><a href="#cb221-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-9"><a href="#cb221-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb221-10"><a href="#cb221-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-11"><a href="#cb221-11" aria-hidden="true" tabindex="-1"></a><span class="co"># mark 500 randomly selected observations</span></span>
<span id="cb221-12"><a href="#cb221-12" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="at">size =</span> <span class="dv">500</span>)</span>
<span id="cb221-13"><a href="#cb221-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-14"><a href="#cb221-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>X[<span class="sc">-</span>id], </span>
<span id="cb221-15"><a href="#cb221-15" aria-hidden="true" tabindex="-1"></a>     dat<span class="sc">$</span>Y[<span class="sc">-</span>id], </span>
<span id="cb221-16"><a href="#cb221-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb221-17"><a href="#cb221-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb221-18"><a href="#cb221-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb221-19"><a href="#cb221-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>,</span>
<span id="cb221-20"><a href="#cb221-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb221-21"><a href="#cb221-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-22"><a href="#cb221-22" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(dat<span class="sc">$</span>X[id], </span>
<span id="cb221-23"><a href="#cb221-23" aria-hidden="true" tabindex="-1"></a>       dat<span class="sc">$</span>Y[id],</span>
<span id="cb221-24"><a href="#cb221-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb221-25"><a href="#cb221-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, </span>
<span id="cb221-26"><a href="#cb221-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb221-27"><a href="#cb221-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-28"><a href="#cb221-28" aria-hidden="true" tabindex="-1"></a><span class="co"># add the population regression function</span></span>
<span id="cb221-29"><a href="#cb221-29" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">coef =</span> <span class="fu">c</span>(<span class="dv">75</span>, <span class="fl">0.5</span>), </span>
<span id="cb221-30"><a href="#cb221-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>,</span>
<span id="cb221-31"><a href="#cb221-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd  =</span> <span class="fl">1.5</span>)</span>
<span id="cb221-32"><a href="#cb221-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-33"><a href="#cb221-33" aria-hidden="true" tabindex="-1"></a><span class="co"># add the estimated regression function for the full sample</span></span>
<span id="cb221-34"><a href="#cb221-34" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(noerror_mod)</span>
<span id="cb221-35"><a href="#cb221-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-36"><a href="#cb221-36" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate model case 1 and add the regression line</span></span>
<span id="cb221-37"><a href="#cb221-37" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat[<span class="sc">-</span>id, ]</span>
<span id="cb221-38"><a href="#cb221-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-39"><a href="#cb221-39" aria-hidden="true" tabindex="-1"></a>c1_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(dat<span class="sc">$</span>Y <span class="sc">~</span> dat<span class="sc">$</span>X, <span class="at">data =</span> dat)</span>
<span id="cb221-40"><a href="#cb221-40" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(c1_mod, <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>)</span>
<span id="cb221-41"><a href="#cb221-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-42"><a href="#cb221-42" aria-hidden="true" tabindex="-1"></a><span class="co"># add a legend</span></span>
<span id="cb221-43"><a href="#cb221-43" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb221-44"><a href="#cb221-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb221-45"><a href="#cb221-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">bg =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb221-46"><a href="#cb221-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb221-47"><a href="#cb221-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;purple&quot;</span>), </span>
<span id="cb221-48"><a href="#cb221-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Population&quot;</span>, <span class="st">&quot;Full sample&quot;</span>, <span class="st">&quot;500 obs. randomly selected&quot;</span>))</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-387-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The gray dots represent the <span class="math inline">\(500\)</span> discarded observations. When using the remaining observations, the estimation results deviate only marginally from the results obtained using the full sample.</p>
<p>Selecting data randomly based on the value of a regressor has also the effect of reducing the sample size and does not introduce estimation bias. We will now drop all observations with <span class="math inline">\(X &gt; 45\)</span>, estimate the model again and compare.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set random seed</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate data</span></span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rmvnorm</span>(<span class="dv">1000</span>, <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">100</span>), </span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">sigma =</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">5</span>), <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>))))</span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-11"><a href="#cb222-11" aria-hidden="true" tabindex="-1"></a><span class="co"># mark observations</span></span>
<span id="cb222-12"><a href="#cb222-12" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> dat<span class="sc">$</span>X <span class="sc">&gt;=</span> <span class="dv">45</span></span>
<span id="cb222-13"><a href="#cb222-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-14"><a href="#cb222-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>X[<span class="sc">-</span>id], </span>
<span id="cb222-15"><a href="#cb222-15" aria-hidden="true" tabindex="-1"></a>     dat<span class="sc">$</span>Y[<span class="sc">-</span>id], </span>
<span id="cb222-16"><a href="#cb222-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb222-17"><a href="#cb222-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb222-18"><a href="#cb222-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb222-19"><a href="#cb222-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>,</span>
<span id="cb222-20"><a href="#cb222-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb222-21"><a href="#cb222-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-22"><a href="#cb222-22" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(dat<span class="sc">$</span>X[id], </span>
<span id="cb222-23"><a href="#cb222-23" aria-hidden="true" tabindex="-1"></a>       dat<span class="sc">$</span>Y[id], </span>
<span id="cb222-24"><a href="#cb222-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb222-25"><a href="#cb222-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb222-26"><a href="#cb222-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb222-27"><a href="#cb222-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-28"><a href="#cb222-28" aria-hidden="true" tabindex="-1"></a><span class="co"># add population regression function</span></span>
<span id="cb222-29"><a href="#cb222-29" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">coef =</span> <span class="fu">c</span>(<span class="dv">75</span>, <span class="fl">0.5</span>), </span>
<span id="cb222-30"><a href="#cb222-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>,</span>
<span id="cb222-31"><a href="#cb222-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd  =</span> <span class="fl">1.5</span>)</span>
<span id="cb222-32"><a href="#cb222-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-33"><a href="#cb222-33" aria-hidden="true" tabindex="-1"></a><span class="co"># add estimated regression function for full sample</span></span>
<span id="cb222-34"><a href="#cb222-34" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(noerror_mod)</span>
<span id="cb222-35"><a href="#cb222-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-36"><a href="#cb222-36" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate model case 1, add regression line</span></span>
<span id="cb222-37"><a href="#cb222-37" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat[<span class="sc">-</span>id, ]</span>
<span id="cb222-38"><a href="#cb222-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-39"><a href="#cb222-39" aria-hidden="true" tabindex="-1"></a>c2_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(dat<span class="sc">$</span>Y <span class="sc">~</span> dat<span class="sc">$</span>X, <span class="at">data =</span> dat)</span>
<span id="cb222-40"><a href="#cb222-40" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(c2_mod, <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>)</span>
<span id="cb222-41"><a href="#cb222-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-42"><a href="#cb222-42" aria-hidden="true" tabindex="-1"></a><span class="co"># add legend</span></span>
<span id="cb222-43"><a href="#cb222-43" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb222-44"><a href="#cb222-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb222-45"><a href="#cb222-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">bg =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb222-46"><a href="#cb222-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb222-47"><a href="#cb222-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;purple&quot;</span>), </span>
<span id="cb222-48"><a href="#cb222-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Population&quot;</span>, <span class="st">&quot;Full sample&quot;</span>, <span class="st">&quot;Obs. with X &lt;= 45&quot;</span>))</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-388-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Note that although we dropped more than <span class="math inline">\(90\%\)</span> of all observations, the estimated regression function is very close to the line estimated based on the full sample.</p>
<p>In the third case we face sample selection bias. We can illustrate this by using only observations with <span class="math inline">\(X_i&lt;55\)</span> and <span class="math inline">\(Y_i&gt;100\)</span>. These observations are easily identified using the function <tt>which()</tt> and logical operators: <code>which(dat$X &lt; 55 &amp; dat$Y &gt; 100)</code></p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set random seed</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate data</span></span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rmvnorm</span>(<span class="dv">1000</span>, <span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">100</span>), </span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">sigma =</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">5</span>), <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span>))))</span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>,<span class="st">&quot;Y&quot;</span>)</span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-11"><a href="#cb223-11" aria-hidden="true" tabindex="-1"></a><span class="co"># mark observations</span></span>
<span id="cb223-12"><a href="#cb223-12" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> <span class="fu">which</span>(dat<span class="sc">$</span>X <span class="sc">&lt;=</span> <span class="dv">55</span> <span class="sc">&amp;</span> dat<span class="sc">$</span>Y <span class="sc">&gt;=</span> <span class="dv">100</span>)</span>
<span id="cb223-13"><a href="#cb223-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-14"><a href="#cb223-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>X[<span class="sc">-</span>id], </span>
<span id="cb223-15"><a href="#cb223-15" aria-hidden="true" tabindex="-1"></a>       dat<span class="sc">$</span>Y[<span class="sc">-</span>id], </span>
<span id="cb223-16"><a href="#cb223-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb223-17"><a href="#cb223-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb223-18"><a href="#cb223-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb223-19"><a href="#cb223-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>,</span>
<span id="cb223-20"><a href="#cb223-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb223-21"><a href="#cb223-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-22"><a href="#cb223-22" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(dat<span class="sc">$</span>X[id], </span>
<span id="cb223-23"><a href="#cb223-23" aria-hidden="true" tabindex="-1"></a>     dat<span class="sc">$</span>Y[id], </span>
<span id="cb223-24"><a href="#cb223-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb223-25"><a href="#cb223-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb223-26"><a href="#cb223-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb223-27"><a href="#cb223-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-28"><a href="#cb223-28" aria-hidden="true" tabindex="-1"></a><span class="co"># add population regression function</span></span>
<span id="cb223-29"><a href="#cb223-29" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">coef =</span> <span class="fu">c</span>(<span class="dv">75</span>, <span class="fl">0.5</span>), </span>
<span id="cb223-30"><a href="#cb223-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>,</span>
<span id="cb223-31"><a href="#cb223-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd  =</span> <span class="fl">1.5</span>)</span>
<span id="cb223-32"><a href="#cb223-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-33"><a href="#cb223-33" aria-hidden="true" tabindex="-1"></a><span class="co"># add estimated regression function for full sample</span></span>
<span id="cb223-34"><a href="#cb223-34" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(noerror_mod)</span>
<span id="cb223-35"><a href="#cb223-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-36"><a href="#cb223-36" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate model case 1, add regression line</span></span>
<span id="cb223-37"><a href="#cb223-37" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat[id, ]</span>
<span id="cb223-38"><a href="#cb223-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-39"><a href="#cb223-39" aria-hidden="true" tabindex="-1"></a>c3_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(dat<span class="sc">$</span>Y <span class="sc">~</span> dat<span class="sc">$</span>X, <span class="at">data =</span> dat)</span>
<span id="cb223-40"><a href="#cb223-40" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(c3_mod, <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>)</span>
<span id="cb223-41"><a href="#cb223-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-42"><a href="#cb223-42" aria-hidden="true" tabindex="-1"></a><span class="co"># add legend</span></span>
<span id="cb223-43"><a href="#cb223-43" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb223-44"><a href="#cb223-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb223-45"><a href="#cb223-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">bg =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb223-46"><a href="#cb223-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb223-47"><a href="#cb223-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;purple&quot;</span>), </span>
<span id="cb223-48"><a href="#cb223-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Population&quot;</span>, <span class="st">&quot;Full sample&quot;</span>, <span class="st">&quot;X &lt;= 55 &amp; Y &gt;= 100&quot;</span>))</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-389-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>We see that the selection process leads to biased estimation results.</p>
<p>There are methods that allow to correct for sample selection bias. However, these methods are beyond the scope of the book and are therefore not considered here. The concept of sample selection bias is summarized in Key Concept 9.5.</p>
</div>
<div id="simultaneous-causality" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Simultaneous Causality<a href="#simultaneous-causality" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="KC9.6" class="keyconcept">
<h3 class="right">
Key Concept 9.6
</h3>
<h3 class="left">
Simultaneous Causality Bias
</h3>
<p>So far we have assumed that the changes in the independent variable <span class="math inline">\(X\)</span> are responsible for changes in the dependent variable <span class="math inline">\(Y\)</span>. When the reverse is also true, we say that there is <em>simultaneous causality</em> between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. This reverse causality leads to correlation between <span class="math inline">\(X\)</span> and the error in the population regression of interest such that the coefficient on <span class="math inline">\(X\)</span> is estimated with bias.</p>
</div>
<p>Suppose we are interested in estimating the effect of a <span class="math inline">\(20\%\)</span> increase in cigarettes prices on cigarette consumption in the United States using a multiple regression model. This may be investigated using the dataset <tt>CigarettesSW</tt> which is part of the <tt>AER</tt> package. <tt>CigarettesSW</tt> is a panel data set on cigarette consumption for all 48 continental U.S. federal states from 1985-1995 and provides data on economic indicators and average local prices, taxes and per capita pack consumption.</p>
<p>After loading the data set, we pick observations for the year 1995 and plot logarithms of the per pack price, <tt>price</tt>, against pack consumption, <tt>packs</tt>, and estimate a simple linear regression model.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the data set</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;CigarettesSW&quot;</span>)</span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>c1995 <span class="ot">&lt;-</span> <span class="fu">subset</span>(CigarettesSW, year <span class="sc">==</span> <span class="st">&quot;1995&quot;</span>)</span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model</span></span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a>cigcon_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(packs) <span class="sc">~</span> <span class="fu">log</span>(price), <span class="at">data =</span> c1995)</span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a>cigcon_mod</span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = log(packs) ~ log(price), data = c1995)</span></span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb224-13"><a href="#cb224-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb224-14"><a href="#cb224-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)   log(price)  </span></span>
<span id="cb224-15"><a href="#cb224-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      10.850       -1.213</span></span></code></pre></div>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the estimated regression line and the data</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(c1995<span class="sc">$</span>price), <span class="fu">log</span>(c1995<span class="sc">$</span>packs),</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;ln(Price)&quot;</span>,</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;ln(Consumption)&quot;</span>,</span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Demand for Cigarettes&quot;</span>,</span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>)</span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(cigcon_mod, </span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>, </span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-393-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Remember from Chapter @ref(nrf) that, due to the log-log specification, in the population regression the coefficient on the logarithm of price is interpreted as the price elasticity of consumption. The estimated coefficient suggests that a <span class="math inline">\(1\%\)</span> increase in cigarettes prices reduces cigarette consumption by about <span class="math inline">\(1.2\%\)</span>, on average. Have we estimated a demand curve? The answer is no: this is a classic example of simultaneous causality, see Key Concept 9.6. The observations are market equilibria which are determined by both changes in supply and changes in demand. Therefore the price is correlated with the error term and the OLS estimator is biased. We can neither estimate a demand nor a supply curve consistently using this approach.</p>
<p>We will return to this issue in Chapter @ref(ivr) which treats instrumental variables regression, an approach that allows consistent estimation when there is simultaneous causality.</p>
</div>
<div id="sources-of-inconsistency-of-ols-standard-errors" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Sources of Inconsistency of OLS Standard Errors<a href="#sources-of-inconsistency-of-ols-standard-errors" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are two central threats to computation of consistent OLS standard errors:</p>
<ol style="list-style-type: decimal">
<li><p>Heteroskedasticity: implications of heteroskedasticiy have been discussed in Chapter @ref(htaciitslrm). Heteroskedasticity-robust standard errors as computed by the function <tt>vcovHC()</tt> from the package <tt>sandwich</tt> produce valid standard errors under heteroskedasticity.</p></li>
<li><p>Serial correlation: if the population regression error is correlated across observations, we have serial correlation. This often happens in applications where repeated observations are used, e.g., in panel data studies. As for heteroskedasticity, <tt>vcovHC()</tt> can be used to obtain valid standard errors when there is serial correlation.</p></li>
</ol>
<p>Inconsistent standard errors will produce invalid hypothesis tests and wrong confidence intervals. For example, when testing the null that some model coefficient is zero, we cannot trust the outcome anymore because the test may fail to have a size of <span class="math inline">\(5\%\)</span> due to the wrongly computed standard error.</p>
<p>Key Concept 9.7 summarizes all threats to internal validity discussed above.</p>
<div id="KC9.7" class="keyconcept">
<h3 class="right">
Key Concept 9.7
</h3>
<h3 class="left">
Threats to Internal Validity of a Regression Study
</h3>
<p>The five primary threats to internal validity of a multiple regression study are:</p>
<ol style="list-style-type: decimal">
<li><p>Omitted variables</p></li>
<li><p>Misspecification of functional form</p></li>
<li><p>Errors in variables (measurement errors in the regressors)</p></li>
<li><p>Sample selection</p></li>
<li><p>Simultaneous causality</p></li>
</ol>
<p>All these threats lead to failure of the first least squares assumption <span class="math display">\[E(u_i\vert X_{1i},\dots ,X_{ki}) \neq 0\]</span> so that the OLS estimator is biased <em>and</em> inconsistent. <br></p>
<p>Furthermore, if one does not adjust for heteroskedasticity <em>and</em>/<em>or</em> serial correlation, incorrect standard errors may be a threat to internal validity of the study.</p>
</div>
</div>
</div>
<div id="internal-and-external-validity-when-the-regression-is-used-for-forecasting" class="section level2 hasAnchor" number="9.3">
<h2 class="hasAnchor"><span class="header-section-number">9.3</span> Internal and External Validity when the Regression is Used for Forecasting<a href="#internal-and-external-validity-when-the-regression-is-used-for-forecasting" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Recall the regression of test scores on the student-teacher ratio (<span class="math inline">\(STR\)</span>) performed in Chapter @ref(lrwor):</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>linear_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> STR, <span class="at">data =</span> CASchools)</span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>linear_model</span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = score ~ STR, data = CASchools)</span></span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)          STR  </span></span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      698.93        -2.28</span></span></code></pre></div>
<p>The estimated regression function was</p>
<p><span class="math display">\[ \widehat{TestScore} = 698.9 - 2.28 \times STR.\]</span></p>
<p>The book discusses the example of a parent moving to a metropolitan area who plans to choose where to live based on the quality of local schools: a school district’s average test score is an adequate measure for the quality. However, the parent has information on the student-teacher ratio only such that test scores need to be predicted. Although we have established that there is omitted variable bias in this model due to omission of variables like student learning opportunities outside school, the share of English learners and so on, <tt>linear_model</tt> may in fact be useful for the parent:</p>
<p>The parent need not care if the coefficient on <span class="math inline">\(STR\)</span> has causal interpretation, she wants <span class="math inline">\(STR\)</span> to explain as much variation in test scores as possible. Therefore, despite the fact that <tt>linear_model</tt> cannot be used to estimate the <em>causal effect</em> of a change in <span class="math inline">\(STR\)</span> on test scores, it can be considered a <em>reliable predictor</em> of test scores in general.</p>
<p>Thus, the threats to internal validity as summarized in Key Concept 9.7 are negligible for the parent. This is, as instanced in the book, different for a superintendent who has been tasked to take measures that increase test scores: she requires a more reliable model that does not suffer from the threats listed in Key Concept 9.7.</p>
<p>Consult Chapter 9.3 of the book for the corresponding discussion.</p>
</div>
<div id="etsacs" class="section level2 hasAnchor" number="9.4">
<h2 class="hasAnchor"><span class="header-section-number">9.4</span> Example: Test Scores and Class Size<a href="#etsacs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section discusses internal and external validity of the results gained from analyzing the California test score data using multiple regression models.</p>
<div id="external-validity-of-the-study" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">External Validity of the Study<a href="#external-validity-of-the-study" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>External validity of the California test score analysis means that its results can be generalized. Whether this is possible depends on the population and the setting. Following the book we conduct the same analysis using data for fourth graders in <span class="math inline">\(220\)</span> public school districts in Massachusetts in 1998. Like <tt>CASchools</tt>, the data set <tt>MASchools</tt> is part of the <tt>AER</tt> package <span class="citation">(<a href="#ref-R-AER" role="doc-biblioref">Christian Kleiber and Zeileis 2022</a>)</span>. Use the help function (<code>?MASchools</code>) to get information on the definitions of all the variables contained.</p>
<p>We start by loading the data set and proceed by computing some summary statistics.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># attach the &#39;MASchools&#39; dataset</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;MASchools&quot;</span>)</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(MASchools)</span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    district         municipality           expreg       expspecial   </span></span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Length:220         Length:220         Min.   :2905   Min.   : 3832  </span></span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Class :character   Class :character   1st Qu.:4065   1st Qu.: 7442  </span></span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mode  :character   Mode  :character   Median :4488   Median : 8354  </span></span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                        Mean   :4605   Mean   : 8901  </span></span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                        3rd Qu.:4972   3rd Qu.: 9722  </span></span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                        Max.   :8759   Max.   :53569  </span></span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                                      </span></span>
<span id="cb227-12"><a href="#cb227-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      expbil           expocc          exptot        scratio      </span></span>
<span id="cb227-13"><a href="#cb227-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :     0   Min.   :    0   Min.   :3465   Min.   : 2.300  </span></span>
<span id="cb227-14"><a href="#cb227-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:     0   1st Qu.:    0   1st Qu.:4730   1st Qu.: 6.100  </span></span>
<span id="cb227-15"><a href="#cb227-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median :     0   Median :    0   Median :5155   Median : 7.800  </span></span>
<span id="cb227-16"><a href="#cb227-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   :  3037   Mean   : 1104   Mean   :5370   Mean   : 8.107  </span></span>
<span id="cb227-17"><a href="#cb227-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:     0   3rd Qu.:    0   3rd Qu.:5789   3rd Qu.: 9.800  </span></span>
<span id="cb227-18"><a href="#cb227-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   :295140   Max.   :15088   Max.   :9868   Max.   :18.400  </span></span>
<span id="cb227-19"><a href="#cb227-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                  NA&#39;s   :9       </span></span>
<span id="cb227-20"><a href="#cb227-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     special          lunch          stratio          income      </span></span>
<span id="cb227-21"><a href="#cb227-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   : 8.10   Min.   : 0.40   Min.   :11.40   Min.   : 9.686  </span></span>
<span id="cb227-22"><a href="#cb227-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:13.38   1st Qu.: 5.30   1st Qu.:15.80   1st Qu.:15.223  </span></span>
<span id="cb227-23"><a href="#cb227-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median :15.45   Median :10.55   Median :17.10   Median :17.128  </span></span>
<span id="cb227-24"><a href="#cb227-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   :15.97   Mean   :15.32   Mean   :17.34   Mean   :18.747  </span></span>
<span id="cb227-25"><a href="#cb227-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:17.93   3rd Qu.:20.02   3rd Qu.:19.02   3rd Qu.:20.376  </span></span>
<span id="cb227-26"><a href="#cb227-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   :34.30   Max.   :76.20   Max.   :27.00   Max.   :46.855  </span></span>
<span id="cb227-27"><a href="#cb227-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                                  </span></span>
<span id="cb227-28"><a href="#cb227-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      score4          score8          salary         english       </span></span>
<span id="cb227-29"><a href="#cb227-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :658.0   Min.   :641.0   Min.   :24.96   Min.   : 0.0000  </span></span>
<span id="cb227-30"><a href="#cb227-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:701.0   1st Qu.:685.0   1st Qu.:33.80   1st Qu.: 0.0000  </span></span>
<span id="cb227-31"><a href="#cb227-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median :711.0   Median :698.0   Median :35.88   Median : 0.0000  </span></span>
<span id="cb227-32"><a href="#cb227-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   :709.8   Mean   :698.4   Mean   :35.99   Mean   : 1.1177  </span></span>
<span id="cb227-33"><a href="#cb227-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:720.0   3rd Qu.:712.0   3rd Qu.:37.96   3rd Qu.: 0.8859  </span></span>
<span id="cb227-34"><a href="#cb227-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   :740.0   Max.   :747.0   Max.   :44.49   Max.   :24.4939  </span></span>
<span id="cb227-35"><a href="#cb227-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  NA&#39;s   :40      NA&#39;s   :25</span></span></code></pre></div>
<p>It is fairly easy to replicate key components of Table 9.1 of the book using <tt>R</tt>. To be consistent with variable names used in the <tt>CASchools</tt> data set, we do some formatting beforehand.</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Customized variables in MASchools</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>MASchools<span class="sc">$</span>score <span class="ot">&lt;-</span> MASchools<span class="sc">$</span>score4 </span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a>MASchools<span class="sc">$</span>STR <span class="ot">&lt;-</span> MASchools<span class="sc">$</span>stratio</span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Reproduce Table 9.1 of the book</span></span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;score&quot;</span>, <span class="st">&quot;STR&quot;</span>, <span class="st">&quot;english&quot;</span>, <span class="st">&quot;lunch&quot;</span>, <span class="st">&quot;income&quot;</span>)</span>
<span id="cb228-7"><a href="#cb228-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-8"><a href="#cb228-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">CA_mean =</span> <span class="fu">sapply</span>(CASchools[, vars], mean),</span>
<span id="cb228-9"><a href="#cb228-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">CA_sd   =</span> <span class="fu">sapply</span>(CASchools[, vars], sd),</span>
<span id="cb228-10"><a href="#cb228-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">MA_mean =</span> <span class="fu">sapply</span>(MASchools[, vars], mean),</span>
<span id="cb228-11"><a href="#cb228-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">MA_sd   =</span> <span class="fu">sapply</span>(MASchools[, vars], sd))</span>
<span id="cb228-12"><a href="#cb228-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           CA_mean     CA_sd    MA_mean     MA_sd</span></span>
<span id="cb228-13"><a href="#cb228-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; score   654.15655 19.053347 709.827273 15.126474</span></span>
<span id="cb228-14"><a href="#cb228-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; STR      19.64043  1.891812  17.344091  2.276666</span></span>
<span id="cb228-15"><a href="#cb228-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; english  15.76816 18.285927   1.117676  2.900940</span></span>
<span id="cb228-16"><a href="#cb228-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lunch    44.70524 27.123381  15.315909 15.060068</span></span>
<span id="cb228-17"><a href="#cb228-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; income   15.31659  7.225890  18.746764  5.807637</span></span></code></pre></div>
<p>The summary statistics reveal that the average test score is higher for school districts in Massachusetts. The test used in Massachusetts is somewhat different from the one used in California (the Massachusetts test score also includes results for the school subject “Science”), therefore a direct comparison of test scores is not appropriate. We also see that, on average, classes are smaller in Massachusetts than in California and that the average district income, average percentage of English learners as well as the average share of students receiving subsidized lunch differ considerably from the averages computed for California. There are also notable differences in the observed dispersion of the variables.</p>
<p>Following the book we examine the relationship between district income and test scores in Massachusetts as we have done before in Chapter @ref(nrf) for the California data and reproduce Figure 9.2 of the book.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate linear model</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>Linear_model_MA <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> income, <span class="at">data =</span> MASchools)</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>Linear_model_MA</span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = score ~ income, data = MASchools)</span></span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)       income  </span></span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     679.387        1.624</span></span>
<span id="cb229-11"><a href="#cb229-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-12"><a href="#cb229-12" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate linear-log model</span></span>
<span id="cb229-13"><a href="#cb229-13" aria-hidden="true" tabindex="-1"></a>Linearlog_model_MA <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> <span class="fu">log</span>(income), <span class="at">data =</span> MASchools) </span>
<span id="cb229-14"><a href="#cb229-14" aria-hidden="true" tabindex="-1"></a>Linearlog_model_MA</span>
<span id="cb229-15"><a href="#cb229-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb229-16"><a href="#cb229-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb229-17"><a href="#cb229-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = score ~ log(income), data = MASchools)</span></span>
<span id="cb229-18"><a href="#cb229-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb229-19"><a href="#cb229-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb229-20"><a href="#cb229-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  log(income)  </span></span>
<span id="cb229-21"><a href="#cb229-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      600.80        37.71</span></span>
<span id="cb229-22"><a href="#cb229-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-23"><a href="#cb229-23" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate Cubic model</span></span>
<span id="cb229-24"><a href="#cb229-24" aria-hidden="true" tabindex="-1"></a>cubic_model_MA <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> <span class="fu">I</span>(income) <span class="sc">+</span> <span class="fu">I</span>(income<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(income<span class="sc">^</span><span class="dv">3</span>), <span class="at">data =</span> MASchools)</span>
<span id="cb229-25"><a href="#cb229-25" aria-hidden="true" tabindex="-1"></a>cubic_model_MA</span>
<span id="cb229-26"><a href="#cb229-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb229-27"><a href="#cb229-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb229-28"><a href="#cb229-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = score ~ I(income) + I(income^2) + I(income^3), data = MASchools)</span></span>
<span id="cb229-29"><a href="#cb229-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb229-30"><a href="#cb229-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb229-31"><a href="#cb229-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)    I(income)  I(income^2)  I(income^3)  </span></span>
<span id="cb229-32"><a href="#cb229-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  600.398531    10.635382    -0.296887     0.002762</span></span></code></pre></div>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(MASchools<span class="sc">$</span>income, MASchools<span class="sc">$</span>score,</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;District income&quot;</span>,</span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Test score&quot;</span>,</span>
<span id="cb230-7"><a href="#cb230-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>),</span>
<span id="cb230-8"><a href="#cb230-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">620</span>, <span class="dv">780</span>))</span>
<span id="cb230-9"><a href="#cb230-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-10"><a href="#cb230-10" aria-hidden="true" tabindex="-1"></a><span class="co"># add estimated regression line for the linear model</span></span>
<span id="cb230-11"><a href="#cb230-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(Linear_model_MA, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb230-12"><a href="#cb230-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-13"><a href="#cb230-13" aria-hidden="true" tabindex="-1"></a><span class="co"># add estimated regression function for Linear-log model</span></span>
<span id="cb230-14"><a href="#cb230-14" aria-hidden="true" tabindex="-1"></a>order_id  <span class="ot">&lt;-</span> <span class="fu">order</span>(MASchools<span class="sc">$</span>income)</span>
<span id="cb230-15"><a href="#cb230-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-16"><a href="#cb230-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(MASchools<span class="sc">$</span>income[order_id],</span>
<span id="cb230-17"><a href="#cb230-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fitted</span>(Linearlog_model_MA)[order_id], </span>
<span id="cb230-18"><a href="#cb230-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, </span>
<span id="cb230-19"><a href="#cb230-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb230-20"><a href="#cb230-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-21"><a href="#cb230-21" aria-hidden="true" tabindex="-1"></a><span class="co"># add estimated cubic regression function</span></span>
<span id="cb230-22"><a href="#cb230-22" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> MASchools<span class="sc">$</span>income[order_id], </span>
<span id="cb230-23"><a href="#cb230-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">fitted</span>(cubic_model_MA)[order_id],</span>
<span id="cb230-24"><a href="#cb230-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;orange&quot;</span>, </span>
<span id="cb230-25"><a href="#cb230-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>) </span>
<span id="cb230-26"><a href="#cb230-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-27"><a href="#cb230-27" aria-hidden="true" tabindex="-1"></a><span class="co"># add a legend</span></span>
<span id="cb230-28"><a href="#cb230-28" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb230-29"><a href="#cb230-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Linear&quot;</span>, <span class="st">&quot;Linear-Log&quot;</span>, <span class="st">&quot;Cubic&quot;</span>),</span>
<span id="cb230-30"><a href="#cb230-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb230-31"><a href="#cb230-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;Black&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;orange&quot;</span>))</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-400-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The plot indicates that the cubic specification fits the data best. Interestingly, this is different from the <tt>CASchools</tt> data where the pattern of nonlinearity is better described by the linear-log specification.</p>
<p>We continue by estimating most of the model specifications used for analysis of the <tt>CASchools</tt> data set in Chapter @ref(nrf) and use <tt>stargazer()</tt> <span class="citation">(<a href="#ref-R-stargazer" role="doc-biblioref">Hlavac 2022</a>)</span> to generate a tabular representation of the regression results.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add &#39;HiEL&#39; to &#39;MASchools&#39;</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>MASchools<span class="sc">$</span>HiEL <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(MASchools<span class="sc">$</span>english <span class="sc">&gt;</span> <span class="fu">median</span>(MASchools<span class="sc">$</span>english))</span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model specifications from Table 9.2 of the book</span></span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a>TestScore_MA_mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> STR, <span class="at">data =</span> MASchools)</span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-7"><a href="#cb231-7" aria-hidden="true" tabindex="-1"></a>TestScore_MA_mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> STR <span class="sc">+</span> english <span class="sc">+</span> lunch <span class="sc">+</span> <span class="fu">log</span>(income), </span>
<span id="cb231-8"><a href="#cb231-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> MASchools)</span>
<span id="cb231-9"><a href="#cb231-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-10"><a href="#cb231-10" aria-hidden="true" tabindex="-1"></a>TestScore_MA_mod3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> STR <span class="sc">+</span> english <span class="sc">+</span> lunch <span class="sc">+</span> income <span class="sc">+</span> <span class="fu">I</span>(income<span class="sc">^</span><span class="dv">2</span>) </span>
<span id="cb231-11"><a href="#cb231-11" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span> <span class="fu">I</span>(income<span class="sc">^</span><span class="dv">3</span>), <span class="at">data =</span> MASchools)</span>
<span id="cb231-12"><a href="#cb231-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-13"><a href="#cb231-13" aria-hidden="true" tabindex="-1"></a>TestScore_MA_mod4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> STR <span class="sc">+</span> <span class="fu">I</span>(STR<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(STR<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> english <span class="sc">+</span> lunch <span class="sc">+</span> income </span>
<span id="cb231-14"><a href="#cb231-14" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span> <span class="fu">I</span>(income<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(income<span class="sc">^</span><span class="dv">3</span>), <span class="at">data =</span> MASchools)</span>
<span id="cb231-15"><a href="#cb231-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-16"><a href="#cb231-16" aria-hidden="true" tabindex="-1"></a>TestScore_MA_mod5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> STR <span class="sc">+</span> <span class="fu">I</span>(income<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(income<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> HiEL<span class="sc">:</span>STR <span class="sc">+</span> lunch </span>
<span id="cb231-17"><a href="#cb231-17" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span> income, <span class="at">data =</span> MASchools)</span>
<span id="cb231-18"><a href="#cb231-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-19"><a href="#cb231-19" aria-hidden="true" tabindex="-1"></a>TestScore_MA_mod6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> STR <span class="sc">+</span> <span class="fu">I</span>(income<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(income<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> HiEL <span class="sc">+</span> HiEL<span class="sc">:</span>STR <span class="sc">+</span> lunch </span>
<span id="cb231-20"><a href="#cb231-20" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span> income, <span class="at">data =</span> MASchools)</span>
<span id="cb231-21"><a href="#cb231-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-22"><a href="#cb231-22" aria-hidden="true" tabindex="-1"></a><span class="co"># gather robust standard errors</span></span>
<span id="cb231-23"><a href="#cb231-23" aria-hidden="true" tabindex="-1"></a>rob_se <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(TestScore_MA_mod1, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb231-24"><a href="#cb231-24" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(TestScore_MA_mod2, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb231-25"><a href="#cb231-25" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(TestScore_MA_mod3, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb231-26"><a href="#cb231-26" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(TestScore_MA_mod4, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb231-27"><a href="#cb231-27" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(TestScore_MA_mod5, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb231-28"><a href="#cb231-28" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(TestScore_MA_mod6, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))))</span>
<span id="cb231-29"><a href="#cb231-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-30"><a href="#cb231-30" aria-hidden="true" tabindex="-1"></a><span class="co"># generate a table with &#39;stargazer()&#39;</span></span>
<span id="cb231-31"><a href="#cb231-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb231-32"><a href="#cb231-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-33"><a href="#cb231-33" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(Linear_model_MA, TestScore_MA_mod2, TestScore_MA_mod3, </span>
<span id="cb231-34"><a href="#cb231-34" aria-hidden="true" tabindex="-1"></a>          TestScore_MA_mod4, TestScore_MA_mod5, TestScore_MA_mod6,</span>
<span id="cb231-35"><a href="#cb231-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">&quot;Regressions Using Massachusetts Test Score Data&quot;</span>,</span>
<span id="cb231-36"><a href="#cb231-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>,</span>
<span id="cb231-37"><a href="#cb231-37" aria-hidden="true" tabindex="-1"></a>          <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb231-38"><a href="#cb231-38" aria-hidden="true" tabindex="-1"></a>          <span class="at">header =</span> <span class="cn">FALSE</span>,</span>
<span id="cb231-39"><a href="#cb231-39" aria-hidden="true" tabindex="-1"></a>          <span class="at">se =</span> rob_se,</span>
<span id="cb231-40"><a href="#cb231-40" aria-hidden="true" tabindex="-1"></a>          <span class="at">object.names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb231-41"><a href="#cb231-41" aria-hidden="true" tabindex="-1"></a>          <span class="at">model.numbers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb231-42"><a href="#cb231-42" aria-hidden="true" tabindex="-1"></a>          <span class="at">column.labels =</span> <span class="fu">c</span>(<span class="st">&quot;(I)&quot;</span>, <span class="st">&quot;(II)&quot;</span>, <span class="st">&quot;(III)&quot;</span>, <span class="st">&quot;(IV)&quot;</span>, <span class="st">&quot;(V)&quot;</span>, <span class="st">&quot;(VI)&quot;</span>))</span></code></pre></div>



<table style="text-align:center"><tr><td colspan="7" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"></td><td colspan="6">Dependent Variable: Score</td></tr>
<tr><td></td><td colspan="6" style="border-bottom: 1px solid black"></td></tr>
<tr><td style="text-align:left"></td><td colspan="6">score</td></tr>
<tr><td style="text-align:left"></td><td>(I)</td><td>(II)</td><td>(III)</td><td>(IV)</td><td>(V)</td><td>(VI)</td></tr>
<tr><td colspan="7" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">STR</td><td>-1.718<sup>***</sup></td><td>-0.689<sup>**</sup></td><td>-0.641<sup>**</sup></td><td>12.426</td><td>-1.018<sup>***</sup></td><td>-0.672<sup>**</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.499)</td><td>(0.270)</td><td>(0.268)</td><td>(14.010)</td><td>(0.370)</td><td>(0.271)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">I(STR2)</td><td></td><td></td><td></td><td>-0.680</td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td>(0.737)</td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">I(STR3)</td><td></td><td></td><td></td><td>0.011</td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td>(0.013)</td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">english</td><td></td><td>-0.411</td><td>-0.437</td><td>-0.434</td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(0.306)</td><td>(0.303)</td><td>(0.300)</td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">HiEL</td><td></td><td></td><td></td><td></td><td>-12.561</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td>(9.793)</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">lunch</td><td></td><td>-0.521<sup>***</sup></td><td>-0.582<sup>***</sup></td><td>-0.587<sup>***</sup></td><td>-0.709<sup>***</sup></td><td>-0.653<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(0.078)</td><td>(0.097)</td><td>(0.104)</td><td>(0.091)</td><td>(0.073)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">log(income)</td><td></td><td>16.529<sup>***</sup></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(3.146)</td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">income</td><td></td><td></td><td>-3.067</td><td>-3.382</td><td>-3.867</td><td>-3.218</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td>(2.353)</td><td>(2.491)</td><td>(2.488)</td><td>(2.306)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">I(income2)</td><td></td><td></td><td>0.164<sup>*</sup></td><td>0.174<sup>*</sup></td><td>0.184<sup>**</sup></td><td>0.165<sup>*</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td>(0.085)</td><td>(0.089)</td><td>(0.090)</td><td>(0.085)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">I(income3)</td><td></td><td></td><td>-0.002<sup>**</sup></td><td>-0.002<sup>**</sup></td><td>-0.002<sup>**</sup></td><td>-0.002<sup>**</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td>(0.001)</td><td>(0.001)</td><td>(0.001)</td><td>(0.001)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">STR:HiEL</td><td></td><td></td><td></td><td></td><td>0.799</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td>(0.555)</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">Constant</td><td>739.621<sup>***</sup></td><td>682.432<sup>***</sup></td><td>744.025<sup>***</sup></td><td>665.496<sup>***</sup></td><td>759.914<sup>***</sup></td><td>747.364<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(8.607)</td><td>(11.497)</td><td>(21.318)</td><td>(81.332)</td><td>(23.233)</td><td>(20.278)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td colspan="7" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">Observations</td><td>220</td><td>220</td><td>220</td><td>220</td><td>220</td><td>220</td></tr>
<tr><td style="text-align:left">R<sup>2</sup></td><td>0.067</td><td>0.676</td><td>0.685</td><td>0.687</td><td>0.686</td><td>0.681</td></tr>
<tr><td style="text-align:left">Adjusted R<sup>2</sup></td><td>0.063</td><td>0.670</td><td>0.676</td><td>0.675</td><td>0.675</td><td>0.674</td></tr>
<tr><td style="text-align:left">Residual Std. Error</td><td>14.646 (df = 218)</td><td>8.686 (df = 215)</td><td>8.607 (df = 213)</td><td>8.626 (df = 211)</td><td>8.621 (df = 212)</td><td>8.637 (df = 214)</td></tr>
<tr><td style="text-align:left">F Statistic</td><td>15.616<sup>***</sup> (df = 1; 218)</td><td>112.284<sup>***</sup> (df = 4; 215)</td><td>77.232<sup>***</sup> (df = 6; 213)</td><td>57.803<sup>***</sup> (df = 8; 211)</td><td>66.023<sup>***</sup> (df = 7; 212)</td><td>91.560<sup>***</sup> (df = 5; 214)</td></tr>
<tr><td colspan="7" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"><em>Note:</em></td><td colspan="6" style="text-align:right"><sup>*</sup>p<0.1; <sup>**</sup>p<0.05; <sup>***</sup>p<0.01</td></tr>
</table>
<caption><p style='text-align:center'>(#tab:rumtsd) Regressions Using Massachusetts Test Score Data</p></caption>


<p>Next we reproduce the <span class="math inline">\(F\)</span>-statistics and <span class="math inline">\(p\)</span>-values for testing exclusion of groups of variables.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co"># F-test model (3)</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(TestScore_MA_mod3, </span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">&quot;I(income^2)=0&quot;</span>, <span class="st">&quot;I(income^3)=0&quot;</span>), </span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb232-8"><a href="#cb232-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I(income^2) = 0</span></span>
<span id="cb232-9"><a href="#cb232-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I(income^3) = 0</span></span>
<span id="cb232-10"><a href="#cb232-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-11"><a href="#cb232-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb232-12"><a href="#cb232-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: score ~ STR + english + lunch + income + I(income^2) + I(income^3)</span></span>
<span id="cb232-13"><a href="#cb232-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-14"><a href="#cb232-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb232-15"><a href="#cb232-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-16"><a href="#cb232-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df     F   Pr(&gt;F)   </span></span>
<span id="cb232-17"><a href="#cb232-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    215                     </span></span>
<span id="cb232-18"><a href="#cb232-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    213  2 6.227 0.002354 **</span></span>
<span id="cb232-19"><a href="#cb232-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb232-20"><a href="#cb232-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb232-21"><a href="#cb232-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-22"><a href="#cb232-22" aria-hidden="true" tabindex="-1"></a><span class="co"># F-tests model (4)</span></span>
<span id="cb232-23"><a href="#cb232-23" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(TestScore_MA_mod4, </span>
<span id="cb232-24"><a href="#cb232-24" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">&quot;STR=0&quot;</span>, <span class="st">&quot;I(STR^2)=0&quot;</span>, <span class="st">&quot;I(STR^3)=0&quot;</span>), </span>
<span id="cb232-25"><a href="#cb232-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb232-26"><a href="#cb232-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb232-27"><a href="#cb232-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-28"><a href="#cb232-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb232-29"><a href="#cb232-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; STR = 0</span></span>
<span id="cb232-30"><a href="#cb232-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I(STR^2) = 0</span></span>
<span id="cb232-31"><a href="#cb232-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I(STR^3) = 0</span></span>
<span id="cb232-32"><a href="#cb232-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-33"><a href="#cb232-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb232-34"><a href="#cb232-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: score ~ STR + I(STR^2) + I(STR^3) + english + lunch + income + </span></span>
<span id="cb232-35"><a href="#cb232-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     I(income^2) + I(income^3)</span></span>
<span id="cb232-36"><a href="#cb232-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-37"><a href="#cb232-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb232-38"><a href="#cb232-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-39"><a href="#cb232-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F  Pr(&gt;F)  </span></span>
<span id="cb232-40"><a href="#cb232-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    214                    </span></span>
<span id="cb232-41"><a href="#cb232-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    211  3 2.3364 0.07478 .</span></span>
<span id="cb232-42"><a href="#cb232-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb232-43"><a href="#cb232-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb232-44"><a href="#cb232-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-45"><a href="#cb232-45" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(TestScore_MA_mod4, </span>
<span id="cb232-46"><a href="#cb232-46" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">&quot;I(STR^2)=0&quot;</span>, <span class="st">&quot;I(STR^3)=0&quot;</span>), </span>
<span id="cb232-47"><a href="#cb232-47" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb232-48"><a href="#cb232-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb232-49"><a href="#cb232-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-50"><a href="#cb232-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb232-51"><a href="#cb232-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I(STR^2) = 0</span></span>
<span id="cb232-52"><a href="#cb232-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I(STR^3) = 0</span></span>
<span id="cb232-53"><a href="#cb232-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-54"><a href="#cb232-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb232-55"><a href="#cb232-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: score ~ STR + I(STR^2) + I(STR^3) + english + lunch + income + </span></span>
<span id="cb232-56"><a href="#cb232-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     I(income^2) + I(income^3)</span></span>
<span id="cb232-57"><a href="#cb232-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-58"><a href="#cb232-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb232-59"><a href="#cb232-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-60"><a href="#cb232-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F Pr(&gt;F)</span></span>
<span id="cb232-61"><a href="#cb232-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    213                 </span></span>
<span id="cb232-62"><a href="#cb232-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    211  2 0.3396 0.7124</span></span>
<span id="cb232-63"><a href="#cb232-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-64"><a href="#cb232-64" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(TestScore_MA_mod4, </span>
<span id="cb232-65"><a href="#cb232-65" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">&quot;I(income^2)=0&quot;</span>, <span class="st">&quot;I(income^3)=0&quot;</span>), </span>
<span id="cb232-66"><a href="#cb232-66" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb232-67"><a href="#cb232-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb232-68"><a href="#cb232-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-69"><a href="#cb232-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb232-70"><a href="#cb232-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I(income^2) = 0</span></span>
<span id="cb232-71"><a href="#cb232-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I(income^3) = 0</span></span>
<span id="cb232-72"><a href="#cb232-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-73"><a href="#cb232-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb232-74"><a href="#cb232-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: score ~ STR + I(STR^2) + I(STR^3) + english + lunch + income + </span></span>
<span id="cb232-75"><a href="#cb232-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     I(income^2) + I(income^3)</span></span>
<span id="cb232-76"><a href="#cb232-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-77"><a href="#cb232-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb232-78"><a href="#cb232-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-79"><a href="#cb232-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F   Pr(&gt;F)   </span></span>
<span id="cb232-80"><a href="#cb232-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    213                      </span></span>
<span id="cb232-81"><a href="#cb232-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    211  2 5.7043 0.003866 **</span></span>
<span id="cb232-82"><a href="#cb232-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb232-83"><a href="#cb232-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb232-84"><a href="#cb232-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-85"><a href="#cb232-85" aria-hidden="true" tabindex="-1"></a><span class="co"># F-tests model (5)</span></span>
<span id="cb232-86"><a href="#cb232-86" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(TestScore_MA_mod5, </span>
<span id="cb232-87"><a href="#cb232-87" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">&quot;STR=0&quot;</span>, <span class="st">&quot;STR:HiEL=0&quot;</span>), </span>
<span id="cb232-88"><a href="#cb232-88" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb232-89"><a href="#cb232-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb232-90"><a href="#cb232-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-91"><a href="#cb232-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb232-92"><a href="#cb232-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; STR = 0</span></span>
<span id="cb232-93"><a href="#cb232-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; STR:HiEL = 0</span></span>
<span id="cb232-94"><a href="#cb232-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-95"><a href="#cb232-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb232-96"><a href="#cb232-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: score ~ STR + HiEL + HiEL:STR + lunch + income + I(income^2) + </span></span>
<span id="cb232-97"><a href="#cb232-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     I(income^3)</span></span>
<span id="cb232-98"><a href="#cb232-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-99"><a href="#cb232-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb232-100"><a href="#cb232-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-101"><a href="#cb232-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F Pr(&gt;F)  </span></span>
<span id="cb232-102"><a href="#cb232-102" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    214                   </span></span>
<span id="cb232-103"><a href="#cb232-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    212  2 3.7663 0.0247 *</span></span>
<span id="cb232-104"><a href="#cb232-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb232-105"><a href="#cb232-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb232-106"><a href="#cb232-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-107"><a href="#cb232-107" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(TestScore_MA_mod5, </span>
<span id="cb232-108"><a href="#cb232-108" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">&quot;I(income^2)=0&quot;</span>, <span class="st">&quot;I(income^3)=0&quot;</span>), </span>
<span id="cb232-109"><a href="#cb232-109" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb232-110"><a href="#cb232-110" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb232-111"><a href="#cb232-111" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-112"><a href="#cb232-112" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb232-113"><a href="#cb232-113" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I(income^2) = 0</span></span>
<span id="cb232-114"><a href="#cb232-114" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I(income^3) = 0</span></span>
<span id="cb232-115"><a href="#cb232-115" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-116"><a href="#cb232-116" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb232-117"><a href="#cb232-117" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: score ~ STR + HiEL + HiEL:STR + lunch + income + I(income^2) + </span></span>
<span id="cb232-118"><a href="#cb232-118" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     I(income^3)</span></span>
<span id="cb232-119"><a href="#cb232-119" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-120"><a href="#cb232-120" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb232-121"><a href="#cb232-121" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-122"><a href="#cb232-122" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F  Pr(&gt;F)  </span></span>
<span id="cb232-123"><a href="#cb232-123" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    214                    </span></span>
<span id="cb232-124"><a href="#cb232-124" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    212  2 3.2201 0.04191 *</span></span>
<span id="cb232-125"><a href="#cb232-125" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb232-126"><a href="#cb232-126" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb232-127"><a href="#cb232-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-128"><a href="#cb232-128" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(TestScore_MA_mod5, </span>
<span id="cb232-129"><a href="#cb232-129" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">&quot;HiEL=0&quot;</span>, <span class="st">&quot;STR:HiEL=0&quot;</span>), </span>
<span id="cb232-130"><a href="#cb232-130" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb232-131"><a href="#cb232-131" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb232-132"><a href="#cb232-132" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-133"><a href="#cb232-133" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb232-134"><a href="#cb232-134" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; HiEL = 0</span></span>
<span id="cb232-135"><a href="#cb232-135" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; STR:HiEL = 0</span></span>
<span id="cb232-136"><a href="#cb232-136" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-137"><a href="#cb232-137" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb232-138"><a href="#cb232-138" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: score ~ STR + HiEL + HiEL:STR + lunch + income + I(income^2) + </span></span>
<span id="cb232-139"><a href="#cb232-139" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     I(income^3)</span></span>
<span id="cb232-140"><a href="#cb232-140" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-141"><a href="#cb232-141" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb232-142"><a href="#cb232-142" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-143"><a href="#cb232-143" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F Pr(&gt;F)</span></span>
<span id="cb232-144"><a href="#cb232-144" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    214                 </span></span>
<span id="cb232-145"><a href="#cb232-145" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    212  2 1.4674 0.2328</span></span>
<span id="cb232-146"><a href="#cb232-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-147"><a href="#cb232-147" aria-hidden="true" tabindex="-1"></a><span class="co"># F-test Model (6)</span></span>
<span id="cb232-148"><a href="#cb232-148" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(TestScore_MA_mod6, </span>
<span id="cb232-149"><a href="#cb232-149" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">&quot;I(income^2)=0&quot;</span>, <span class="st">&quot;I(income^3)=0&quot;</span>), </span>
<span id="cb232-150"><a href="#cb232-150" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb232-151"><a href="#cb232-151" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb232-152"><a href="#cb232-152" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-153"><a href="#cb232-153" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb232-154"><a href="#cb232-154" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I(income^2) = 0</span></span>
<span id="cb232-155"><a href="#cb232-155" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I(income^3) = 0</span></span>
<span id="cb232-156"><a href="#cb232-156" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-157"><a href="#cb232-157" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb232-158"><a href="#cb232-158" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: score ~ STR + lunch + income + I(income^2) + I(income^3)</span></span>
<span id="cb232-159"><a href="#cb232-159" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-160"><a href="#cb232-160" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb232-161"><a href="#cb232-161" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-162"><a href="#cb232-162" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F  Pr(&gt;F)  </span></span>
<span id="cb232-163"><a href="#cb232-163" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    216                    </span></span>
<span id="cb232-164"><a href="#cb232-164" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    214  2 4.2776 0.01508 *</span></span>
<span id="cb232-165"><a href="#cb232-165" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb232-166"><a href="#cb232-166" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>We see that, in terms of <span class="math inline">\(\bar{R}^2\)</span>, specification (3) which uses a cubic to model the relationship between district income and test scores indeed performs better than the linear-log specification (2). Using different <span class="math inline">\(F\)</span>-tests on models (4) and (5), we cannot reject the hypothesis that there is no nonlinear relationship between student teacher ratio and test score and also that the share of English learners has an influence on the relationship of interest. Furthermore, regression (6) shows that the percentage of English learners can be omitted as a regressor. Because of the model specifications made in (4) to (6) do not lead to substantially different results than those of regression (3), we choose model (3) as the most suitable specification.</p>
<p>In comparison to the California data, we observe the following results:</p>
<ol style="list-style-type: decimal">
<li><p>Controlling for the students’ background characteristics in model specification (2) reduces the coefficient of interest (student-teacher ratio) by roughly <span class="math inline">\(60\%\)</span>. The estimated coefficients are close to each other.</p></li>
<li><p>The coefficient on student-teacher ratio is always significantly different from zero at the level of <span class="math inline">\(1\%\)</span> for both data sets. This holds for all considered model specifications in both studies.</p></li>
<li><p>In both studies the share of English learners in a school district is of little importance for the estimated impact of a change in the student-teacher ratio on test score.</p></li>
</ol>
<p>The biggest difference is that, in contrast to the California results, we do not find evidence of a nonlinear relationship between test scores and the student teacher ratio for the Massachusetts data since the corresponding <span class="math inline">\(F\)</span>-tests for model (4) do not reject.</p>
<p>As pointed out in the book, the test scores for California and Massachusetts have different units because the underlying tests are different. Thus the estimated coefficients on the student-teacher ratio in both regressions cannot be compared before standardizing test scores to the same units as <span class="math display">\[\frac{Testscore - \overline{TestScore}}{\sigma_{TestScore}}\]</span> for all observations in both data sets and running the regressions of interest using the standardized data again. One can show that the coefficient on student-teacher ratio in the regression using standardized test scores is the coefficient of the original regression divided by the standard deviation of test scores.</p>
<p>For model (3) of the Massachusetts data, the estimated coefficient on the student-teacher ratio is <span class="math inline">\(-0.64\)</span>. A reduction of the student-teacher ratio by two students is predicted to increase test scores by <span class="math inline">\(-2 \cdot (-0.64) = 1.28\)</span> points. Thus we can compute the effect of a reduction of student-teacher ratio by two students on the standardized test scores as follows:</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>TestScore_MA_mod3<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">/</span> <span class="fu">sd</span>(MASchools<span class="sc">$</span>score) <span class="sc">*</span> (<span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        STR </span></span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.08474001</span></span></code></pre></div>
<p>For Massachusetts the predicted increase of test scores due to a reduction of the student-teacher ratio by two students is <span class="math inline">\(0.085\)</span> standard deviations of the distribution of the observed distribution of test scores.</p>
<p>Using the linear specification (2) for California, the estimated coefficient on the student-teacher ratio is <span class="math inline">\(-0.73\)</span> so the predicted increase of test scores induced by a reduction of the student-teacher ratio by two students is <span class="math inline">\(-0.73 \cdot (-2) = 1.46\)</span>. We use <tt>R</tt> to compute the predicted change in standard deviation units:</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>TestScore_mod2<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">/</span> <span class="fu">sd</span>(CASchools<span class="sc">$</span>score) <span class="sc">*</span> (<span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        STR </span></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.07708103</span></span></code></pre></div>
<p>This shows that the the predicted increase of test scores due to a reduction of the student-teacher ratio by two students is <span class="math inline">\(0.077\)</span> standard deviation of the observed distribution of test scores for the California data.</p>
<p>In terms of standardized test scores, the predicted change is essentially the same for school districts in California and Massachusetts.</p>
<p>Altogether, the results support external validity of the inferences made using data on Californian elementary school districts — at least for Massachusetts.</p>
</div>
<div id="internal-validity-of-the-study" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Internal Validity of the Study<a href="#internal-validity-of-the-study" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>External validity of the study <em>does not</em> ensure their internal validity. Although the chosen model specification improves upon a simple linear regression model, internal validity may still be violated due to some of the threats listed in Key Concept 9.7. These threats are:</p>
<ul>
<li><p>omitted variable bias</p></li>
<li><p>misspecification of functional form</p></li>
<li><p>errors in variables</p></li>
<li><p>sample selection issues</p></li>
<li><p>simultaneous causality</p></li>
<li><p>heteroskedasticity</p></li>
<li><p>correlation of errors across observations</p></li>
</ul>
<p>Consult the book for an in-depth discussion of these threats in view of both test score studies.</p>
</div>
<div id="summary-1" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Summary<a href="#summary-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We have found that there <em>is</em> a small but statistically significant effect of the student-teacher ratio on test scores. However, it remains unclear if we have indeed estimated the causal effect of interest since — despite that our approach including control variables, taking into account nonlinearities in the population regression function and statistical inference using robust standard errors — the results might still be biased for example if there are omitted factors which we have not considered. Thus <em>internal validity</em> of the study remains questionable. As we have concluded from comparison with the analysis of the Massachusetts data set, this result may be <em>externally valid</em>.</p>
<p>The following chapters address techniques that can be remedies to all the threats to internal validity listed in Key Concept 9.7 if multiple regression alone is insufficient. This includes regression using panel data and approaches that employ instrumental variables.</p>
</div>
</div>
<div id="exercises-9" class="section level2 hasAnchor" number="9.5">
<h2 class="hasAnchor"><span class="header-section-number">9.5</span> Exercises<a href="#exercises-9" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="simulation-study-misspecification-of-functional-form" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">1. Simulation Study: Misspecification of Functional Form<a href="#simulation-study-misspecification-of-functional-form" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As stated in Chapter @ref(ttivomra), misspecification of the regression function violates assumption 1 of Key Concept 6.3 so that the OLS estimator will be biased and inconsistent. We have illustrated the bias of <span class="math inline">\(\hat{\beta}_0\)</span> for the example of the quadratic population regression function
<span class="math display">\[Y_i = X_i^2 \]</span>
and the linear model <span class="math display">\[Y_i = \beta_0 + \beta_1 X_i + u_i, \, u_i \sim \mathcal{N}(0,1)\]</span> using 100 randomly generated observations. Strictly speaking, this finding could be just a coincidence because we consider just one estimate obtained using a single data set.</p>
<p>In this exercise, you have to generate simulation evidence for the bias of <span class="math inline">\(\hat{\beta}_0\)</span> in the model <span class="math display">\[Y_i = \beta_0 + \beta_1 X_i + u_i\]</span> if the population regression function is <span class="math display">\[Y_i = X_i^2.\]</span></p>
<p><strong>Instructions:</strong></p>
<p>Make sure to use the definitions suggested in the skeleton code in <tt>script.R</tt> to complete the following tasks:</p>
<ul>
<li><p>Generate 1000 OLS estimates of <span class="math inline">\(\beta_0\)</span> in the model above using a <tt>for()</tt> loop where <span class="math inline">\(X_i \sim \mathcal{U}[-5,5]\)</span>, <span class="math inline">\(u_i \sim \mathcal{N}(0,1)\)</span> using samples of size <span class="math inline">\(100\)</span>. Save the estimates in <tt>beta_hats</tt>.</p></li>
<li><p>Compare the sample mean of the estimates to the true parameter using the <tt>==</tt> operator.</p></li>
</ul>
<iframe src="DCL/ex9_1.html" frameborder="0" scrolling="no" style="width:100%;height:360px">
</iframe>
<p><strong>Hint:</strong></p>
<p>You can generate random numbers from a uniform distribution using <tt>runif()</tt>.</p>
</div>
<div id="simulation-study-errors-in-variables-bias" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">2. Simulation Study: Errors-in-Variables Bias<a href="#simulation-study-errors-in-variables-bias" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider again the application of the classical measurement error model introduced in Chapter @ref(ttivomra):</p>
<p>The single regressor <span class="math inline">\(X_i\)</span> is measured with error so that <span class="math inline">\(\overset{\sim}{X}_i\)</span> is observed instead. Thus one estimates <span class="math inline">\(\beta_1\)</span> in
<span class="math display">\[\begin{align*}
  Y_i =&amp; \, \beta_0 + \beta_1 \overset{\sim}{X}_i + \underbrace{\beta_1 (X_i -\overset{\sim}{X}_i) + u_i}_{=v_i} \\
  Y_i =&amp; \, \beta_0 + \beta_1 \overset{\sim}{X}_i + v_i
\end{align*}\]</span>
instead of <span class="math display">\[Y_i = \beta_0 + \beta_1 X_i + u_i,\]</span></p>
<p>with the zero mean error <span class="math inline">\(w_i\)</span> being uncorrelated with <span class="math inline">\(X_i\)</span> and <span class="math inline">\(u_i\)</span>. Then <span class="math inline">\(\beta_1\)</span> is inconsistently estimated by OLS:
<span class="math display">\[\begin{equation}
  \widehat{\beta}_1 \xrightarrow{p}{\frac{\sigma_{X}^2}{\sigma_{X}^2 + \sigma_{w}^2}} \beta_1
\end{equation}\]</span></p>
<p>Let <span class="math display">\[(X, Y) \sim \mathcal{N}\left[\begin{pmatrix}50\\ 100\end{pmatrix},\begin{pmatrix}10 &amp; 5 \\ 5 &amp; 10 \end{pmatrix}\right].\]</span> Recall from @ref(eq:bnormexpfn) that <span class="math inline">\(E(Y_i\vert X_i) = 75 + 0.5 X_i\)</span> in this case. Further Assume that <span class="math inline">\(\overset{\sim}{X_i} = X_i + w_i\)</span> with <span class="math inline">\(w_i \overset{i.i.d}{\sim} \mathcal{N}(0,10)\)</span>.</p>
<p>As mentioned in Exercise 1, Chapter @ref(ttivomra) discusses the consequences of the measurement error for the OLS estimator of <span class="math inline">\(\beta_1\)</span> in this setting based on a <em>single</em> sample and and thus just one estimate. Strictly speaking, the conclusion made could be wrong because the oberseved bias may be due to random variation. A Monto Carlo simulation is more appropriate here.</p>
<p><strong>Instructions:</strong></p>
<p>Show that <span class="math inline">\(\beta_1\)</span> is estimated with a bias using a simulation study. Make sure to use the definitions suggested in the skeleton code in <tt>script.R</tt> to complete the following tasks:</p>
<ul>
<li><p>Generate 1000 estimates of <span class="math inline">\(\beta_1\)</span> in the simple regression model <span class="math display">\[Y_i = \beta_0 + \beta_1 X_i + u_i.\]</span> Use <tt>rmvnorm()</tt> to generate samples of 100 random observations from the bivariate normal distribution stated above.</p></li>
<li><p>Save the estimates in <tt>beta_hats</tt>.</p></li>
<li><p>Compute the sample mean of the estimates.</p></li>
</ul>
<iframe src="DCL/ex9_2.html" frameborder="0" scrolling="no" style="width:100%;height:400px">
</iframe>
</div>
<!--chapter:end:09-ch9.Rmd-->
</div>
</div>
<div id="rwpd" class="section level1 hasAnchor" number="10">
<h1 class="hasAnchor"><span class="header-section-number">10</span> Regression with Panel Data<a href="#rwpd" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Regression using panel data may mitigate omitted variable bias when there is no information on variables that correlate with both the regressors of interest and the independent variable and if these variables are constant in the time dimension or across entities. Provided that panel data is available panel regression methods may improve upon multiple regression models which, as discussed in Chapter @ref(asbomr), produce results that are not internally valid in such a setting.</p>
<p>This chapter covers the following topics:</p>
<ul>
<li>notation for panel data</li>
<li>fixed effects regression using time and/or entity fixed effects</li>
<li>computation of standard errors in fixed effects regression models</li>
</ul>
<p>Following the book, for applications we make use of the dataset <tt>Fatalities</tt> from the <tt>AER</tt> package <span class="citation">(<a href="#ref-R-AER" role="doc-biblioref">Christian Kleiber and Zeileis 2022</a>)</span> which is a panel dataset reporting annual state level observations on U.S. traffic fatalities for the period 1982 through 1988. The applications analyze if there are effects of alcohol taxes and drunk driving laws on road fatalities and, if present, <em>how strong</em> these effects are.</p>
<p>We introduce <tt>plm()</tt>, a convenient <tt>R</tt> function that enables us to estimate linear panel regression models which comes with the package <tt>plm</tt> <span class="citation">(<a href="#ref-R-plm" role="doc-biblioref">Croissant, Millo, and Tappe 2022</a>)</span>. Usage of <tt>plm()</tt> is very similar as for the function <tt>lm()</tt> which we have used throughout the previous chapters for estimation of simple and multiple regression models.</p>
<p>The following packages and their dependencies are needed for reproduction of the code chunks presented throughout this chapter on your computer:</p>
<ul>
<li><tt>AER</tt></li>
<li><tt>plm</tt></li>
<li><tt>stargazer</tt></li>
</ul>
<p>Check whether the following code chunk runs without any errors.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plm)</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span></code></pre></div>
<div id="panel-data" class="section level2 hasAnchor" number="10.1">
<h2 class="hasAnchor"><span class="header-section-number">10.1</span> Panel Data<a href="#panel-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="KC10.1" class="keyconcept">
<h3 class="right">
Key Concept 10.1
</h3>
<h3 class="left">
Notation for Panel Data
</h3>
<p>In contrast to cross-section data where we have observations on <span class="math inline">\(n\)</span> subjects (entities), panel data has observations on <span class="math inline">\(n\)</span> entities at <span class="math inline">\(T\geq2\)</span> time periods. This is denoted</p>
<p><span class="math display">\[(X_{it},Y_{it}), \ i=1,\dots,n \ \ \ \text{and} \ \ \ t=1,\dots,T \]</span>
where the index <span class="math inline">\(i\)</span> refers to the entity while <span class="math inline">\(t\)</span> refers to the time period.</p>
</div>
<p>Sometimes panel data is also called longitudinal data as it adds a temporal dimension to cross-sectional data. Let us have a look at the dataset <tt>Fatalities</tt> by checking its structure and listing the first few observations.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the package and the dataset</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Fatalities)</span></code></pre></div>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain the dimension and inspect the structure</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.data.frame</span>(Fatalities)</span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Fatalities)</span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 336  34</span></span></code></pre></div>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Fatalities)</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;data.frame&#39;:    336 obs. of  34 variables:</span></span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ state       : Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ year        : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ spirits     : num  1.37 1.36 1.32 1.28 1.23 ...</span></span>
<span id="cb238-6"><a href="#cb238-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ unemp       : num  14.4 13.7 11.1 8.9 9.8 ...</span></span>
<span id="cb238-7"><a href="#cb238-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ income      : num  10544 10733 11109 11333 11662 ...</span></span>
<span id="cb238-8"><a href="#cb238-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ emppop      : num  50.7 52.1 54.2 55.3 56.5 ...</span></span>
<span id="cb238-9"><a href="#cb238-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ beertax     : num  1.54 1.79 1.71 1.65 1.61 ...</span></span>
<span id="cb238-10"><a href="#cb238-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ baptist     : num  30.4 30.3 30.3 30.3 30.3 ...</span></span>
<span id="cb238-11"><a href="#cb238-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ mormon      : num  0.328 0.343 0.359 0.376 0.393 ...</span></span>
<span id="cb238-12"><a href="#cb238-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ drinkage    : num  19 19 19 19.7 21 ...</span></span>
<span id="cb238-13"><a href="#cb238-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ dry         : num  25 23 24 23.6 23.5 ...</span></span>
<span id="cb238-14"><a href="#cb238-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ youngdrivers: num  0.212 0.211 0.211 0.211 0.213 ...</span></span>
<span id="cb238-15"><a href="#cb238-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ miles       : num  7234 7836 8263 8727 8953 ...</span></span>
<span id="cb238-16"><a href="#cb238-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ breath      : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb238-17"><a href="#cb238-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ jail        : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-18"><a href="#cb238-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ service     : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-19"><a href="#cb238-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ fatal       : int  839 930 932 882 1081 1110 1023 724 675 869 ...</span></span>
<span id="cb238-20"><a href="#cb238-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ nfatal      : int  146 154 165 146 172 181 139 131 112 149 ...</span></span>
<span id="cb238-21"><a href="#cb238-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ sfatal      : int  99 98 94 98 119 114 89 76 60 81 ...</span></span>
<span id="cb238-22"><a href="#cb238-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ fatal1517   : int  53 71 49 66 82 94 66 40 40 51 ...</span></span>
<span id="cb238-23"><a href="#cb238-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ nfatal1517  : int  9 8 7 9 10 11 8 7 7 8 ...</span></span>
<span id="cb238-24"><a href="#cb238-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ fatal1820   : int  99 108 103 100 120 127 105 81 83 118 ...</span></span>
<span id="cb238-25"><a href="#cb238-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ nfatal1820  : int  34 26 25 23 23 31 24 16 19 34 ...</span></span>
<span id="cb238-26"><a href="#cb238-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ fatal2124   : int  120 124 118 114 119 138 123 96 80 123 ...</span></span>
<span id="cb238-27"><a href="#cb238-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ nfatal2124  : int  32 35 34 45 29 30 25 36 17 33 ...</span></span>
<span id="cb238-28"><a href="#cb238-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ afatal      : num  309 342 305 277 361 ...</span></span>
<span id="cb238-29"><a href="#cb238-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ pop         : num  3942002 3960008 3988992 4021008 4049994 ...</span></span>
<span id="cb238-30"><a href="#cb238-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ pop1517     : num  209000 202000 197000 195000 204000 ...</span></span>
<span id="cb238-31"><a href="#cb238-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ pop1820     : num  221553 219125 216724 214349 212000 ...</span></span>
<span id="cb238-32"><a href="#cb238-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ pop2124     : num  290000 290000 288000 284000 263000 ...</span></span>
<span id="cb238-33"><a href="#cb238-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ milestot    : num  28516 31032 32961 35091 36259 ...</span></span>
<span id="cb238-34"><a href="#cb238-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ unempus     : num  9.7 9.6 7.5 7.2 7 ...</span></span>
<span id="cb238-35"><a href="#cb238-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ emppopus    : num  57.8 57.9 59.5 60.1 60.7 ...</span></span>
<span id="cb238-36"><a href="#cb238-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ gsp         : num  -0.0221 0.0466 0.0628 0.0275 0.0321 ...</span></span></code></pre></div>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co"># list the first few observations</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Fatalities)</span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   state year spirits unemp   income   emppop  beertax baptist  mormon drinkage</span></span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    al 1982    1.37  14.4 10544.15 50.69204 1.539379 30.3557 0.32829    19.00</span></span>
<span id="cb239-5"><a href="#cb239-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    al 1983    1.36  13.7 10732.80 52.14703 1.788991 30.3336 0.34341    19.00</span></span>
<span id="cb239-6"><a href="#cb239-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3    al 1984    1.32  11.1 11108.79 54.16809 1.714286 30.3115 0.35924    19.00</span></span>
<span id="cb239-7"><a href="#cb239-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4    al 1985    1.28   8.9 11332.63 55.27114 1.652542 30.2895 0.37579    19.67</span></span>
<span id="cb239-8"><a href="#cb239-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5    al 1986    1.23   9.8 11661.51 56.51450 1.609907 30.2674 0.39311    21.00</span></span>
<span id="cb239-9"><a href="#cb239-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6    al 1987    1.18   7.8 11944.00 57.50988 1.560000 30.2453 0.41123    21.00</span></span>
<span id="cb239-10"><a href="#cb239-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       dry youngdrivers    miles breath jail service fatal nfatal sfatal</span></span>
<span id="cb239-11"><a href="#cb239-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 25.0063     0.211572 7233.887     no   no      no   839    146     99</span></span>
<span id="cb239-12"><a href="#cb239-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 22.9942     0.210768 7836.348     no   no      no   930    154     98</span></span>
<span id="cb239-13"><a href="#cb239-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 24.0426     0.211484 8262.990     no   no      no   932    165     94</span></span>
<span id="cb239-14"><a href="#cb239-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 23.6339     0.211140 8726.917     no   no      no   882    146     98</span></span>
<span id="cb239-15"><a href="#cb239-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 23.4647     0.213400 8952.854     no   no      no  1081    172    119</span></span>
<span id="cb239-16"><a href="#cb239-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 23.7924     0.215527 9166.302     no   no      no  1110    181    114</span></span>
<span id="cb239-17"><a href="#cb239-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   fatal1517 nfatal1517 fatal1820 nfatal1820 fatal2124 nfatal2124  afatal</span></span>
<span id="cb239-18"><a href="#cb239-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        53          9        99         34       120         32 309.438</span></span>
<span id="cb239-19"><a href="#cb239-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        71          8       108         26       124         35 341.834</span></span>
<span id="cb239-20"><a href="#cb239-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        49          7       103         25       118         34 304.872</span></span>
<span id="cb239-21"><a href="#cb239-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        66          9       100         23       114         45 276.742</span></span>
<span id="cb239-22"><a href="#cb239-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        82         10       120         23       119         29 360.716</span></span>
<span id="cb239-23"><a href="#cb239-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        94         11       127         31       138         30 368.421</span></span>
<span id="cb239-24"><a href="#cb239-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       pop  pop1517  pop1820  pop2124 milestot unempus emppopus         gsp</span></span>
<span id="cb239-25"><a href="#cb239-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 3942002 208999.6 221553.4 290000.1    28516     9.7     57.8 -0.02212476</span></span>
<span id="cb239-26"><a href="#cb239-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 3960008 202000.1 219125.5 290000.2    31032     9.6     57.9  0.04655825</span></span>
<span id="cb239-27"><a href="#cb239-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 3988992 197000.0 216724.1 288000.2    32961     7.5     59.5  0.06279784</span></span>
<span id="cb239-28"><a href="#cb239-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 4021008 194999.7 214349.0 284000.3    35091     7.2     60.1  0.02748997</span></span>
<span id="cb239-29"><a href="#cb239-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 4049994 203999.9 212000.0 263000.3    36259     7.0     60.7  0.03214295</span></span>
<span id="cb239-30"><a href="#cb239-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 4082999 204999.8 208998.5 258999.8    37426     6.2     61.5  0.04897637</span></span></code></pre></div>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize the variables &#39;state&#39; and &#39;year&#39;</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Fatalities[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)])</span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      state       year   </span></span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  al     :  7   1982:48  </span></span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  az     :  7   1983:48  </span></span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  ar     :  7   1984:48  </span></span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  ca     :  7   1985:48  </span></span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  co     :  7   1986:48  </span></span>
<span id="cb240-9"><a href="#cb240-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  ct     :  7   1987:48  </span></span>
<span id="cb240-10"><a href="#cb240-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  (Other):294   1988:48</span></span></code></pre></div>
<p>We find that the dataset consists of 336 observations on 34 variables. Notice that the variable <tt>state</tt> is a factor variable with 48 levels (one for each of the 48 contiguous federal states of the U.S.).
The variable <tt>year</tt> is also a factor variable that has 7 levels identifying the time period when the observation was made. This gives us <span class="math inline">\(7\times48 = 336\)</span> observations in total. Since all variables are observed for all entities and over all time periods, the panel is <em>balanced</em>. If there were missing data for at least one entity in at least one time period we would call the panel <em>unbalanced</em>.</p>
<div id="example-traffic-deaths-and-alcohol-taxes" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Example: Traffic Deaths and Alcohol Taxes<a href="#example-traffic-deaths-and-alcohol-taxes" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We start by reproducing Figure 10.1 of the book. To this end we estimate simple regressions using data for years 1982 and 1988 that model the relationship between beer tax (adjusted for 1988 dollars) and the traffic fatality rate, measured as the number of fatalities per 10000 inhabitants. Afterwards, we plot the data and add the corresponding estimated regression functions.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the fatality rate</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>Fatalities<span class="sc">$</span>fatal_rate <span class="ot">&lt;-</span> Fatalities<span class="sc">$</span>fatal <span class="sc">/</span> Fatalities<span class="sc">$</span>pop <span class="sc">*</span> <span class="dv">10000</span></span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a><span class="co"># subset the data</span></span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a>Fatalities1982 <span class="ot">&lt;-</span> <span class="fu">subset</span>(Fatalities, year <span class="sc">==</span> <span class="st">&quot;1982&quot;</span>)</span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true" tabindex="-1"></a>Fatalities1988 <span class="ot">&lt;-</span> <span class="fu">subset</span>(Fatalities, year <span class="sc">==</span> <span class="st">&quot;1988&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate simple regression models using 1982 and 1988 data</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>fatal1982_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(fatal_rate <span class="sc">~</span> beertax, <span class="at">data =</span> Fatalities1982)</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>fatal1988_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(fatal_rate <span class="sc">~</span> beertax, <span class="at">data =</span> Fatalities1988)</span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(fatal1982_mod, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb242-7"><a href="#cb242-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb242-8"><a href="#cb242-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb242-9"><a href="#cb242-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb242-10"><a href="#cb242-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  2.01038    0.14957 13.4408   &lt;2e-16 ***</span></span>
<span id="cb242-11"><a href="#cb242-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beertax      0.14846    0.13261  1.1196   0.2687    </span></span>
<span id="cb242-12"><a href="#cb242-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb242-13"><a href="#cb242-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb242-14"><a href="#cb242-14" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(fatal1988_mod, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb242-15"><a href="#cb242-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb242-16"><a href="#cb242-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb242-17"><a href="#cb242-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb242-18"><a href="#cb242-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb242-19"><a href="#cb242-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  1.85907    0.11461 16.2205 &lt; 2.2e-16 ***</span></span>
<span id="cb242-20"><a href="#cb242-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beertax      0.43875    0.12786  3.4314  0.001279 ** </span></span>
<span id="cb242-21"><a href="#cb242-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb242-22"><a href="#cb242-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The estimated regression functions are
<span class="math display">\[\begin{align*}
  \widehat{FatalityRate} =&amp; \, \underset{(0.15)}{2.01} + \underset{(0.13)}{0.15} \times BeerTax \quad (1982 \text{ data}), \\
  \widehat{FatalityRate} =&amp; \, \underset{(0.11)}{1.86} + \underset{(0.13)}{0.44} \times BeerTax \quad (1988 \text{ data}).
\end{align*}\]</span></p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the observations and add the estimated regression line for 1982 data</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> Fatalities1982<span class="sc">$</span>beertax, </span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> Fatalities1982<span class="sc">$</span>fatal_rate, </span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Beer tax (in 1988 dollars)&quot;</span>,</span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Fatality rate (fatalities per 10000)&quot;</span>,</span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Traffic Fatality Rates and Beer Taxes in 1982&quot;</span>,</span>
<span id="cb243-7"><a href="#cb243-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">4.5</span>),</span>
<span id="cb243-8"><a href="#cb243-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, </span>
<span id="cb243-9"><a href="#cb243-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>)</span>
<span id="cb243-10"><a href="#cb243-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-11"><a href="#cb243-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fatal1982_mod, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-419-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot observations and add estimated regression line for 1988 data</span></span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> Fatalities1988<span class="sc">$</span>beertax, </span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> Fatalities1988<span class="sc">$</span>fatal_rate, </span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Beer tax (in 1988 dollars)&quot;</span>,</span>
<span id="cb244-6"><a href="#cb244-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Fatality rate (fatalities per 10000)&quot;</span>,</span>
<span id="cb244-7"><a href="#cb244-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Traffic Fatality Rates and Beer Taxes in 1988&quot;</span>,</span>
<span id="cb244-8"><a href="#cb244-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">4.5</span>),</span>
<span id="cb244-9"><a href="#cb244-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, </span>
<span id="cb244-10"><a href="#cb244-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>)</span>
<span id="cb244-11"><a href="#cb244-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-12"><a href="#cb244-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fatal1988_mod, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-419-2.png" width="80%" style="display: block; margin: auto;" /></p>
<p>In both plots, each point represents observations of beer tax and fatality rate for a given state in the respective year. The regression results indicate a positive relationship between the beer tax and the fatality rate for both years. The estimated coefficient on beer tax for the 1988 data is almost three times as large as for the 1988 dataset. This is contrary to our expectations: alcohol taxes are supposed to <em>lower</em> the rate of traffic fatalities. As we known from Chapter @ref(rmwmr), this is possibly due to omitted variable bias, since both models do not include any covariates, e.g., economic conditions. This could be corrected for using a multiple regression approach. However, this cannot account for omitted <em>unobservable</em> factors that differ from state to state but can be assumed to be constant over the observation span, e.g., the populations’ attitude towards drunk driving. As shown in the next section, panel data allow us to hold such factors constant.</p>
</div>
</div>
<div id="PDWTTP" class="section level2 hasAnchor" number="10.2">
<h2 class="hasAnchor"><span class="header-section-number">10.2</span> Panel Data with Two Time Periods: “Before and After” Comparisons<a href="#PDWTTP" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Suppose there are only <span class="math inline">\(T=2\)</span> time periods <span class="math inline">\(t=1982,1988\)</span>. This allows us to analyze differences in changes of the the fatality rate from year 1982 to 1988. We start by considering the population regression model <span class="math display">\[FatalityRate_{it} = \beta_0 + \beta_1 BeerTax_{it} + \beta_2 Z_{i} + u_{it}\]</span> where the <span class="math inline">\(Z_i\)</span> are state specific characteristics that differ between states but are <em>constant over time</em>. For <span class="math inline">\(t=1982\)</span> and <span class="math inline">\(t=1988\)</span> we have
<span class="math display">\[\begin{align*}
  FatalityRate_{i1982} =&amp;\, \beta_0 + \beta_1 BeerTax_{i1982} + \beta_2 Z_i + u_{i1982}, \\
  FatalityRate_{i1988} =&amp;\, \beta_0 + \beta_1 BeerTax_{i1988} + \beta_2 Z_i + u_{i1988}.
\end{align*}\]</span></p>
<p>We can eliminate the <span class="math inline">\(Z_i\)</span> by regressing the difference in the fatality rate between 1988 and 1982 on the difference in beer tax between those years:
<span class="math display">\[FatalityRate_{i1988} - FatalityRate_{i1982} = \beta_1 (BeerTax_{i1988} - BeerTax_{i1982}) + u_{i1988} - u_{i1982}\]</span>
This regression model yields an estimate for <span class="math inline">\(\beta_1\)</span> robust a possible bias due to omission of the <span class="math inline">\(Z_i\)</span>, since these influences are eliminated from the model. Next we use use <tt>R</tt> to estimate a regression based on the differenced data and plot the estimated regression function.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the differences </span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>diff_fatal_rate <span class="ot">&lt;-</span> Fatalities1988<span class="sc">$</span>fatal_rate <span class="sc">-</span> Fatalities1982<span class="sc">$</span>fatal_rate</span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a>diff_beertax <span class="ot">&lt;-</span> Fatalities1988<span class="sc">$</span>beertax <span class="sc">-</span> Fatalities1982<span class="sc">$</span>beertax</span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate a regression using differenced data</span></span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a>fatal_diff_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(diff_fatal_rate <span class="sc">~</span> diff_beertax)</span>
<span id="cb245-7"><a href="#cb245-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-8"><a href="#cb245-8" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(fatal_diff_mod, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb245-9"><a href="#cb245-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb245-10"><a href="#cb245-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb245-11"><a href="#cb245-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb245-12"><a href="#cb245-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span id="cb245-13"><a href="#cb245-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -0.072037   0.065355 -1.1022 0.276091   </span></span>
<span id="cb245-14"><a href="#cb245-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; diff_beertax -1.040973   0.355006 -2.9323 0.005229 **</span></span>
<span id="cb245-15"><a href="#cb245-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb245-16"><a href="#cb245-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Including the intercept allows for a change in the mean fatality rate in the time between 1982 and 1988 in the absence of a change in the beer tax.</p>
<p>We obtain the OLS estimated regression function <span class="math display">\[\widehat{FatalityRate_{i1988} - FatalityRate_{i1982}} = -\underset{(0.065)}{0.072} -\underset{(0.36)}{1.04} \times (BeerTax_{i1988}-BeerTax_{i1982}).\]</span></p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the differenced data</span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> diff_beertax, </span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> diff_fatal_rate, </span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Change in beer tax (in 1988 dollars)&quot;</span>,</span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Change in fatality rate (fatalities per 10000)&quot;</span>,</span>
<span id="cb246-6"><a href="#cb246-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Changes in Traffic Fatality Rates and Beer Taxes in 1982-1988&quot;</span>,</span>
<span id="cb246-7"><a href="#cb246-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.6</span>, <span class="fl">0.6</span>),</span>
<span id="cb246-8"><a href="#cb246-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="dv">1</span>),</span>
<span id="cb246-9"><a href="#cb246-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, </span>
<span id="cb246-10"><a href="#cb246-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>)</span>
<span id="cb246-11"><a href="#cb246-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-12"><a href="#cb246-12" aria-hidden="true" tabindex="-1"></a><span class="co"># add the regression line to plot</span></span>
<span id="cb246-13"><a href="#cb246-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fatal_diff_mod, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-421-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The estimated coefficient on beer tax is now negative and significantly different from zero at <span class="math inline">\(5\%\)</span>. Its interpretation is that raising the beer tax by <span class="math inline">\(\$1\)</span> causes traffic fatalities to decrease by <span class="math inline">\(1.04\)</span> per <span class="math inline">\(10000\)</span> people. This is rather large as the average fatality rate is approximately <span class="math inline">\(2\)</span> persons per <span class="math inline">\(10000\)</span> people.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute mean fatality rate over all states for all time periods</span></span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(Fatalities<span class="sc">$</span>fatal_rate)</span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2.040444</span></span></code></pre></div>
<p>Once more this outcome is likely to be a consequence of omitting factors in the single-year regression that influence the fatality rate and are correlated with the beer tax <em>and</em> change over time. The message is that we need to be more careful and control for such factors before drawing conclusions about the effect of a raise in beer taxes.</p>
<p>The approach presented in this section discards information for years <span class="math inline">\(1983\)</span> to <span class="math inline">\(1987\)</span>. A method that allows to use data for more than <span class="math inline">\(T=2\)</span> time periods and enables us to add control variables is the fixed effects regression approach.</p>
</div>
<div id="fixed-effects-regression" class="section level2 hasAnchor" number="10.3">
<h2 class="hasAnchor"><span class="header-section-number">10.3</span> Fixed Effects Regression<a href="#fixed-effects-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consider the panel regression model</p>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 X_{it} + \beta_2 Z_i +  u_{it}\]</span>
where the <span class="math inline">\(Z_i\)</span> are unobserved time-invariant heterogeneities across the entities <span class="math inline">\(i=1,\dots,n\)</span>. We aim to estimate <span class="math inline">\(\beta_1\)</span>, the effect on <span class="math inline">\(Y_i\)</span> of a change in <span class="math inline">\(X_i\)</span> holding constant <span class="math inline">\(Z_i\)</span>. Letting <span class="math inline">\(\alpha_i = \beta_0 + \beta_2 Z_i\)</span> we obtain the model
<span class="math display">\[\begin{align}
Y_{it} = \alpha_i + \beta_1 X_{it} + u_{it} (\#eq:femodel).
\end{align}\]</span>
Having individual specific intercepts <span class="math inline">\(\alpha_i\)</span>, <span class="math inline">\(i=1,\dots,n\)</span>, where each of these can be understood as the fixed effect of entity <span class="math inline">\(i\)</span>, this model is called the <em>fixed effects model</em>.
The variation in the <span class="math inline">\(\alpha_i\)</span>, <span class="math inline">\(i=1,\dots,n\)</span> comes from the <span class="math inline">\(Z_i\)</span>. @ref(eq:femodel) can be rewritten as a regression model containing <span class="math inline">\(n-1\)</span> dummy regressors and a constant:
<span class="math display">\[\begin{align}
Y_{it} = \beta_0 + \beta_1 X_{it} + \gamma_2 D2_i + \gamma_3 D3_i + \cdots + \gamma_n Dn_i + u_{it} (\#eq:drmodel).
\end{align}\]</span>
Model @ref(eq:drmodel) has <span class="math inline">\(n\)</span> different intercepts — one for every entity. @ref(eq:femodel) and @ref(eq:drmodel) are equivalent representations of the fixed effects model.</p>
<p>The fixed effects model can be generalized to contain more than just one determinant of <span class="math inline">\(Y\)</span> that is correlated with <span class="math inline">\(X\)</span> and changes over time. Key Concept 10.2 presents the generalized fixed effects regression model.</p>
<div id="KC10.2" class="keyconcept">
<h3 class="right">
Key Concept 10.2
</h3>
<h3 class="left">
The Fixed Effects Regression Model
</h3>
<p>The fixed effects regression model is</p>
<p><span class="math display">\[\begin{align}
Y_{it} = \beta_1 X_{1,it} + \cdots + \beta_k X_{k,it} + \alpha_i + u_{it} (\#eq:gfemodel)
\end{align}\]</span></p>
<p>with <span class="math inline">\(i=1,\dots,n\)</span> and <span class="math inline">\(t=1,\dots,T\)</span>. The <span class="math inline">\(\alpha_i\)</span> are entity-specific intercepts that capture heterogeneities across entities. An equivalent representation of this model is given by</p>
<p><span class="math display">\[\begin{align}
Y_{it} = \beta_0 + \beta_1 X_{1,it} + \cdots + \beta_k X_{k,it} + \gamma_2 D2_i + \gamma_3 D3_i + \cdots + \gamma_n Dn_i  + u_{it} (\#eq:gdrmodel)
\end{align}\]</span></p>
<p>where the <span class="math inline">\(D2_i,D3_i,\dots,Dn_i\)</span> are dummy variables.</p>
</div>
<div id="estimation-and-inference" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Estimation and Inference<a href="#estimation-and-inference" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Software packages use a so-called “entity-demeaned” OLS algorithm which is computationally more efficient than estimating regression models with <span class="math inline">\(k+n\)</span> regressors as needed for models @ref(eq:gfemodel) and @ref(eq:gdrmodel).</p>
<p>Taking averages on both sides of @ref(eq:femodel) we obtain
<span class="math display">\[\begin{align*}
\frac{1}{T} \sum_{t=1}^T Y_{it} =&amp; \, \beta_1 \frac{1}{T} \sum_{t=1}^T X_{it} + \frac{1}{T} \sum_{t=1}^T \alpha_i + \frac{1}{T} \sum_{t=1}^T u_{it} \\
\overline{Y}_i =&amp; \, \beta_1 \overline{X}_i + \alpha_i + \overline{u}_i.
\end{align*}\]</span>
Subtraction from @ref(eq:femodel) yields
<span class="math display">\[\begin{align}
\begin{split}
Y_{it} - \overline{Y}_i =&amp; \, \beta_1(X_{it}-\overline{X}_i) + (u_{it} - \overline{u}_i) \\
\overset{\sim}{Y}_{it} =&amp; \, \beta_1 \overset{\sim}{X}_{it} + \overset{\sim}{u}_{it}.
\end{split} (\#eq:edols)
\end{align}\]</span>
In this model, the OLS estimate of the parameter of interest <span class="math inline">\(\beta_1\)</span> is equal to the estimate obtained using @ref(eq:drmodel) — without the need to estimate <span class="math inline">\(n-1\)</span> dummies and an intercept.</p>
<p>We conclude that there are two ways of estimating <span class="math inline">\(\beta_1\)</span> in the fixed effects regression:</p>
<ol style="list-style-type: decimal">
<li><p>OLS of the dummy regression model as shown in @ref(eq:drmodel)</p></li>
<li><p>OLS using the entity demeaned data as in @ref(eq:edols)</p></li>
</ol>
<p>Provided the fixed effects regression assumptions stated in Key Concept 10.3 hold, the sampling distribution of the OLS estimator in the fixed effects regression model is normal in large samples. The variance of the estimates can be estimated and we can compute standard errors, <span class="math inline">\(t\)</span>-statistics and confidence intervals for coefficients. In the next section, we see how to estimate a fixed effects model using <tt>R</tt> and how to obtain a model summary that reports heteroskedasticity-robust standard errors. We leave aside complicated formulas of the estimators. See Chapter 10.5 and Appendix 10.2 of the book for a discussion of theoretical aspects.</p>
</div>
<div id="application-to-traffic-deaths" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Application to Traffic Deaths<a href="#application-to-traffic-deaths" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Following Key Concept 10.2, the simple fixed effects model for estimation of the relation between traffic fatality rates and the beer taxes is
<span class="math display">\[\begin{align}
FatalityRate_{it} = \beta_1 BeerTax_{it} + StateFixedEffects + u_{it}, (\#eq:fatsemod)
\end{align}\]</span>
a regression of the traffic fatality rate on beer tax and 48 binary regressors — one for each federal state.</p>
<p>We can simply use the function <tt>lm()</tt> to obtain an estimate of <span class="math inline">\(\beta_1\)</span>.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>fatal_fe_lm_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(fatal_rate <span class="sc">~</span> beertax <span class="sc">+</span> state <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> Fatalities)</span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>fatal_fe_lm_mod</span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = fatal_rate ~ beertax + state - 1, data = Fatalities)</span></span>
<span id="cb248-6"><a href="#cb248-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb248-7"><a href="#cb248-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb248-8"><a href="#cb248-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beertax  stateal  stateaz  statear  stateca  stateco  statect  statede  </span></span>
<span id="cb248-9"><a href="#cb248-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -0.6559   3.4776   2.9099   2.8227   1.9682   1.9933   1.6154   2.1700  </span></span>
<span id="cb248-10"><a href="#cb248-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; statefl  statega  stateid  stateil  statein  stateia  stateks  stateky  </span></span>
<span id="cb248-11"><a href="#cb248-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3.2095   4.0022   2.8086   1.5160   2.0161   1.9337   2.2544   2.2601  </span></span>
<span id="cb248-12"><a href="#cb248-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; statela  stateme  statemd  statema  statemi  statemn  statems  statemo  </span></span>
<span id="cb248-13"><a href="#cb248-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2.6305   2.3697   1.7712   1.3679   1.9931   1.5804   3.4486   2.1814  </span></span>
<span id="cb248-14"><a href="#cb248-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; statemt  statene  statenv  statenh  statenj  statenm  stateny  statenc  </span></span>
<span id="cb248-15"><a href="#cb248-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3.1172   1.9555   2.8769   2.2232   1.3719   3.9040   1.2910   3.1872  </span></span>
<span id="cb248-16"><a href="#cb248-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; statend  stateoh  stateok  stateor  statepa  stateri  statesc  statesd  </span></span>
<span id="cb248-17"><a href="#cb248-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1.8542   1.8032   2.9326   2.3096   1.7102   1.2126   4.0348   2.4739  </span></span>
<span id="cb248-18"><a href="#cb248-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; statetn  statetx  stateut  statevt  stateva  statewa  statewv  statewi  </span></span>
<span id="cb248-19"><a href="#cb248-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2.6020   2.5602   2.3137   2.5116   2.1874   1.8181   2.5809   1.7184  </span></span>
<span id="cb248-20"><a href="#cb248-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; statewy  </span></span>
<span id="cb248-21"><a href="#cb248-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3.2491</span></span></code></pre></div>
<p>As discussed in the previous section, it is also possible to estimate <span class="math inline">\(\beta_1\)</span> by applying OLS to the demeaned data, that is, to run the regression</p>
<p><span class="math display">\[\overset{\sim}{FatalityRate} = \beta_1 \overset{\sim}{BeerTax}_{it} + u_{it}. \]</span></p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain demeaned data</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a>Fatalities_demeaned <span class="ot">&lt;-</span> <span class="fu">with</span>(Fatalities,</span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">data.frame</span>(<span class="at">fatal_rate =</span> fatal_rate <span class="sc">-</span> <span class="fu">ave</span>(fatal_rate, state),</span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">beertax =</span> beertax <span class="sc">-</span> <span class="fu">ave</span>(beertax, state)))</span>
<span id="cb249-5"><a href="#cb249-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-6"><a href="#cb249-6" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the regression</span></span>
<span id="cb249-7"><a href="#cb249-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(fatal_rate <span class="sc">~</span> beertax <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> Fatalities_demeaned))</span></code></pre></div>
<p>The function <tt>ave</tt> is convenient for computing group averages. We use it to obtain state specific averages of the fatality rate and the beer tax.</p>
<p>Alternatively one may use <tt>plm()</tt> from the package with the same name.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install and load the &#39;plm&#39; package</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="do">## install.packages(&quot;plm&quot;)</span></span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plm)</span></code></pre></div>
<p>As for <tt>lm()</tt> we have to specify the regression formula and the data to be used in our call of <tt>plm()</tt>. Additionally, it is required to pass a vector of names of entity and time ID variables to the argument <tt>index</tt>. For <tt>Fatalities</tt>, the ID variable for entities is named <tt>state</tt> and the time id variable is <tt>year</tt>. Since the fixed effects estimator is also called the <em>within estimator</em>, we set <tt>model = “within”</tt>. Finally, the function <tt>coeftest()</tt> allows to obtain inference based on robust standard errors.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the fixed effects regression with plm()</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>fatal_fe_mod <span class="ot">&lt;-</span> <span class="fu">plm</span>(fatal_rate <span class="sc">~</span> beertax, </span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> Fatalities,</span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;state&quot;</span>, <span class="st">&quot;year&quot;</span>), </span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">model =</span> <span class="st">&quot;within&quot;</span>)</span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-7"><a href="#cb251-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print summary using robust standard errors</span></span>
<span id="cb251-8"><a href="#cb251-8" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(fatal_fe_mod, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb251-9"><a href="#cb251-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb251-10"><a href="#cb251-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb251-11"><a href="#cb251-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb251-12"><a href="#cb251-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span id="cb251-13"><a href="#cb251-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beertax -0.65587    0.28880  -2.271  0.02388 *</span></span>
<span id="cb251-14"><a href="#cb251-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb251-15"><a href="#cb251-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The estimated coefficient is again <span class="math inline">\(-0.6559\)</span>. Note that <tt>plm()</tt> uses the entity-demeaned OLS algorithm and thus does not report dummy coefficients. The estimated regression function is</p>
<p><span class="math display">\[\begin{align}
\widehat{FatalityRate} = -\underset{(0.29)}{0.66} \times BeerTax + StateFixedEffects. (\#eq:efemod)
\end{align}\]</span></p>
<p>The coefficient on <span class="math inline">\(BeerTax\)</span> is negative and significant. The interpretation is that the estimated reduction in traffic fatalities due to an increase in the real beer tax by <span class="math inline">\(\$1\)</span> is <span class="math inline">\(0.66\)</span> per <span class="math inline">\(10000\)</span> people, which is still pretty high. Although including state fixed effects eliminates the risk of a bias due to omitted factors that vary across states but not over time, we suspect that there are other omitted variables that vary over time and thus cause a bias.</p>
</div>
</div>
<div id="regression-with-time-fixed-effects" class="section level2 hasAnchor" number="10.4">
<h2 class="hasAnchor"><span class="header-section-number">10.4</span> Regression with Time Fixed Effects<a href="#regression-with-time-fixed-effects" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Controlling for variables that are constant across entities but vary over time can be done by including time fixed effects. If there are <em>only</em> time fixed effects, the fixed effects regression model becomes <span class="math display">\[Y_{it} = \beta_0 + \beta_1 X_{it} + \delta_2 B2_t + \cdots + \delta_T BT_t + u_{it},\]</span> where only <span class="math inline">\(T-1\)</span> dummies are included (<span class="math inline">\(B1\)</span> is omitted) since the model includes an intercept. This model eliminates omitted variable bias caused by excluding unobserved variables that evolve over time but are constant across entities.</p>
<p>In some applications it is meaningful to include both entity and time fixed effects. The <em>entity and time fixed effects model</em> is <span class="math display">\[Y_{it} = \beta_0 + \beta_1 X_{it} + \gamma_2 D2_i + \cdots + \gamma_n DT_i + \delta_2 B2_t + \cdots + \delta_T BT_t + u_{it} .\]</span> The combined model allows to eliminate bias from unobservables that change over time but are constant over entities and it controls for factors that differ across entities but are constant over time. Such models can be estimated using the OLS algorithm that is implemented in <tt>R</tt>.</p>
<p>The following code chunk shows how to estimate the combined entity and time fixed effects model of the relation between fatalities and beer tax, <span class="math display">\[FatalityRate_{it} = \beta_1 BeerTax_{it} + StateEffects + TimeFixedEffects + u_{it}\]</span> using both <tt>lm()</tt> and <tt>plm()</tt>. It is straightforward to estimate this regression with <tt>lm()</tt> since it is just an extension of @ref(eq:fatsemod) so we only have to adjust the <tt>formula</tt> argument by adding the additional regressor <tt>year</tt> for time fixed effects. In our call of <tt>plm()</tt> we set another argument <tt>effect = “twoways”</tt> for inclusion of entity <em>and</em> time dummies.</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate a combined time and entity fixed effects regression model</span></span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a><span class="co"># via lm()</span></span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a>fatal_tefe_lm_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(fatal_rate <span class="sc">~</span> beertax <span class="sc">+</span> state <span class="sc">+</span> year <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> Fatalities)</span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a>fatal_tefe_lm_mod</span>
<span id="cb252-6"><a href="#cb252-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb252-7"><a href="#cb252-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb252-8"><a href="#cb252-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = fatal_rate ~ beertax + state + year - 1, data = Fatalities)</span></span>
<span id="cb252-9"><a href="#cb252-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb252-10"><a href="#cb252-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb252-11"><a href="#cb252-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  beertax   stateal   stateaz   statear   stateca   stateco   statect   statede  </span></span>
<span id="cb252-12"><a href="#cb252-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -0.63998   3.51137   2.96451   2.87284   2.02618   2.04984   1.67125   2.22711  </span></span>
<span id="cb252-13"><a href="#cb252-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  statefl   statega   stateid   stateil   statein   stateia   stateks   stateky  </span></span>
<span id="cb252-14"><a href="#cb252-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3.25132   4.02300   2.86242   1.57287   2.07123   1.98709   2.30707   2.31659  </span></span>
<span id="cb252-15"><a href="#cb252-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  statela   stateme   statemd   statema   statemi   statemn   statems   statemo  </span></span>
<span id="cb252-16"><a href="#cb252-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2.67772   2.41713   1.82731   1.42335   2.04488   1.63488   3.49146   2.23598  </span></span>
<span id="cb252-17"><a href="#cb252-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  statemt   statene   statenv   statenh   statenj   statenm   stateny   statenc  </span></span>
<span id="cb252-18"><a href="#cb252-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3.17160   2.00846   2.93322   2.27245   1.43016   3.95748   1.34849   3.22630  </span></span>
<span id="cb252-19"><a href="#cb252-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  statend   stateoh   stateok   stateor   statepa   stateri   statesc   statesd  </span></span>
<span id="cb252-20"><a href="#cb252-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1.90762   1.85664   2.97776   2.36597   1.76563   1.26964   4.06496   2.52317  </span></span>
<span id="cb252-21"><a href="#cb252-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  statetn   statetx   stateut   statevt   stateva   statewa   statewv   statewi  </span></span>
<span id="cb252-22"><a href="#cb252-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2.65670   2.61282   2.36165   2.56100   2.23618   1.87424   2.63364   1.77545  </span></span>
<span id="cb252-23"><a href="#cb252-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  statewy  year1983  year1984  year1985  year1986  year1987  year1988  </span></span>
<span id="cb252-24"><a href="#cb252-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3.30791  -0.07990  -0.07242  -0.12398  -0.03786  -0.05090  -0.05180</span></span>
<span id="cb252-25"><a href="#cb252-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-26"><a href="#cb252-26" aria-hidden="true" tabindex="-1"></a><span class="co"># via plm()</span></span>
<span id="cb252-27"><a href="#cb252-27" aria-hidden="true" tabindex="-1"></a>fatal_tefe_mod <span class="ot">&lt;-</span> <span class="fu">plm</span>(fatal_rate <span class="sc">~</span> beertax, </span>
<span id="cb252-28"><a href="#cb252-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> Fatalities,</span>
<span id="cb252-29"><a href="#cb252-29" aria-hidden="true" tabindex="-1"></a>                      <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;state&quot;</span>, <span class="st">&quot;year&quot;</span>), </span>
<span id="cb252-30"><a href="#cb252-30" aria-hidden="true" tabindex="-1"></a>                      <span class="at">model =</span> <span class="st">&quot;within&quot;</span>, </span>
<span id="cb252-31"><a href="#cb252-31" aria-hidden="true" tabindex="-1"></a>                      <span class="at">effect =</span> <span class="st">&quot;twoways&quot;</span>)</span>
<span id="cb252-32"><a href="#cb252-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-33"><a href="#cb252-33" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(fatal_tefe_mod, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb252-34"><a href="#cb252-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb252-35"><a href="#cb252-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb252-36"><a href="#cb252-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb252-37"><a href="#cb252-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span id="cb252-38"><a href="#cb252-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beertax -0.63998    0.35015 -1.8277  0.06865 .</span></span>
<span id="cb252-39"><a href="#cb252-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb252-40"><a href="#cb252-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Before discussing the outcomes we convince ourselves that <tt>state</tt> and <tt>year</tt> are of the class <tt>factor</tt> .</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check the class of &#39;state&#39; and &#39;year&#39;</span></span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(Fatalities<span class="sc">$</span>state)</span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;factor&quot;</span></span>
<span id="cb253-4"><a href="#cb253-4" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(Fatalities<span class="sc">$</span>year)</span>
<span id="cb253-5"><a href="#cb253-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;factor&quot;</span></span></code></pre></div>
<p>The <tt>lm()</tt> functions converts factors into dummies automatically. Since we exclude the intercept by adding <tt>-1</tt> to the right-hand side of the regression formula, <tt>lm()</tt> estimates coefficients for <span class="math inline">\(n + (T-1) = 48 + 6 = 54\)</span> binary variables (6 year dummies and 48 state dummies). Again, <tt>plm()</tt> only reports the estimated coefficient on <span class="math inline">\(BeerTax\)</span>.</p>
<p>The estimated regression function is
<span class="math display">\[\begin{align}
\widehat{FatalityRate} =  -\underset{(0.35)}{0.64} \times BeerTax + StateEffects + TimeFixedEffects. (\#eq:cbnfemod)
\end{align}\]</span>
The result <span class="math inline">\(-0.66\)</span> is close to the estimated coefficient for the regression model including only entity fixed effects. Unsurprisingly, the coefficient is less precisely estimated but significantly different from zero at <span class="math inline">\(10\%\)</span>.</p>
<p>In view of @ref(eq:efemod) and @ref(eq:cbnfemod) we conclude that the estimated relationship between traffic fatalities and the real beer tax is not affected by omitted variable bias due to factors that are constant over time.</p>
</div>
<div id="tferaaseffer" class="section level2 hasAnchor" number="10.5">
<h2 class="hasAnchor"><span class="header-section-number">10.5</span> The Fixed Effects Regression Assumptions and Standard Errors for Fixed Effects Regression<a href="#tferaaseffer" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section focuses on the entity fixed effects model and presents model assumptions that need to hold in order for OLS to produce unbiased estimates that are normally distributed in large samples. These assumptions are an extension of the assumptions made for the multiple regression model (see Key Concept 6.4) and are given in Key Concept 10.3. We also briefly discuss standard errors in fixed effects models which differ from standard errors in multiple regression as the regression error can exhibit serial correlation in panel models.</p>
<div id="KC10.3" class="keyconcept">
<h3 class="right">
Key Concept 10.3
</h3>
<h3 class="left">
The Fixed Effects Regression Assumptions
</h3>
<p>In the fixed effects model <span class="math display">\[ Y_{it} = \beta_1 X_{it} + \alpha_i + u_{it} \ \ , \ \ i=1,\dots,n, \ t=1,\dots,T, \]</span> we assume the following:</p>
<ol style="list-style-type: decimal">
<li><p>The error term <span class="math inline">\(u_{it}\)</span> has conditional mean zero, that is, <span class="math inline">\(E(u_{it}|X_{i1}, X_{i2},\dots, X_{iT})\)</span>.</p></li>
<li><p><span class="math inline">\((X_{i1}, X_{i2}, \dots, X_{i3}, u_{i1}, \dots, u_{iT})\)</span>, <span class="math inline">\(i=1,\dots,n\)</span> are i.i.d. draws from their joint distribution.</p></li>
<li><p>Large outliers are unlikely, i.e., <span class="math inline">\((X_{it}, u_{it})\)</span> have nonzero finite fourth moments.</p></li>
<li><p>There is no perfect multicollinearity.</p></li>
</ol>
<p>When there are multiple regressors, <span class="math inline">\(X_{it}\)</span> is replaced by <span class="math inline">\(X_{1,it}, X_{2,it}, \dots, X_{k,it}\)</span>.</p>
</div>
<p>The first assumption is that the error is uncorrelated with <em>all</em> observations of the variable <span class="math inline">\(X\)</span> for the entity <span class="math inline">\(i\)</span> over time. If this assumption is violated, we face omitted variables bias. The second assumption ensures that variables are i.i.d. <em>across</em> entities <span class="math inline">\(i=1,\dots,n\)</span>. This does not require the observations to be uncorrelated <em>within</em> an entity. The <span class="math inline">\(X_{it}\)</span> are allowed to be <em>autocorrelated</em> within entities. This is a common property of time series data. The same is allowed for errors <span class="math inline">\(u_{it}\)</span>. Consult Chapter @ref(tferaaseffer) of the book for a detailed explanation for why autocorrelation is plausible in panel applications. The second assumption is justified if the entities are selected by simple random sampling. The third and fourth assumptions are analogous to the multiple regression assumptions made in Key Concept 6.4.</p>
<div id="standard-errors-for-fixed-effects-regression" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Standard Errors for Fixed Effects Regression<a href="#standard-errors-for-fixed-effects-regression" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Similar as for heteroskedasticity, autocorrelation invalidates the usual standard error formulas as well as heteroskedasticity-robust standard errors since these are derived under the assumption that there is no autocorrelation. When there is both heteroskedasticity <em>and</em> autocorrelation so-called <em>heteroskedasticity and autocorrelation-consistent (HAC) standard errors</em> need to be used. <em>Clustered standard errors</em> belong to these type of standard errors. They allow for heteroskedasticity and autocorrelated errors within an entity but <em>not</em> correlation across entities.</p>
<p>As shown in the examples throughout this chapter, it is fairly easy to specify usage of clustered standard errors in regression summaries produced by function like <tt>coeftest()</tt> in conjunction with <tt>vcovHC()</tt> from the package <tt>sandwich</tt>. Conveniently, <tt>vcovHC()</tt> recognizes panel model objects (objects of class <tt>plm</tt>) and computes clustered standard errors by default.</p>
<p>The regressions conducted in this chapter are a good examples for why usage of clustered standard errors is crucial in empirical applications of fixed effects models. For example, consider the entity and time fixed effects model for fatalities. Since <tt>fatal_tefe_lm_mod</tt> is an object of class <tt>lm</tt>, <tt>coeftest()</tt> does not compute clustered standard errors but uses robust standard errors that are only valid in the absence of autocorrelated errors.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check class of the model object</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(fatal_tefe_lm_mod)</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;lm&quot;</span></span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain a summary based on heteroskedasticity-robust standard errors </span></span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a><span class="co"># (no adjustment for heteroskedasticity only)</span></span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(fatal_tefe_lm_mod, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)[<span class="dv">1</span>, ]</span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Estimate Std. Error    t value   Pr(&gt;|t|) </span></span>
<span id="cb254-9"><a href="#cb254-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -0.6399800  0.2547149 -2.5125346  0.0125470</span></span>
<span id="cb254-10"><a href="#cb254-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-11"><a href="#cb254-11" aria-hidden="true" tabindex="-1"></a><span class="co"># check class of the (plm) model object</span></span>
<span id="cb254-12"><a href="#cb254-12" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(fatal_tefe_mod)</span>
<span id="cb254-13"><a href="#cb254-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;plm&quot;        &quot;panelmodel&quot;</span></span>
<span id="cb254-14"><a href="#cb254-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-15"><a href="#cb254-15" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain a summary based on clusterd standard errors </span></span>
<span id="cb254-16"><a href="#cb254-16" aria-hidden="true" tabindex="-1"></a><span class="co"># (adjustment for autocorrelation + heteroskedasticity)</span></span>
<span id="cb254-17"><a href="#cb254-17" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(fatal_tefe_mod, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb254-18"><a href="#cb254-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb254-19"><a href="#cb254-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb254-20"><a href="#cb254-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb254-21"><a href="#cb254-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span id="cb254-22"><a href="#cb254-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beertax -0.63998    0.35015 -1.8277  0.06865 .</span></span>
<span id="cb254-23"><a href="#cb254-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb254-24"><a href="#cb254-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The outcomes differ rather strongly: imposing no autocorrelation we obtain a standard error of <span class="math inline">\(0.25\)</span> which implies significance of <span class="math inline">\(\hat\beta_1\)</span>, the coefficient on <span class="math inline">\(BeerTax\)</span> at the level of <span class="math inline">\(5\%\)</span>. On the contrary, using the clustered standard error <span class="math inline">\(0.35\)</span> leads to acceptance of the hypothesis <span class="math inline">\(H_0: \beta_1 = 0\)</span> at the same level, see equation @ref(eq:cbnfemod). Consult Appendix 10.2 of the book for insights on the computation of clustered standard errors.</p>
</div>
</div>
<div id="drunk-driving-laws-and-traffic-deaths" class="section level2 hasAnchor" number="10.6">
<h2 class="hasAnchor"><span class="header-section-number">10.6</span> Drunk Driving Laws and Traffic Deaths<a href="#drunk-driving-laws-and-traffic-deaths" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are two major sources of omitted variable bias that are not accounted for by all of the models of the relation between traffic fatalities and beer taxes that we have considered so far: economic conditions and driving laws. Fortunately, <tt>Fatalities</tt> has data on state-specific legal drinking age (<tt>drinkage</tt>), punishment (<tt>jail</tt>, <tt>service</tt>) and various economic indicators like unemployment rate (<tt>unemp</tt>) and per capita income (<tt>income</tt>). We may use these covariates to extend the preceding analysis.</p>
<p>These covariates are defined as follows:</p>
<ul>
<li><tt>unemp</tt>: a numeric variable stating the state specific unemployment rate.</li>
<li><tt>log(income)</tt>: the logarithm of real per capita income (in prices of 1988).</li>
<li><tt>miles</tt>: the state average miles per driver.</li>
<li><tt>drinkage</tt>: the state specify minimum legal drinking age.</li>
<li><tt>drinkagc</tt>: a discretized version of <tt>drinkage</tt> that classifies states into four categories of minimal drinking age; <span class="math inline">\(18\)</span>, <span class="math inline">\(19\)</span>, <span class="math inline">\(20\)</span>, <span class="math inline">\(21\)</span> and older. <tt>R</tt> denotes this as <tt>[18,19)</tt>, <tt>[19,20)</tt>, <tt>[20,21)</tt> and <tt>[21,22]</tt>. These categories are included as dummy regressors where <tt>[21,22]</tt> is chosen as the reference category.</li>
<li><tt>punish</tt>: a dummy variable with levels <tt>yes</tt> and <tt>no</tt> that measures if drunk driving is severely punished by mandatory jail time or mandatory community service (first conviction).</li>
</ul>
<p>At first, we define the variables according to the regression results presented in Table 10.1 of the book.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="co"># discretize the minimum legal drinking age</span></span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>Fatalities<span class="sc">$</span>drinkagec <span class="ot">&lt;-</span> <span class="fu">cut</span>(Fatalities<span class="sc">$</span>drinkage,</span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">breaks =</span> <span class="dv">18</span><span class="sc">:</span><span class="dv">22</span>, </span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">include.lowest =</span> <span class="cn">TRUE</span>, </span>
<span id="cb255-5"><a href="#cb255-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">right =</span> <span class="cn">FALSE</span>)</span>
<span id="cb255-6"><a href="#cb255-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-7"><a href="#cb255-7" aria-hidden="true" tabindex="-1"></a><span class="co"># set minimum drinking age [21, 22] to be the baseline level</span></span>
<span id="cb255-8"><a href="#cb255-8" aria-hidden="true" tabindex="-1"></a>Fatalities<span class="sc">$</span>drinkagec <span class="ot">&lt;-</span> <span class="fu">relevel</span>(Fatalities<span class="sc">$</span>drinkagec, <span class="st">&quot;[21,22]&quot;</span>)</span>
<span id="cb255-9"><a href="#cb255-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-10"><a href="#cb255-10" aria-hidden="true" tabindex="-1"></a><span class="co"># mandadory jail or community service?</span></span>
<span id="cb255-11"><a href="#cb255-11" aria-hidden="true" tabindex="-1"></a>Fatalities<span class="sc">$</span>punish <span class="ot">&lt;-</span> <span class="fu">with</span>(Fatalities, <span class="fu">factor</span>(jail <span class="sc">==</span> <span class="st">&quot;yes&quot;</span> <span class="sc">|</span> service <span class="sc">==</span> <span class="st">&quot;yes&quot;</span>, </span>
<span id="cb255-12"><a href="#cb255-12" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>)))</span>
<span id="cb255-13"><a href="#cb255-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-14"><a href="#cb255-14" aria-hidden="true" tabindex="-1"></a><span class="co"># the set of observations on all variables for 1982 and 1988</span></span>
<span id="cb255-15"><a href="#cb255-15" aria-hidden="true" tabindex="-1"></a>Fatalities_1982_1988 <span class="ot">&lt;-</span> Fatalities[<span class="fu">with</span>(Fatalities, year <span class="sc">==</span> <span class="dv">1982</span> <span class="sc">|</span> year <span class="sc">==</span> <span class="dv">1988</span>), ]</span></code></pre></div>
<p>Next, we estimate all seven models using <tt>plm()</tt>.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate all seven models</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>fatalities_mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(fatal_rate <span class="sc">~</span> beertax, <span class="at">data =</span> Fatalities)</span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a>fatalities_mod2 <span class="ot">&lt;-</span> <span class="fu">plm</span>(fatal_rate <span class="sc">~</span> beertax <span class="sc">+</span> state, <span class="at">data =</span> Fatalities)</span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true" tabindex="-1"></a>fatalities_mod3 <span class="ot">&lt;-</span> <span class="fu">plm</span>(fatal_rate <span class="sc">~</span> beertax <span class="sc">+</span> state <span class="sc">+</span> year,</span>
<span id="cb256-7"><a href="#cb256-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;state&quot;</span>,<span class="st">&quot;year&quot;</span>),</span>
<span id="cb256-8"><a href="#cb256-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">model =</span> <span class="st">&quot;within&quot;</span>,</span>
<span id="cb256-9"><a href="#cb256-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">effect =</span> <span class="st">&quot;twoways&quot;</span>, </span>
<span id="cb256-10"><a href="#cb256-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> Fatalities)</span>
<span id="cb256-11"><a href="#cb256-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-12"><a href="#cb256-12" aria-hidden="true" tabindex="-1"></a>fatalities_mod4 <span class="ot">&lt;-</span> <span class="fu">plm</span>(fatal_rate <span class="sc">~</span> beertax <span class="sc">+</span> state <span class="sc">+</span> year <span class="sc">+</span> drinkagec </span>
<span id="cb256-13"><a href="#cb256-13" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">+</span> punish <span class="sc">+</span> miles <span class="sc">+</span> unemp <span class="sc">+</span> <span class="fu">log</span>(income), </span>
<span id="cb256-14"><a href="#cb256-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;state&quot;</span>, <span class="st">&quot;year&quot;</span>),</span>
<span id="cb256-15"><a href="#cb256-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">model =</span> <span class="st">&quot;within&quot;</span>,</span>
<span id="cb256-16"><a href="#cb256-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">effect =</span> <span class="st">&quot;twoways&quot;</span>,</span>
<span id="cb256-17"><a href="#cb256-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> Fatalities)</span>
<span id="cb256-18"><a href="#cb256-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-19"><a href="#cb256-19" aria-hidden="true" tabindex="-1"></a>fatalities_mod5 <span class="ot">&lt;-</span> <span class="fu">plm</span>(fatal_rate <span class="sc">~</span> beertax <span class="sc">+</span> state <span class="sc">+</span> year <span class="sc">+</span> drinkagec </span>
<span id="cb256-20"><a href="#cb256-20" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">+</span> punish <span class="sc">+</span> miles,</span>
<span id="cb256-21"><a href="#cb256-21" aria-hidden="true" tabindex="-1"></a>                       <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;state&quot;</span>, <span class="st">&quot;year&quot;</span>),</span>
<span id="cb256-22"><a href="#cb256-22" aria-hidden="true" tabindex="-1"></a>                       <span class="at">model =</span> <span class="st">&quot;within&quot;</span>,</span>
<span id="cb256-23"><a href="#cb256-23" aria-hidden="true" tabindex="-1"></a>                       <span class="at">effect =</span> <span class="st">&quot;twoways&quot;</span>,</span>
<span id="cb256-24"><a href="#cb256-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> Fatalities)</span>
<span id="cb256-25"><a href="#cb256-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-26"><a href="#cb256-26" aria-hidden="true" tabindex="-1"></a>fatalities_mod6 <span class="ot">&lt;-</span> <span class="fu">plm</span>(fatal_rate <span class="sc">~</span> beertax <span class="sc">+</span> year <span class="sc">+</span> drinkage </span>
<span id="cb256-27"><a href="#cb256-27" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">+</span> punish <span class="sc">+</span> miles <span class="sc">+</span> unemp <span class="sc">+</span> <span class="fu">log</span>(income), </span>
<span id="cb256-28"><a href="#cb256-28" aria-hidden="true" tabindex="-1"></a>                       <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;state&quot;</span>, <span class="st">&quot;year&quot;</span>),</span>
<span id="cb256-29"><a href="#cb256-29" aria-hidden="true" tabindex="-1"></a>                       <span class="at">model =</span> <span class="st">&quot;within&quot;</span>,</span>
<span id="cb256-30"><a href="#cb256-30" aria-hidden="true" tabindex="-1"></a>                       <span class="at">effect =</span> <span class="st">&quot;twoways&quot;</span>,</span>
<span id="cb256-31"><a href="#cb256-31" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> Fatalities)</span>
<span id="cb256-32"><a href="#cb256-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-33"><a href="#cb256-33" aria-hidden="true" tabindex="-1"></a>fatalities_mod7 <span class="ot">&lt;-</span> <span class="fu">plm</span>(fatal_rate <span class="sc">~</span> beertax <span class="sc">+</span> state <span class="sc">+</span> year <span class="sc">+</span> drinkagec </span>
<span id="cb256-34"><a href="#cb256-34" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">+</span> punish <span class="sc">+</span> miles <span class="sc">+</span> unemp <span class="sc">+</span> <span class="fu">log</span>(income), </span>
<span id="cb256-35"><a href="#cb256-35" aria-hidden="true" tabindex="-1"></a>                       <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;state&quot;</span>, <span class="st">&quot;year&quot;</span>),</span>
<span id="cb256-36"><a href="#cb256-36" aria-hidden="true" tabindex="-1"></a>                       <span class="at">model =</span> <span class="st">&quot;within&quot;</span>,</span>
<span id="cb256-37"><a href="#cb256-37" aria-hidden="true" tabindex="-1"></a>                       <span class="at">effect =</span> <span class="st">&quot;twoways&quot;</span>,</span>
<span id="cb256-38"><a href="#cb256-38" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> Fatalities_1982_1988)</span></code></pre></div>
<p>We again use <tt>stargazer()</tt> <span class="citation">(<a href="#ref-R-stargazer" role="doc-biblioref">Hlavac 2022</a>)</span> to generate a comprehensive tabular presentation of the results.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a><span class="co"># gather clustered standard errors in a list</span></span>
<span id="cb257-4"><a href="#cb257-4" aria-hidden="true" tabindex="-1"></a>rob_se <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(fatalities_mod1, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb257-5"><a href="#cb257-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(fatalities_mod2, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb257-6"><a href="#cb257-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(fatalities_mod3, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb257-7"><a href="#cb257-7" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(fatalities_mod4, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb257-8"><a href="#cb257-8" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(fatalities_mod5, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb257-9"><a href="#cb257-9" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(fatalities_mod6, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb257-10"><a href="#cb257-10" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(fatalities_mod7, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))))</span>
<span id="cb257-11"><a href="#cb257-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-12"><a href="#cb257-12" aria-hidden="true" tabindex="-1"></a><span class="co"># generate the table</span></span>
<span id="cb257-13"><a href="#cb257-13" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(fatalities_mod1, fatalities_mod2, fatalities_mod3, </span>
<span id="cb257-14"><a href="#cb257-14" aria-hidden="true" tabindex="-1"></a>          fatalities_mod4, fatalities_mod5, fatalities_mod6, fatalities_mod7, </span>
<span id="cb257-15"><a href="#cb257-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb257-16"><a href="#cb257-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">header =</span> <span class="cn">FALSE</span>,</span>
<span id="cb257-17"><a href="#cb257-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>, </span>
<span id="cb257-18"><a href="#cb257-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">se =</span> rob_se,</span>
<span id="cb257-19"><a href="#cb257-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">&quot;Linear Panel Regression Models of Traffic Fatalities due to Drunk Driving&quot;</span>,</span>
<span id="cb257-20"><a href="#cb257-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">model.numbers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb257-21"><a href="#cb257-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">column.labels =</span> <span class="fu">c</span>(<span class="st">&quot;(1)&quot;</span>, <span class="st">&quot;(2)&quot;</span>, <span class="st">&quot;(3)&quot;</span>, <span class="st">&quot;(4)&quot;</span>, <span class="st">&quot;(5)&quot;</span>, <span class="st">&quot;(6)&quot;</span>, <span class="st">&quot;(7)&quot;</span>))</span></code></pre></div>



<table style="text-align:center"><tr><td colspan="8" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"></td><td colspan="7">Dependent Variable: Fatality Rate</td></tr>
<tr><td></td><td colspan="7" style="border-bottom: 1px solid black"></td></tr>
<tr><td style="text-align:left"></td><td colspan="7">fatal_rate</td></tr>
<tr><td style="text-align:left"></td><td><em>OLS</em></td><td colspan="6"><em>panel</em></td></tr>
<tr><td style="text-align:left"></td><td><em></em></td><td colspan="6"><em>linear</em></td></tr>
<tr><td style="text-align:left"></td><td>(1)</td><td>(2)</td><td>(3)</td><td>(4)</td><td>(5)</td><td>(6)</td><td>(7)</td></tr>
<tr><td colspan="8" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">beertax</td><td>0.365<sup>***</sup></td><td>-0.656<sup>**</sup></td><td>-0.640<sup>*</sup></td><td>-0.445</td><td>-0.690<sup>**</sup></td><td>-0.456</td><td>-0.926<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.053)</td><td>(0.289)</td><td>(0.350)</td><td>(0.291)</td><td>(0.345)</td><td>(0.301)</td><td>(0.337)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">drinkagec[18,19)</td><td></td><td></td><td></td><td>0.028</td><td>-0.010</td><td></td><td>0.037</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td>(0.068)</td><td>(0.081)</td><td></td><td>(0.101)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">drinkagec[19,20)</td><td></td><td></td><td></td><td>-0.018</td><td>-0.076</td><td></td><td>-0.065</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td>(0.049)</td><td>(0.066)</td><td></td><td>(0.097)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">drinkagec[20,21)</td><td></td><td></td><td></td><td>0.032</td><td>-0.100<sup>*</sup></td><td></td><td>-0.113</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td>(0.050)</td><td>(0.055)</td><td></td><td>(0.123)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">drinkage</td><td></td><td></td><td></td><td></td><td></td><td>-0.002</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td>(0.021)</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">punishyes</td><td></td><td></td><td></td><td>0.038</td><td>0.085</td><td>0.039</td><td>0.089</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td>(0.101)</td><td>(0.109)</td><td>(0.101)</td><td>(0.161)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">miles</td><td></td><td></td><td></td><td>0.00001</td><td>0.00002<sup>*</sup></td><td>0.00001</td><td>0.0001<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td>(0.00001)</td><td>(0.00001)</td><td>(0.00001)</td><td>(0.00005)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">unemp</td><td></td><td></td><td></td><td>-0.063<sup>***</sup></td><td></td><td>-0.063<sup>***</sup></td><td>-0.091<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td>(0.013)</td><td></td><td>(0.013)</td><td>(0.021)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">log(income)</td><td></td><td></td><td></td><td>1.816<sup>***</sup></td><td></td><td>1.786<sup>***</sup></td><td>0.996</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td>(0.624)</td><td></td><td>(0.631)</td><td>(0.666)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">Constant</td><td>1.853<sup>***</sup></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td>(0.047)</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td colspan="8" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">Observations</td><td>336</td><td>336</td><td>336</td><td>335</td><td>335</td><td>335</td><td>95</td></tr>
<tr><td style="text-align:left">R<sup>2</sup></td><td>0.093</td><td>0.041</td><td>0.036</td><td>0.360</td><td>0.066</td><td>0.357</td><td>0.659</td></tr>
<tr><td style="text-align:left">Adjusted R<sup>2</sup></td><td>0.091</td><td>-0.120</td><td>-0.149</td><td>0.217</td><td>-0.134</td><td>0.219</td><td>0.157</td></tr>
<tr><td style="text-align:left">Residual Std. Error</td><td>0.544 (df = 334)</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">F Statistic</td><td>34.394<sup>***</sup> (df = 1; 334)</td><td>12.190<sup>***</sup> (df = 1; 287)</td><td>10.513<sup>***</sup> (df = 1; 281)</td><td>19.194<sup>***</sup> (df = 8; 273)</td><td>3.252<sup>***</sup> (df = 6; 275)</td><td>25.423<sup>***</sup> (df = 6; 275)</td><td>9.194<sup>***</sup> (df = 8; 38)</td></tr>
<tr><td colspan="8" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"><em>Note:</em></td><td colspan="7" style="text-align:right"><sup>*</sup>p<0.1; <sup>**</sup>p<0.05; <sup>***</sup>p<0.01</td></tr>
</table>
<caption><p style='text-align:center'>(#tab:lprmotfdtdd) Linear Panel Regression Models of Traffic Fatalities due to Drunk Driving</p></caption>


<p>While columns (2) and (3) recap the results @ref(eq:efemod) and @ref(eq:cbnfemod), column (1) presents an estimate of the coefficient of interest in the naive OLS regression of the fatality rate on beer tax without any fixed effects. We obtain a <em>positive</em> estimate for the coefficient on beer tax that is likely to be upward biased. The model fit is rather bad, too (<span class="math inline">\(\bar{R}^2 = 0.091\)</span>). The sign of the estimate changes as we extend the model by both entity and time fixed effects in models (2) and (3). Furthermore <span class="math inline">\(\bar{R}^2\)</span> increases substantially as fixed effects are included in the model equation. Nonetheless, as discussed before, the magnitudes of both estimates may be too large.</p>
<p>The model specifications (4) to (7) include covariates that shall capture the effect of overall state economic conditions as well as the legal framework. Considering (4) as the baseline specification, we observe four interesting results:</p>
<ol style="list-style-type: decimal">
<li><p>Including the covariates does not lead to a major reduction of the estimated effect of the beer tax. The coefficient is not significantly different from zero at the level of <span class="math inline">\(5\%\)</span> as the estimate is rather imprecise.</p></li>
<li><p>The minimum legal drinking age <em>does not</em> have an effect on traffic fatalities: none of the three dummy variables are significantly different from zero at any common level of significance. Moreover, an <span class="math inline">\(F\)</span>-Test of the joint hypothesis that all three coefficients are zero does not reject. The next code chunk shows how to test this hypothesis.</p></li>
</ol>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test if legal drinking age has no explanatory power</span></span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(fatalities_mod4,</span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">test =</span> <span class="st">&quot;F&quot;</span>,</span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">&quot;drinkagec[18,19)=0&quot;</span>, <span class="st">&quot;drinkagec[19,20)=0&quot;</span>, <span class="st">&quot;drinkagec[20,21)&quot;</span>), </span>
<span id="cb258-5"><a href="#cb258-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb258-6"><a href="#cb258-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb258-7"><a href="#cb258-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb258-8"><a href="#cb258-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb258-9"><a href="#cb258-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; drinkagec[18,19) = 0</span></span>
<span id="cb258-10"><a href="#cb258-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; drinkagec[19,20) = 0</span></span>
<span id="cb258-11"><a href="#cb258-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; drinkagec[20,21) = 0</span></span>
<span id="cb258-12"><a href="#cb258-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb258-13"><a href="#cb258-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb258-14"><a href="#cb258-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: fatal_rate ~ beertax + state + year + drinkagec + punish + miles + </span></span>
<span id="cb258-15"><a href="#cb258-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     unemp + log(income)</span></span>
<span id="cb258-16"><a href="#cb258-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb258-17"><a href="#cb258-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb258-18"><a href="#cb258-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb258-19"><a href="#cb258-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F Pr(&gt;F)</span></span>
<span id="cb258-20"><a href="#cb258-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    276                 </span></span>
<span id="cb258-21"><a href="#cb258-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    273  3 0.3782 0.7688</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li><p>There is no evidence that punishment for first offenders has a deterring effects on drunk driving: the corresponding coefficient is not significant at the <span class="math inline">\(10\%\)</span> level.</p></li>
<li><p>The economic variables significantly explain traffic fatalities. We can check that the employment rate and per capita income are jointly significant at the level of <span class="math inline">\(0.1\%\)</span>.</p></li>
</ol>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test if economic indicators have no explanatory power</span></span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(fatalities_mod4, </span>
<span id="cb259-3"><a href="#cb259-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">test =</span> <span class="st">&quot;F&quot;</span>,</span>
<span id="cb259-4"><a href="#cb259-4" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">&quot;log(income)&quot;</span>, <span class="st">&quot;unemp&quot;</span>), </span>
<span id="cb259-5"><a href="#cb259-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb259-6"><a href="#cb259-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb259-7"><a href="#cb259-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb259-8"><a href="#cb259-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb259-9"><a href="#cb259-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; log(income) = 0</span></span>
<span id="cb259-10"><a href="#cb259-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unemp = 0</span></span>
<span id="cb259-11"><a href="#cb259-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb259-12"><a href="#cb259-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb259-13"><a href="#cb259-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: fatal_rate ~ beertax + state + year + drinkagec + punish + miles + </span></span>
<span id="cb259-14"><a href="#cb259-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     unemp + log(income)</span></span>
<span id="cb259-15"><a href="#cb259-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb259-16"><a href="#cb259-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb259-17"><a href="#cb259-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb259-18"><a href="#cb259-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F    Pr(&gt;F)    </span></span>
<span id="cb259-19"><a href="#cb259-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    275                        </span></span>
<span id="cb259-20"><a href="#cb259-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    273  2 31.577 4.609e-13 ***</span></span>
<span id="cb259-21"><a href="#cb259-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb259-22"><a href="#cb259-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Model (5) omits the economic factors. The result supports the notion that economic indicators should remain in the model as the coefficient on beer tax is sensitive to the inclusion of the latter.</p>
<p>Results for model (6) demonstrate that the legal drinking age has little explanatory power and that the coefficient of interest is not sensitive to changes in the functional form of the relation between drinking age and traffic fatalities.</p>
<p>Specification (7) reveals that reducing the amount of available information (we only use 95 observations for the period 1982 to 1988 here) inflates standard errors but does not lead to drastic changes in coefficient estimates.</p>
<div id="summary-2" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Summary<a href="#summary-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We have not found evidence that severe punishments and increasing the minimum drinking age reduce traffic fatalities due to drunk driving. Nonetheless, there seems to be a negative effect of alcohol taxes on traffic fatalities which, however, is estimated imprecisely and cannot be interpreted as the causal effect of interest as there still may be a bias. The issue is that there may be omitted variables that differ across states <em>and</em> change over time and this bias remains even though we use a panel approach that controls for entity specific and time invariant unobservables.</p>
<p>A powerful method that can be used if common panel regression approaches fail is instrumental variables regression. We will return to this concept in Chapter @ref(ivr).</p>
</div>
</div>
<div id="exercises-10" class="section level2 hasAnchor" number="10.7">
<h2 class="hasAnchor"><span class="header-section-number">10.7</span> Exercises<a href="#exercises-10" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For the course of this section, you will work with <tt>Guns</tt>, a balanced panel containing observations on criminal and demographic variables for all US states and the years 1977-1999. The dataset comes with the package <tt>AER</tt> which is already installed for the interactive R exercises below.</p>
<div id="the-guns-dataset" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">1. The Guns Dataset<a href="#the-guns-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Load both the <tt>AER</tt> package and the <tt>Guns</tt> dataset.</p></li>
<li><p>Get yourself an overview over the dataset using the <tt>summary()</tt> function. Use <tt>?Guns</tt> for detailed information on the variables.</p></li>
<li><p>Verify that <tt>Guns</tt> is a balanced panel: extract the number of years and states from the dataset and assign them to the predefined variables <tt>years</tt> and <tt>states</tt>, respectively. Afterwards use these variables for a logical comparison: check that the panel is balanced.</p></li>
</ul>
<iframe src="DCL/ex10_1.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li>Use <tt>library()</tt> and <tt>data()</tt> to attach the package and load the dataset, respectively.</li>
<li>Use <tt>summary()</tt> to obtain a comprehensive overview of the dataset.</li>
<li>Remember that in a balanced panel the number of entities times the number of years equals the total number of observations in the dataset. The basic functions <tt>levels()</tt>, <tt>length()</tt> and <tt>nrow()</tt> may be useful.</li>
</ul>
</div>
<div id="strict-or-loose-gun-laws-and-the-effect-on-crime-i" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">2. Strict or Loose? Gun Laws and the Effect on Crime I<a href="#strict-or-loose-gun-laws-and-the-effect-on-crime-i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There is a controversial debate whether and if to what extent the right to carry a gun influences crime. Proponents of so-called “Carrying a Concealed Weapon” (CCW) laws argue that the deterrent effect of guns prevents crime, whereas opponents argue that the public availability of guns increases their usage and thus makes it easier to commit crimes. In the following exercises you will empirically investigate this topic.
To begin with consider the following estimated model
<span class="math display">\[\widehat{{\log(violent_i)}} = 6.135 - 0.443 \times law_i,\]</span>
with <span class="math inline">\(i=1,\ldots,51\)</span> where <tt>violent</tt> is the violent crime rate (incidents per 100000 residents) and <tt>law</tt> is a binary variable indicating the implementation of a CCW law (1 = yes, 0 = no), respectively.</p>
<p>The estimated model is available as <tt>model</tt> in your working environment. The packages <tt>AER</tt> and <tt>plm</tt> have been loaded.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Extend and estimate the model by including state fixed effects using the function <tt>plm()</tt> and assign the model object to the predefined variable <tt>model_se</tt>. Can you think of an unobserved variable that is captured by this model specification?</li>
<li>Print a summary of the model which reports cluster robust standard errors.</li>
<li>Test whether the fixed state effects are jointly significant from zero. To do so use the function <tt>pFtest()</tt>. Use <tt>?pFtest</tt> for additional information.</li>
</ul>
<iframe src="DCL/ex10_2.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>The function <tt>plm()</tt> allows you to conduct regressions with panel data and works very similar to <tt>lm()</tt>. You have to specify the entity and time indicators inside as a vector using the argument <tt>index</tt> and specify the estimator to be used with the argument <tt>model</tt> (for the fixed effects estimator this is <tt>“within”</tt>).</p></li>
<li><p>As usual you can use <tt>coeftest()</tt> in conjunction with appropriate arguments to obtain a summary output with robust standard errors.</p></li>
<li><p><tt>pFtest()</tt> expects two model objects. The first model includes fixed effects, the second does not.</p></li>
</ul>
</div>
<div id="strict-or-loose-gun-laws-and-the-effect-on-crime-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">3. Strict or Loose? Gun Laws and the Effect on Crime II<a href="#strict-or-loose-gun-laws-and-the-effect-on-crime-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As touched upon at the end of the last exercise it is reasonable to also include time effects which is why we now consider the model
<span class="math display">\[\begin{align}\log(violent_i)  &amp; = \beta_1\times law_i + \alpha_i + \lambda_t + u_i,\end{align}\]</span>
for <span class="math inline">\(i=1,\ldots,51\)</span> and <span class="math inline">\(t=1977,\ldots,1999\)</span>.
The models <tt>model</tt> and <tt>model_se</tt> from the previous exercises are available in your working environment. The packages <tt>AER</tt> and <tt>plm</tt> have been attached.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Estimate the model above and assign it to the variable <tt>model_sete</tt> using <tt>plm()</tt>.</li>
<li>Print a summary of the model which reports robust standard errors.</li>
<li>Test whether both state and time fixed effects are jointly significant.</li>
</ul>
<iframe src="DCL/ex10_3.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li>To additionally incorparate time fixed effects, one can set the argument <tt>effect=“twoways”</tt> inside of <tt>plm()</tt>.</li>
<li>Note that we want to test whether the state <em>and</em> time fixed effects are jointly significant.</li>
</ul>
</div>
<div id="strict-or-loose-gun-laws-and-the-effect-on-crime-iii" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">4. Strict or Loose? Gun Laws and the Effect on Crime III<a href="#strict-or-loose-gun-laws-and-the-effect-on-crime-iii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Despite the evidence for state as well as time effects found in exercise 3, there still might be a bias due to omitted variables such as sociodemographic characteristics. The following model accounts for the latter:
<span class="math display">\[\begin{align}\log(violent_i)  &amp; = \beta_1\times law_i + \beta_2\times density_i + \beta_3\times income_i + \beta_4\times population_i \\&amp;\quad + \beta_5\times afam_i + \beta_6\times cauc_i + \beta_7\times male_i + \alpha_i + \lambda_t + u_i.\end{align}\]</span>
See <tt>?Guns</tt> for detailed information on the additional variables.</p>
<p>The packages <tt>AER</tt> and <tt>plm</tt> have been loaded.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Estimate the extended model and assign it to the predefined variable <tt>model_sete_ext</tt>.</li>
<li>Print a robust summary of the estimated model. What can you say about the effect of a CCW law?</li>
</ul>
<iframe src="DCL/ex10_4.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="fixed-effects-regression---two-time-periods" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">5. Fixed Effects Regression - Two Time Periods<a href="#fixed-effects-regression---two-time-periods" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Recall the fixed effects model from Exercise 10.2, but now assume that you only have observations for the years 1978 and 1984. Consider the two model specifications
<span class="math display">\[\begin{align}
\log(violent_{i1984}) - \log(violent_{i1978}) = \beta_{BA}\times(law_{i1984}-law_{i1978}) + (u_{i1984} - u_{i1978})
\end{align}\]</span>
and
<span class="math display">\[\begin{align}
\log(violent_{it}) = \beta_{FE}\times law_{it} + \alpha_i + u_{it},\\
\end{align}\]</span>
with <span class="math inline">\(i=1,\ldots,51\)</span> and <span class="math inline">\(t=1978,1984\)</span>.
In this exercise you need to show that <span class="math inline">\(\widehat{\beta}_{BA}=\widehat{\beta}_{FE}\)</span>.
The subsets of <tt>Guns</tt> for the years 1978 and 1984 are already available as <tt>Guns78</tt> and <tt>Guns84</tt> in your working environment. The packages <tt>AER</tt> and <tt>plm</tt> have been loaded.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Compute the differences necessary to estimate the first model and assign them to the variables <tt>diff_logv</tt> and <tt>diff_law</tt>.</li>
<li>Estimate both models. Use the differenced data to estimate the first model and <tt>plm()</tt> for the second.</li>
<li>Verify with a logical comparison that both procedures numerically yield the same estimate. Use the variables <tt>coef_diff</tt> and <tt>coef_plm</tt> which contain the relevant coefficients rounded to the fourth decimal place.</li>
</ul>
<iframe src="DCL/ex10_5.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li>Keep in mind that the dependend variable is log-transformed.</li>
<li>You may use <tt>plm()</tt> as in the previous exercises. Note that you only need a subset of the original <tt>Guns</tt> dataset. Theargument <tt>subset</tt> allows to subset the dataset passed to the argument <tt>data</tt>. Alternatively, you can join the two datasets <tt>Guns78</tt> and <tt>Guns84</tt>using, e.g., <tt>rbind()</tt>.</li>
<li>Use the logical operator <tt>==</tt> to compare both estimates.</li>
</ul>
</div>
<!--chapter:end:10-ch10.Rmd-->
</div>
</div>
<div id="rwabdv" class="section level1 hasAnchor" number="11">
<h1 class="hasAnchor"><span class="header-section-number">11</span> Regression with a Binary Dependent Variable<a href="#rwabdv" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter, we discusses a special class of regression models that aim to explain a limited dependent variable. In particular, we consider models where the dependent variable is binary. We will see that in such models, the regression function can be interpreted as a conditional probability function of the binary dependent variable.</p>
<p>We review the following concepts:</p>
<ul>
<li>the linear probability model</li>
<li>the Probit model</li>
<li>the Logit model</li>
<li>maximum likelihood estimation of nonlinear regression models</li>
</ul>
<p>Of course, we will also see how to estimate above models using <tt>R</tt> and discuss an application where we examine the question whether there is racial discrimination in the U.S. mortgage market.</p>
<p>The following packages and their dependencies are needed for reproduction of the code chunks presented throughout this chapter on your computer:</p>
<ul>
<li><tt>AER</tt> <span class="citation">(<a href="#ref-R-AER" role="doc-biblioref">Christian Kleiber and Zeileis 2022</a>)</span></li>
<li><tt>stargazer</tt> <span class="citation">(<a href="#ref-R-stargazer" role="doc-biblioref">Hlavac 2022</a>)</span></li>
</ul>
<p>Check whether the following code chunk runs without any errors.</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span></code></pre></div>
<div id="binary-dependent-variables-and-the-linear-probability-model" class="section level2 hasAnchor" number="11.1">
<h2 class="hasAnchor"><span class="header-section-number">11.1</span> Binary Dependent Variables and the Linear Probability Model<a href="#binary-dependent-variables-and-the-linear-probability-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="KC11.1" class="keyconcept">
<h3 class="right">
Key Concept 11.1
</h3>
<h3 class="left">
The Linear Probability Model
</h3>
<p>The linear regression model</p>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + \dots + \beta_k X_{ki} + u_i\]</span>
with a binary dependent variable <span class="math inline">\(Y_i\)</span> is called the linear probability model. In the linear probability model we have <span class="math display">\[E(Y\vert X_1,X_2,\dots,X_k) = P(Y=1\vert X_1, X_2,\dots, X_3)\]</span> where <span class="math display">\[ P(Y = 1 \vert X_1, X_2, \dots, X_k) = \beta_0 + \beta_1 + X_{1i} + \beta_2 X_{2i} + \dots + \beta_k X_{ki}.\]</span></p>
<p>Thus, <span class="math inline">\(\beta_j\)</span> can be interpreted as the change in the probability that <span class="math inline">\(Y_i=1\)</span>, holding constant the other <span class="math inline">\(k-1\)</span> regressors. Just as in common multiple regression, the <span class="math inline">\(\beta_j\)</span> can be estimated using OLS and the robust standard error formulas can be used for hypothesis testing and computation of confidence intervals.</p>
<p>In most linear probability models, <span class="math inline">\(R^2\)</span> has no meaningful interpretation since the regression line can never fit the data perfectly if the dependent variable is binary and the regressors are continuous. This can be seen in the application below.</p>
<p>It is <em>essential</em> to use robust standard errors since the <span class="math inline">\(u_i\)</span> in a linear probability model are always heteroskedastic.</p>
<p>Linear probability models are easily estimated in <tt>R</tt> using the function <tt>lm()</tt>.</p>
</div>
<div id="mortgage-data" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Mortgage Data<a href="#mortgage-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Following the book, we start by loading the data set <tt>HMDA</tt> which provides data that relate to mortgage applications filed in Boston in the year of 1990.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load `AER` package and attach the HMDA data</span></span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(HMDA)</span></code></pre></div>
<p>We continue by inspecting the first few observations and compute summary statistics afterwards.</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect the data</span></span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(HMDA)</span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   deny pirat hirat     lvrat chist mhist phist unemp selfemp insurance condomin</span></span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   no 0.221 0.221 0.8000000     5     2    no   3.9      no        no       no</span></span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   no 0.265 0.265 0.9218750     2     2    no   3.2      no        no       no</span></span>
<span id="cb262-6"><a href="#cb262-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3   no 0.372 0.248 0.9203980     1     2    no   3.2      no        no       no</span></span>
<span id="cb262-7"><a href="#cb262-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   no 0.320 0.250 0.8604651     1     2    no   4.3      no        no       no</span></span>
<span id="cb262-8"><a href="#cb262-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   no 0.360 0.350 0.6000000     1     1    no   3.2      no        no       no</span></span>
<span id="cb262-9"><a href="#cb262-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6   no 0.240 0.170 0.5105263     1     1    no   3.9      no        no       no</span></span>
<span id="cb262-10"><a href="#cb262-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   afam single hschool</span></span>
<span id="cb262-11"><a href="#cb262-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   no     no     yes</span></span>
<span id="cb262-12"><a href="#cb262-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   no    yes     yes</span></span>
<span id="cb262-13"><a href="#cb262-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3   no     no     yes</span></span>
<span id="cb262-14"><a href="#cb262-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   no     no     yes</span></span>
<span id="cb262-15"><a href="#cb262-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   no     no     yes</span></span>
<span id="cb262-16"><a href="#cb262-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6   no     no     yes</span></span>
<span id="cb262-17"><a href="#cb262-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(HMDA)</span>
<span id="cb262-18"><a href="#cb262-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   deny          pirat            hirat            lvrat        chist   </span></span>
<span id="cb262-19"><a href="#cb262-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  no :2095   Min.   :0.0000   Min.   :0.0000   Min.   :0.0200   1:1353  </span></span>
<span id="cb262-20"><a href="#cb262-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  yes: 285   1st Qu.:0.2800   1st Qu.:0.2140   1st Qu.:0.6527   2: 441  </span></span>
<span id="cb262-21"><a href="#cb262-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Median :0.3300   Median :0.2600   Median :0.7795   3: 126  </span></span>
<span id="cb262-22"><a href="#cb262-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Mean   :0.3308   Mean   :0.2553   Mean   :0.7378   4:  77  </span></span>
<span id="cb262-23"><a href="#cb262-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             3rd Qu.:0.3700   3rd Qu.:0.2988   3rd Qu.:0.8685   5: 182  </span></span>
<span id="cb262-24"><a href="#cb262-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Max.   :3.0000   Max.   :3.0000   Max.   :1.9500   6: 201  </span></span>
<span id="cb262-25"><a href="#cb262-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  mhist    phist          unemp        selfemp    insurance  condomin  </span></span>
<span id="cb262-26"><a href="#cb262-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1: 747   no :2205   Min.   : 1.800   no :2103   no :2332   no :1694  </span></span>
<span id="cb262-27"><a href="#cb262-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2:1571   yes: 175   1st Qu.: 3.100   yes: 277   yes:  48   yes: 686  </span></span>
<span id="cb262-28"><a href="#cb262-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3:  41              Median : 3.200                                   </span></span>
<span id="cb262-29"><a href="#cb262-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4:  21              Mean   : 3.774                                   </span></span>
<span id="cb262-30"><a href="#cb262-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      3rd Qu.: 3.900                                   </span></span>
<span id="cb262-31"><a href="#cb262-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      Max.   :10.600                                   </span></span>
<span id="cb262-32"><a href="#cb262-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   afam      single     hschool   </span></span>
<span id="cb262-33"><a href="#cb262-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  no :2041   no :1444   no :  39  </span></span>
<span id="cb262-34"><a href="#cb262-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  yes: 339   yes: 936   yes:2341  </span></span>
<span id="cb262-35"><a href="#cb262-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                  </span></span>
<span id="cb262-36"><a href="#cb262-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                  </span></span>
<span id="cb262-37"><a href="#cb262-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                  </span></span>
<span id="cb262-38"><a href="#cb262-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span></code></pre></div>
<p>The variable we are interested in modelling is <tt>deny</tt>, an indicator for whether an applicant’s mortgage application has been accepted (<tt>deny = no</tt>) or denied (<tt>deny = yes</tt>). A regressor that ought to have power in explaining whether a mortgage application has been denied is <tt>pirat</tt>, the size of the anticipated total monthly loan payments relative to the the applicant’s income. It is straightforward to translate this into the simple regression model</p>
<p><span class="math display">\[\begin{align}
  deny = \beta_0 + \beta_1 \times P/I\ ratio + u. (\#eq:denymod1)
\end{align}\]</span></p>
<p>We estimate this model just as any other linear regression model using <tt>lm()</tt>. Before we do so, the variable <tt>deny</tt> must be converted to a numeric variable using <tt>as.numeric()</tt> as <tt>lm()</tt> does not accept the <em>dependent variable</em> to be of class <tt>factor</tt>. Note that <code>as.numeric(HMDA$deny)</code> will turn <tt>deny = no</tt> into <tt>deny = 1</tt> and <tt>deny = yes</tt> into <tt>deny = 2</tt>, so using <tt>as.numeric(HMDA$deny)-1</tt> we obtain the values <tt>0</tt> and <tt>1</tt>.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert &#39;deny&#39; to numeric</span></span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>HMDA<span class="sc">$</span>deny <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(HMDA<span class="sc">$</span>deny) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate a simple linear probabilty model</span></span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a>denymod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(deny <span class="sc">~</span> pirat, <span class="at">data =</span> HMDA)</span>
<span id="cb263-6"><a href="#cb263-6" aria-hidden="true" tabindex="-1"></a>denymod1</span>
<span id="cb263-7"><a href="#cb263-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb263-8"><a href="#cb263-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb263-9"><a href="#cb263-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = deny ~ pirat, data = HMDA)</span></span>
<span id="cb263-10"><a href="#cb263-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb263-11"><a href="#cb263-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb263-12"><a href="#cb263-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)        pirat  </span></span>
<span id="cb263-13"><a href="#cb263-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    -0.07991      0.60353</span></span></code></pre></div>
<p>Next, we plot the data and the regression line to reproduce Figure 11.1 of the book.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the data</span></span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> HMDA<span class="sc">$</span>pirat, </span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> HMDA<span class="sc">$</span>deny,</span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Scatterplot Mortgage Application Denial and the Payment-to-Income Ratio&quot;</span>,</span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;P/I ratio&quot;</span>,</span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Deny&quot;</span>,</span>
<span id="cb264-7"><a href="#cb264-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb264-8"><a href="#cb264-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>, <span class="fl">1.4</span>),</span>
<span id="cb264-9"><a href="#cb264-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.main =</span> <span class="fl">0.8</span>)</span>
<span id="cb264-10"><a href="#cb264-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-11"><a href="#cb264-11" aria-hidden="true" tabindex="-1"></a><span class="co"># add horizontal dashed lines and text</span></span>
<span id="cb264-12"><a href="#cb264-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb264-13"><a href="#cb264-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb264-14"><a href="#cb264-14" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">2.5</span>, <span class="fl">0.9</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="st">&quot;Mortgage denied&quot;</span>)</span>
<span id="cb264-15"><a href="#cb264-15" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">2.5</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">cex=</span> <span class="fl">0.8</span>, <span class="st">&quot;Mortgage approved&quot;</span>)</span>
<span id="cb264-16"><a href="#cb264-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-17"><a href="#cb264-17" aria-hidden="true" tabindex="-1"></a><span class="co"># add the estimated regression line</span></span>
<span id="cb264-18"><a href="#cb264-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(denymod1, </span>
<span id="cb264-19"><a href="#cb264-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fl">1.8</span>, </span>
<span id="cb264-20"><a href="#cb264-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-452-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>According to the estimated model, a payment-to-income ratio of <span class="math inline">\(1\)</span> is associated with an expected probability of mortgage application denial of roughly <span class="math inline">\(50\%\)</span>. The model indicates that there is a positive relation between the payment-to-income ratio and the probability of a denied mortgage application so individuals with a high ratio of loan payments to income are more likely to be rejected.</p>
<p>We may use <tt>coeftest()</tt> to obtain robust standard errors for both coefficient estimates.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print robust coefficient summary</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(denymod1, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb265-5"><a href="#cb265-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb265-6"><a href="#cb265-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb265-7"><a href="#cb265-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.079910   0.031967 -2.4998   0.01249 *  </span></span>
<span id="cb265-8"><a href="#cb265-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pirat        0.603535   0.098483  6.1283 1.036e-09 ***</span></span>
<span id="cb265-9"><a href="#cb265-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb265-10"><a href="#cb265-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The estimated regression line is
<span class="math display">\[\begin{align}
\widehat{deny} = -\underset{(0.032)}{0.080} + \underset{(0.098)}{0.604} P/I \ ratio. (\#eq:lpm)
\end{align}\]</span>
The true coefficient on <span class="math inline">\(P/I \ ratio\)</span> is statistically different from <span class="math inline">\(0\)</span> at the <span class="math inline">\(1\%\)</span> level. Its estimate can be interpreted as follows: a 1 percentage point increase in <span class="math inline">\(P/I \ ratio\)</span> leads to an increase in the probability of a loan denial by <span class="math inline">\(0.604 \cdot 0.01 = 0.00604 \approx 0.6\%\)</span>.</p>
<p>Following the book we augment the simple model @ref(eq:denymod1) by an additional regressor <span class="math inline">\(black\)</span> which equals <span class="math inline">\(1\)</span> if the applicant is an African American and equals <span class="math inline">\(0\)</span> otherwise. Such a specification is the baseline for investigating if there is racial discrimination in the mortgage market: if being black has a significant (positive) influence on the probability of a loan denial when we control for factors that allow for an objective assessment of an applicants credit worthiness, this is an indicator for discrimination.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the variable &#39;afam&#39; for consistency</span></span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(HMDA)[<span class="fu">colnames</span>(HMDA) <span class="sc">==</span> <span class="st">&quot;afam&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model</span></span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true" tabindex="-1"></a>denymod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(deny <span class="sc">~</span> pirat <span class="sc">+</span> black, <span class="at">data =</span> HMDA)</span>
<span id="cb266-6"><a href="#cb266-6" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(denymod2, <span class="at">vcov. =</span> vcovHC)</span>
<span id="cb266-7"><a href="#cb266-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb266-8"><a href="#cb266-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb266-9"><a href="#cb266-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb266-10"><a href="#cb266-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb266-11"><a href="#cb266-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.090514   0.033430 -2.7076  0.006826 ** </span></span>
<span id="cb266-12"><a href="#cb266-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pirat        0.559195   0.103671  5.3939 7.575e-08 ***</span></span>
<span id="cb266-13"><a href="#cb266-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; blackyes     0.177428   0.025055  7.0815 1.871e-12 ***</span></span>
<span id="cb266-14"><a href="#cb266-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb266-15"><a href="#cb266-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The estimated regression function is
<span class="math display">\[\begin{align}
  \widehat{deny} =&amp; \, -\underset{(0.029)}{0.091} + \underset{(0.089)}{0.559} P/I \ ratio + \underset{(0.025)}{0.177} black. (\#eq:denymod2)
\end{align}\]</span></p>
<p>The coefficient on <span class="math inline">\(black\)</span> is positive and significantly different from zero at the <span class="math inline">\(0.01\%\)</span> level. The interpretation is that, holding constant the <span class="math inline">\(P/I \ ratio\)</span>, being black increases the probability of a mortgage application denial by about <span class="math inline">\(17.7\%\)</span>. This finding is compatible with racial discrimination. However, it might be distorted by omitted variable bias so discrimination could be a premature conclusion.</p>
</div>
</div>
<div id="palr" class="section level2 hasAnchor" number="11.2">
<h2 class="hasAnchor"><span class="header-section-number">11.2</span> Probit and Logit Regression<a href="#palr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The linear probability model has a major flaw: it assumes the conditional probability function to be linear. This does not restrict <span class="math inline">\(P(Y=1\vert X_1,\dots,X_k)\)</span> to lie between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>. We can easily see this in our reproduction of Figure 11.1 of the book: for <span class="math inline">\(P/I \ ratio \geq 1.75\)</span>, @ref(eq:lpm) predicts the probability of a mortgage application denial to be bigger than <span class="math inline">\(1\)</span>. For applications with <span class="math inline">\(P/I \ ratio\)</span> close to <span class="math inline">\(0\)</span>, the predicted probability of denial is even negative so that the model has no meaningful interpretation here.</p>
<p>This circumstance calls for an approach that uses a nonlinear function to model the conditional probability function of a binary dependent variable. Commonly used methods are Probit and Logit regression.</p>
<div id="probit-regression" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Probit Regression<a href="#probit-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In Probit regression, the cumulative standard normal distribution function <span class="math inline">\(\Phi(\cdot)\)</span> is used to model the regression function when the dependent variable is binary, that is, we assume
<span class="math display">\[\begin{align}
  E(Y\vert X) = P(Y=1\vert X) = \Phi(\beta_0 + \beta_1 X). (\#eq:probitmodel)
\end{align}\]</span></p>
<p><span class="math inline">\(\beta_0 + \beta_1 X\)</span> in @ref(eq:probitmodel) plays the role of a quantile <span class="math inline">\(z\)</span>. Remember that <span class="math display">\[\Phi(z) = P(Z \leq z) \ , \ Z \sim \mathcal{N}(0,1)\]</span> such that the Probit coefficient <span class="math inline">\(\beta_1\)</span> in @ref(eq:probitmodel) is the change in <span class="math inline">\(z\)</span> associated with a one unit change in <span class="math inline">\(X\)</span>. Although the effect on <span class="math inline">\(z\)</span> of a change in <span class="math inline">\(X\)</span> is linear, the link between <span class="math inline">\(z\)</span> and the dependent variable <span class="math inline">\(Y\)</span> is nonlinear since <span class="math inline">\(\Phi\)</span> is a nonlinear function of <span class="math inline">\(X\)</span>.</p>
<p>Since the dependent variable is a nonlinear function of the regressors, the coefficient on <span class="math inline">\(X\)</span> has no simple interpretation. According to Key Concept 8.1, the expected change in the probability that <span class="math inline">\(Y=1\)</span> due to a change in <span class="math inline">\(P/I \ ratio\)</span> can be computed as follows:</p>
<ol style="list-style-type: decimal">
<li>Compute the predicted probability that <span class="math inline">\(Y=1\)</span> for the original value of <span class="math inline">\(X\)</span>.</li>
<li>Compute the predicted probability that <span class="math inline">\(Y=1\)</span> for <span class="math inline">\(X + \Delta X\)</span>.</li>
<li>Compute the difference between both predicted probabilities.</li>
</ol>
<p>Of course we can generalize @ref(eq:probitmodel) to Probit regression with multiple regressors to mitigate the risk of facing omitted variable bias. Probit regression essentials are summarized in Key Concept 11.2.</p>
<div id="KC11.2" class="keyconcept">
<h3 class="right">
Key Concept 11.2
</h3>
<h3 class="left">
Probit Model, Predicted Probabilities and Estimated Effects
</h3>
<p>Assume that <span class="math inline">\(Y\)</span> is a binary variable. The model</p>
<p><span class="math display">\[ Y= \beta_0 + \beta_1 + X_1 + \beta_2 X_2 + \dots + \beta_k X_k + u \]</span>
with
<span class="math display">\[P(Y = 1 \vert X_1, X_2, \dots ,X_k) = \Phi(\beta_0 + \beta_1 + X_1 + \beta_2 X_2 + \dots + \beta_k X_k)\]</span>
is the population Probit model with multiple regressors <span class="math inline">\(X_1, X_2, \dots, X_k\)</span> and <span class="math inline">\(\Phi(\cdot)\)</span> is the cumulative standard normal distribution function.</p>
<p>The predicted probability that <span class="math inline">\(Y=1\)</span> given <span class="math inline">\(X_1, X_2, \dots, X_k\)</span> can be calculated in two steps:</p>
<ol style="list-style-type: decimal">
<li><p>Compute <span class="math inline">\(z = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \dots + \beta_k X_k\)</span></p></li>
<li><p>Look up <span class="math inline">\(\Phi(z)\)</span> by calling <tt>pnorm()</tt>.</p></li>
</ol>
<p><span class="math inline">\(\beta_j\)</span> is the effect on <span class="math inline">\(z\)</span> of a one unit change in regressor <span class="math inline">\(X_j\)</span>, holding constant all other <span class="math inline">\(k-1\)</span> regressors.</p>
<p>The effect on the predicted probability of a change in a regressor can be computed as in Key Concept 8.1.</p>
<p>In <tt>R</tt>, Probit models can be estimated using the function <tt>glm()</tt> from the package <tt>stats</tt>. Using the argument <tt>family</tt> we specify that we want to use a Probit link function.</p>
</div>
<p>We now estimate a simple Probit model of the probability of a mortgage denial.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the simple probit model</span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>denyprobit <span class="ot">&lt;-</span> <span class="fu">glm</span>(deny <span class="sc">~</span> pirat, </span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;probit&quot;</span>), </span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> HMDA)</span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-6"><a href="#cb267-6" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(denyprobit, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb267-7"><a href="#cb267-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb267-8"><a href="#cb267-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; z test of coefficients:</span></span>
<span id="cb267-9"><a href="#cb267-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb267-10"><a href="#cb267-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error  z value  Pr(&gt;|z|)    </span></span>
<span id="cb267-11"><a href="#cb267-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -2.19415    0.18901 -11.6087 &lt; 2.2e-16 ***</span></span>
<span id="cb267-12"><a href="#cb267-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pirat        2.96787    0.53698   5.5269 3.259e-08 ***</span></span>
<span id="cb267-13"><a href="#cb267-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb267-14"><a href="#cb267-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The estimated model is</p>
<p><span class="math display">\[\begin{align}
  \widehat{P(deny\vert P/I \ ratio}) = \Phi(-\underset{(0.19)}{2.19} + \underset{(0.54)}{2.97} P/I \ ratio). (\#eq:denyprobit)
\end{align}\]</span></p>
<p>Just as in the linear probability model we find that the relation between the probability of denial and the payments-to-income ratio is positive and that the corresponding coefficient is highly significant.</p>
<p>The following code chunk reproduces Figure 11.2 of the book.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> HMDA<span class="sc">$</span>pirat, </span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> HMDA<span class="sc">$</span>deny,</span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Probit Model of the Probability of Denial, Given P/I Ratio&quot;</span>,</span>
<span id="cb268-5"><a href="#cb268-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;P/I ratio&quot;</span>,</span>
<span id="cb268-6"><a href="#cb268-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Deny&quot;</span>,</span>
<span id="cb268-7"><a href="#cb268-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb268-8"><a href="#cb268-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>, <span class="fl">1.4</span>),</span>
<span id="cb268-9"><a href="#cb268-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.main =</span> <span class="fl">0.85</span>)</span>
<span id="cb268-10"><a href="#cb268-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-11"><a href="#cb268-11" aria-hidden="true" tabindex="-1"></a><span class="co"># add horizontal dashed lines and text</span></span>
<span id="cb268-12"><a href="#cb268-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb268-13"><a href="#cb268-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb268-14"><a href="#cb268-14" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">2.5</span>, <span class="fl">0.9</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="st">&quot;Mortgage denied&quot;</span>)</span>
<span id="cb268-15"><a href="#cb268-15" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">2.5</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">cex=</span> <span class="fl">0.8</span>, <span class="st">&quot;Mortgage approved&quot;</span>)</span>
<span id="cb268-16"><a href="#cb268-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-17"><a href="#cb268-17" aria-hidden="true" tabindex="-1"></a><span class="co"># add estimated regression line</span></span>
<span id="cb268-18"><a href="#cb268-18" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="fl">0.01</span>)</span>
<span id="cb268-19"><a href="#cb268-19" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">predict</span>(denyprobit, <span class="fu">list</span>(<span class="at">pirat =</span> x), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb268-20"><a href="#cb268-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-21"><a href="#cb268-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y, <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-458-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The estimated regression function has a stretched “S”-shape which is typical for the CDF of a continuous random variable with symmetric PDF like that of a normal random variable. The function is clearly nonlinear and flattens out for large and small values of <span class="math inline">\(P/I \ ratio\)</span>. The functional form thus also ensures that the predicted conditional probabilities of a denial lie between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>.</p>
<p>We use <tt>predict()</tt> to compute the predicted change in the denial probability when <span class="math inline">\(P/I \ ratio\)</span> is increased from <span class="math inline">\(0.3\)</span> to <span class="math inline">\(0.4\)</span>.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. compute predictions for P/I ratio = 0.3, 0.4</span></span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(denyprobit, </span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="st">&quot;pirat&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.4</span>)),</span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-6"><a href="#cb269-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Compute difference in probabilities</span></span>
<span id="cb269-7"><a href="#cb269-7" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(predictions)</span>
<span id="cb269-8"><a href="#cb269-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          2 </span></span>
<span id="cb269-9"><a href="#cb269-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.06081433</span></span></code></pre></div>
<p>We find that an increase in the payment-to-income ratio from <span class="math inline">\(0.3\)</span> to <span class="math inline">\(0.4\)</span> is predicted to increase the probability of denial by approximately <span class="math inline">\(6.1\%\)</span>.</p>
<p>We continue by using an augmented Probit model to estimate the effect of race on the probability of a mortgage application denial.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a>denyprobit2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(deny <span class="sc">~</span> pirat <span class="sc">+</span> black, </span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;probit&quot;</span>), </span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> HMDA)</span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(denyprobit2, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb270-7"><a href="#cb270-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; z test of coefficients:</span></span>
<span id="cb270-8"><a href="#cb270-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb270-9"><a href="#cb270-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error  z value  Pr(&gt;|z|)    </span></span>
<span id="cb270-10"><a href="#cb270-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -2.258787   0.176608 -12.7898 &lt; 2.2e-16 ***</span></span>
<span id="cb270-11"><a href="#cb270-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pirat        2.741779   0.497673   5.5092 3.605e-08 ***</span></span>
<span id="cb270-12"><a href="#cb270-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; blackyes     0.708155   0.083091   8.5227 &lt; 2.2e-16 ***</span></span>
<span id="cb270-13"><a href="#cb270-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb270-14"><a href="#cb270-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The estimated model equation is</p>
<p><span class="math display">\[\begin{align}
  \widehat{P(deny\vert P/I \ ratio, black)} = \Phi (-\underset{(0.18)}{2.26} + \underset{(0.50)}{2.74} P/I \ ratio + \underset{(0.08)}{0.71} black). (\#eq:denyprobit2)
\end{align}\]</span></p>
<p>While all coefficients are highly significant, both the estimated coefficients on the payments-to-income ratio and the indicator for African American descent are positive. Again, the coefficients are difficult to interpret but they indicate that, first, African Americans have a higher probability of denial than white applicants, holding constant the payments-to-income ratio and second, applicants with a high payments-to-income ratio face a higher risk of being rejected.</p>
<p>How big is the estimated difference in denial probabilities between two hypothetical applicants with the same payments-to-income ratio? As before, we may use <tt>predict()</tt> to compute this difference.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. compute predictions for P/I ratio = 0.3</span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(denyprobit2, </span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="st">&quot;black&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>), </span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">&quot;pirat&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>)),</span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb271-6"><a href="#cb271-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-7"><a href="#cb271-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. compute difference in probabilities</span></span>
<span id="cb271-8"><a href="#cb271-8" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(predictions)</span>
<span id="cb271-9"><a href="#cb271-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         2 </span></span>
<span id="cb271-10"><a href="#cb271-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.1578117</span></span></code></pre></div>
<p>In this case, the estimated difference in denial probabilities is about <span class="math inline">\(15.8\%\)</span>.</p>
</div>
<div id="logit-regression" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Logit Regression<a href="#logit-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Key Concept 11.3 summarizes the Logit regression function.</p>
<div id="KC11.3" class="keyconcept">
<h3 class="right">
Key Concept 11.3
</h3>
<h3 class="left">
Logit Regression
</h3>
<p>The population Logit regression function is</p>
<p><span class="math display">\[\begin{align*}
  P(Y=1\vert X_1, X_2, \dots, X_k) =&amp; \, F(\beta_0 + \beta_1 X_1 + \beta_2 X_2 + \dots + \beta_k X_k) \\
  =&amp; \, \frac{1}{1+e^{-(\beta_0 + \beta_1 X_1 + \beta_2 X_2 + \dots + \beta_k X_k)}}.
\end{align*}\]</span></p>
<p>The idea is similar to Probit regression except that a different CDF is used: <span class="math display">\[F(x) = \frac{1}{1+e^{-x}}\]</span> is the CDF of a standard logistically distributed random variable.</p>
</div>
<p>As for Probit regression, there is no simple interpretation of the model coefficients and it is best to consider predicted probabilities or differences in predicted probabilities. Here again, <span class="math inline">\(t\)</span>-statistics and confidence intervals based on large sample normal approximations can be computed as usual.</p>
<p>It is fairly easy to estimate a Logit regression model using <tt>R</tt>.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>denylogit <span class="ot">&lt;-</span> <span class="fu">glm</span>(deny <span class="sc">~</span> pirat, </span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>), </span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> HMDA)</span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-5"><a href="#cb272-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(denylogit, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb272-6"><a href="#cb272-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb272-7"><a href="#cb272-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; z test of coefficients:</span></span>
<span id="cb272-8"><a href="#cb272-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb272-9"><a href="#cb272-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error  z value  Pr(&gt;|z|)    </span></span>
<span id="cb272-10"><a href="#cb272-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -4.02843    0.35898 -11.2218 &lt; 2.2e-16 ***</span></span>
<span id="cb272-11"><a href="#cb272-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pirat        5.88450    1.00015   5.8836 4.014e-09 ***</span></span>
<span id="cb272-12"><a href="#cb272-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb272-13"><a href="#cb272-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The subsequent code chunk reproduces Figure 11.3 of the book.</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> HMDA<span class="sc">$</span>pirat, </span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> HMDA<span class="sc">$</span>deny,</span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Probit and Logit Models Model of the Probability of Denial, Given P/I Ratio&quot;</span>,</span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;P/I ratio&quot;</span>,</span>
<span id="cb273-6"><a href="#cb273-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Deny&quot;</span>,</span>
<span id="cb273-7"><a href="#cb273-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb273-8"><a href="#cb273-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>, <span class="fl">1.4</span>),</span>
<span id="cb273-9"><a href="#cb273-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.main =</span> <span class="fl">0.9</span>)</span>
<span id="cb273-10"><a href="#cb273-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-11"><a href="#cb273-11" aria-hidden="true" tabindex="-1"></a><span class="co"># add horizontal dashed lines and text</span></span>
<span id="cb273-12"><a href="#cb273-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb273-13"><a href="#cb273-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb273-14"><a href="#cb273-14" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">2.5</span>, <span class="fl">0.9</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="st">&quot;Mortgage denied&quot;</span>)</span>
<span id="cb273-15"><a href="#cb273-15" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">2.5</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">cex=</span> <span class="fl">0.8</span>, <span class="st">&quot;Mortgage approved&quot;</span>)</span>
<span id="cb273-16"><a href="#cb273-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-17"><a href="#cb273-17" aria-hidden="true" tabindex="-1"></a><span class="co"># add estimated regression line of Probit and Logit models</span></span>
<span id="cb273-18"><a href="#cb273-18" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="fl">0.01</span>)</span>
<span id="cb273-19"><a href="#cb273-19" aria-hidden="true" tabindex="-1"></a>y_probit <span class="ot">&lt;-</span> <span class="fu">predict</span>(denyprobit, <span class="fu">list</span>(<span class="at">pirat =</span> x), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb273-20"><a href="#cb273-20" aria-hidden="true" tabindex="-1"></a>y_logit <span class="ot">&lt;-</span> <span class="fu">predict</span>(denylogit, <span class="fu">list</span>(<span class="at">pirat =</span> x), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb273-21"><a href="#cb273-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-22"><a href="#cb273-22" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y_probit, <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>)</span>
<span id="cb273-23"><a href="#cb273-23" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y_logit, <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb273-24"><a href="#cb273-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-25"><a href="#cb273-25" aria-hidden="true" tabindex="-1"></a><span class="co"># add a legend</span></span>
<span id="cb273-26"><a href="#cb273-26" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb273-27"><a href="#cb273-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">horiz =</span> <span class="cn">TRUE</span>,</span>
<span id="cb273-28"><a href="#cb273-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Probit&quot;</span>, <span class="st">&quot;Logit&quot;</span>),</span>
<span id="cb273-29"><a href="#cb273-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;steelblue&quot;</span>, <span class="st">&quot;black&quot;</span>), </span>
<span id="cb273-30"><a href="#cb273-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-465-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Both models produce very similar estimates of the probability that a mortgage application will be denied depending on the applicants payment-to-income ratio.</p>
<p>Following the book we extend the simple Logit model of mortgage denial with the additional regressor <span class="math inline">\(black\)</span>.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate a Logit regression with multiple regressors</span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>denylogit2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(deny <span class="sc">~</span> pirat <span class="sc">+</span> black, </span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>), </span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> HMDA)</span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-6"><a href="#cb274-6" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(denylogit2, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb274-7"><a href="#cb274-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb274-8"><a href="#cb274-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; z test of coefficients:</span></span>
<span id="cb274-9"><a href="#cb274-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb274-10"><a href="#cb274-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error  z value  Pr(&gt;|z|)    </span></span>
<span id="cb274-11"><a href="#cb274-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -4.12556    0.34597 -11.9245 &lt; 2.2e-16 ***</span></span>
<span id="cb274-12"><a href="#cb274-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pirat        5.37036    0.96376   5.5723 2.514e-08 ***</span></span>
<span id="cb274-13"><a href="#cb274-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; blackyes     1.27278    0.14616   8.7081 &lt; 2.2e-16 ***</span></span>
<span id="cb274-14"><a href="#cb274-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb274-15"><a href="#cb274-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>We obtain</p>
<p><span class="math display">\[\begin{align}
  \widehat{P(deny=1 \vert P/I ratio, black)} = F(-\underset{(0.35)}{4.13} + \underset{(0.96)}{5.37} P/I \ ratio + \underset{(0.15)}{1.27} black). (\#eq:denylogit2)
\end{align}\]</span></p>
<p>As for the Probit model @ref(eq:denyprobit2) all model coefficients are highly significant and we obtain positive estimates for the coefficients on <span class="math inline">\(P/I \ ratio\)</span> and <span class="math inline">\(black\)</span>. For comparison we compute the predicted probability of denial for two hypothetical applicants that differ in race and have a <span class="math inline">\(P/I \ ratio\)</span> of <span class="math inline">\(0.3\)</span>.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. compute predictions for P/I ratio = 0.3</span></span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(denylogit2, </span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="st">&quot;black&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>), </span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">&quot;pirat&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>)),</span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb275-6"><a href="#cb275-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-7"><a href="#cb275-7" aria-hidden="true" tabindex="-1"></a>predictions</span>
<span id="cb275-8"><a href="#cb275-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          1          2 </span></span>
<span id="cb275-9"><a href="#cb275-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.07485143 0.22414592</span></span>
<span id="cb275-10"><a href="#cb275-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-11"><a href="#cb275-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Compute difference in probabilities</span></span>
<span id="cb275-12"><a href="#cb275-12" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(predictions)</span>
<span id="cb275-13"><a href="#cb275-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         2 </span></span>
<span id="cb275-14"><a href="#cb275-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.1492945</span></span></code></pre></div>
<p>We find that the white applicant faces a denial probability of only <span class="math inline">\(7.5\%\)</span>, while the African American is rejected with a probability of <span class="math inline">\(22.4\%\)</span>, a difference of <span class="math inline">\(14.9\)</span> percentage points.</p>
<div id="comparison-of-the-models" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Comparison of the Models<a href="#comparison-of-the-models" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Probit model and the Logit model deliver only approximations to the unknown population regression function <span class="math inline">\(E(Y\vert X)\)</span>. It is not obvious how to decide which model to use in practice. The linear probability model has the clear drawback of not being able to capture the nonlinear nature of the population regression function and it may predict probabilities to lie outside the interval <span class="math inline">\([0,1]\)</span>. Probit and Logit models are harder to interpret but capture the nonlinearities better than the linear approach: both models produce predictions of probabilities that lie inside the interval <span class="math inline">\([0,1]\)</span>. Predictions of all three models are often close to each other. The book suggests to use the method that is easiest to use in the statistical software of choice. As we have seen, it is equally easy to estimate Probit and Logit model using <tt>R</tt>. We can therefore give no general recommendation which method to use.</p>
</div>
</div>
</div>
<div id="estimation-and-inference-in-the-logit-and-probit-models" class="section level2 hasAnchor" number="11.3">
<h2 class="hasAnchor"><span class="header-section-number">11.3</span> Estimation and Inference in the Logit and Probit Models<a href="#estimation-and-inference-in-the-logit-and-probit-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So far nothing has been said about <em>how</em> Logit and Probit models are estimated by statistical software. The reason why this is interesting is that both models are <em>nonlinear in the parameters</em> and thus cannot be estimated using OLS. Instead one relies on <em>maximum likelihood estimation</em> (MLE). Another approach is estimation by <em>nonlinear least squares</em> (NLS).</p>
<div id="nonlinear-least-squares" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Nonlinear Least Squares<a href="#nonlinear-least-squares" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider the multiple regression Probit model
<span class="math display">\[\begin{align}
  E(Y_i\vert X_{1i}, \dots, X_{ki}) = P(Y_i=1\vert X_{1i}, \dots, X_{ki}) = \Phi(\beta_0 + \beta_1 X_{1i} + \dots + \beta_k X_{ki}). (\#eq:multprobit)
\end{align}\]</span>
Similarly to OLS, NLS estimates the parameters <span class="math inline">\(\beta_0,\beta_1,\dots,\beta_k\)</span> by minimizing the sum of squared mistakes
<span class="math display">\[\sum_{i=1}^n\left[ Y_i - \Phi(b_0 + b_1 X_{1i} + \dots + b_k X_{ki}) \right]^2.\]</span>
NLS estimation is a consistent approach that produces estimates which are normally distributed in large samples. In <tt>R</tt> there are functions like <tt>nls()</tt> from package <tt>stats</tt> which provide algorithms for solving nonlinear least squares problems.
However, NLS is inefficient, meaning that there are estimation techniques that have a smaller variance which is why we will not dwell any further on this topic.</p>
</div>
<div id="maximum-likelihood-estimation" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Maximum Likelihood Estimation<a href="#maximum-likelihood-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In MLE we seek to estimate the unknown parameters choosing them such that the likelihood of drawing the sample observed is maximized. This probability is measured by means of the likelihood function, the joint probability distribution of the data treated as a function of the unknown parameters. Put differently, the maximum likelihood estimates of the unknown parameters are the values that result in a model which is most likely to produce the data observed. It turns out that MLE is more efficient than NLS.</p>
<p>As maximum likelihood estimates are normally distributed in large samples, statistical inference for coefficients in nonlinear models like Logit and Probit regression can be made using the same tools that are used for linear regression models: we can compute <span class="math inline">\(t\)</span>-statistics and confidence intervals.</p>
<p>Many software packages use an MLE algorithm for estimation of nonlinear models. The function <tt>glm()</tt> uses an algorithm named <em>iteratively reweighted least squares</em>.</p>
</div>
<div id="measures-of-fit-1" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Measures of Fit<a href="#measures-of-fit-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>It is important to be aware that the usual <span class="math inline">\(R^2\)</span> and <span class="math inline">\(\bar{R}^2\)</span> are <em>invalid</em> for nonlinear regression models. The reason for this is simple: both measures assume that the relation between the dependent and the explanatory variable(s) is linear. This obviously does not hold for Probit and Logit models. Thus <span class="math inline">\(R^2\)</span> need not lie between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span> and there is no meaningful interpretation. However, statistical software sometimes reports these measures anyway.</p>
<p>There are many measures of fit for nonlinear regression models and there is no consensus which one should be reported. The situation is even more complicated because there is no measure of fit that is generally meaningful. For models with a binary response variable like <span class="math inline">\(deny\)</span> one could use the following rule: If <span class="math inline">\(Y_i = 1\)</span> and <span class="math inline">\(\widehat{P(Y_i|X_{i1}, \dots, X_{ik})} &gt; 0.5\)</span> or if <span class="math inline">\(Y_i = 0\)</span> and <span class="math inline">\(\widehat{P(Y_i|X_{i1}, \dots, X_{ik})} &lt; 0.5\)</span>, consider the <span class="math inline">\(Y_i\)</span> as correctly predicted. Otherwise <span class="math inline">\(Y_i\)</span> is said to be incorrectly predicted. The measure of fit is the share of correctly predicted observations. The downside of such an approach is that it does not mirror the quality of the prediction: whether <span class="math inline">\(\widehat{P(Y_i = 1|X_{i1}, \dots, X_{ik}) = 0.51}\)</span> or <span class="math inline">\(\widehat{P(Y_i =1|X_{i1}, \dots, X_{ik}) = 0.99}\)</span> is not reflected, we just predict <span class="math inline">\(Y_i = 1\)</span>.<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a></p>
<p>An alternative to the latter are so called pseudo-<span class="math inline">\(R^2\)</span> measures. In order to measure the quality of the fit, these measures compare the value of the maximized (log-)likelihood of the model with all regressors (the <em>full model</em>) to the likelihood of a model with no regressors (<em>null model</em>, regression on a constant).</p>
<p>For example, consider a Probit regression. The <span class="math inline">\(\text{pseudo-}R^2\)</span> is given by <span class="math display">\[\text{pseudo-}R^2 = 1 - \frac{\ln(f^{max}_{full})}{\ln(f^{max}_{null})}\]</span> where <span class="math inline">\(f^{max}_j \in [0,1]\)</span> denotes the maximized likelihood for model <span class="math inline">\(j\)</span>.</p>
<p>The reasoning behind this is that the maximized likelihood increases as additional regressors are added to the model, similarly to the decrease in <span class="math inline">\(SSR\)</span> when regressors are added in a linear regression model. If the full model has a similar maximized likelihood as the null model, the full model does not really improve upon a model that uses only the information in the dependent variable, so <span class="math inline">\(\text{pseudo-}R^2 \approx 0\)</span>. If the full model fits the data very well, the maximized likelihood should be close to <span class="math inline">\(1\)</span> such that <span class="math inline">\(\ln(f^{max}_{full}) \approx 0\)</span> and <span class="math inline">\(\text{pseudo-}R^2 \approx 1\)</span>. See Appendix 11.2 of the book for more on MLE and pseudo-<span class="math inline">\(R^2\)</span> measures.</p>
<p><tt>summary()</tt> does not report <span class="math inline">\(\text{pseudo-}R^2\)</span> for models estimated by <tt>glm()</tt> but we can use the entries <em>residual deviance</em> (<tt>deviance</tt>) and <em>null deviance</em> (<tt>null.deviance</tt>) instead. These are computed as
<span class="math display">\[\text{deviance} = -2 \times \left[\ln(f^{max}_{saturated}) - \ln(f^{max}_{full}) \right]\]</span>
and</p>
<p><span class="math display">\[\text{null deviance} = -2 \times \left[\ln(f^{max}_{saturated}) - \ln(f^{max}_{null}) \right]\]</span>
where <span class="math inline">\(f^{max}_{saturated}\)</span> is the maximized likelihood for a model which assumes that each observation has its own parameter (there are <span class="math inline">\(n+1\)</span> parameters to be estimated which leads to a perfect fit). For models with a binary dependent variable, it holds that <span class="math display">\[\text{pseudo-}R^2 = 1 - \frac{\text{deviance}}{\text{null deviance}} = 1- \frac{\ln(f^{max}_{full})}{\ln(f^{max}_{null})}.\]</span></p>
<p>We now compute the <span class="math inline">\(\text{pseudo-}R^2\)</span> for the augmented Probit model of mortgage denial.</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute pseudo-R2 for the probit model of mortgage denial</span></span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a>pseudoR2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (denyprobit2<span class="sc">$</span>deviance) <span class="sc">/</span> (denyprobit2<span class="sc">$</span>null.deviance)</span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true" tabindex="-1"></a>pseudoR2</span>
<span id="cb276-4"><a href="#cb276-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.08594259</span></span></code></pre></div>
<p>Another way to obtain the <span class="math inline">\(\text{pseudo-}R^2\)</span> is to estimate the null model using <tt>glm()</tt> and extract the maximized log-likelihoods for both the null and the full model using the function <tt>logLik()</tt>.</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the null model</span></span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a>denyprobit_null <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> deny <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;probit&quot;</span>), </span>
<span id="cb277-4"><a href="#cb277-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> HMDA)</span>
<span id="cb277-5"><a href="#cb277-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-6"><a href="#cb277-6" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the pseudo-R2 using &#39;logLik&#39;</span></span>
<span id="cb277-7"><a href="#cb277-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">logLik</span>(denyprobit2)[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">logLik</span>(denyprobit_null)[<span class="dv">1</span>]</span>
<span id="cb277-8"><a href="#cb277-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.08594259</span></span></code></pre></div>
</div>
</div>
<div id="application-to-the-boston-hmda-data" class="section level2 hasAnchor" number="11.4">
<h2 class="hasAnchor"><span class="header-section-number">11.4</span> Application to the Boston HMDA Data<a href="#application-to-the-boston-hmda-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Models @ref(eq:denyprobit2) and @ref(eq:denylogit2) indicate that denial rates are higher for African American applicants holding constant the payment-to-income ratio. Both results could be subject to omitted variable bias. In order to obtain a more trustworthy estimate of the effect of being black on the probability of a mortgage application denial we estimate a linear probability model as well as several Logit and Probit models. We thereby control for financial variables and additional applicant characteristics which are likely to influence the probability of denial and differ between black and white applicants.</p>
<p>Sample averages as shown in Table 11.1 of the book can be easily reproduced using the functions <tt>mean()</tt> (as usual for numeric variables) and <tt>prop.table()</tt> (for factor variables).</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean P/I ratio</span></span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(HMDA<span class="sc">$</span>pirat)</span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.3308136</span></span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-5"><a href="#cb278-5" aria-hidden="true" tabindex="-1"></a><span class="co"># inhouse expense-to-total-income ratio</span></span>
<span id="cb278-6"><a href="#cb278-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(HMDA<span class="sc">$</span>hirat)</span>
<span id="cb278-7"><a href="#cb278-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.2553461</span></span>
<span id="cb278-8"><a href="#cb278-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-9"><a href="#cb278-9" aria-hidden="true" tabindex="-1"></a><span class="co"># loan-to-value ratio</span></span>
<span id="cb278-10"><a href="#cb278-10" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(HMDA<span class="sc">$</span>lvrat)</span>
<span id="cb278-11"><a href="#cb278-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.7377759</span></span>
<span id="cb278-12"><a href="#cb278-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-13"><a href="#cb278-13" aria-hidden="true" tabindex="-1"></a><span class="co"># consumer credit score</span></span>
<span id="cb278-14"><a href="#cb278-14" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">as.numeric</span>(HMDA<span class="sc">$</span>chist))</span>
<span id="cb278-15"><a href="#cb278-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2.116387</span></span>
<span id="cb278-16"><a href="#cb278-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-17"><a href="#cb278-17" aria-hidden="true" tabindex="-1"></a><span class="co"># mortgage credit score</span></span>
<span id="cb278-18"><a href="#cb278-18" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">as.numeric</span>(HMDA<span class="sc">$</span>mhist))</span>
<span id="cb278-19"><a href="#cb278-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.721008</span></span>
<span id="cb278-20"><a href="#cb278-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-21"><a href="#cb278-21" aria-hidden="true" tabindex="-1"></a><span class="co"># public bad credit record</span></span>
<span id="cb278-22"><a href="#cb278-22" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">as.numeric</span>(HMDA<span class="sc">$</span>phist)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb278-23"><a href="#cb278-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.07352941</span></span>
<span id="cb278-24"><a href="#cb278-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-25"><a href="#cb278-25" aria-hidden="true" tabindex="-1"></a><span class="co"># denied mortgage insurance</span></span>
<span id="cb278-26"><a href="#cb278-26" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(HMDA<span class="sc">$</span>insurance))</span>
<span id="cb278-27"><a href="#cb278-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb278-28"><a href="#cb278-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         no        yes </span></span>
<span id="cb278-29"><a href="#cb278-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.97983193 0.02016807</span></span>
<span id="cb278-30"><a href="#cb278-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-31"><a href="#cb278-31" aria-hidden="true" tabindex="-1"></a><span class="co"># self-employed</span></span>
<span id="cb278-32"><a href="#cb278-32" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(HMDA<span class="sc">$</span>selfemp))</span>
<span id="cb278-33"><a href="#cb278-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb278-34"><a href="#cb278-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        no       yes </span></span>
<span id="cb278-35"><a href="#cb278-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.8836134 0.1163866</span></span>
<span id="cb278-36"><a href="#cb278-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-37"><a href="#cb278-37" aria-hidden="true" tabindex="-1"></a><span class="co"># single</span></span>
<span id="cb278-38"><a href="#cb278-38" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(HMDA<span class="sc">$</span>single))</span>
<span id="cb278-39"><a href="#cb278-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb278-40"><a href="#cb278-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        no       yes </span></span>
<span id="cb278-41"><a href="#cb278-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.6067227 0.3932773</span></span>
<span id="cb278-42"><a href="#cb278-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-43"><a href="#cb278-43" aria-hidden="true" tabindex="-1"></a><span class="co"># high school diploma</span></span>
<span id="cb278-44"><a href="#cb278-44" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(HMDA<span class="sc">$</span>hschool))</span>
<span id="cb278-45"><a href="#cb278-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb278-46"><a href="#cb278-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         no        yes </span></span>
<span id="cb278-47"><a href="#cb278-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.01638655 0.98361345</span></span>
<span id="cb278-48"><a href="#cb278-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-49"><a href="#cb278-49" aria-hidden="true" tabindex="-1"></a><span class="co"># unemployment rate</span></span>
<span id="cb278-50"><a href="#cb278-50" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(HMDA<span class="sc">$</span>unemp)</span>
<span id="cb278-51"><a href="#cb278-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3.774496</span></span>
<span id="cb278-52"><a href="#cb278-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-53"><a href="#cb278-53" aria-hidden="true" tabindex="-1"></a><span class="co"># condominium</span></span>
<span id="cb278-54"><a href="#cb278-54" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(HMDA<span class="sc">$</span>condomin))</span>
<span id="cb278-55"><a href="#cb278-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb278-56"><a href="#cb278-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        no       yes </span></span>
<span id="cb278-57"><a href="#cb278-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.7117647 0.2882353</span></span>
<span id="cb278-58"><a href="#cb278-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-59"><a href="#cb278-59" aria-hidden="true" tabindex="-1"></a><span class="co"># black</span></span>
<span id="cb278-60"><a href="#cb278-60" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(HMDA<span class="sc">$</span>black))</span>
<span id="cb278-61"><a href="#cb278-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb278-62"><a href="#cb278-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       no      yes </span></span>
<span id="cb278-63"><a href="#cb278-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.857563 0.142437</span></span>
<span id="cb278-64"><a href="#cb278-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-65"><a href="#cb278-65" aria-hidden="true" tabindex="-1"></a><span class="co"># deny</span></span>
<span id="cb278-66"><a href="#cb278-66" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(HMDA<span class="sc">$</span>deny))</span>
<span id="cb278-67"><a href="#cb278-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb278-68"><a href="#cb278-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         0         1 </span></span>
<span id="cb278-69"><a href="#cb278-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.8802521 0.1197479</span></span></code></pre></div>
<p>See Chapter 11.4 of the book or use <tt>R</tt>’s help function for more on variables contained in the <tt>HMDA</tt> dataset.</p>
<p>Before estimating the models we transform the loan-to-value ratio (<tt>lvrat</tt>) into a factor variable, where</p>
<p><span class="math display">\[\begin{align*}
  lvrat =
  \begin{cases}
    \text{low} &amp; \text{if} \ \ lvrat &lt; 0.8, \\
    \text{medium} &amp; \text{if} \ \ 0.8 \leq lvrat \leq 0.95, \\
    \text{high} &amp; \text{if} \ \ lvrat &gt; 0.95
  \end{cases}
\end{align*}\]</span></p>
<p>and convert both credit scores to numeric variables.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define low, medium and high loan-to-value ratio</span></span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a>HMDA<span class="sc">$</span>lvrat <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb279-3"><a href="#cb279-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(HMDA<span class="sc">$</span>lvrat <span class="sc">&lt;</span> <span class="fl">0.8</span>, <span class="st">&quot;low&quot;</span>,</span>
<span id="cb279-4"><a href="#cb279-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(HMDA<span class="sc">$</span>lvrat <span class="sc">&gt;=</span> <span class="fl">0.8</span> <span class="sc">&amp;</span> HMDA<span class="sc">$</span>lvrat <span class="sc">&lt;=</span> <span class="fl">0.95</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;high&quot;</span>)),</span>
<span id="cb279-5"><a href="#cb279-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;high&quot;</span>))</span>
<span id="cb279-6"><a href="#cb279-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-7"><a href="#cb279-7" aria-hidden="true" tabindex="-1"></a><span class="co"># convert credit scores to numeric</span></span>
<span id="cb279-8"><a href="#cb279-8" aria-hidden="true" tabindex="-1"></a>HMDA<span class="sc">$</span>mhist <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(HMDA<span class="sc">$</span>mhist)</span>
<span id="cb279-9"><a href="#cb279-9" aria-hidden="true" tabindex="-1"></a>HMDA<span class="sc">$</span>chist <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(HMDA<span class="sc">$</span>chist)</span></code></pre></div>
<p>Next we reproduce the estimation results presented in Table 11.2 of the book.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate all 6 models for the denial probability</span></span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>lpm_HMDA <span class="ot">&lt;-</span> <span class="fu">lm</span>(deny <span class="sc">~</span> black <span class="sc">+</span> pirat <span class="sc">+</span> hirat <span class="sc">+</span> lvrat <span class="sc">+</span> chist <span class="sc">+</span> mhist <span class="sc">+</span> phist </span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a>               <span class="sc">+</span> insurance <span class="sc">+</span> selfemp, <span class="at">data =</span> HMDA)</span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a>logit_HMDA <span class="ot">&lt;-</span> <span class="fu">glm</span>(deny <span class="sc">~</span> black <span class="sc">+</span> pirat <span class="sc">+</span> hirat <span class="sc">+</span> lvrat <span class="sc">+</span> chist <span class="sc">+</span> mhist <span class="sc">+</span> phist </span>
<span id="cb280-6"><a href="#cb280-6" aria-hidden="true" tabindex="-1"></a>                  <span class="sc">+</span> insurance <span class="sc">+</span> selfemp, </span>
<span id="cb280-7"><a href="#cb280-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>), </span>
<span id="cb280-8"><a href="#cb280-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> HMDA)</span>
<span id="cb280-9"><a href="#cb280-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-10"><a href="#cb280-10" aria-hidden="true" tabindex="-1"></a>probit_HMDA_1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(deny <span class="sc">~</span> black <span class="sc">+</span> pirat <span class="sc">+</span> hirat <span class="sc">+</span> lvrat <span class="sc">+</span> chist <span class="sc">+</span> mhist <span class="sc">+</span> phist </span>
<span id="cb280-11"><a href="#cb280-11" aria-hidden="true" tabindex="-1"></a>                     <span class="sc">+</span> insurance <span class="sc">+</span> selfemp, </span>
<span id="cb280-12"><a href="#cb280-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;probit&quot;</span>), </span>
<span id="cb280-13"><a href="#cb280-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> HMDA)</span>
<span id="cb280-14"><a href="#cb280-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-15"><a href="#cb280-15" aria-hidden="true" tabindex="-1"></a>probit_HMDA_2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(deny <span class="sc">~</span> black <span class="sc">+</span> pirat <span class="sc">+</span> hirat <span class="sc">+</span> lvrat <span class="sc">+</span> chist <span class="sc">+</span> mhist <span class="sc">+</span> phist </span>
<span id="cb280-16"><a href="#cb280-16" aria-hidden="true" tabindex="-1"></a>                     <span class="sc">+</span> insurance <span class="sc">+</span> selfemp <span class="sc">+</span> single <span class="sc">+</span> hschool <span class="sc">+</span> unemp, </span>
<span id="cb280-17"><a href="#cb280-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;probit&quot;</span>), </span>
<span id="cb280-18"><a href="#cb280-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> HMDA)</span>
<span id="cb280-19"><a href="#cb280-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-20"><a href="#cb280-20" aria-hidden="true" tabindex="-1"></a>probit_HMDA_3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(deny <span class="sc">~</span> black <span class="sc">+</span> pirat <span class="sc">+</span> hirat <span class="sc">+</span> lvrat <span class="sc">+</span> chist <span class="sc">+</span> mhist </span>
<span id="cb280-21"><a href="#cb280-21" aria-hidden="true" tabindex="-1"></a>                     <span class="sc">+</span> phist <span class="sc">+</span> insurance <span class="sc">+</span> selfemp <span class="sc">+</span> single <span class="sc">+</span> hschool <span class="sc">+</span> unemp <span class="sc">+</span> condomin </span>
<span id="cb280-22"><a href="#cb280-22" aria-hidden="true" tabindex="-1"></a>                     <span class="sc">+</span> <span class="fu">I</span>(mhist<span class="sc">==</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(mhist<span class="sc">==</span><span class="dv">4</span>) <span class="sc">+</span> <span class="fu">I</span>(chist<span class="sc">==</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(chist<span class="sc">==</span><span class="dv">4</span>) <span class="sc">+</span> <span class="fu">I</span>(chist<span class="sc">==</span><span class="dv">5</span>) </span>
<span id="cb280-23"><a href="#cb280-23" aria-hidden="true" tabindex="-1"></a>                     <span class="sc">+</span> <span class="fu">I</span>(chist<span class="sc">==</span><span class="dv">6</span>), </span>
<span id="cb280-24"><a href="#cb280-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;probit&quot;</span>), </span>
<span id="cb280-25"><a href="#cb280-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> HMDA)</span>
<span id="cb280-26"><a href="#cb280-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-27"><a href="#cb280-27" aria-hidden="true" tabindex="-1"></a>probit_HMDA_4 <span class="ot">&lt;-</span> <span class="fu">glm</span>(deny <span class="sc">~</span> black <span class="sc">*</span> (pirat <span class="sc">+</span> hirat) <span class="sc">+</span> lvrat <span class="sc">+</span> chist <span class="sc">+</span> mhist <span class="sc">+</span> phist </span>
<span id="cb280-28"><a href="#cb280-28" aria-hidden="true" tabindex="-1"></a>                     <span class="sc">+</span> insurance <span class="sc">+</span> selfemp <span class="sc">+</span> single <span class="sc">+</span> hschool <span class="sc">+</span> unemp, </span>
<span id="cb280-29"><a href="#cb280-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;probit&quot;</span>), </span>
<span id="cb280-30"><a href="#cb280-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> HMDA)</span></code></pre></div>
<p>Just as in previous chapters, we store heteroskedasticity-robust standard errors of the coefficient estimators in a <tt>list</tt> which is then used as the argument <tt>se</tt> in <tt>stargazer()</tt>.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a>rob_se <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(lpm_HMDA, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(logit_HMDA, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(probit_HMDA_1, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb281-4"><a href="#cb281-4" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(probit_HMDA_2, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb281-5"><a href="#cb281-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(probit_HMDA_3, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb281-6"><a href="#cb281-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(probit_HMDA_4, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))))</span>
<span id="cb281-7"><a href="#cb281-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-8"><a href="#cb281-8" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(lpm_HMDA, logit_HMDA, probit_HMDA_1, </span>
<span id="cb281-9"><a href="#cb281-9" aria-hidden="true" tabindex="-1"></a>          probit_HMDA_2, probit_HMDA_3, probit_HMDA_4,  </span>
<span id="cb281-10"><a href="#cb281-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb281-11"><a href="#cb281-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>, </span>
<span id="cb281-12"><a href="#cb281-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">header =</span> <span class="cn">FALSE</span>,</span>
<span id="cb281-13"><a href="#cb281-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">se =</span> rob_se,</span>
<span id="cb281-14"><a href="#cb281-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">model.numbers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb281-15"><a href="#cb281-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">column.labels =</span> <span class="fu">c</span>(<span class="st">&quot;(1)&quot;</span>, <span class="st">&quot;(2)&quot;</span>, <span class="st">&quot;(3)&quot;</span>, <span class="st">&quot;(4)&quot;</span>, <span class="st">&quot;(5)&quot;</span>, <span class="st">&quot;(6)&quot;</span>))</span></code></pre></div>



<table style="text-align:center"><tr><td colspan="7" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"></td><td colspan="6">Dependent Variable: Mortgage Application Denial</td></tr>
<tr><td></td><td colspan="6" style="border-bottom: 1px solid black"></td></tr>
<tr><td style="text-align:left"></td><td colspan="6">deny</td></tr>
<tr><td style="text-align:left"></td><td><em>OLS</em></td><td><em>logistic</em></td><td colspan="4"><em>probit</em></td></tr>
<tr><td style="text-align:left"></td><td>(1)</td><td>(2)</td><td>(3)</td><td>(4)</td><td>(5)</td><td>(6)</td></tr>
<tr><td colspan="7" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">blackyes</td><td>0.084<sup>***</sup></td><td>0.688<sup>***</sup></td><td>0.389<sup>***</sup></td><td>0.371<sup>***</sup></td><td>0.363<sup>***</sup></td><td>0.246</td></tr>
<tr><td style="text-align:left"></td><td>(0.023)</td><td>(0.183)</td><td>(0.099)</td><td>(0.100)</td><td>(0.101)</td><td>(0.479)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">pirat</td><td>0.449<sup>***</sup></td><td>4.764<sup>***</sup></td><td>2.442<sup>***</sup></td><td>2.464<sup>***</sup></td><td>2.622<sup>***</sup></td><td>2.572<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.114)</td><td>(1.332)</td><td>(0.673)</td><td>(0.654)</td><td>(0.665)</td><td>(0.728)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">hirat</td><td>-0.048</td><td>-0.109</td><td>-0.185</td><td>-0.302</td><td>-0.502</td><td>-0.538</td></tr>
<tr><td style="text-align:left"></td><td>(0.110)</td><td>(1.298)</td><td>(0.689)</td><td>(0.689)</td><td>(0.715)</td><td>(0.755)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">lvratmedium</td><td>0.031<sup>**</sup></td><td>0.464<sup>***</sup></td><td>0.214<sup>***</sup></td><td>0.216<sup>***</sup></td><td>0.215<sup>**</sup></td><td>0.216<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.013)</td><td>(0.160)</td><td>(0.082)</td><td>(0.082)</td><td>(0.084)</td><td>(0.083)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">lvrathigh</td><td>0.189<sup>***</sup></td><td>1.495<sup>***</sup></td><td>0.791<sup>***</sup></td><td>0.795<sup>***</sup></td><td>0.836<sup>***</sup></td><td>0.788<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.050)</td><td>(0.325)</td><td>(0.183)</td><td>(0.184)</td><td>(0.185)</td><td>(0.185)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">chist</td><td>0.031<sup>***</sup></td><td>0.290<sup>***</sup></td><td>0.155<sup>***</sup></td><td>0.158<sup>***</sup></td><td>0.344<sup>***</sup></td><td>0.158<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.005)</td><td>(0.039)</td><td>(0.021)</td><td>(0.021)</td><td>(0.108)</td><td>(0.021)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">mhist</td><td>0.021<sup>*</sup></td><td>0.279<sup>**</sup></td><td>0.148<sup>**</sup></td><td>0.110</td><td>0.162</td><td>0.111</td></tr>
<tr><td style="text-align:left"></td><td>(0.011)</td><td>(0.138)</td><td>(0.073)</td><td>(0.076)</td><td>(0.104)</td><td>(0.077)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">phistyes</td><td>0.197<sup>***</sup></td><td>1.226<sup>***</sup></td><td>0.697<sup>***</sup></td><td>0.702<sup>***</sup></td><td>0.717<sup>***</sup></td><td>0.705<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.035)</td><td>(0.203)</td><td>(0.114)</td><td>(0.115)</td><td>(0.116)</td><td>(0.115)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">insuranceyes</td><td>0.702<sup>***</sup></td><td>4.548<sup>***</sup></td><td>2.557<sup>***</sup></td><td>2.585<sup>***</sup></td><td>2.589<sup>***</sup></td><td>2.590<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.045)</td><td>(0.576)</td><td>(0.305)</td><td>(0.299)</td><td>(0.306)</td><td>(0.299)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">selfempyes</td><td>0.060<sup>***</sup></td><td>0.666<sup>***</sup></td><td>0.359<sup>***</sup></td><td>0.346<sup>***</sup></td><td>0.342<sup>***</sup></td><td>0.348<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.021)</td><td>(0.214)</td><td>(0.113)</td><td>(0.116)</td><td>(0.116)</td><td>(0.116)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">singleyes</td><td></td><td></td><td></td><td>0.229<sup>***</sup></td><td>0.230<sup>***</sup></td><td>0.226<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td>(0.080)</td><td>(0.086)</td><td>(0.081)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">hschoolyes</td><td></td><td></td><td></td><td>-0.613<sup>***</sup></td><td>-0.604<sup>**</sup></td><td>-0.620<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td>(0.229)</td><td>(0.237)</td><td>(0.229)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">unemp</td><td></td><td></td><td></td><td>0.030<sup>*</sup></td><td>0.028</td><td>0.030</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td>(0.018)</td><td>(0.018)</td><td>(0.018)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">condominyes</td><td></td><td></td><td></td><td></td><td>-0.055</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td>(0.096)</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">I(mhist == 3)</td><td></td><td></td><td></td><td></td><td>-0.107</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td>(0.301)</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">I(mhist == 4)</td><td></td><td></td><td></td><td></td><td>-0.383</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td>(0.427)</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">I(chist == 3)</td><td></td><td></td><td></td><td></td><td>-0.226</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td>(0.248)</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">I(chist == 4)</td><td></td><td></td><td></td><td></td><td>-0.251</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td>(0.338)</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">I(chist == 5)</td><td></td><td></td><td></td><td></td><td>-0.789<sup>*</sup></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td>(0.412)</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">I(chist == 6)</td><td></td><td></td><td></td><td></td><td>-0.905<sup>*</sup></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td>(0.515)</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">blackyes:pirat</td><td></td><td></td><td></td><td></td><td></td><td>-0.579</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td>(1.550)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">blackyes:hirat</td><td></td><td></td><td></td><td></td><td></td><td>1.232</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td>(1.709)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">Constant</td><td>-0.183<sup>***</sup></td><td>-5.707<sup>***</sup></td><td>-3.041<sup>***</sup></td><td>-2.575<sup>***</sup></td><td>-2.896<sup>***</sup></td><td>-2.543<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.028)</td><td>(0.484)</td><td>(0.250)</td><td>(0.350)</td><td>(0.404)</td><td>(0.370)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td colspan="7" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">Observations</td><td>2,380</td><td>2,380</td><td>2,380</td><td>2,380</td><td>2,380</td><td>2,380</td></tr>
<tr><td style="text-align:left">R<sup>2</sup></td><td>0.266</td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">Adjusted R<sup>2</sup></td><td>0.263</td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">Log Likelihood</td><td></td><td>-635.637</td><td>-636.847</td><td>-628.614</td><td>-625.064</td><td>-628.332</td></tr>
<tr><td style="text-align:left">Akaike Inf. Crit.</td><td></td><td>1,293.273</td><td>1,295.694</td><td>1,285.227</td><td>1,292.129</td><td>1,288.664</td></tr>
<tr><td style="text-align:left">Residual Std. Error</td><td>0.279 (df = 2369)</td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">F Statistic</td><td>85.974<sup>***</sup> (df = 10; 2369)</td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td colspan="7" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"><em>Note:</em></td><td colspan="6" style="text-align:right"><sup>*</sup>p<0.1; <sup>**</sup>p<0.05; <sup>***</sup>p<0.01</td></tr>
</table>
<caption><p style='text-align:center'>(#tab:hmdad) HMDA Data: LPM, Probit and Logit Models</p></caption>


<p>In Table @ref(tab:hmdad), models (1), (2) and (3) are baseline specifications that include several financial control variables. They differ only in the way they model the denial probability. Model (1) is a linear probability model, model (2) is a Logit regression and model (3) uses the Probit approach.</p>
<p>In the linear model (1), the coefficients have direct interpretation. For example, an increase in the consumer credit score by <span class="math inline">\(1\)</span> unit is estimated to increase the probability of a loan denial by about <span class="math inline">\(0.031\)</span> percentage points. Having a high loan-to-value ratio is detriment for credit approval: the coefficient for a loan-to-value ratio higher than <span class="math inline">\(0.95\)</span> is <span class="math inline">\(0.189\)</span> so clients with this property are estimated to face an almost <span class="math inline">\(19\%\)</span> larger risk of denial than those with a low loan-to-value ratio, ceteris paribus. The estimated coefficient on the race dummy is <span class="math inline">\(0.084\)</span>, which indicates the denial probability for African Americans is <span class="math inline">\(8.4\%\)</span> larger than for white applicants with the same characteristics except for race. Apart from the housing-expense-to-income ratio and the mortgage credit score, all coefficients are significant.</p>
<p>Models (2) and (3) provide similar evidence that there is racial discrimination in the U.S. mortgage market. All coefficients except for the housing expense-to-income ratio (which is not significantly different from zero) are significant at the <span class="math inline">\(1\%\)</span> level. As discussed above, the nonlinearity makes the interpretation of the coefficient estimates more difficult than for model (1). In order to make a statement about the effect of being black, we need to compute the estimated denial probability for two individuals that differ only in race. For the comparison we consider two individuals that share mean values for all numeric regressors. For the qualitative variables we assign the property that is most representative for the data at hand. For example, consider self-employment: we have seen that about <span class="math inline">\(88\%\)</span> of all individuals in the sample are not self-employed such that we set <tt>selfemp = no</tt>. Using this approach, the estimate for the effect on the denial probability of being African American of the Logit model (2) is about <span class="math inline">\(4\%\)</span>. The next code chunk shows how to apply this approach for models (1) to (7) using <tt>R</tt>.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comppute regressor values for an average black person</span></span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;pirat&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(HMDA<span class="sc">$</span>pirat),</span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;hirat&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(HMDA<span class="sc">$</span>hirat),</span>
<span id="cb282-5"><a href="#cb282-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;lvrat&quot;</span> <span class="ot">=</span> <span class="st">&quot;low&quot;</span>,</span>
<span id="cb282-6"><a href="#cb282-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;chist&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(HMDA<span class="sc">$</span>chist),</span>
<span id="cb282-7"><a href="#cb282-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;mhist&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(HMDA<span class="sc">$</span>mhist),</span>
<span id="cb282-8"><a href="#cb282-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;phist&quot;</span> <span class="ot">=</span> <span class="st">&quot;no&quot;</span>,</span>
<span id="cb282-9"><a href="#cb282-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;insurance&quot;</span> <span class="ot">=</span> <span class="st">&quot;no&quot;</span>,</span>
<span id="cb282-10"><a href="#cb282-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;selfemp&quot;</span> <span class="ot">=</span> <span class="st">&quot;no&quot;</span>,</span>
<span id="cb282-11"><a href="#cb282-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;black&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>),</span>
<span id="cb282-12"><a href="#cb282-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;single&quot;</span> <span class="ot">=</span> <span class="st">&quot;no&quot;</span>,</span>
<span id="cb282-13"><a href="#cb282-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;hschool&quot;</span> <span class="ot">=</span> <span class="st">&quot;yes&quot;</span>,</span>
<span id="cb282-14"><a href="#cb282-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;unemp&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(HMDA<span class="sc">$</span>unemp),</span>
<span id="cb282-15"><a href="#cb282-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;condomin&quot;</span> <span class="ot">=</span> <span class="st">&quot;no&quot;</span>)</span>
<span id="cb282-16"><a href="#cb282-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-17"><a href="#cb282-17" aria-hidden="true" tabindex="-1"></a><span class="co"># differnce predicted by the LPM</span></span>
<span id="cb282-18"><a href="#cb282-18" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(lpm_HMDA, <span class="at">newdata =</span> new)</span>
<span id="cb282-19"><a href="#cb282-19" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(predictions)</span>
<span id="cb282-20"><a href="#cb282-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          2 </span></span>
<span id="cb282-21"><a href="#cb282-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.08369674</span></span>
<span id="cb282-22"><a href="#cb282-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-23"><a href="#cb282-23" aria-hidden="true" tabindex="-1"></a><span class="co"># differnce predicted by the logit model</span></span>
<span id="cb282-24"><a href="#cb282-24" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_HMDA, <span class="at">newdata =</span> new, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb282-25"><a href="#cb282-25" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(predictions)</span>
<span id="cb282-26"><a href="#cb282-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          2 </span></span>
<span id="cb282-27"><a href="#cb282-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.04042135</span></span>
<span id="cb282-28"><a href="#cb282-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-29"><a href="#cb282-29" aria-hidden="true" tabindex="-1"></a><span class="co"># difference predicted by probit model (3)</span></span>
<span id="cb282-30"><a href="#cb282-30" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(probit_HMDA_1, <span class="at">newdata =</span> new, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb282-31"><a href="#cb282-31" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(predictions)</span>
<span id="cb282-32"><a href="#cb282-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          2 </span></span>
<span id="cb282-33"><a href="#cb282-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.05049716</span></span>
<span id="cb282-34"><a href="#cb282-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-35"><a href="#cb282-35" aria-hidden="true" tabindex="-1"></a><span class="co"># difference predicted by probit model (4)</span></span>
<span id="cb282-36"><a href="#cb282-36" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(probit_HMDA_2, <span class="at">newdata =</span> new, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb282-37"><a href="#cb282-37" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(predictions)</span>
<span id="cb282-38"><a href="#cb282-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          2 </span></span>
<span id="cb282-39"><a href="#cb282-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.03978918</span></span>
<span id="cb282-40"><a href="#cb282-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-41"><a href="#cb282-41" aria-hidden="true" tabindex="-1"></a><span class="co"># difference predicted by probit model (5)</span></span>
<span id="cb282-42"><a href="#cb282-42" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(probit_HMDA_3, <span class="at">newdata =</span> new, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb282-43"><a href="#cb282-43" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(predictions)</span>
<span id="cb282-44"><a href="#cb282-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          2 </span></span>
<span id="cb282-45"><a href="#cb282-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.04972468</span></span>
<span id="cb282-46"><a href="#cb282-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-47"><a href="#cb282-47" aria-hidden="true" tabindex="-1"></a><span class="co"># difference predicted by probit model (6)</span></span>
<span id="cb282-48"><a href="#cb282-48" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(probit_HMDA_4, <span class="at">newdata =</span> new, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb282-49"><a href="#cb282-49" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(predictions)</span>
<span id="cb282-50"><a href="#cb282-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          2 </span></span>
<span id="cb282-51"><a href="#cb282-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.03955893</span></span></code></pre></div>
<p>The estimates of the impact on the denial probability of being black are similar for models (2) and (3). It is interesting that the magnitude of the estimated effects is much smaller than for Probit and Logit models that do not control for financial characteristics (see section 11.2). This indicates that these simple models produce biased estimates due to omitted variables.</p>
<p>Regressions (4) to (6) use regression specifications that include different applicant characteristics and credit rating indicator variables as well as interactions. However, most of the corresponding coefficients are not significant and the estimates of the coefficient on <tt>black</tt> obtained for these models as well as the estimated difference in denial probabilities do not differ much from those obtained for the similar specifications (2) and (3).</p>
<p>An interesting question related to racial discrimination can be investigated using the Probit model (6) where the interactions <tt>blackyes:pirat</tt> and <tt>blackyes:hirat</tt> are added to model (4). If the coefficient on <tt>blackyes:pirat</tt> was different from zero, the effect of the payment-to-income ratio on the denial probability would be different for black and white applicants. Similarly, a non-zero coefficient on <tt>blackyes:hirat</tt> would indicate that loan officers weight the risk of bankruptcy associated with a high loan-to-value ratio differently for black and white mortgage applicants. We can test whether these coefficients are jointly significant at the <span class="math inline">\(5\%\)</span> level using an <span class="math inline">\(F\)</span>-Test.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(probit_HMDA_4,</span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">test =</span> <span class="st">&quot;F&quot;</span>,</span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">&quot;blackyes:pirat=0&quot;</span>, <span class="st">&quot;blackyes:hirat=0&quot;</span>),</span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb283-5"><a href="#cb283-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb283-6"><a href="#cb283-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb283-7"><a href="#cb283-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb283-8"><a href="#cb283-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; blackyes:pirat = 0</span></span>
<span id="cb283-9"><a href="#cb283-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; blackyes:hirat = 0</span></span>
<span id="cb283-10"><a href="#cb283-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb283-11"><a href="#cb283-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb283-12"><a href="#cb283-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: deny ~ black * (pirat + hirat) + lvrat + chist + mhist + phist + </span></span>
<span id="cb283-13"><a href="#cb283-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     insurance + selfemp + single + hschool + unemp</span></span>
<span id="cb283-14"><a href="#cb283-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb283-15"><a href="#cb283-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb283-16"><a href="#cb283-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb283-17"><a href="#cb283-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F Pr(&gt;F)</span></span>
<span id="cb283-18"><a href="#cb283-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   2366                 </span></span>
<span id="cb283-19"><a href="#cb283-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   2364  2 0.2473 0.7809</span></span></code></pre></div>
<p>Since <span class="math inline">\(p\text{-value} \approx 0.77\)</span> for this test, the null cannot be rejected. Nonetheless, we can reject the hypothesis that there is no racial discrimination at all since the corresponding <span class="math inline">\(F\)</span>-test has a <span class="math inline">\(p\text{-value}\)</span> of about <span class="math inline">\(0.002\)</span>.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(probit_HMDA_4,</span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">test =</span> <span class="st">&quot;F&quot;</span>,</span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">&quot;blackyes=0&quot;</span>, <span class="st">&quot;blackyes:pirat=0&quot;</span>, <span class="st">&quot;blackyes:hirat=0&quot;</span>),</span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb284-6"><a href="#cb284-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb284-7"><a href="#cb284-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb284-8"><a href="#cb284-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; blackyes = 0</span></span>
<span id="cb284-9"><a href="#cb284-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; blackyes:pirat = 0</span></span>
<span id="cb284-10"><a href="#cb284-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; blackyes:hirat = 0</span></span>
<span id="cb284-11"><a href="#cb284-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb284-12"><a href="#cb284-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb284-13"><a href="#cb284-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: deny ~ black * (pirat + hirat) + lvrat + chist + mhist + phist + </span></span>
<span id="cb284-14"><a href="#cb284-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     insurance + selfemp + single + hschool + unemp</span></span>
<span id="cb284-15"><a href="#cb284-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb284-16"><a href="#cb284-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb284-17"><a href="#cb284-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb284-18"><a href="#cb284-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F   Pr(&gt;F)   </span></span>
<span id="cb284-19"><a href="#cb284-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   2367                      </span></span>
<span id="cb284-20"><a href="#cb284-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   2364  3 4.7774 0.002534 **</span></span>
<span id="cb284-21"><a href="#cb284-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb284-22"><a href="#cb284-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<div id="summary-3" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Summary<a href="#summary-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Models (1) to (6) provide evidence that there is an effect of being African American on the probability of a mortgage application denial: in all specifications, the effect is estimated to be positive (ranging from <span class="math inline">\(4\%\)</span> to <span class="math inline">\(5\%\)</span>) and is significantly different from zero at the <span class="math inline">\(1\%\)</span> level. While the linear probability model seems to slightly overestimate this effect, it still can be used as an approximation to an intrinsically nonlinear relationship.</p>
<p>See Chapters 11.4 and 11.5 of the book for a discussion of external and internal validity of this study and some concluding remarks on regression models where the dependent variable is binary.</p>
</div>
</div>
<div id="exercises-11" class="section level2 hasAnchor" number="11.5">
<h2 class="hasAnchor"><span class="header-section-number">11.5</span> Exercises<a href="#exercises-11" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="titanic-survival-data" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">1. Titanic Survival Data<a href="#titanic-survival-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Chapter @ref(palr) presented three approaches to model the conditional expectation function of a binary dependent variable: the linear probability model as well as Probit and Logit regression.</p>
<p>The exercises in this Chapter use data on the fate of the passengers of the ocean linear <em>Titanic</em>. We aim to explain survival, a binary variable, by socioeconomic variables using the above approaches.</p>
<p>In this exercise we start with the aggregated data set <tt>Titanic</tt>. It is part of the package <tt>datasets</tt> which is part of base <tt>R</tt>. The following quote from the <a href="https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/Titanic.html">description</a> of the dataset motivates the attempt to predict the <em>probability</em> of survival:</p>
<p><em>The sinking of the Titanic is a famous event, and new books are still being published about it. Many well-known facts — from the proportions of first-class passengers to the ‘women and children first’ policy, and the fact that that policy was not entirely successful in saving the women and children in the third class — are reflected in the survival rates for various classes of passenger.</em></p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Assign the <tt>Titanic</tt> data to <tt>Titanic_1</tt> and get an overview.</p></li>
<li><p>Visualize the conditional survival rates for travel class (<tt>Class</tt>), gender (<tt>Sex</tt>) and age (<tt>Age</tt>) using <tt>mosaicplot()</tt>.</p></li>
</ul>
<iframe src="DCL/ex11_1.html" frameborder="0" scrolling="no" style="width:100%;height:360px">
</iframe>
</div>
<div id="titanic-survival-data-ctd." class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">2. Titanic Survival Data — Ctd.<a href="#titanic-survival-data-ctd." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <tt>Titanic</tt> data set from Exercise 1 is not useful for regression analysis because it is highly aggregated. In this exercise you will work with <tt>titanic.csv</tt> which is available under the URL <a href="https://stanford.io/2O9RUCF" class="uri">https://stanford.io/2O9RUCF</a>.</p>
<p>The columns of <tt>titanic.csv</tt> contain the following variables:</p>
<p><tt>Survived</tt> — The survived indicator</p>
<p><tt>Pclass</tt> — passenger class</p>
<p><tt>Name</tt> — passenger’s Name</p>
<p><tt>Sex</tt> — passenger’s gender</p>
<p><tt>Age</tt> — passengers’s age</p>
<p><tt>Siblings</tt> — number of siblings aboard</p>
<p><tt>Parents.Children.Aboard</tt> — number of parents and children aboard</p>
<p><tt>fare</tt> — the fare paid in british pound</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Import the data from <tt>titanic.csv</tt> using the function <tt>read.csv2()</tt>. Save it to <tt>Titanic_2</tt>.</p></li>
<li><p>Assign the following column names to <tt>Titanic_2</tt>:</p>
<p><tt>Survived, Class, Name, Sex, Age, Siblings, Parents</tt> and <tt>Fare</tt>.</p></li>
<li><p>Get an overview over the data set. Drop the column <tt>Name</tt>.</p></li>
<li><p>Attach the packages <tt>corrplot</tt> and <tt>dplyr</tt>. Check whether there is multicollinearity in the data using <tt>corrplot()</tt>.</p></li>
</ul>
<iframe src="DCL/ex11_2.html" frameborder="0" scrolling="no" style="width:100%;height:560px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p><tt>read_csv()</tt> guesses the column specification as well as the seperators used in the <tt>.csv</tt> file. You should always check if the result is correct.</p></li>
<li><p>You may use <tt>select_if()</tt> from the <tt>dplyr</tt> package to select all numeric columns from the data set.</p></li>
</ul>
</div>
<div id="titanic-survival-data-survival-rates" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">3. Titanic Survival Data — Survival Rates<a href="#titanic-survival-data-survival-rates" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Contingency tables similar to those provided by the data set <tt>Titanic</tt> from Exercise 1 may shed some light on the distribution of survival conditional and possible determinants thereof, e.g., the passenger class. Contingency tables are easily created using the base <tt>R</tt> function <tt>table</tt>.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Generate a contingency table for <tt>Survived</tt> and <tt>Class</tt> using <tt>table()</tt>. Save the table to <tt>t_abs</tt>.</p></li>
<li><p><tt>t_abs</tt> reports absolute frequencies. Transform <tt>t_abs</tt> into a table which reports relative frequencies (relative to the total number of observations). Save the result to <tt>t_rel</tt>.</p></li>
<li><p>Visualize the relative frequencies in <tt>t_rel</tt> using <tt>barplot()</tt>. Use different colors for better distinquishablitly among survival and non-survival rate (it does not matter which colors you use).</p></li>
</ul>
<iframe src="DCL/ex11_4_3.html" frameborder="0" scrolling="no" style="width:100%;height:320px">
</iframe>
</div>
<div id="titanic-survival-data-conditional-distributions-of-age" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">4. Titanic Survival Data — Conditional Distributions of <tt>Age</tt><a href="#titanic-survival-data-conditional-distributions-of-age" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Contingency tables are useful for summarizing distribution of categorical variables like <tt>Survived</tt> and <tt>Class</tt> in Exercise 3. They are, however, not useful when the variable of interest takes on many different integers (and they are even impossible to generate when the variable is continuous).</p>
<p>In this exercise you are asked to generate and visualize density estimates of the distribution of <tt>Age</tt> conditional on <tt>Survived</tt> to see whether there are indications how age relates to the chance of survival (despite that the data set reports integers, we treat <tt>Age</tt> as a continuous variable here). For example, it is interesting to see if the ‘women and children first’ policy was effective.</p>
<p>The data set <tt>Titanic_2</tt> from the previous exercises is available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Obtain kernel density estimates of the distributions of <tt>Age</tt> for both the survivors and the deceased.</p></li>
<li><p>Save the results to <tt>dens_age_surv</tt> (survived) and <tt>dens_age_died</tt> (died).</p></li>
<li><p>Plot both kernel density estimates (overlay them in a single plot!). Use different colors of your choive to make the estimates distinguishable.</p></li>
</ul>
<iframe src="DCL/ex11_5_4.html" frameborder="0" scrolling="no" style="width:100%;height:330px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>Kernel density estimates can be obtained using the functon <tt>density()</tt>.</p></li>
<li><p>Use <tt>plot()</tt> and <tt>lines()</tt> to plot the density estimates.</p></li>
</ul>
</div>
<div id="titanic-survival-data-a-linear-probability-model-for-survival-i" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">5. Titanic Survival Data — A Linear Probability Model for <tt>Survival</tt> I<a href="#titanic-survival-data-a-linear-probability-model-for-survival-i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>How do socio-economic characteristics of the passengers impact the probability of survival? In particular, are there systematic differences between the three passenger classes? Do the data reflect the ‘children and women first’ policy?</p>
<p>It is natural to start the analysis by estimating a simple linear probability model like (LMP) <span class="math display">\[Survived_i = \beta_0 + \beta_1 Class2_i + \beta_2 Class3_i + u_i\]</span> with dummy variables <span class="math inline">\(Class2_i\)</span> and <span class="math inline">\(Class3_i\)</span>.</p>
<p>The data set <tt>Titanic_2</tt> from the previous exercises is available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Attach the <tt>AER</tt> package.</p></li>
<li><p><tt>Class</tt> is of type <tt>int</tt> (integer), Convert <tt>Class</tt> to a factor variable.</p></li>
<li><p>Estimate the linear probability model and save the result to <tt>surv_mod</tt>.</p></li>
<li><p>Obtain a robust summary of the model coefficients.</p></li>
<li><p>Use <tt>surv_mod</tt> to predict the probability of survival for the three passenger classes.</p></li>
</ul>
<iframe src="DCL/ex11_lpm.html" frameborder="0" scrolling="no" style="width:100%;height:320px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>Linear probability models can be estimated using <tt>lm()</tt>.</p></li>
<li><p>Use <tt>predict()</tt> to obtain the predictions. Remember that a <tt>data.frame</tt> must be provided to the argument <tt>newdata</tt>.</p></li>
</ul>
</div>
<div id="titanic-survival-data-a-linear-probability-model-for-survival-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">6. Titanic Survival Data — A Linear Probability Model for <tt>Survival</tt> II<a href="#titanic-survival-data-a-linear-probability-model-for-survival-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider again the outcome from Exercise 5:</p>
<p><span class="math display">\[\widehat{Survived}_i = \underset{(0.03)}{0.63} - \underset{(0.05)}{0.16} Class2_i - \underset{(0.04)}{0.39} Class3_i + u_i \]</span></p>
<p>(The estimated coefficients in this model are related to the class specific sample means of <tt>Survived</tt>. You are asked to compute them below.)</p>
<p>The highly significant coefficients indicate that the probability of survival decreases with the passenger class, that is, passengers from a less luxurious class are less likely to survive.</p>
<p>This result could be affected by omitted variable bias arising from correlation of the passenger class with determinants of the probability of survival not included in the model. We therefore augment the model such that it includes all remaining variables as regressors.</p>
<p>The data set <tt>Titanic_2</tt> as well as the model <tt>surv_mod</tt> from the previous exercises are available in your working environment. The <tt>AER</tt> package is attached.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Use the model object <tt>surv_mod</tt> to obtain the class specific estimates for the probability of survival. Store them in <tt>surv_prob_c1</tt>, <tt>surv_prob_c2</tt> and <tt>surv_prob_c3</tt>.</p></li>
<li><p>Fit the augmented LMP and assign the result to the object <tt>LPM_mod</tt>.</p></li>
<li><p>Obtain a robust summary of the model coefficients.</p></li>
</ul>
<iframe src="DCL/ex11_lpm2.html" frameborder="0" scrolling="no" style="width:100%;height:320px">
</iframe>
<p><strong>Hint:</strong></p>
<ul>
<li>Remember that the formula <tt>a ~ .</tt> specifies a regression of <tt>a</tt> on all other variables in the data set provided as the argument <tt>data</tt> in <tt>glm()</tt>.</li>
</ul>
</div>
<div id="titanic-survival-data-logistic-regression" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">7. Titanic Survival Data — Logistic Regression<a href="#titanic-survival-data-logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Chapter @ref(palr) introduces Logistic regression, also called Logit regression, which is a more suitable than the LPM for modelling the conditional probability function of a dichotomous outcome variable. Logit regression uses a nonlinear link function that restricts the fitted values to lie between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>: in Logit regression, the <em>log-odds</em> of the outcome are modeled as a linear combination of the predictors while the LPM assumes that the conditional probability function of outcome is linear.</p>
<p>The data set <tt>Titanic_2</tt> from Exercise 2 is available in your working environment. The package <tt>AER</tt> is attached.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Use <tt>glm()</tt> to estimate the model
<span class="math display">\[\begin{align*}
\log\left(\frac{P(survived_i = 1)}{1-P(survived_i = 1)}\right) =&amp; \, \beta_0 + \beta_1 Class2_i + \beta_2 Ckass3_i + \beta_3 Sex_i \\ +&amp; \, \beta_4 Age_i + \beta_5 Siblings_i + \beta_6 Perents_i + \beta_7 Fare_i + u_i.
\end{align*}\]</span></p></li>
<li><p>Obtain a robust summary of the model coefficients.</p></li>
<li><p>The data frame <tt>passengers</tt> contains data on three hypothetical male passengers that differ only in their passenger class (the other variables are set to the respective sample average). Use <tt>Logit_mod</tt> to predict the probability of survival for these passengers.</p></li>
</ul>
<iframe src="DCL/ex11_3_6.html" frameborder="0" scrolling="no" style="width:100%;height:430px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>Remember that the formula <tt>a ~ .</tt> specifies a regression of <tt>a</tt> on all other variables in the data set provided as the argument <tt>data</tt> in <tt>glm()</tt>.</p></li>
<li><p>You need to specify the correct type of prediction in <tt>predict()</tt>.</p></li>
</ul>
</div>
<div id="titanic-survival-data-probit-regression" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">8. Titanic Survival Data — Probit Regression<a href="#titanic-survival-data-probit-regression" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Repeat Exercise 7 but this time estimate the Probit model
<span class="math display">\[\begin{align*}
P(Survived_i = 1\vert Class2_i, Class3_i, \dots, Fare_i) =&amp; \, \Phi (\beta_0 + \beta_1 Class2_i + \beta_2 Class3_i + \beta_3 Sex_i \\ +&amp; \, \beta_4 Age_i + \beta_5 Siblings_i + \beta_6 Parents_i + \beta_7 Fare_i + u_i).
\end{align*}\]</span></p>
<p>The data set <tt>Titanic_2</tt> from the previous exercises as well as the Logit model <tt>Logit_mod</tt> are available in your working environment. The package <tt>AER</tt> is attached.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Use <tt>glm()</tt> to estimate the above Probit model. Save the result to <tt>Probit_mod</tt>.</p></li>
<li><p>Obtain a robust summary of the model coefficients.</p></li>
<li><p>The data frame <tt>passengers</tt> contains data on three hypothetical male passengers that differ only in their passenger class (the other variables are set to the respective sample average). Use <tt>Probit_mod</tt> to predict the probability of survival for these passengers.</p></li>
</ul>
<iframe src="DCL/ex11_8.html" frameborder="0" scrolling="no" style="width:100%;height:430px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>Remember that the formula <tt>a ~ .</tt> specifies a regression of <tt>a</tt> on all other variables in the data set provided as the argument <tt>data</tt> in <tt>glm()</tt>.</p></li>
<li><p>You need to specify the correct type of prediction in <tt>predict()</tt>.</p></li>
</ul>
</div>
<!--chapter:end:11-ch11.Rmd-->
</div>
</div>
<div id="ivr" class="section level1 hasAnchor" number="12">
<h1 class="hasAnchor"><span class="header-section-number">12</span> Instrumental Variables Regression<a href="#ivr" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>As discussed in Chapter @ref(asbomr), regression models may suffer from problems like omitted variables, measurement errors and simultaneous causality. If so, the error term is correlated with the regressor of interest and so that the corresponding coefficient is estimated inconsistently.
So far we have assumed that we can add the omitted variables to the regression to mitigate the risk of biased estimation of the causal effect of interest. However, if omitted factors cannot be measured or are not available for other reasons, multiple regression cannot solve the problem.
The same issue arises if there is simultaneous causality. When causality runs from <span class="math inline">\(X\)</span> to <span class="math inline">\(Y\)</span> and vice versa, there will be an estimation bias that cannot be corrected for by multiple regression.</p>
<p>A general technique for obtaining a consistent estimator of the coefficient of interest is instrumental variables (IV) regression. In this chapter we focus on the IV regression tool called <em>two-stage least squares</em> (TSLS). The first sections briefly recap the general mechanics and assumptions of IV regression and show how to perform TSLS estimation using <tt>R</tt>. Next, IV regression is used for estimating the elasticity of the demand for cigarettes — a classical example where multiple regression fails to do the job because of simultaneous causality.</p>
<p>Just like for the previous chapter, the packages <tt>AER</tt> <span class="citation">(<a href="#ref-R-AER" role="doc-biblioref">Christian Kleiber and Zeileis 2022</a>)</span> and <tt>stargazer</tt> <span class="citation">(<a href="#ref-R-stargazer" role="doc-biblioref">Hlavac 2022</a>)</span> are required for reproducing the code presented in this chapter. Check whether the code chunk below executes without any error messages.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span></code></pre></div>
<div id="TIVEWASRAASI" class="section level2 hasAnchor" number="12.1">
<h2 class="hasAnchor"><span class="header-section-number">12.1</span> The IV Estimator with a Single Regressor and a Single Instrument<a href="#TIVEWASRAASI" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consider the simple regression model</p>
<p><span class="math display">\[\begin{align}
  Y_i = \beta_0 + \beta_1 X_i + u_i \ \ , \ \ i=1,\dots,n  (\#eq:srm12)
\end{align}\]</span></p>
<p>where the error term <span class="math inline">\(u_i\)</span> is correlated with the regressor <span class="math inline">\(X_i\)</span> (<span class="math inline">\(X\)</span> is <em>endogenous</em>) such that OLS is inconsistent for the true <span class="math inline">\(\beta_1\)</span>. In the most simple case, IV regression uses a single instrumental variable <span class="math inline">\(Z\)</span> to obtain a consistent estimator for <span class="math inline">\(\beta_1\)</span>.</p>
<p><span class="math inline">\(Z\)</span> must satisfy two conditions to be a valid instrument:</p>
<p><strong>1. Instrument relevance condition</strong>:</p>
<center>
<span class="math inline">\(X\)</span> and its instrument <span class="math inline">\(Z\)</span> <em>must be</em> correlated: <span class="math inline">\(\rho_{Z_i,X_i} \neq 0\)</span>.
</center>
<p><strong>2. Instrument exogeneity condition</strong>:</p>
<center>
The instrument <span class="math inline">\(Z\)</span> <em>must not be</em> correlated with the error term <span class="math inline">\(u\)</span>: <span class="math inline">\(\rho_{Z_i,u_i} = 0\)</span>.
</center>
<div id="the-two-stage-least-squares-estimator" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">The Two-Stage Least Squares Estimator<a href="#the-two-stage-least-squares-estimator" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As can be guessed from its name, TSLS proceeds in two stages. In the first stage, the variation in the endogenous regressor <span class="math inline">\(X\)</span> is decomposed into a problem-free component that is explained by the instrument <span class="math inline">\(Z\)</span> and a problematic component that is correlated with the error <span class="math inline">\(u_i\)</span>. The second stage uses the problem-free component of the variation in <span class="math inline">\(X\)</span> to estimate <span class="math inline">\(\beta_1\)</span>.</p>
<p>The first stage regression model is <span class="math display">\[X_i = \pi_0 + \pi_1 Z_i + \nu_i,\]</span> where <span class="math inline">\(\pi_0 + \pi_1 Z_i\)</span> is the component of <span class="math inline">\(X_i\)</span> that is explained by <span class="math inline">\(Z_i\)</span> while <span class="math inline">\(\nu_i\)</span> is the component that cannot be explained by <span class="math inline">\(Z_i\)</span> and exhibits correlation with <span class="math inline">\(u_i\)</span>.</p>
<p>Using the OLS estimates <span class="math inline">\(\widehat{\pi}_0\)</span> and <span class="math inline">\(\widehat{\pi}_1\)</span> we obtain predicted values <span class="math inline">\(\widehat{X}_i, \ \ i=1,\dots,n\)</span>. If <span class="math inline">\(Z\)</span> is a valid instrument, the <span class="math inline">\(\widehat{X}_i\)</span> are problem-free in the sense that <span class="math inline">\(\widehat{X}\)</span> is exogenous in a regression of <span class="math inline">\(Y\)</span> on <span class="math inline">\(\widehat{X}\)</span> which is done in the second stage regression. The second stage produces <span class="math inline">\(\widehat{\beta}_0^{TSLS}\)</span> and <span class="math inline">\(\widehat{\beta}_1^{TSLS}\)</span>, the TSLS estimates of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p>
<p>For the case of a single instrument one can show that the TSLS estimator of <span class="math inline">\(\beta_1\)</span> is</p>
<p><span class="math display">\[\begin{align}
\widehat{\beta}_1^{TSLS} = \frac{s_{ZY}}{s_{ZX}} = \frac{\frac{1}{n-1}\sum_{i=1}^n(Y_i - \overline{Y})(Z_i - \overline{Z})}{\frac{1}{n-1}\sum_{i=1}^n(X_i - \overline{X})(Z_i - \overline{Z})}, (\#eq:simpletsls)
\end{align}\]</span></p>
<p>which is nothing but the ratio of the sample covariance between <span class="math inline">\(Z\)</span> and <span class="math inline">\(Y\)</span> to the sample covariance between <span class="math inline">\(Z\)</span> and <span class="math inline">\(X\)</span>.</p>
<p>As shown in Appendix 12.3 of the book, @ref(eq:simpletsls) is a consistent estimator for <span class="math inline">\(\beta_1\)</span> in @ref(eq:srm12) under the assumption that <span class="math inline">\(Z\)</span> is a valid instrument. Just as for every other OLS estimator we have considered so far, the CLT implies that the distribution of <span class="math inline">\(\widehat{\beta}_1^{TSLS}\)</span> can be approximated by a normal distribution if the sample size is large. This allows us to use <span class="math inline">\(t\)</span>-statistics and confidence intervals which are also computed by certain <tt>R</tt> functions. A more detailed argument on the large-sample distribution of the TSLS estimator is sketched in Appendix 12.3 of the book.</p>
</div>
<div id="application-to-the-demand-for-cigarettes" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Application to the Demand For Cigarettes<a href="#application-to-the-demand-for-cigarettes" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The relation between the demand for and the price of commodities is a simple yet widespread problem in economics. Health economics is concerned with the study of how health-affecting behavior of individuals is influenced by the health-care system and regulation policy. Probably the most prominent example in public policy debates is smoking as it is related to many illnesses and negative externalities.</p>
<p>It is plausible that cigarette consumption can be reduced by taxing cigarettes more heavily. The question is by <em>how much</em> taxes must be increased to reach a certain reduction in cigarette consumption. Economists use elasticities to answer this kind of question. Since the price elasticity for the demand of cigarettes is unknown, it must be estimated. As discussed in the box <em>Who Invented Instrumental Variables Regression</em> presented in Chapter 12.1 of the book, an OLS regression of log quantity on log price cannot be used to estimate the effect of interest since there is simultaneous causality between demand and supply. Instead, IV regression can be used.</p>
<p>We use the data set <tt>CigarettesSW</tt> which comes with the package <tt>AER</tt>. It is a panel data set that contains observations on cigarette consumption and several economic indicators for all 48 continental federal states of the U.S. from 1985 to 1995. Following the book we consider data for the cross section of states in 1995 only.</p>
<p>We start by loading the package, attaching the data set and getting an overview.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the data set and get an overview</span></span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;CigarettesSW&quot;</span>)</span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(CigarettesSW)</span>
<span id="cb286-5"><a href="#cb286-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      state      year         cpi          population           packs       </span></span>
<span id="cb286-6"><a href="#cb286-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  AL     : 2   1985:48   Min.   :1.076   Min.   :  478447   Min.   : 49.27  </span></span>
<span id="cb286-7"><a href="#cb286-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  AR     : 2   1995:48   1st Qu.:1.076   1st Qu.: 1622606   1st Qu.: 92.45  </span></span>
<span id="cb286-8"><a href="#cb286-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  AZ     : 2             Median :1.300   Median : 3697472   Median :110.16  </span></span>
<span id="cb286-9"><a href="#cb286-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  CA     : 2             Mean   :1.300   Mean   : 5168866   Mean   :109.18  </span></span>
<span id="cb286-10"><a href="#cb286-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  CO     : 2             3rd Qu.:1.524   3rd Qu.: 5901500   3rd Qu.:123.52  </span></span>
<span id="cb286-11"><a href="#cb286-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  CT     : 2             Max.   :1.524   Max.   :31493524   Max.   :197.99  </span></span>
<span id="cb286-12"><a href="#cb286-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  (Other):84                                                                </span></span>
<span id="cb286-13"><a href="#cb286-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      income               tax            price             taxs       </span></span>
<span id="cb286-14"><a href="#cb286-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :  6887097   Min.   :18.00   Min.   : 84.97   Min.   : 21.27  </span></span>
<span id="cb286-15"><a href="#cb286-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.: 25520384   1st Qu.:31.00   1st Qu.:102.71   1st Qu.: 34.77  </span></span>
<span id="cb286-16"><a href="#cb286-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median : 61661644   Median :37.00   Median :137.72   Median : 41.05  </span></span>
<span id="cb286-17"><a href="#cb286-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   : 99878736   Mean   :42.68   Mean   :143.45   Mean   : 48.33  </span></span>
<span id="cb286-18"><a href="#cb286-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:127313964   3rd Qu.:50.88   3rd Qu.:176.15   3rd Qu.: 59.48  </span></span>
<span id="cb286-19"><a href="#cb286-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   :771470144   Max.   :99.00   Max.   :240.85   Max.   :112.63  </span></span>
<span id="cb286-20"><a href="#cb286-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span></code></pre></div>
<p>Use <code>?CigarettesSW</code> for a detailed description of the variables.</p>
<p>We are interested in estimating <span class="math inline">\(\beta_1\)</span> in</p>
<p><span class="math display">\[\begin{align}
  \log(Q_i^{cigarettes}) = \beta_0 + \beta_1 \log(P_i^{cigarettes}) + u_i, (\#eq:cigstsls)
\end{align}\]</span></p>
<p>where <span class="math inline">\(Q_i^{cigarettes}\)</span> is the number of cigarette packs per capita sold and <span class="math inline">\(P_i^{cigarettes}\)</span> is the after-tax average real price per pack of cigarettes in state <span class="math inline">\(i\)</span>.</p>
<p>The instrumental variable we are going to use for instrumenting the endogenous regressor <span class="math inline">\(\log(P_i^{cigarettes})\)</span> is <span class="math inline">\(SalesTax\)</span>, the portion of taxes on cigarettes arising from the general sales tax. <span class="math inline">\(SalesTax\)</span> is measured in dollars per pack. The idea is that <span class="math inline">\(SalesTax\)</span> is a relevant instrument as it is included in the after-tax average price per pack. Also, it is plausible that <span class="math inline">\(SalesTax\)</span> is exogenous since the sales tax does not influence quantity sold directly but indirectly through the price.</p>
<p>We perform some transformations in order to obtain deflated cross section data for the year 1995.</p>
<p>We also compute the sample correlation between the sales tax and price per pack. The sample correlation is a consistent estimator of the population correlation. The estimate of approximately <span class="math inline">\(0.614\)</span> indicates that <span class="math inline">\(SalesTax\)</span> and <span class="math inline">\(P_i^{cigarettes}\)</span> exhibit positive correlation which meets our expectations: higher sales taxes lead to higher prices. However, a correlation analysis like this is not sufficient for checking whether the instrument is relevant. We will later come back to the issue of checking whether an instrument is relevant and exogenous.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute real per capita prices</span></span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a>CigarettesSW<span class="sc">$</span>rprice <span class="ot">&lt;-</span> <span class="fu">with</span>(CigarettesSW, price <span class="sc">/</span> cpi)</span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  compute the sales tax</span></span>
<span id="cb287-5"><a href="#cb287-5" aria-hidden="true" tabindex="-1"></a>CigarettesSW<span class="sc">$</span>salestax <span class="ot">&lt;-</span> <span class="fu">with</span>(CigarettesSW, (taxs <span class="sc">-</span> tax) <span class="sc">/</span> cpi)</span>
<span id="cb287-6"><a href="#cb287-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-7"><a href="#cb287-7" aria-hidden="true" tabindex="-1"></a><span class="co"># check the correlation between sales tax and price</span></span>
<span id="cb287-8"><a href="#cb287-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(CigarettesSW<span class="sc">$</span>salestax, CigarettesSW<span class="sc">$</span>price)</span>
<span id="cb287-9"><a href="#cb287-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.6141228</span></span>
<span id="cb287-10"><a href="#cb287-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-11"><a href="#cb287-11" aria-hidden="true" tabindex="-1"></a><span class="co"># generate a subset for the year 1995</span></span>
<span id="cb287-12"><a href="#cb287-12" aria-hidden="true" tabindex="-1"></a>c1995 <span class="ot">&lt;-</span> <span class="fu">subset</span>(CigarettesSW, year <span class="sc">==</span> <span class="st">&quot;1995&quot;</span>)</span></code></pre></div>
<p>The first stage regression is <span class="math display">\[\log(P_i^{cigarettes}) = \pi_0 + \pi_1 SalesTax_i + \nu_i.\]</span> We estimate this model in <tt>R</tt> using <tt>lm()</tt>. In the second stage we run a regression of <span class="math inline">\(\log(Q_i^{cigarettes})\)</span> on <span class="math inline">\(\widehat{\log(P_i^{cigarettes})}\)</span> to obtain <span class="math inline">\(\widehat{\beta}_0^{TSLS}\)</span> and <span class="math inline">\(\widehat{\beta}_1^{TSLS}\)</span>.</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="co"># perform the first stage regression</span></span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a>cig_s1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(rprice) <span class="sc">~</span> salestax, <span class="at">data =</span> c1995)</span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cig_s1, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb288-5"><a href="#cb288-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb288-6"><a href="#cb288-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb288-7"><a href="#cb288-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb288-8"><a href="#cb288-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error  t value  Pr(&gt;|t|)    </span></span>
<span id="cb288-9"><a href="#cb288-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 4.6165463  0.0289177 159.6444 &lt; 2.2e-16 ***</span></span>
<span id="cb288-10"><a href="#cb288-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; salestax    0.0307289  0.0048354   6.3549 8.489e-08 ***</span></span>
<span id="cb288-11"><a href="#cb288-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb288-12"><a href="#cb288-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The first stage regression is <span class="math display">\[\widehat{\log(P_i^{cigarettes})} = \underset{(0.03)}{4.62} + \underset{(0.005)}{0.031} SalesTax_i\]</span> which predicts the relation between sales tax price per cigarettes to be positive. How much of the observed variation in <span class="math inline">\(\log(P^{cigarettes})\)</span> is explained by the instrument <span class="math inline">\(SalesTax\)</span>? This can be answered by looking at the regression’s <span class="math inline">\(R^2\)</span> which states that about <span class="math inline">\(47\%\)</span> of the variation in after tax prices is explained by the variation of the sales tax across states.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect the R^2 of the first stage regression</span></span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cig_s1)<span class="sc">$</span>r.squared</span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.4709961</span></span></code></pre></div>
<p>We next store <span class="math inline">\(\widehat{\log(P_i^{cigarettes})}\)</span>, the fitted values obtained by the first stage regression <tt>cig_s1</tt>, in the variable <tt>lcigp_pred</tt>.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="co"># store the predicted values</span></span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a>lcigp_pred <span class="ot">&lt;-</span> cig_s1<span class="sc">$</span>fitted.values</span></code></pre></div>
<p>Next, we run the second stage regression which gives us the TSLS estimates we seek.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run the stage 2 regression</span></span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a>cig_s2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(c1995<span class="sc">$</span>packs) <span class="sc">~</span> lcigp_pred)</span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cig_s2, <span class="at">vcov =</span> vcovHC)</span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb291-5"><a href="#cb291-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb291-6"><a href="#cb291-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb291-7"><a href="#cb291-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb291-8"><a href="#cb291-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  9.71988    1.70304  5.7074 7.932e-07 ***</span></span>
<span id="cb291-9"><a href="#cb291-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lcigp_pred  -1.08359    0.35563 -3.0469  0.003822 ** </span></span>
<span id="cb291-10"><a href="#cb291-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb291-11"><a href="#cb291-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Thus estimating the model @ref(eq:cigstsls) using TSLS yields</p>
<p><span class="math display">\[\begin{align}
  \widehat{\log(Q_i^{cigarettes})} = \underset{(1.70)}{9.72} + \underset{(0.36)}{1.08} \log(P_i^{cigarettes}), (\#eq:ecigstsls)
\end{align}\]</span></p>
<p>where we write <span class="math inline">\(\log(P_i^{cigarettes})\)</span> instead of <span class="math inline">\(\widehat{\log(P_i^{cigarettes})}\)</span> for consistency with the book.</p>
<p>The function <tt>ivreg()</tt> from the package <tt>AER</tt> carries out TSLS procedure automatically. It is used similarly as <tt>lm()</tt>. Instruments can be added to the usual specification of the regression formula using a vertical bar separating the model equation from the instruments. Thus, for the regression at hand the correct formula is <tt>log(packs) ~ log(rprice) | salestax</tt>.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="co"># perform TSLS using &#39;ivreg()&#39;</span></span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a>cig_ivreg <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(<span class="fu">log</span>(packs) <span class="sc">~</span> <span class="fu">log</span>(rprice) <span class="sc">|</span> salestax, <span class="at">data =</span> c1995)</span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-4"><a href="#cb292-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cig_ivreg, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb292-5"><a href="#cb292-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb292-6"><a href="#cb292-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb292-7"><a href="#cb292-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb292-8"><a href="#cb292-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb292-9"><a href="#cb292-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  9.71988    1.52832  6.3598 8.346e-08 ***</span></span>
<span id="cb292-10"><a href="#cb292-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; log(rprice) -1.08359    0.31892 -3.3977  0.001411 ** </span></span>
<span id="cb292-11"><a href="#cb292-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb292-12"><a href="#cb292-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>We find that the coefficient estimates coincide for both approaches.</p>
<p><strong>Two Notes on the Computation of TSLS Standard Errors</strong></p>
<ol style="list-style-type: decimal">
<li><p>We have demonstrated that running the individual regressions for each stage of TSLS using <tt>lm()</tt> leads to the same coefficient estimates as when using <tt>ivreg()</tt>. However, the standard errors reported for the second-stage regression, e.g., by <tt>coeftest()</tt> or <tt>summary()</tt>, are <em>invalid</em>: neither adjusts for using predictions from the first-stage regression as regressors in the second-stage regression. Fortunately, <tt>ivreg()</tt> performs the necessary adjustment automatically. This is another advantage over manual step-by-step estimation which we have done above for demonstrating the mechanics of the procedure.</p></li>
<li><p>Just like in multiple regression it is important to compute heteroskedasticity-robust standard errors as we have done above using <tt>vcovHC()</tt>.</p></li>
</ol>
<p>The TSLS estimate for <span class="math inline">\(\beta_1\)</span> in @ref(eq:ecigstsls) suggests that an increase in cigarette prices by one percent reduces cigarette consumption by roughly <span class="math inline">\(1.08\)</span> percentage points, which is fairly elastic. However, we should keep in mind that this estimate might not be trustworthy even though we used IV estimation: there still might be a bias due to omitted variables. Thus a multiple IV regression approach is needed.</p>
</div>
</div>
<div id="TGIVRM" class="section level2 hasAnchor" number="12.2">
<h2 class="hasAnchor"><span class="header-section-number">12.2</span> The General IV Regression Model<a href="#TGIVRM" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The simple IV regression model is easily extended to a multiple regression model which we refer to as the general IV regression model. In this model we distinguish between four types of variables: the dependent variable, included exogenous variables, included endogenous variables and instrumental variables. Key Concept 12.1 summarizes the model and the common terminology. See Chapter 12.2 of the book for a more comprehensive discussion of the individual components of the general model.</p>
<div id="KC12.1" class="keyconcept">
<h3 class="right">
Key Concept 12.1
</h3>
<h3 class="left">
The General Instrumental Variables Regression Model and Terminology
</h3>
<p><span class="math display">\[\begin{align}
  Y_i = \beta_0 + \beta_1 X_{1i} + \dots + \beta_k X_{ki} + \beta_{k+1} W_{1i} + \dots + \beta_{k+r} W_{ri} + u_i, (\#eq:givmodel)
\end{align}\]</span></p>
<p>with <span class="math inline">\(i=1,\dots,n\)</span> is the general instrumental variables regression model where</p>
<ul>
<li><p><span class="math inline">\(Y_i\)</span> is the dependent variable</p></li>
<li><p><span class="math inline">\(\beta_0,\dots,\beta_{k+1}\)</span> are <span class="math inline">\(1+k+r\)</span> unknown regression coefficients</p></li>
<li><p><span class="math inline">\(X_{1i},\dots,X_{ki}\)</span> are <span class="math inline">\(k\)</span> endogenous regressors</p></li>
<li><p><span class="math inline">\(W_{1i},\dots,W_{ri}\)</span> are <span class="math inline">\(r\)</span> exogenous regressors which are uncorrelated with <span class="math inline">\(u_i\)</span></p></li>
<li><p><span class="math inline">\(u_i\)</span> is the error term</p></li>
<li><p><span class="math inline">\(Z_{1i},\dots,Z_{mi}\)</span> are <span class="math inline">\(m\)</span> instrumental variables</p></li>
</ul>
<p>The coefficients are overidentified if <span class="math inline">\(m&gt;k\)</span>. If <span class="math inline">\(m&lt;k\)</span>, the coefficients are underidentified and when <span class="math inline">\(m=k\)</span> they are exactly identified. For estimation of the IV regression model we require exact identification or overidentification.</p>
</div>
<p>While computing both stages of TSLS individually is not a big deal in @ref(eq:srm12), the simple regression model with a single endogenous regressor, Key Concept 12.2 clarifies why resorting to TSLS functions like <tt>ivreg()</tt> are more convenient when the set of potentially endogenous regressors (and instruments) is large.</p>
<p>Estimating regression models with TSLS using multiple instruments by means of <tt>ivreg()</tt> is straightforward. There are, however, some subtleties in correctly specifying the regression formula.</p>
<p>Assume that you want to estimate the model <span class="math display">\[Y_i = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + W_{1i} + u_i\]</span> where <span class="math inline">\(X_{1i}\)</span> and <span class="math inline">\(X_{2i}\)</span> are endogenous regressors that shall be instrumented by <span class="math inline">\(Z_{1i}\)</span>, <span class="math inline">\(Z_{2i}\)</span> and <span class="math inline">\(Z_{3i}\)</span> and <span class="math inline">\(W_{1i}\)</span> is an exogenous regressor. The corresponding data is available in a <tt>data.frame</tt> with column names <tt>y</tt>, <tt>x1</tt>, <tt>x1</tt>, <tt>w1</tt>, <tt>z1</tt>, <tt>z2</tt> and <tt>z3</tt>. It might be tempting to specify the argument <tt>formula</tt> in your call of <tt>ivreg()</tt> as <tt>y ~ x1 + x2 + w1 | z1 + z2 + z3</tt> which is wrong. As explained in the documentation of <tt>ivreg()</tt> (see <code>?ivreg</code>), it is necessary to list <em>all</em> exogenous variables as instruments too, that is joining them by <tt>+</tt>’s on the right of the vertical bar: <tt>y ~ x1 + x2 + w1 | w1 + z1 + z2 + z3</tt> where <tt>w1</tt> is “instrumenting itself”.</p>
<p>If there is a large number of exogenous variables it may be convenient to provide an update formula with a <tt>.</tt> (this includes all variables except for the dependent variable) right after the <tt>|</tt> and to exclude all endogenous variables using a <tt>-</tt>. For example, if there is one exogenous regressor <tt>w1</tt> and one endogenous regressor <tt>x1</tt> with instrument <tt>z1</tt>, the appropriate formula would be <tt>y ~ w1 + x1 | w1 + z1</tt> which is equivalent to <tt>y ~ w1 + x1 | . - x1 + z1</tt>.</p>
<div id="KC12.2" class="keyconcept">
<h3 class="right">
Key Concept 12.2
</h3>
<h3 class="left">
Two-Stage Least Squares
</h3>
<p>Similarly to the simple IV regression model, the general IV model @ref(eq:givmodel) can be estimated using the two-stage least squares estimator:</p>
<ol style="list-style-type: decimal">
<li><p><strong>First-stage regression(s)</strong></p>
<p>Run an OLS regression for each of the endogenous variables (<span class="math inline">\(X_{1i},\dots,X_{ki}\)</span>) on all instrumental variables (<span class="math inline">\(Z_{1i},\dots,Z_{mi}\)</span>), all exogenous variables (<span class="math inline">\(W_{1i},\dots,W_{ri}\)</span>) and an intercept. Compute the fitted values (<span class="math inline">\(\widehat{X}_{1i},\dots,\widehat{X}_{ki}\)</span>).</p></li>
<li><p><strong>Second-stage regression</strong></p>
<p>Regress the dependent variable on the predicted values of all endogenous regressors, all exogenous variables and an intercept using OLS. This gives <span class="math inline">\(\widehat{\beta}_{0}^{TSLS},\dots,\widehat{\beta}_{k+r}^{TSLS}\)</span>, the TSLS estimates of the model coefficients.</p></li>
</ol>
</div>
<p>In the general IV regression model, the instrument relevance and instrument exogeneity assumptions are the same as in the simple regression model with a single endogenous regressor and only one instrument. See Key Concept 12.3 for a recap using the terminology of general IV regression.</p>
<div id="KC12.3" class="keyconcept">
<h3 class="right">
Key Concept 12.3
</h3>
<h3 class="left">
Two Conditions for Valid Instruments
</h3>
<p>For <span class="math inline">\(Z_{1i},\dots,Z_{mi}\)</span> to be a set of valid instruments, the following two conditions must be fulfilled:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Instrument Relevance</strong>:</p>
<p>if there are <span class="math inline">\(k\)</span> endogenous variables, <span class="math inline">\(r\)</span> exogenous variables and <span class="math inline">\(m\geq k\)</span> instruments <span class="math inline">\(Z\)</span> and the <span class="math inline">\(\widehat{X}_{1i}^*,\dots,\widehat{X}_{ki}^*\)</span> are the predicted values from the <span class="math inline">\(k\)</span> population first stage regressions, it must hold that <span class="math display">\[(\widehat{X}_{1i}^*,\dots,\widehat{X}_{ki}^*, W_{1i}, \dots, W_{ri},1)\]</span> are not perfectly multicollinear. <span class="math inline">\(1\)</span> denotes the constant regressor which equals <span class="math inline">\(1\)</span> for all observations.</p>
<p><em>Note</em>: If there is only one endogenous regressor <span class="math inline">\(X_i\)</span>, there must be at least one non-zero coefficient on the <span class="math inline">\(Z\)</span> and the <span class="math inline">\(W\)</span> in the population regression for this condition to be valid: if all of the coefficients are zero, all the <span class="math inline">\(\widehat{X}^*_i\)</span> are just the mean of <span class="math inline">\(X\)</span> such that there is perfect multicollinearity.</p></li>
<li><p><strong>Instrument Exogeneity</strong>:</p>
<p>All <span class="math inline">\(m\)</span> instruments must be uncorrelated with the error term,</p>
<p><span class="math display">\[\rho_{Z_{1i},u_i} = 0,\dots,\rho_{Z_{mi},u_i} = 0.\]</span></p></li>
</ol>
</div>
<p>One can show that if the IV regression assumptions presented in Key Concept 12.4 hold, the TSLS estimator in @ref(eq:givmodel) is consistent and normally distributed when the sample size is large. Appendix 12.3 of the book deals with a proof in the special case with a single regressor, a single instrument and no exogenous variables. The reasoning behind this carries over to the general IV model. Chapter 18 of the book proves a more complicated explanation for the general case.</p>
<p>For our purposes it is sufficient to bear in mind that validity of the assumptions stated in Key Concept 12.4 allows us to obtain valid statistical inference using <tt>R</tt> functions which compute <span class="math inline">\(t\)</span>-Tests, <span class="math inline">\(F\)</span>-Tests and confidence intervals for model coefficients.</p>
<div id="KC12.4" class="keyconcept">
<h3 class="right">
Key Concept 12.4
</h3>
<h3 class="left">
The IV Regression Assumptions
</h3>
<p>For the general IV regression model in Key Concept 12.1 we assume the following:</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(E(u_i\vert W_{1i}, \dots, W_{ri}) = 0.\)</span></p></li>
<li><p><span class="math inline">\((X_{1i},\dots,X_{ki},W_{1i},\dots,W_{ri},Z_{1i},\dots,Z_{mi})\)</span> are i.i.d. draws from their joint distribution.</p></li>
<li><p>All variables have nonzero finite fourth moments, i.e., outliers are unlikely.</p></li>
<li><p>The <span class="math inline">\(Z\)</span>s are valid instruments (see Key Concept 12.3).</p></li>
</ol>
</div>
<div id="application-to-the-demand-for-cigarettes-1" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Application to the Demand for Cigarettes<a href="#application-to-the-demand-for-cigarettes-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The estimated elasticity of the demand for cigarettes in @ref(eq:srm12) is <span class="math inline">\(1.08\)</span>. Although @ref(eq:srm12) was estimated using IV regression it is plausible that this IV estimate is biased: in this model, the TSLS estimator is inconsistent for the true <span class="math inline">\(\beta_1\)</span> if the instrument (the real sales tax per pack) correlates with the error term. This is likely to be the case since there are economic factors, like state income, which impact the demand for cigarettes and correlate with the sales tax. States with high personal income tend to generate tax revenues by income taxes and less by sales taxes. Consequently, state income should be included in the regression model.</p>
<p><span class="math display">\[\begin{align}
  \log(Q_i^{cigarettes}) = \beta_0 + \beta_1 \log(P_i^{cigarettes}) + \beta_2 \log(income_i) + u_i (\#eq:mcigstsls1)
\end{align}\]</span></p>
<p>Before estimating @ref(eq:mcigstsls1) using <tt>ivreg()</tt> we define <span class="math inline">\(income\)</span> as real per capita income <tt>rincome</tt> and append it to the data set <tt>CigarettesSW</tt>.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add rincome to the dataset</span></span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a>CigarettesSW<span class="sc">$</span>rincome <span class="ot">&lt;-</span> <span class="fu">with</span>(CigarettesSW, income <span class="sc">/</span> population <span class="sc">/</span> cpi)</span>
<span id="cb293-3"><a href="#cb293-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-4"><a href="#cb293-4" aria-hidden="true" tabindex="-1"></a>c1995 <span class="ot">&lt;-</span> <span class="fu">subset</span>(CigarettesSW, year <span class="sc">==</span> <span class="st">&quot;1995&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model</span></span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a>cig_ivreg2 <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(<span class="fu">log</span>(packs) <span class="sc">~</span> <span class="fu">log</span>(rprice) <span class="sc">+</span> <span class="fu">log</span>(rincome) <span class="sc">|</span> <span class="fu">log</span>(rincome) <span class="sc">+</span> </span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a>                    salestax, <span class="at">data =</span> c1995)</span>
<span id="cb294-4"><a href="#cb294-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-5"><a href="#cb294-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cig_ivreg2, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb294-6"><a href="#cb294-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb294-7"><a href="#cb294-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb294-8"><a href="#cb294-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb294-9"><a href="#cb294-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb294-10"><a href="#cb294-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)   9.43066    1.25939  7.4883 1.935e-09 ***</span></span>
<span id="cb294-11"><a href="#cb294-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; log(rprice)  -1.14338    0.37230 -3.0711  0.003611 ** </span></span>
<span id="cb294-12"><a href="#cb294-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; log(rincome)  0.21452    0.31175  0.6881  0.494917    </span></span>
<span id="cb294-13"><a href="#cb294-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb294-14"><a href="#cb294-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>We obtain</p>
<p><span class="math display">\[\begin{align}
  \widehat{\log(Q_i^{cigarettes})} = \underset{(1.26)}{9.42} - \underset{(0.37)}{1.14} \log(P_i^{cigarettes}) + \underset{(0.31)}{0.21} \log(income_i). (\#eq:emcigstsls2)
\end{align}\]</span></p>
<p>Following the book we add the cigarette-specific taxes (<span class="math inline">\(cigtax_i\)</span>) as a further instrumental variable and estimate again using TSLS.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add cigtax to the data set</span></span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a>CigarettesSW<span class="sc">$</span>cigtax <span class="ot">&lt;-</span> <span class="fu">with</span>(CigarettesSW, tax<span class="sc">/</span>cpi)</span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-4"><a href="#cb295-4" aria-hidden="true" tabindex="-1"></a>c1995 <span class="ot">&lt;-</span> <span class="fu">subset</span>(CigarettesSW, year <span class="sc">==</span> <span class="st">&quot;1995&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model</span></span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a>cig_ivreg3 <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(<span class="fu">log</span>(packs) <span class="sc">~</span> <span class="fu">log</span>(rprice) <span class="sc">+</span> <span class="fu">log</span>(rincome) <span class="sc">|</span> </span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">log</span>(rincome) <span class="sc">+</span> salestax <span class="sc">+</span> cigtax, <span class="at">data =</span> c1995)</span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cig_ivreg3, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb296-6"><a href="#cb296-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb296-7"><a href="#cb296-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb296-8"><a href="#cb296-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb296-9"><a href="#cb296-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb296-10"><a href="#cb296-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)   9.89496    0.95922 10.3157 1.947e-13 ***</span></span>
<span id="cb296-11"><a href="#cb296-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; log(rprice)  -1.27742    0.24961 -5.1177 6.211e-06 ***</span></span>
<span id="cb296-12"><a href="#cb296-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; log(rincome)  0.28040    0.25389  1.1044    0.2753    </span></span>
<span id="cb296-13"><a href="#cb296-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb296-14"><a href="#cb296-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Using the two instruments <span class="math inline">\(salestax_i\)</span> and <span class="math inline">\(cigtax_i\)</span> we have <span class="math inline">\(m=2\)</span> and <span class="math inline">\(k=1\)</span> so the coefficient on the endogenous regressor <span class="math inline">\(\log(P_i^{cigarettes})\)</span> is <em>overidentified</em>. The TSLS estimate of @ref(eq:mcigstsls1) is</p>
<p><span class="math display">\[\begin{align}
  \widehat{\log(Q_i^{cigarettes})} = \underset{(0.96)}{9.89} - \underset{(0.25)}{1.28} \log(P_i^{cigarettes}) + \underset{(0.25)}{0.28} \log(income_i). (\#eq:emcigstsls3)
\end{align}\]</span></p>
<p>Should we trust the estimates presented in @ref(eq:emcigstsls2) or rather rely on @ref(eq:emcigstsls3)? The estimates obtained using both instruments are more precise since in @ref(eq:emcigstsls3) all standard errors reported are smaller than in @ref(eq:emcigstsls2). In fact, the standard error for the estimate of the demand elasticity is only two thirds of the standard error when the sales tax is the only instrument used. This is due to more information being used in estimation @ref(eq:emcigstsls3). <em>If</em> the instruments are valid, @ref(eq:emcigstsls3) can be considered more reliable.</p>
<p>However, without insights regarding the validity of the instruments it is not sensible to make such a statement. This stresses why checking instrument validity is essential. Chapter @ref(civ) briefly discusses guidelines in checking instrument validity and presents approaches that allow to test for instrument relevance and exogeneity under certain conditions. These are then used in an application to the demand for cigarettes in Chapter @ref(attdfc).</p>
</div>
</div>
<div id="civ" class="section level2 hasAnchor" number="12.3">
<h2 class="hasAnchor"><span class="header-section-number">12.3</span> Checking Instrument Validity<a href="#civ" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="instrument-relevance" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Instrument Relevance<a href="#instrument-relevance" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Instruments that explain little variation in the endogenous regressor <span class="math inline">\(X\)</span> are called <em>weak instruments</em>. Weak instruments provide little information about the variation in <span class="math inline">\(X\)</span> that is exploited by IV regression to estimate the effect of interest: the estimate of the coefficient on the endogenous regressor is estimated inaccurately. Moreover, weak instruments cause the distribution of the estimator to deviate considerably from a normal distribution even in large samples such that the usual methods for obtaining inference about the true coefficient on <span class="math inline">\(X\)</span> may produce wrong results. See Chapter 12.3 and Appendix 12.4 of the book for a more detailed argument on the undesirable consequences of using weak instruments in IV regression.</p>
<div id="KC12.5" class="keyconcept">
<h3 class="right">
Key Concept 12.5
</h3>
<h3 class="left">
A Rule of Thumb for Checking for Weak Instruments
</h3>
<p>Consider the case of a single endogenous regressor <span class="math inline">\(X\)</span> and <span class="math inline">\(m\)</span> instruments <span class="math inline">\(Z_1,\dots,Z_m\)</span>. If the coefficients on all instruments in the population first-stage regression of a TSLS estimation are zero, the instruments do not explain any of the variation in the <span class="math inline">\(X\)</span> which clearly violates assumption 1 of Key Concept 12.2. Although the latter case is unlikely to be encountered in practice, we should ask ourselves “to what extent” the assumption of instrument relevance should be fulfilled.</p>
<p>While this is hard to answer for general IV regression, in the case of a <em>single</em> endogenous regressor <span class="math inline">\(X\)</span> one may use the following rule of thumb:</p>
<p>Compute the <span class="math inline">\(F\)</span>-statistic which corresponds to the hypothesis that the coefficients on <span class="math inline">\(Z_1,\dots,Z_m\)</span> are all zero in the first-stage regression. If the <span class="math inline">\(F\)</span>-statistic is less than <span class="math inline">\(10\)</span>, the instruments are weak such that the TSLS estimate of the coefficient on <span class="math inline">\(X\)</span> is biased and no valid statistical inference about its true value can be made. See also Appendix 12.5 of the book.</p>
</div>
<p>The rule of thumb of Key Concept 12.5 is easily implemented in <tt>R</tt>. Run the first-stage regression using <tt>lm()</tt> and subsequently compute the heteroskedasticity-robust <span class="math inline">\(F\)</span>-statistic by means of <tt>linearHypothesis()</tt>. This is part of the application to the demand for cigarettes discussed in Chapter @ref(attdfc).</p>
</div>
<div id="if-instruments-are-weak" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">If Instruments are Weak<a href="#if-instruments-are-weak" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are two ways to proceed if instruments are weak:</p>
<ol style="list-style-type: decimal">
<li><p>Discard the weak instruments and/or find stronger instruments. While the former is only an option if the unknown coefficients remain identified when the weak instruments are discarded, the latter can be very difficult and even may require a redesign of the whole study.</p></li>
<li><p>Stick with the weak instruments but use methods that improve upon TSLS in this scenario, for example limited information maximum likelihood estimation, see Appendix 12.5 of the book.</p></li>
</ol>
</div>
<div id="when-the-assumption-of-instrument-exogeneity-is-violated" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">When the Assumption of Instrument Exogeneity is Violated<a href="#when-the-assumption-of-instrument-exogeneity-is-violated" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If there is correlation between an instrument and the error term, IV regression is not consistent (this is shown in Appendix 12.4 of the book). The overidentifying restrictions test (also called the <span class="math inline">\(J\)</span>-test) is an approach to test the hypothesis that <em>additional</em> instruments are exogenous. For the <span class="math inline">\(J\)</span>-test to be applicable there need to be <em>more</em> instruments than endogenous regressors. The <span class="math inline">\(J\)</span>-test is summarized in Key Concept 12.5.</p>
<div id="KC12.6" class="keyconcept">
<h3 class="right">
Key Concept 12.6
</h3>
<h3 class="left">
<span class="math inline">\(J\)</span>-Statistic / Overidentifying Restrictions Test
</h3>
<p>Take <span class="math inline">\(\widehat{u}_i^{TSLS} \ , \ i = 1,\dots,n\)</span>, the residuals of the TSLS estimation of the general IV regression model @ref(eq:givmodel). Run the OLS regression</p>
<p><span class="math display">\[\begin{align}
  \widehat{u}_i^{TSLS} =&amp; \, \delta_0 + \delta_1 Z_{1i} + \dots + \delta_m Z_{mi} + \delta_{m+1} W_{1i} + \dots + \delta_{m+r} W_{ri} + e_i (\#eq:jstatreg)
\end{align}\]</span></p>
<p>and test the joint hypothesis <span class="math display">\[H_0: \delta_1 = 0, \dots, \delta_{m} = 0\]</span> which states that all instruments are exogenous. This can be done using the corresponding <span class="math inline">\(F\)</span>-statistic by computing <span class="math display">\[J = mF.\]</span> This test is the overidentifying restrictions test and the statistic is called the <span class="math inline">\(J\)</span>-statistic with <span class="math display">\[J \sim \chi^2_{m-k}\]</span> in large samples under the null and the assumption of homoskedasticity. The degrees of freedom <span class="math inline">\(m-k\)</span> state the degree of overidentification since this is the number of instruments <span class="math inline">\(m\)</span> minus the number of endogenous regressors <span class="math inline">\(k\)</span>.</p>
</div>
<p>It is important to note that the <span class="math inline">\(J\)</span>-statistic discussed in Key Concept 12.6 is only <span class="math inline">\(\chi^2_{m-k}\)</span> distributed when the error term <span class="math inline">\(e_i\)</span> in the regression @ref(eq:jstatreg) is homoskedastic. A discussion of the heteroskedasticity-robust <span class="math inline">\(J\)</span>-statistic is beyond the scope of this chapter. We refer to Section 18.7 of the book for a theoretical argument.</p>
<p>As for the procedure shown in Key Concept 12.6, the application in the next section shows how to apply the <span class="math inline">\(J\)</span>-test using <tt>linearHypothesis()</tt>.</p>
</div>
</div>
<div id="attdfc" class="section level2 hasAnchor" number="12.4">
<h2 class="hasAnchor"><span class="header-section-number">12.4</span> Application to the Demand for Cigarettes<a href="#attdfc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Are the general sales tax and the cigarette-specific tax valid instruments? If not, TSLS is not helpful to estimate the demand elasticity for cigarettes discussed in Chapter @ref(TGIVRM). As discussed in Chapter @ref(TIVEWASRAASI), both variables are likely to be relevant but whether they are exogenous is a different question.</p>
<p>The book argues that cigarette-specific taxes could be endogenous because there might be state specific historical factors like economic importance of the tobacco farming and cigarette production industry that lobby for low cigarette specific taxes. Since it is plausible that tobacco growing states have higher rates of smoking than others, this would lead to endogeneity of cigarette specific taxes. If we had data on the size on the tobacco and cigarette industry, we could solve this potential issue by including the information in the regression. Unfortunately, this is not the case.</p>
<p>However, since the role of the tobacco and cigarette industry is a factor that can be assumed to differ across states but not over time we may exploit the panel structure of <tt>CigarettesSW</tt> instead: as shown in Chapter @ref(PDWTTP), regression using data on <em>changes</em> between two time periods eliminates such state specific and time invariant effects. Following the book we consider changes in variables between 1985 and 1995. That is, we are interested in estimating the <em>long-run elasticity</em> of the demand for cigarettes.</p>
<p>The model to be estimated by TSLS using the general sales tax and the cigarette-specific sales tax as instruments hence is</p>
<p><span class="math display">\[\begin{align}
\begin{split}
  \log(Q_{i,1995}^{cigarettes}) - \log(Q_{i,1995}^{cigarettes}) =&amp; \, \beta_0 + \beta_1 \left[\log(P_{i,1995}^{cigarettes}) - \log(P_{i,1985}^{cigarettes}) \right] \\ &amp;+ \beta_2 \left[\log(income_{i,1995}) - \log(income_{i,1985})\right] + u_i. \end{split}(\#eq:diffivreg)
\end{align}\]</span></p>
<p>We first create differences from 1985 to 1995 for the dependent variable, the regressors and both instruments.</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subset data for year 1985</span></span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>c1985 <span class="ot">&lt;-</span> <span class="fu">subset</span>(CigarettesSW, year <span class="sc">==</span> <span class="st">&quot;1985&quot;</span>)</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define differences in variables</span></span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a>packsdiff <span class="ot">&lt;-</span> <span class="fu">log</span>(c1995<span class="sc">$</span>packs) <span class="sc">-</span> <span class="fu">log</span>(c1985<span class="sc">$</span>packs)</span>
<span id="cb297-6"><a href="#cb297-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-7"><a href="#cb297-7" aria-hidden="true" tabindex="-1"></a>pricediff <span class="ot">&lt;-</span> <span class="fu">log</span>(c1995<span class="sc">$</span>price<span class="sc">/</span>c1995<span class="sc">$</span>cpi) <span class="sc">-</span> <span class="fu">log</span>(c1985<span class="sc">$</span>price<span class="sc">/</span>c1985<span class="sc">$</span>cpi)</span>
<span id="cb297-8"><a href="#cb297-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-9"><a href="#cb297-9" aria-hidden="true" tabindex="-1"></a>incomediff <span class="ot">&lt;-</span> <span class="fu">log</span>(c1995<span class="sc">$</span>income<span class="sc">/</span>c1995<span class="sc">$</span>population<span class="sc">/</span>c1995<span class="sc">$</span>cpi) <span class="sc">-</span></span>
<span id="cb297-10"><a href="#cb297-10" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(c1985<span class="sc">$</span>income<span class="sc">/</span>c1985<span class="sc">$</span>population<span class="sc">/</span>c1985<span class="sc">$</span>cpi)</span>
<span id="cb297-11"><a href="#cb297-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-12"><a href="#cb297-12" aria-hidden="true" tabindex="-1"></a>salestaxdiff <span class="ot">&lt;-</span> (c1995<span class="sc">$</span>taxs <span class="sc">-</span> c1995<span class="sc">$</span>tax)<span class="sc">/</span>c1995<span class="sc">$</span>cpi <span class="sc">-</span> (c1985<span class="sc">$</span>taxs <span class="sc">-</span> c1985<span class="sc">$</span>tax)<span class="sc">/</span>c1985<span class="sc">$</span>cpi</span>
<span id="cb297-13"><a href="#cb297-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-14"><a href="#cb297-14" aria-hidden="true" tabindex="-1"></a>cigtaxdiff <span class="ot">&lt;-</span> c1995<span class="sc">$</span>tax<span class="sc">/</span>c1995<span class="sc">$</span>cpi <span class="sc">-</span> c1985<span class="sc">$</span>tax<span class="sc">/</span>c1985<span class="sc">$</span>cpi</span></code></pre></div>
<p>We now perform three different IV estimations of @ref(eq:diffivreg) using <tt>ivreg()</tt>:</p>
<ol style="list-style-type: decimal">
<li><p>TSLS using only the difference in the sales taxes between 1985 and 1995 as the instrument.</p></li>
<li><p>TSLS using only the difference in the cigarette-specific sales taxes 1985 and 1995 as the instrument.</p></li>
<li><p>TSLS using both the difference in the sales taxes 1985 and 1995 and the difference in the cigarette-specific sales taxes 1985 and 1995 as instruments.</p></li>
</ol>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the three models</span></span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a>cig_ivreg_diff1 <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(packsdiff <span class="sc">~</span> pricediff <span class="sc">+</span> incomediff <span class="sc">|</span> incomediff <span class="sc">+</span> </span>
<span id="cb298-3"><a href="#cb298-3" aria-hidden="true" tabindex="-1"></a>                         salestaxdiff)</span>
<span id="cb298-4"><a href="#cb298-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-5"><a href="#cb298-5" aria-hidden="true" tabindex="-1"></a>cig_ivreg_diff2 <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(packsdiff <span class="sc">~</span> pricediff <span class="sc">+</span> incomediff <span class="sc">|</span> incomediff <span class="sc">+</span> </span>
<span id="cb298-6"><a href="#cb298-6" aria-hidden="true" tabindex="-1"></a>                         cigtaxdiff)</span>
<span id="cb298-7"><a href="#cb298-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-8"><a href="#cb298-8" aria-hidden="true" tabindex="-1"></a>cig_ivreg_diff3 <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(packsdiff <span class="sc">~</span> pricediff <span class="sc">+</span> incomediff <span class="sc">|</span> incomediff <span class="sc">+</span> </span>
<span id="cb298-9"><a href="#cb298-9" aria-hidden="true" tabindex="-1"></a>                         salestaxdiff <span class="sc">+</span> cigtaxdiff)</span></code></pre></div>
<p>As usual we use <tt>coeftest()</tt> in conjunction with <tt>vcovHC()</tt> to obtain robust coefficient summaries for all models.</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co"># robust coefficient summary for 1.</span></span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cig_ivreg_diff1, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb299-4"><a href="#cb299-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb299-5"><a href="#cb299-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb299-6"><a href="#cb299-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb299-7"><a href="#cb299-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.117962   0.068217 -1.7292   0.09062 .  </span></span>
<span id="cb299-8"><a href="#cb299-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pricediff   -0.938014   0.207502 -4.5205 4.454e-05 ***</span></span>
<span id="cb299-9"><a href="#cb299-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; incomediff   0.525970   0.339494  1.5493   0.12832    </span></span>
<span id="cb299-10"><a href="#cb299-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb299-11"><a href="#cb299-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb299-12"><a href="#cb299-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-13"><a href="#cb299-13" aria-hidden="true" tabindex="-1"></a><span class="co"># robust coefficient summary for 2.</span></span>
<span id="cb299-14"><a href="#cb299-14" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cig_ivreg_diff2, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb299-15"><a href="#cb299-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb299-16"><a href="#cb299-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb299-17"><a href="#cb299-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb299-18"><a href="#cb299-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb299-19"><a href="#cb299-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.017049   0.067217 -0.2536    0.8009    </span></span>
<span id="cb299-20"><a href="#cb299-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pricediff   -1.342515   0.228661 -5.8712 4.848e-07 ***</span></span>
<span id="cb299-21"><a href="#cb299-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; incomediff   0.428146   0.298718  1.4333    0.1587    </span></span>
<span id="cb299-22"><a href="#cb299-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb299-23"><a href="#cb299-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb299-24"><a href="#cb299-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-25"><a href="#cb299-25" aria-hidden="true" tabindex="-1"></a><span class="co"># robust coefficient summary for 3.</span></span>
<span id="cb299-26"><a href="#cb299-26" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cig_ivreg_diff3, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb299-27"><a href="#cb299-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb299-28"><a href="#cb299-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb299-29"><a href="#cb299-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb299-30"><a href="#cb299-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb299-31"><a href="#cb299-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.052003   0.062488 -0.8322    0.4097    </span></span>
<span id="cb299-32"><a href="#cb299-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pricediff   -1.202403   0.196943 -6.1053 2.178e-07 ***</span></span>
<span id="cb299-33"><a href="#cb299-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; incomediff   0.462030   0.309341  1.4936    0.1423    </span></span>
<span id="cb299-34"><a href="#cb299-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb299-35"><a href="#cb299-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>We proceed by generating a tabulated summary of the estimation results using <tt>stargazer()</tt>.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gather robust standard errors in a list</span></span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a>rob_se <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(cig_ivreg_diff1, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb300-3"><a href="#cb300-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(cig_ivreg_diff2, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb300-4"><a href="#cb300-4" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(cig_ivreg_diff3, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))))</span>
<span id="cb300-5"><a href="#cb300-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-6"><a href="#cb300-6" aria-hidden="true" tabindex="-1"></a><span class="co"># generate table</span></span>
<span id="cb300-7"><a href="#cb300-7" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(cig_ivreg_diff1, cig_ivreg_diff2,cig_ivreg_diff3,</span>
<span id="cb300-8"><a href="#cb300-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">header =</span> <span class="cn">FALSE</span>, </span>
<span id="cb300-9"><a href="#cb300-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;html&quot;</span>,</span>
<span id="cb300-10"><a href="#cb300-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">omit.table.layout =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb300-11"><a href="#cb300-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">3</span>, </span>
<span id="cb300-12"><a href="#cb300-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">column.labels =</span> <span class="fu">c</span>(<span class="st">&quot;IV: salestax&quot;</span>, <span class="st">&quot;IV: cigtax&quot;</span>, <span class="st">&quot;IVs: salestax, cigtax&quot;</span>),</span>
<span id="cb300-13"><a href="#cb300-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">dep.var.labels.include =</span> <span class="cn">FALSE</span>,</span>
<span id="cb300-14"><a href="#cb300-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">dep.var.caption =</span> <span class="st">&quot;Dependent Variable: 1985-1995 Difference in Log per Pack Price&quot;</span>,</span>
<span id="cb300-15"><a href="#cb300-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> rob_se)</span></code></pre></div>



<table style="text-align:center"><tr><td colspan="4" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"></td><td colspan="3">Dependent variable: 1985-1995 difference in log per pack price</td></tr>
<tr><td></td><td colspan="3" style="border-bottom: 1px solid black"></td></tr>
<tr><td style="text-align:left"></td><td>IV: salestax</td><td>IV: cigtax</td><td>IVs: salestax, cigtax</td></tr>
<tr><td style="text-align:left"></td><td>(1)</td><td>(2)</td><td>(3)</td></tr>
<tr><td colspan="4" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">pricediff</td><td>-0.938<sup>***</sup></td><td>-1.343<sup>***</sup></td><td>-1.202<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.208)</td><td>(0.229)</td><td>(0.197)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">incomediff</td><td>0.526</td><td>0.428</td><td>0.462</td></tr>
<tr><td style="text-align:left"></td><td>(0.339)</td><td>(0.299)</td><td>(0.309)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">Constant</td><td>-0.118<sup>*</sup></td><td>-0.017</td><td>-0.052</td></tr>
<tr><td style="text-align:left"></td><td>(0.068)</td><td>(0.067)</td><td>(0.062)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td></tr>
<tr><td colspan="4" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">Observations</td><td>48</td><td>48</td><td>48</td></tr>
<tr><td style="text-align:left">R<sup>2</sup></td><td>0.550</td><td>0.520</td><td>0.547</td></tr>
<tr><td style="text-align:left">Adjusted R<sup>2</sup></td><td>0.530</td><td>0.498</td><td>0.526</td></tr>
<tr><td style="text-align:left">Residual Std. Error (df = 45)</td><td>0.091</td><td>0.094</td><td>0.091</td></tr>
<tr><td colspan="4" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"><em>Note:</em></td><td colspan="3" style="text-align:right"><sup>*</sup>p<0.1; <sup>**</sup>p<0.05; <sup>***</sup>p<0.01</td></tr>
</table>
<caption><p style='text-align:center'>(#tab:tslseotlteotdfcupd) TSLS Estimates of the Long-Term Elasticity of the Demand for Cigarettes using Panel Data</p></caption>


<p>Table @ref(tab:tslseotlteotdfcupd) reports negative estimates of the coefficient on <tt>pricediff</tt> that are quite different in magnitude. Which one should we trust? This hinges on the validity of the instruments used. To assess this we compute <span class="math inline">\(F\)</span>-statistics for the first-stage regressions of all three models to check instrument relevance.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first-stage regressions</span></span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a>mod_relevance1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pricediff <span class="sc">~</span> salestaxdiff <span class="sc">+</span> incomediff)</span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a>mod_relevance2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pricediff <span class="sc">~</span> cigtaxdiff <span class="sc">+</span> incomediff)</span>
<span id="cb301-4"><a href="#cb301-4" aria-hidden="true" tabindex="-1"></a>mod_relevance3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pricediff <span class="sc">~</span> incomediff <span class="sc">+</span> salestaxdiff <span class="sc">+</span> cigtaxdiff)</span></code></pre></div>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check instrument relevance for model (1)</span></span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(mod_relevance1, </span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;salestaxdiff = 0&quot;</span>, </span>
<span id="cb302-4"><a href="#cb302-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb302-5"><a href="#cb302-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb302-6"><a href="#cb302-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb302-7"><a href="#cb302-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb302-8"><a href="#cb302-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; salestaxdiff = 0</span></span>
<span id="cb302-9"><a href="#cb302-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb302-10"><a href="#cb302-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb302-11"><a href="#cb302-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: pricediff ~ salestaxdiff + incomediff</span></span>
<span id="cb302-12"><a href="#cb302-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb302-13"><a href="#cb302-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb302-14"><a href="#cb302-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb302-15"><a href="#cb302-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F    Pr(&gt;F)    </span></span>
<span id="cb302-16"><a href="#cb302-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     46                        </span></span>
<span id="cb302-17"><a href="#cb302-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     45  1 28.445 3.009e-06 ***</span></span>
<span id="cb302-18"><a href="#cb302-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb302-19"><a href="#cb302-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check instrument relevance for model (2)</span></span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(mod_relevance2, </span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;cigtaxdiff = 0&quot;</span>, </span>
<span id="cb303-4"><a href="#cb303-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb303-5"><a href="#cb303-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb303-6"><a href="#cb303-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb303-7"><a href="#cb303-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb303-8"><a href="#cb303-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cigtaxdiff = 0</span></span>
<span id="cb303-9"><a href="#cb303-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb303-10"><a href="#cb303-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb303-11"><a href="#cb303-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: pricediff ~ cigtaxdiff + incomediff</span></span>
<span id="cb303-12"><a href="#cb303-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb303-13"><a href="#cb303-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb303-14"><a href="#cb303-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb303-15"><a href="#cb303-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F   Pr(&gt;F)    </span></span>
<span id="cb303-16"><a href="#cb303-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     46                       </span></span>
<span id="cb303-17"><a href="#cb303-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     45  1 98.034 7.09e-13 ***</span></span>
<span id="cb303-18"><a href="#cb303-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb303-19"><a href="#cb303-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check instrument relevance for model (3)</span></span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(mod_relevance3, </span>
<span id="cb304-3"><a href="#cb304-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">&quot;salestaxdiff = 0&quot;</span>, <span class="st">&quot;cigtaxdiff = 0&quot;</span>), </span>
<span id="cb304-4"><a href="#cb304-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb304-5"><a href="#cb304-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb304-6"><a href="#cb304-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb304-7"><a href="#cb304-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb304-8"><a href="#cb304-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; salestaxdiff = 0</span></span>
<span id="cb304-9"><a href="#cb304-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cigtaxdiff = 0</span></span>
<span id="cb304-10"><a href="#cb304-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb304-11"><a href="#cb304-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb304-12"><a href="#cb304-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: pricediff ~ incomediff + salestaxdiff + cigtaxdiff</span></span>
<span id="cb304-13"><a href="#cb304-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb304-14"><a href="#cb304-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb304-15"><a href="#cb304-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb304-16"><a href="#cb304-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F    Pr(&gt;F)    </span></span>
<span id="cb304-17"><a href="#cb304-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     46                        </span></span>
<span id="cb304-18"><a href="#cb304-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     44  2 76.916 4.339e-15 ***</span></span>
<span id="cb304-19"><a href="#cb304-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb304-20"><a href="#cb304-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>We also conduct the overidentifying restrictions test for model three which is the only model where the coefficient on the difference in log prices is overidentified (<span class="math inline">\(m=2\)</span>, <span class="math inline">\(k=1\)</span>) such that the <span class="math inline">\(J\)</span>-statistic can be computed. To do this we take the residuals stored in <tt>cig_ivreg_diff3</tt> and regress them on both instruments and the presumably exogenous regressor <tt>incomediff</tt>. We again use <tt>linearHypothesis()</tt> to test whether the coefficients on both instruments are zero which is necessary for the exogeneity assumption to be fulfilled. Note that with <tt>test = “Chisq”</tt> we obtain a chi-squared distributed test statistic instead of an <span class="math inline">\(F\)</span>-statistic.</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the J-statistic</span></span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a>cig_iv_OR <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">residuals</span>(cig_ivreg_diff3) <span class="sc">~</span> incomediff <span class="sc">+</span> salestaxdiff <span class="sc">+</span> cigtaxdiff)</span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-4"><a href="#cb305-4" aria-hidden="true" tabindex="-1"></a>cig_OR_test <span class="ot">&lt;-</span> <span class="fu">linearHypothesis</span>(cig_iv_OR, </span>
<span id="cb305-5"><a href="#cb305-5" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">c</span>(<span class="st">&quot;salestaxdiff = 0&quot;</span>, <span class="st">&quot;cigtaxdiff = 0&quot;</span>), </span>
<span id="cb305-6"><a href="#cb305-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span>
<span id="cb305-7"><a href="#cb305-7" aria-hidden="true" tabindex="-1"></a>cig_OR_test</span>
<span id="cb305-8"><a href="#cb305-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb305-9"><a href="#cb305-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb305-10"><a href="#cb305-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb305-11"><a href="#cb305-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; salestaxdiff = 0</span></span>
<span id="cb305-12"><a href="#cb305-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cigtaxdiff = 0</span></span>
<span id="cb305-13"><a href="#cb305-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb305-14"><a href="#cb305-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb305-15"><a href="#cb305-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: residuals(cig_ivreg_diff3) ~ incomediff + salestaxdiff + cigtaxdiff</span></span>
<span id="cb305-16"><a href="#cb305-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb305-17"><a href="#cb305-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df     RSS Df Sum of Sq Chisq Pr(&gt;Chisq)  </span></span>
<span id="cb305-18"><a href="#cb305-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     46 0.37472                                </span></span>
<span id="cb305-19"><a href="#cb305-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     44 0.33695  2  0.037769 4.932    0.08492 .</span></span>
<span id="cb305-20"><a href="#cb305-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb305-21"><a href="#cb305-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p><strong>Caution</strong>: In this case the <span class="math inline">\(p\)</span>-Value reported by <tt>linearHypothesis()</tt> is wrong because the degrees of freedom are set to <span class="math inline">\(2\)</span>. This differs from the degree of overidentification (<span class="math inline">\(m-k=2-1=1\)</span>) so the <span class="math inline">\(J\)</span>-statistic is <span class="math inline">\(\chi^2_1\)</span> distributed instead of following a <span class="math inline">\(\chi^2_2\)</span> distribution as assumed defaultly by <tt>linearHypothesis()</tt>. We may compute the correct <span class="math inline">\(p\)</span>-Value using <tt>pchisq()</tt>.</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute correct p-value for J-statistic</span></span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(cig_OR_test[<span class="dv">2</span>, <span class="dv">5</span>], <span class="at">df =</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.02636406</span></span></code></pre></div>
<p>Since this value is smaller than <span class="math inline">\(0.05\)</span> we reject the hypothesis that both instruments are exogenous at the level of <span class="math inline">\(5\%\)</span>. This means one of the following:</p>
<ol style="list-style-type: decimal">
<li>The sales tax is an invalid instrument for the per-pack price.</li>
<li>The cigarettes-specific sales tax is an invalid instrument for the per-pack price.</li>
<li>Both instruments are invalid.</li>
</ol>
<p>The book argues that the assumption of instrument exogeneity is more likely to hold for the general sales tax (see Chapter 12.4 of the book) such that the IV estimate of the long-run elasticity of demand for cigarettes we consider the most trustworthy is <span class="math inline">\(-0.94\)</span>, the TSLS estimate obtained using the general sales tax as the only instrument.</p>
<p>The interpretation of this estimate is that over a 10-year period, an increase in the average price per package by one percent is expected to decrease consumption by about <span class="math inline">\(0.94\)</span> percentage points. This suggests that, in the long run, price increases can reduce cigarette consumption considerably.</p>
</div>
<div id="where-do-valid-instruments-come-from" class="section level2 hasAnchor" number="12.5">
<h2 class="hasAnchor"><span class="header-section-number">12.5</span> Where Do Valid Instruments Come From?<a href="#where-do-valid-instruments-come-from" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Chapter 12.5 of the book presents a comprehensive discussion of approaches to find valid instruments in practice by the example of three research questions:</p>
<ul>
<li>Does putting criminals in jail reduce crime?</li>
<li>Does cutting class sizes increase test scores?</li>
<li>Does aggressive treatment of heart attacks prolong lives?</li>
</ul>
<p>This section is not directly related to applications in <tt>R</tt> which is why we do not discuss the contents here. We encourage you to work through this on your own.</p>
<div id="summary-4" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Summary<a href="#summary-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><tt>ivreg()</tt> from the package <tt>AER</tt> provides convenient functionalities to estimate IV regression models in <tt>R</tt>. It is an implementation of the TSLS estimation approach.</p>
<p>Besides treating IV estimation, we have also discussed how to test for weak instruments and how to conduct an overidentifying restrictions test when there are more instruments than endogenous regressors using <tt>R</tt>.</p>
<p>An empirical application has shown how <tt>ivreg()</tt> can be used to estimate the long-run elasticity of demand for cigarettes based on <tt>CigarettesSW</tt>, a panel data set on cigarette consumption and economic indicators for all 48 continental U.S. states for 1985 and 1995. Different sets of instruments were used and it has been argued why using the general sales tax as the only instrument is the preferred choice. The estimate of the demand elasticity deemed the most trustworthy is <span class="math inline">\(-0.94\)</span>. This estimate suggests that there is a remarkable negative long-run effect on cigarette consumption of increasing prices.</p>
</div>
</div>
<div id="exercises-12" class="section level2 hasAnchor" number="12.6">
<h2 class="hasAnchor"><span class="header-section-number">12.6</span> Exercises<a href="#exercises-12" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="the-college-distance-data" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">1. The College Distance Data<a href="#the-college-distance-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are many studies in labor economics which deal with the issue of estimating human capital earnings functions which state how wage income is determined by education and working experience. A prominent example is <span class="citation">Card (<a href="#ref-card1993" role="doc-biblioref">1993</a>)</span> who investigates the economic return to schooling and uses college proximity as an instrumental variable.</p>
<p>The exercises in this chapter deal with the dataset <tt>CollegeDistance</tt> which is similar to the data used by <span class="citation">Card (<a href="#ref-card1993" role="doc-biblioref">1993</a>)</span>. It stems from a survey of high school graduates with variables coded for wages, education, average tuition and a number of socio-economic measures. The data set also includes the distance from a college while the survey participants were in high school. <tt>CollegeDistance</tt> comes with the <tt>AER</tt> package.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Attach the <tt>AER</tt> package and load the <tt>CollegeDistance</tt> data.</p></li>
<li><p>Get an overview over the data set.</p></li>
<li><p>The variable <tt>distance</tt> (the distance to the closest 4-year college in 10 miles) will serve as an instrument in later exercises. Use a histogram to visualize the distribution of <tt>distance</tt>.</p></li>
</ul>
<iframe src="DCL/ex12_1.html" frameborder="0" scrolling="no" style="width:100%;height:330px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>Use <tt>data()</tt> to attach the data set.</p></li>
<li><p>The function <tt>hist()</tt> can be used to generate histograms.</p></li>
</ul>
</div>
<div id="the-selection-problem" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">2. The Selection Problem<a href="#the-selection-problem" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Regressing <tt>wage</tt> on <tt>education</tt> and control variables to estimate the human capital earnings function is problematic because education is not randomly assigned across the surveyed: individuals make their own education choices and so measured differences in earnings between individuals with different levels of education depend on how these choices are made. In the literature this is referred to as a <em>selection problem</em>. This selection problem implies that <tt>education</tt> is <em>endogenous</em> so the OLS estimate will be biased and we cannot make valid inference regarding the true coefficient.</p>
<p>In this exercise you are asked to estimate two regressions which both do not yield trustworthy estimates of the coefficient on education due to the issue sketched above. Later you will compare the results to those obtained using the instrumental variables approach applied by <span class="citation">Card (<a href="#ref-card1993" role="doc-biblioref">1993</a>)</span>.</p>
<p>The <tt>AER</tt> package has been attached. The data set <tt>CollegeDistance</tt> is available in your global environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Regress the <em>logarithm</em> of <tt>wage</tt> on <tt>education</tt>, that is, estimate the model <span class="math display">\[\log(wage_i) = \beta_0 + \beta_1 education_i + u_i\]</span> Save the result to <tt>wage_mod_1</tt>.</p></li>
<li><p>Augment the model by including the regressors <tt>unemp</tt>, <tt>hispanic</tt>, <tt>af-am</tt>, <tt>female</tt> and <tt>urban</tt>. Save the result to <tt>wage_mod_2</tt></p></li>
<li><p>Obtain summaries on the estimated coefficients in both models.</p></li>
</ul>
<iframe src="DCL/ex12_2.html" frameborder="0" scrolling="no" style="width:100%;height:330px">
</iframe>
</div>
<div id="instrumental-variables-regression-approaches-i" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">3. Instrumental Variables Regression Approaches — I<a href="#instrumental-variables-regression-approaches-i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The above discussed selection problem renders the regression estimates in Exercise 2 implausible which is why <span class="citation">Card (<a href="#ref-card1993" role="doc-biblioref">1993</a>)</span> suggests instrumental variables regression that uses college distance as an instrument for education.</p>
<p>Why use college distance as an instrument? The logic behind this is that distance from a college will be correlated to the decision to pursue a college degree (relevance) but may not predict wages apart from increased education (exogeneity) so college proximity could be considered a valid instrument (recall the definition of a valid instrument stated at the beginning of Chapter @ref(TIVEWASRAASI)).</p>
<p>The <tt>AER</tt> package has been attached. The data set <tt>CollegeDistance</tt> is available in your global environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Compute the correlations of the instrument <tt>distance</tt> with the edogenous regressor <tt>education</tt> and the dependent variable <tt>wage</tt>.</p></li>
<li><p>How much of the variation in <tt>education</tt> is explained by the <em>first-stage regression</em> which uses <tt>distance</tt> as a regressor? Save the result to <tt>R2</tt>.</p></li>
<li><p>Repeat Exercise 2 with IV regression, i.e., employ <tt>distance</tt> as an instrument for <tt>education</tt> in both regressions using <tt>ivreg()</tt>. Save the results to <tt>wage_mod_iv1</tt> and <tt>wage_mod_iv2</tt>. Obtain robust coefficient summaries for both models.</p></li>
</ul>
<iframe src="DCL/ex12_3.html" frameborder="0" scrolling="no" style="width:100%;height:410px">
</iframe>
</div>
<div id="instrumental-variables-regression-approaches-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">4. Instrumental Variables Regression Approaches — II<a href="#instrumental-variables-regression-approaches-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Convince yourself that <tt>ivreg()</tt> works as expected by implementing the TSLS algorithm presented in Key Concept 12.2 for a single instrument, see Chapter @ref(TGIVRM).</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Complete the function <tt>TSLS()</tt> such that it implements the TSLS estimator.</p></li>
<li><p>Use <tt>TSLS()</tt> to reproduce the coefficient estimates obtained using <tt>ivreg()</tt> for both models of Exercise 3.</p></li>
</ul>
<iframe src="DCL/ex12_4.html" frameborder="0" scrolling="no" style="width:100%;height:460px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>Completion of the function boils down to replacing the <tt>. . .</tt> by appropriate arguments.</p></li>
<li><p>Besides the data set (<tt>data</tt>), the function expects the dependent variable (<tt>Y</tt>), exogenous regressors (<tt>W</tt>), the endogenous regressors (<tt>X</tt>) and an instrument (<tt>Z</tt>) as arguments. All of these should be of class <tt>character</tt>.</p></li>
<li><p>Including <tt>W = NULL</tt> in the head of the function definition ensures that the set of exogenous variables is empty, by default.</p></li>
</ul>
</div>
<div id="should-we-trust-the-results" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">5. Should we trust the Results?<a href="#should-we-trust-the-results" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is not a real code exercise (there are no submission correctness tests for checking your code). Instead we would like you to use the widget below to compare the results obtained using the OLS regressions of Exercise 2 with those of the IV regressions of Exercise 3.</p>
<p>The data set <tt>CollegeDistance</tt> and all model objects from Exercises 2 and 3 are available in the global environment.</p>
<p><strong>Instructions:</strong></p>
<p>Convince yourself of the following:</p>
<ol style="list-style-type: decimal">
<li><p>It is likely that the bias of the estimated coefficient on <tt>education</tt> in the simple regression model <tt>wage_mod_1</tt> is subtantial because the regressor is endogenous due to omitting variables from the model which correlate with <tt>education</tt> and impact wage income.</p></li>
<li><p>Due to the selection problem in described in Exercise 2, the estimate of the coefficient of interest is not trustworthy even in the multiple regression model <tt>wage_mod_2</tt> which includes several socio-economic control variables. The coeffiecient on <tt>education</tt> is not significant and its estimate is close to zero).</p></li>
<li><p>Instrumenting education by the college distance as done in <tt>wage_mod_iv1</tt> yields the IV estimate of the coefficient of interest. The result should, however, not be considered reliable because this simple model probably suffers from omitted variables bias just as the multiple regression model <tt>wage_mod_2</tt> from Exercise 2, see 1. Again, the coeffiecient on <tt>education</tt> is not significant its estimate is quite small.</p></li>
<li><p><tt>wage_mod_iv2</tt>, the multiple regression model where we include demographic control variables and instrumend <tt>education</tt> by <tt>distance</tt> delivers the most reliable estimate of the impact of education on wage income among all the models considered. The coefficient is highly significant and the estimate is about <span class="math inline">\(0.067\)</span>. Following Key Concept 8.2, the interpretation is that an additional year of schooling is expected to increases wage income by roughly <span class="math inline">\(0.067 \cdot 100\% = 6.7\%\)</span>.</p></li>
<li><p>Is the estimate of the coefficient on education reported by <tt>wage_mod_iv2</tt> trustworthy? This question is not easy to answer. In any case, we should bear in mind that using an instrumental variables approach is problematic when the instrument is <em>weak</em>. This could be the case here: Families with strong preference for education may move into neighborhoods close to colleges. Furthermore, neighborhoods close to colleges may have stronger job markets reflected by higher incomes. Such features would render the instrument invalid as they introduce unobserved variables which influence earnings but cannot be captured by years of schooling, our measure of education.</p></li>
</ol>
<iframe src="DCL/ex12_5.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<!--chapter:end:12-ch12.Rmd-->
</div>
</div>
<div id="eaqe" class="section level1 hasAnchor" number="13">
<h1 class="hasAnchor"><span class="header-section-number">13</span> Experiments and Quasi-Experiments<a href="#eaqe" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter discusses statistical tools that are commonly applied in program evaluation, where interest lies in measuring the causal effects of programs, policies or other interventions. An optimal research design for this purpose is what statisticians call an ideal randomized controlled experiment. The basic idea is to randomly assign subjects to two different groups, one that receives the treatment (the treatment group) and one that does not (the control group) and to compare outcomes for both groups in order to get an estimate of the average treatment effect.</p>
<p>Such <em>experimental</em> data is fundamentally different from <em>observational</em> data. For example, one might use a randomized controlled experiment to measure how much the performance of students in a standardized test differs between two classes where one has a “regular”” student-teacher ratio and the other one has fewer students. The data produced by such an experiment would be different from, e.g., the observed cross-section data on the students’ performance used throughout Chapters @ref(lrwor) to @ref(nrf) where class sizes are not randomly assigned to students but instead are the results of an economic decision where educational objectives and budgetary aspects were balanced.</p>
<p>For economists, randomized controlled experiments are often difficult or even indefeasible to implement. For example, due to ethic, moral and legal reasons it is practically impossible for a business owner to estimate the causal effect on the productivity of workers of setting them under psychological stress using an experiment where workers are randomly assigned either to the treatment group that is under time pressure or to the control group where work is under regular conditions, at best without knowledge of being in an experiment (see the box <em>The Hawthorne Effect</em> on p. 528 of the book).</p>
<p>However, sometimes external circumstances produce what is called a <em>quasi-experiment</em> or <em>natural experiment</em>. This “as if” randomness allows for estimation of causal effects that are of interest for economists using tools which are very similar to those valid for ideal randomized controlled experiments. These tools draw heavily on the theory of multiple regression and also on IV regression (see Chapter @ref(ivr)). We will review the core aspects of these methods and demonstrate how to apply them in R using the STAR data set (see the <a href="https://dataverse.harvard.edu/dataset.xhtml?persistentId=hdl:1902.1/10766">description</a> of the data set).</p>
<p>The following packages and their dependencies are needed for reproduction of the code chunks presented throughout this chapter:</p>
<ul>
<li><tt>AER</tt> <span class="citation">(<a href="#ref-R-AER" role="doc-biblioref">Christian Kleiber and Zeileis 2022</a>)</span></li>
<li><tt>dplyr</tt> <span class="citation">(<a href="#ref-R-dplyr" role="doc-biblioref">Wickham et al. 2023</a>)</span></li>
<li><tt>MASS</tt> <span class="citation">(<a href="#ref-R-MASS" role="doc-biblioref">Ripley 2023</a>)</span></li>
<li><tt>mvtnorm</tt> <span class="citation">(<a href="#ref-R-mvtnorm" role="doc-biblioref">Genz et al. 2021</a>)</span></li>
<li><tt>rddtools</tt> <span class="citation">(<a href="#ref-R-rddtools" role="doc-biblioref">Stigler and Quast 2022</a>)</span></li>
<li><tt>scales</tt> <span class="citation">(<a href="#ref-R-scales" role="doc-biblioref">Wickham and Seidel 2022</a>)</span></li>
<li><tt>stargazer</tt><span class="citation">(<a href="#ref-R-stargazer" role="doc-biblioref">Hlavac 2022</a>)</span></li>
<li><tt>tidyr</tt> <span class="citation">(<a href="#ref-R-tidyr" role="doc-biblioref">Wickham, Vaughan, and Girlich 2023</a>)</span></li>
</ul>
<p>Make sure the following code chunk runs without any errors.</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb307-4"><a href="#cb307-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb307-5"><a href="#cb307-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rddtools)</span>
<span id="cb307-6"><a href="#cb307-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb307-7"><a href="#cb307-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb307-8"><a href="#cb307-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code></pre></div>
<div id="poceaie" class="section level2 hasAnchor" number="13.1">
<h2 class="hasAnchor"><span class="header-section-number">13.1</span> Potential Outcomes, Causal Effects and Idealized Experiments<a href="#poceaie" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We now briefly recap the idea of the average causal effect and how it can be estimated using the <em>differences estimator</em>. We advise you to work through Chapter 13.1 of the book for a better understanding.</p>
<div id="potential-outcomes-and-the-average-causal-effect" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Potential Outcomes and the average causal effect<a href="#potential-outcomes-and-the-average-causal-effect" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A <em>potential outcome</em> is the outcome for an individual under a potential treatment. For this individual, the causal effect of the treatment is the difference between the potential outcome if the individual receives the treatment and the potential outcome if she does not. Since this causal effect may be different for different individuals and it is not possible to measure the causal effect for a single individual, one is interested in studying the <em>average causal effect</em> of the treatment, hence also called the <em>average treatment effect</em>.</p>
<p>In an ideal randomized controlled experiment the following conditions are fulfilled:</p>
<ol style="list-style-type: decimal">
<li>The subjects are selected at random from the population.</li>
<li>The subjects are randomly assigned to treatment and control group.</li>
</ol>
<p>Condition 1 guarantees that the subjects’ potential outcomes are drawn randomly from the same distribution such that the expected value of the causal effect in the sample is equal to the average causal effect in the distribution. Condition 2 ensures that the receipt of treatment is independent from the subjects’ potential outcomes. If both conditions are fulfilled, the expected causal effect is the expected outcome in the treatment group minus the expected outcome in the control group. Using conditional expectations we have <span class="math display">\[\text{Average causal effect} =  E(Y_i\vert X_i=1) -  E(Y_i\vert X_i=0),\]</span> where <span class="math inline">\(X_i\)</span> is a binary treatment indicator.</p>
<p>The average causal effect can be estimated using the <em>differences estimator</em>, which is nothing but the OLS estimator in the simple regression model
<span class="math display">\[\begin{align}
  Y_i = \beta_0 + \beta_1 X_i + u_i \ \ , \ \ i=1,\dots,n, (\#eq:diffest)
\end{align}\]</span>
where random assignment ensures that <span class="math inline">\(E(u_i\vert X_i) = 0\)</span>.</p>
<p>The OLS estimator in the regression model
<span class="math display">\[\begin{align}
  Y_i = \beta_0 + \beta_1 X_i + \beta_2 W_{1i} + \dots + \beta_{1+r} W_{ri} + u_i \ \ , \ \ i=1,\dots,n (\#eq:diffestwar)
\end{align}\]</span>
with additional regressors <span class="math inline">\(W_1,\dots,W_r\)</span> is called the <em>differences estimator with additional regressors</em>. It is assumed that treatment <span class="math inline">\(X_i\)</span> is randomly assigned so that it is independent of the the pretreatment characteristic <span class="math inline">\(W_i\)</span>. This is assumption is called <em>conditional mean independence</em> and implies <span class="math display">\[E(u_i\vert X_i , W_i) = E(u_i\vert W_i) = 0,\]</span> so the conditional expectation of the error <span class="math inline">\(u_i\)</span> given the treatment indicator <span class="math inline">\(X_i\)</span> and the pretreatment characteristic <span class="math inline">\(W_i\)</span> does not depend on the <span class="math inline">\(X_i\)</span>. Conditional mean independence replaces the first least squares assumption in Key Concept 6.4 and thus ensures that the differences estimator of <span class="math inline">\(\beta_1\)</span> is unbiased. The <em>differences estimator with additional regressors</em> is more efficient than the <em>differences estimator</em> if the additional regressors explain some of the variation in the <span class="math inline">\(Y_i\)</span>.</p>
</div>
</div>
<div id="threats-to-validity-of-experiments" class="section level2 hasAnchor" number="13.2">
<h2 class="hasAnchor"><span class="header-section-number">13.2</span> Threats to Validity of Experiments<a href="#threats-to-validity-of-experiments" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The concepts of internal and external validity discussed in Key Concept 9.1 are also applicable for studies based on experimental and quasi-experimental data. Chapter 13.2 of the book provides a thorough explanation of the particular threats to internal and external validity of experiments including examples. We limit ourselves to a short repetition of the threats listed there. Consult the book for a more detailed explanation.</p>
<div id="threats-to-internal-validity-1" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Threats to Internal Validity<a href="#threats-to-internal-validity-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li><p><strong>Failure to Randomize</strong></p>
<p>If the subjects are not randomly assigned to the treatment group, then the outcomes will be contaminated with the effect of the subjects’ individual characteristics or preferences and it is not possible to obtain an unbiased estimate of the treatment effect. One can test for nonrandom assignment using a significance test (<span class="math inline">\(F\)</span>-Test) on the coefficients in the regression model <span class="math display">\[X_i = \beta_0 + \beta_1 W_{1i} + \dots +\beta_2 W_{ri} + u_i \ \ , \ \ i=1,\dots,n.\]</span></p></li>
<li><p><strong>Failure to Follow the Treatment Protocol</strong></p>
<p>If subjects do not follow the treatment protocol, i.e., some subjects in the treatment group manage to avoid receiving the treatment and/or some subjects in the control group manage to receive the treatment (<em>partial compliance</em>), there is correlation between <span class="math inline">\(X_i\)</span> und <span class="math inline">\(u_i\)</span> such that the OLS estimator of the average treatment effect will be biased. If there are data on <em>both</em> treatment actually recieved (<span class="math inline">\(X_i\)</span>) and initial random assignment (<span class="math inline">\(Z_i\)</span>), IV regression of the models @ref(eq:diffest) and @ref(eq:diffestwar) is a remedy.</p></li>
<li><p><strong>Attrition</strong></p>
<p>Attrition may result in a nonrandomly selected sample. If subjects systematically drop out of the study after beeing assigned to the control or the treatment group (systematic means that the reason of the dropout is related to the treatment) there will be correlation between <span class="math inline">\(X_i\)</span> and <span class="math inline">\(u_i\)</span> and hence bias in the OLS estimator of the treatment effect.</p></li>
<li><p><strong>Experimental Effects</strong></p>
<p>If human subjects in treatment group and/or control group know that they are in an experiment, they might adapt their behaviour in a way that prevents unbiased estimation of the treatment effect.</p></li>
<li><p><strong>Small Sample Sizes</strong></p>
<p>As we know from the theory of linear regression, small sample sizes lead to imprecise estimation of the coefficients and thus imply imprecise estimation of the causal effect. Furthermore, confidence intervals and hypothesis test may produce wrong inference when the sample size is small.</p></li>
</ol>
</div>
<div id="threats-to-external-validity-1" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Threats to External Validity<a href="#threats-to-external-validity-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li><p><strong>Nonrepresentative Sample</strong></p>
<p>If the population studied and the population of interest are not sufficiently similar, there is no justification in generalizing the results.</p></li>
<li><p><strong>Nonrepresentative Program or Policy</strong></p>
<p>If the program or policy for the population studied differs considerably from the program (to be) applied to population(s) of interest, the results cannot be generalized. For example, a small-scale programm with low funding might have different effects than a widely available scaled-up program that is actually implemented. There are other factors like duration and the extent of monitoring that should be considered here.</p></li>
<li><p><strong>General Equilibrium Effects</strong></p>
<p>If market and/or environmental conditions cannot be kept constant when an internally valid program is implemented broadly, external validity may be doubtful.</p></li>
</ol>
</div>
</div>
<div id="experimental-estimates-of-the-effect-of-class-size-reductions" class="section level2 hasAnchor" number="13.3">
<h2 class="hasAnchor"><span class="header-section-number">13.3</span> Experimental Estimates of the Effect of Class Size Reductions<a href="#experimental-estimates-of-the-effect-of-class-size-reductions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="experimental-design-and-the-data-set" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Experimental Design and the Data Set<a href="#experimental-design-and-the-data-set" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Project <em>Student-Teacher Achievement Ratio</em> (STAR) was a large randomized controlled experiment with the aim of asserting whether a class size reduction is effective in improving education outcomes. It has been conducted in 80 Tennessee elementary schools over a period of four years during the 1980s by the State Department of Education.</p>
<p>In the first year, about 6400 students were randomly assigned into one of three interventions: small class (13 to 17 students per teacher), regular class (22 to 25 students per teacher), and regular-with-aide class (22 to 25 students with a full-time teacher’s aide). Teachers were also randomly assigned to the classes they taught. The interventions were initiated as the students entered school in kindergarten and continued through to third grade. Control and treatment groups across grades are summarized in Table @ref(tab:starstructure).</p>
<table>
<caption>(#tab:starstructure) Control and treatment groups in the STAR experiment</caption>
<colgroup>
<col width="16%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>K</th>
<th>1</th>
<th>2</th>
<th>3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Treatment 1</td>
<td>Small class</td>
<td>Small class</td>
<td>Small class</td>
<td>Small class</td>
</tr>
<tr class="even">
<td>Treatment 2</td>
<td>Regular class + aide</td>
<td>Regular class + aide</td>
<td>Regular class + aide</td>
<td>Regular class + aide</td>
</tr>
<tr class="odd">
<td>Control</td>
<td>Regular class</td>
<td>Regular class</td>
<td>Regular class</td>
<td>Regular class</td>
</tr>
</tbody>
</table>
<p>Each year, the students’ learning progress was assessed using the sum of the points scored on the math and reading parts of a standardized test (the <a href="https://en.wikipedia.org/wiki/Stanford_Achievement_Test_Series">Stanford Achievement Test</a>).</p>
<p>The STAR data set is part of the package <tt>AER</tt>.</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the package AER and the STAR dataset</span></span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(STAR)</span></code></pre></div>
<p><tt>head(STAR)</tt> shows that there is a variety of factor variables that describe student and teacher characteristics as well as various school indicators, all of which are separately recorded for the four different grades. The data is in <em>wide format</em>. That is, each variable has its own column and for each student, the rows contain observations on these variables. Using <tt>dim(STAR)</tt> we find that there are a total of 11598 observations on 47 variables.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get an overview</span></span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(STAR, <span class="dv">2</span>)</span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      gender ethnicity   birth stark star1 star2   star3 readk read1 read2 read3</span></span>
<span id="cb309-4"><a href="#cb309-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1122 female      afam 1979 Q3  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; regular    NA    NA    NA   580</span></span>
<span id="cb309-5"><a href="#cb309-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1137 female      cauc 1980 Q1 small small small   small   447   507   568   587</span></span>
<span id="cb309-6"><a href="#cb309-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      mathk math1 math2 math3   lunchk lunch1   lunch2 lunch3 schoolk school1</span></span>
<span id="cb309-7"><a href="#cb309-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1122    NA    NA    NA   564     &lt;NA&gt;   &lt;NA&gt;     &lt;NA&gt;   free    &lt;NA&gt;    &lt;NA&gt;</span></span>
<span id="cb309-8"><a href="#cb309-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1137   473   538   579   593 non-free   free non-free   free   rural   rural</span></span>
<span id="cb309-9"><a href="#cb309-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      school2  school3  degreek  degree1  degree2  degree3 ladderk ladder1</span></span>
<span id="cb309-10"><a href="#cb309-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1122    &lt;NA&gt; suburban     &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt; bachelor    &lt;NA&gt;    &lt;NA&gt;</span></span>
<span id="cb309-11"><a href="#cb309-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1137   rural    rural bachelor bachelor bachelor bachelor  level1  level1</span></span>
<span id="cb309-12"><a href="#cb309-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         ladder2    ladder3 experiencek experience1 experience2 experience3</span></span>
<span id="cb309-13"><a href="#cb309-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1122       &lt;NA&gt;     level1          NA          NA          NA          30</span></span>
<span id="cb309-14"><a href="#cb309-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1137 apprentice apprentice           7           7           3           1</span></span>
<span id="cb309-15"><a href="#cb309-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      tethnicityk tethnicity1 tethnicity2 tethnicity3 systemk system1 system2</span></span>
<span id="cb309-16"><a href="#cb309-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1122        &lt;NA&gt;        &lt;NA&gt;        &lt;NA&gt;        cauc    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;</span></span>
<span id="cb309-17"><a href="#cb309-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1137        cauc        cauc        cauc        cauc      30      30      30</span></span>
<span id="cb309-18"><a href="#cb309-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      system3 schoolidk schoolid1 schoolid2 schoolid3</span></span>
<span id="cb309-19"><a href="#cb309-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1122      22      &lt;NA&gt;      &lt;NA&gt;      &lt;NA&gt;        54</span></span>
<span id="cb309-20"><a href="#cb309-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1137      30        63        63        63        63</span></span>
<span id="cb309-21"><a href="#cb309-21" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(STAR)</span>
<span id="cb309-22"><a href="#cb309-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 11598    47</span></span></code></pre></div>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get variable names</span></span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(STAR)</span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;gender&quot;      &quot;ethnicity&quot;   &quot;birth&quot;       &quot;stark&quot;       &quot;star1&quot;      </span></span>
<span id="cb310-4"><a href="#cb310-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6] &quot;star2&quot;       &quot;star3&quot;       &quot;readk&quot;       &quot;read1&quot;       &quot;read2&quot;      </span></span>
<span id="cb310-5"><a href="#cb310-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11] &quot;read3&quot;       &quot;mathk&quot;       &quot;math1&quot;       &quot;math2&quot;       &quot;math3&quot;      </span></span>
<span id="cb310-6"><a href="#cb310-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [16] &quot;lunchk&quot;      &quot;lunch1&quot;      &quot;lunch2&quot;      &quot;lunch3&quot;      &quot;schoolk&quot;    </span></span>
<span id="cb310-7"><a href="#cb310-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [21] &quot;school1&quot;     &quot;school2&quot;     &quot;school3&quot;     &quot;degreek&quot;     &quot;degree1&quot;    </span></span>
<span id="cb310-8"><a href="#cb310-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [26] &quot;degree2&quot;     &quot;degree3&quot;     &quot;ladderk&quot;     &quot;ladder1&quot;     &quot;ladder2&quot;    </span></span>
<span id="cb310-9"><a href="#cb310-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [31] &quot;ladder3&quot;     &quot;experiencek&quot; &quot;experience1&quot; &quot;experience2&quot; &quot;experience3&quot;</span></span>
<span id="cb310-10"><a href="#cb310-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [36] &quot;tethnicityk&quot; &quot;tethnicity1&quot; &quot;tethnicity2&quot; &quot;tethnicity3&quot; &quot;systemk&quot;    </span></span>
<span id="cb310-11"><a href="#cb310-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [41] &quot;system1&quot;     &quot;system2&quot;     &quot;system3&quot;     &quot;schoolidk&quot;   &quot;schoolid1&quot;  </span></span>
<span id="cb310-12"><a href="#cb310-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [46] &quot;schoolid2&quot;   &quot;schoolid3&quot;</span></span></code></pre></div>
<p>A majority of the variable names contain a suffix (<tt>k</tt>, <tt>1</tt>, <tt>2</tt> or <tt>3</tt>) stating the grade which the respective variable is referring to. This facilitates regression analysis because it allows to adjust the <tt>formula</tt> argument in <tt>lm()</tt> for each grade by simply changing the variables’ suffixes accordingly.</p>
<p>The outcome produced by <tt>head()</tt> shows that some values recorded are <tt>NA</tt> and <tt><NA></tt>, i.e., there is no data on this variable for the student under consideration. This lies in the nature of the data: for example, take the first observation <code>STAR[1,]</code>.</p>
<p>In the output of <code>head(STAR, 2)</code> we find that the student entered the experiment in third grade in a regular class, which is why the class size is recorded in <tt>star3</tt> and the other class type indicator variables are <tt><NA></tt>. For the same reason there are no recordings of her math and reading score but for the third grade. It is straightforward to only get her non-<tt>NA</tt>/<tt><NA></tt> recordings: simply drop the <tt>NA</tt>s using <tt>!is.na()</tt>.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="co"># drop NA recordings for the first observation and print to the console</span></span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a>STAR[<span class="dv">1</span>, <span class="sc">!</span><span class="fu">is.na</span>(STAR[<span class="dv">1</span>, ])]</span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      gender ethnicity   birth   star3 read3 math3 lunch3  school3  degree3</span></span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1122 female      afam 1979 Q3 regular   580   564   free suburban bachelor</span></span>
<span id="cb311-5"><a href="#cb311-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      ladder3 experience3 tethnicity3 system3 schoolid3</span></span>
<span id="cb311-6"><a href="#cb311-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1122  level1          30        cauc      22        54</span></span></code></pre></div>
<p><code>is.na(STAR[1, ])</code> returns a logical vector with <tt>TRUE</tt> at positions that correspond to <tt><NA></tt> entries for the first observation. The <tt>!</tt> operator is used to invert the result such that we obtain only non-<tt><NA></tt> entries for the first observations.</p>
<p>In general it is not necessary to remove rows with missing data because <tt>lm()</tt> does so by default. Missing data may imply a small sample size and thus may lead to imprecise estimation and wrong inference This is, however, not an issue for the study at hand since, as we will see below, sample sizes lie beyond 5000 observations for each regression conducted.</p>
</div>
<div id="analysis-of-the-star-data" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Analysis of the STAR Data<a href="#analysis-of-the-star-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As can be seen from Table @ref(tab:starstructure) there are two treatment groups in each grade, small classes with only 13 to 17 students and regular classes with 22 to 25 students and a teaching aide. Thus, two binary variables, each being an indicator for the respective treatment group, are introduced for the differences estimator to capture the treatment effect for each treatment group separately. This yields the population regression model
<span class="math display">\[\begin{align}
  Y_i = \beta_0 + \beta_1 SmallClass_i + \beta_2 RegAide_i + u_i, (\#eq:starpopreg)
\end{align}\]</span>
with test score <span class="math inline">\(Y_i\)</span>, the small class indicator <span class="math inline">\(SmallClass_i\)</span> and <span class="math inline">\(RegAide_i\)</span>, the indicator for a regular class with aide.</p>
<p>We reproduce the results presented in Table 13.1 of the book by performing the regression @ref(eq:starpopreg) for each grade separately. For each student, the dependent variable is simply the sum of the points scored in the math and reading parts, constructed using <tt>I()</tt>.</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute differences Estimates for each grades</span></span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a>fmk <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">I</span>(readk <span class="sc">+</span> mathk) <span class="sc">~</span> stark, <span class="at">data =</span> STAR)</span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true" tabindex="-1"></a>fm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">I</span>(read1 <span class="sc">+</span> math1) <span class="sc">~</span> star1, <span class="at">data =</span> STAR)</span>
<span id="cb312-4"><a href="#cb312-4" aria-hidden="true" tabindex="-1"></a>fm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">I</span>(read2 <span class="sc">+</span> math2) <span class="sc">~</span> star2, <span class="at">data =</span> STAR)</span>
<span id="cb312-5"><a href="#cb312-5" aria-hidden="true" tabindex="-1"></a>fm3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">I</span>(read3 <span class="sc">+</span> math3) <span class="sc">~</span> star3, <span class="at">data =</span> STAR)</span></code></pre></div>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain coefficient matrix using robust standard errors</span></span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(fmk, <span class="at">vcov =</span> vcovHC, <span class="at">type=</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb313-3"><a href="#cb313-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb313-4"><a href="#cb313-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb313-5"><a href="#cb313-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb313-6"><a href="#cb313-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                    Estimate Std. Error  t value  Pr(&gt;|t|)    </span></span>
<span id="cb313-7"><a href="#cb313-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)       918.04289    1.63339 562.0473 &lt; 2.2e-16 ***</span></span>
<span id="cb313-8"><a href="#cb313-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; starksmall         13.89899    2.45409   5.6636 1.554e-08 ***</span></span>
<span id="cb313-9"><a href="#cb313-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; starkregular+aide   0.31394    2.27098   0.1382    0.8901    </span></span>
<span id="cb313-10"><a href="#cb313-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb313-11"><a href="#cb313-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb313-12"><a href="#cb313-12" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(fm1, <span class="at">vcov =</span> vcovHC, <span class="at">type=</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb313-13"><a href="#cb313-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb313-14"><a href="#cb313-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb313-15"><a href="#cb313-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb313-16"><a href="#cb313-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                    Estimate Std. Error  t value  Pr(&gt;|t|)    </span></span>
<span id="cb313-17"><a href="#cb313-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)       1039.3926     1.7846 582.4321 &lt; 2.2e-16 ***</span></span>
<span id="cb313-18"><a href="#cb313-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; star1small          29.7808     2.8311  10.5190 &lt; 2.2e-16 ***</span></span>
<span id="cb313-19"><a href="#cb313-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; star1regular+aide   11.9587     2.6520   4.5093  6.62e-06 ***</span></span>
<span id="cb313-20"><a href="#cb313-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb313-21"><a href="#cb313-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb313-22"><a href="#cb313-22" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(fm2, <span class="at">vcov =</span> vcovHC, <span class="at">type=</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb313-23"><a href="#cb313-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb313-24"><a href="#cb313-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb313-25"><a href="#cb313-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb313-26"><a href="#cb313-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                    Estimate Std. Error  t value  Pr(&gt;|t|)    </span></span>
<span id="cb313-27"><a href="#cb313-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)       1157.8066     1.8151 637.8820 &lt; 2.2e-16 ***</span></span>
<span id="cb313-28"><a href="#cb313-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; star2small          19.3944     2.7117   7.1522  9.55e-13 ***</span></span>
<span id="cb313-29"><a href="#cb313-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; star2regular+aide    3.4791     2.5447   1.3672    0.1716    </span></span>
<span id="cb313-30"><a href="#cb313-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb313-31"><a href="#cb313-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb313-32"><a href="#cb313-32" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(fm3, <span class="at">vcov =</span> vcovHC, <span class="at">type=</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb313-33"><a href="#cb313-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb313-34"><a href="#cb313-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb313-35"><a href="#cb313-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb313-36"><a href="#cb313-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     Estimate Std. Error  t value  Pr(&gt;|t|)    </span></span>
<span id="cb313-37"><a href="#cb313-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)       1228.50636    1.68001 731.2483 &lt; 2.2e-16 ***</span></span>
<span id="cb313-38"><a href="#cb313-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; star3small          15.58660    2.39604   6.5051 8.393e-11 ***</span></span>
<span id="cb313-39"><a href="#cb313-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; star3regular+aide   -0.29094    2.27271  -0.1280    0.8981    </span></span>
<span id="cb313-40"><a href="#cb313-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb313-41"><a href="#cb313-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>We gather the results and present them in a table using <tt>stargazer()</tt>.</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute robust standard errors for each model and gather them in a list</span></span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a>rob_se_1 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(fmk, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(fm1, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(fm2, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb314-5"><a href="#cb314-5" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(fm2, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))))</span></code></pre></div>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(fmk,fm1,fm2,fm3,</span>
<span id="cb315-4"><a href="#cb315-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Project STAR: Differences Estimates&quot;</span>,</span>
<span id="cb315-5"><a href="#cb315-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">header =</span> <span class="cn">FALSE</span>, </span>
<span id="cb315-6"><a href="#cb315-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>,</span>
<span id="cb315-7"><a href="#cb315-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">model.numbers =</span> F,</span>
<span id="cb315-8"><a href="#cb315-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">omit.table.layout =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb315-9"><a href="#cb315-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">3</span>, </span>
<span id="cb315-10"><a href="#cb315-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">column.labels =</span> <span class="fu">c</span>(<span class="st">&quot;K&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>),</span>
<span id="cb315-11"><a href="#cb315-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">dep.var.caption  =</span> <span class="st">&quot;Dependent Variable: Grade&quot;</span>,</span>
<span id="cb315-12"><a href="#cb315-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">dep.var.labels.include =</span> <span class="cn">FALSE</span>,</span>
<span id="cb315-13"><a href="#cb315-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> rob_se_1)</span></code></pre></div>



<table style="text-align:center"><tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"></td><td colspan="4">Dependent Variable: Grade</td></tr>
<tr><td></td><td colspan="4" style="border-bottom: 1px solid black"></td></tr>
<tr><td style="text-align:left"></td><td>K</td><td>1</td><td>2</td><td>3</td></tr>
<tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">starksmall</td><td>13.90<sup>***</sup></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td>(2.45)</td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">starkregular+aide</td><td>0.31</td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td>(2.27)</td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">star1small</td><td></td><td>29.78<sup>***</sup></td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.83)</td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">star1regular+aide</td><td></td><td>11.96<sup>***</sup></td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.65)</td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">star2small</td><td></td><td></td><td>19.39<sup>***</sup></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td>(2.71)</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">star2regular+aide</td><td></td><td></td><td>3.48</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td>(2.54)</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">star3small</td><td></td><td></td><td></td><td>15.59</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">star3regular+aide</td><td></td><td></td><td></td><td>-0.29</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">Constant</td><td>918.04<sup>***</sup></td><td>1,039.39<sup>***</sup></td><td>1,157.81<sup>***</sup></td><td>1,228.51<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(1.63)</td><td>(1.78)</td><td>(1.82)</td><td>(1.82)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">Observations</td><td>5,786</td><td>6,379</td><td>6,049</td><td>5,967</td></tr>
<tr><td style="text-align:left">R<sup>2</sup></td><td>0.01</td><td>0.02</td><td>0.01</td><td>0.01</td></tr>
<tr><td style="text-align:left">Adjusted R<sup>2</sup></td><td>0.01</td><td>0.02</td><td>0.01</td><td>0.01</td></tr>
<tr><td style="text-align:left">Residual Std. Error</td><td>73.49 (df = 5783)</td><td>90.50 (df = 6376)</td><td>83.69 (df = 6046)</td><td>72.91 (df = 5964)</td></tr>
<tr><td style="text-align:left">F Statistic</td><td>21.26<sup>***</sup> (df = 2; 5783)</td><td>56.34<sup>***</sup> (df = 2; 6376)</td><td>28.71<sup>***</sup> (df = 2; 6046)</td><td>30.25<sup>***</sup> (df = 2; 5964)</td></tr>
<tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr></table>
<caption><p style='text-align:center'>(#tab:psde) Project STAR - Differences Estimates</p></caption>


<p>The estimates presented in Table @ref(tab:psde) suggest that the class size reduction improves student performance. Except for grade 1, the estimates of the coefficient on <span class="math inline">\(SmallClass\)</span> are roughly of the same magnitude (the estimates lie between 13.90 and 19.39 points) and they are statistically significant at <span class="math inline">\(1\%\)</span>. Furthermore, a teaching aide has little, possibly zero, effect on the performance of the students.</p>
<p>Following the book, we augment the regression model @ref(eq:starpopreg) by different sets of regressors for two reasons:</p>
<ol style="list-style-type: decimal">
<li>If the additional regressors explain some of the observed variation in the dependent variable, we obtain more efficient estimates of the coefficients of interest.</li>
<li>If the treatment is not received at random due to failures to follow the treatment protocol (see Chapter 13.3 of the book), the estimates obtained using @ref(eq:starpopreg) may be biased. Adding additional regressors may solve or mitigate this problem.</li>
</ol>
<p>In particular, we consider the following student and teacher characteristics</p>
<ul>
<li><span class="math inline">\(experience\)</span> — Teacher’s years of experience</li>
<li><span class="math inline">\(boy\)</span> — Student is a boy (dummy)</li>
<li><span class="math inline">\(lunch\)</span> — Free lunch eligibility (dummy)</li>
<li><span class="math inline">\(black\)</span> — Student is African-American (dummy)</li>
<li><span class="math inline">\(race\)</span> — Student’s race is other than black or white (dummy)</li>
<li><span class="math inline">\(\text{schoolid}\)</span> — School indicator variables</li>
</ul>
<p>in the four population regression specifications
<span class="math display">\[\begin{align}
Y_i =&amp; \beta_0 + \beta_1 SmallClass_i + \beta_2 RegAide_i + u_i, (\#eq:augstarpopreg1) \\
Y_i =&amp; \beta_0 + \beta_1 SmallClass_i + \beta_2 RegAide_i + \beta_3 experience_i + u_i, (\#eq:augstarpopreg2) \\
Y_i =&amp; \beta_0 + \beta_1 SmallClass_i + \beta_2 RegAide_i + \beta_3 experience_i + schoolid + u_i, (\#eq:augstarpopreg3)
\end{align}\]</span>
and
<span class="math display">\[\begin{align}
Y_i =&amp; \beta_0 + \beta_1 SmallClass_i + \beta_2 RegAide_i + \beta_3 experience_i + \beta_4 boy + \beta_5 lunch \\
&amp; + \beta_6 black + \beta_7 race + schoolid + u_i. (\#eq:augstarpopreg4)
\end{align}\]</span></p>
<p>Prior to estimation, we perform some subsetting and data wrangling using functions from the packages <tt>dplyr</tt> and <tt>tidyr</tt>. These are both part of <tt>tidyverse</tt>, a collection of <tt>R</tt> packages designed for data science and handling big datasets (see the <a href="https://www.tidyverse.org/">official site</a> for more on <tt>tidyverse</tt> packages). The functions <tt>%&gt;%</tt>, <tt>transmute()</tt> and <tt>mutate()</tt> are sufficient for us here:</p>
<ul>
<li><tt>%&gt;%</tt> allows to chain function calls.</li>
<li><tt>transmute()</tt> allows to subset the data set by naming the variables to be kept.</li>
<li><tt>mutate()</tt> is convenient for adding new variables based on existing ones while preserving the latter.</li>
</ul>
<p>The regression models @ref(eq:augstarpopreg1) to @ref(eq:augstarpopreg4) require the variables <tt>gender</tt>, <tt>ethnicity</tt>, <tt>stark</tt>, <tt>readk</tt>, <tt>mathk</tt>, <tt>lunchk</tt>, <tt>experiencek</tt> and <tt>schoolidk</tt>. After dropping the remaining variables using <tt>transmute()</tt>, we use <tt>mutate()</tt> to add three additional binary variables which are derivatives of existing ones: <tt>black</tt>, <tt>race</tt> and <tt>boy</tt>. They are generated using logical statements within the function <tt>ifelse()</tt>.</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages &#39;dplyr&#39; and &#39;tidyr&#39; for data wrangling functionalities</span></span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb316-3"><a href="#cb316-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb316-4"><a href="#cb316-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-5"><a href="#cb316-5" aria-hidden="true" tabindex="-1"></a><span class="co"># generate subset with kindergarten data</span></span>
<span id="cb316-6"><a href="#cb316-6" aria-hidden="true" tabindex="-1"></a>STARK <span class="ot">&lt;-</span> STAR <span class="sc">%&gt;%</span> </span>
<span id="cb316-7"><a href="#cb316-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">transmute</span>(gender,</span>
<span id="cb316-8"><a href="#cb316-8" aria-hidden="true" tabindex="-1"></a>                ethnicity,</span>
<span id="cb316-9"><a href="#cb316-9" aria-hidden="true" tabindex="-1"></a>                stark,</span>
<span id="cb316-10"><a href="#cb316-10" aria-hidden="true" tabindex="-1"></a>                readk,</span>
<span id="cb316-11"><a href="#cb316-11" aria-hidden="true" tabindex="-1"></a>                mathk,</span>
<span id="cb316-12"><a href="#cb316-12" aria-hidden="true" tabindex="-1"></a>                lunchk,</span>
<span id="cb316-13"><a href="#cb316-13" aria-hidden="true" tabindex="-1"></a>                experiencek,</span>
<span id="cb316-14"><a href="#cb316-14" aria-hidden="true" tabindex="-1"></a>                schoolidk) <span class="sc">%&gt;%</span> </span>
<span id="cb316-15"><a href="#cb316-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">black =</span> <span class="fu">ifelse</span>(ethnicity <span class="sc">==</span> <span class="st">&quot;afam&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb316-16"><a href="#cb316-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">race =</span> <span class="fu">ifelse</span>(ethnicity <span class="sc">==</span> <span class="st">&quot;afam&quot;</span> <span class="sc">|</span> ethnicity <span class="sc">==</span> <span class="st">&quot;cauc&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb316-17"><a href="#cb316-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">boy =</span> <span class="fu">ifelse</span>(gender <span class="sc">==</span> <span class="st">&quot;male&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span></code></pre></div>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the models </span></span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a>gradeK1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">I</span>(mathk <span class="sc">+</span> readk) <span class="sc">~</span> stark <span class="sc">+</span> experiencek, </span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> STARK)</span>
<span id="cb317-4"><a href="#cb317-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-5"><a href="#cb317-5" aria-hidden="true" tabindex="-1"></a>gradeK2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">I</span>(mathk <span class="sc">+</span> readk) <span class="sc">~</span> stark <span class="sc">+</span> experiencek <span class="sc">+</span> schoolidk, </span>
<span id="cb317-6"><a href="#cb317-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> STARK)</span>
<span id="cb317-7"><a href="#cb317-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-8"><a href="#cb317-8" aria-hidden="true" tabindex="-1"></a>gradeK3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">I</span>(mathk <span class="sc">+</span> readk) <span class="sc">~</span> stark <span class="sc">+</span> experiencek <span class="sc">+</span> boy <span class="sc">+</span> lunchk </span>
<span id="cb317-9"><a href="#cb317-9" aria-hidden="true" tabindex="-1"></a>              <span class="sc">+</span> black <span class="sc">+</span> race <span class="sc">+</span> schoolidk, </span>
<span id="cb317-10"><a href="#cb317-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> STARK)</span></code></pre></div>
<p>For brevity, we exclude the coefficients for the indicator dummies in <tt>coeftest()</tt>’s output by subsetting the matrices.</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain robust inference on the significance of coefficients</span></span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(gradeK1, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb318-3"><a href="#cb318-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb318-4"><a href="#cb318-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb318-5"><a href="#cb318-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb318-6"><a href="#cb318-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                    Estimate Std. Error  t value  Pr(&gt;|t|)    </span></span>
<span id="cb318-7"><a href="#cb318-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)       904.72124    2.22235 407.1020 &lt; 2.2e-16 ***</span></span>
<span id="cb318-8"><a href="#cb318-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; starksmall         14.00613    2.44704   5.7237 1.095e-08 ***</span></span>
<span id="cb318-9"><a href="#cb318-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; starkregular+aide  -0.60058    2.25430  -0.2664    0.7899    </span></span>
<span id="cb318-10"><a href="#cb318-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; experiencek         1.46903    0.16929   8.6778 &lt; 2.2e-16 ***</span></span>
<span id="cb318-11"><a href="#cb318-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb318-12"><a href="#cb318-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb318-13"><a href="#cb318-13" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(gradeK2, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, ]</span>
<span id="cb318-14"><a href="#cb318-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      Estimate Std. Error     t value     Pr(&gt;|t|)</span></span>
<span id="cb318-15"><a href="#cb318-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)       925.6748750  7.6527218 120.9602155 0.000000e+00</span></span>
<span id="cb318-16"><a href="#cb318-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; starksmall         15.9330822  2.2411750   7.1092540 1.310324e-12</span></span>
<span id="cb318-17"><a href="#cb318-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; starkregular+aide   1.2151960  2.0353415   0.5970477 5.504993e-01</span></span>
<span id="cb318-18"><a href="#cb318-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; experiencek         0.7431059  0.1697619   4.3773429 1.222880e-05</span></span>
<span id="cb318-19"><a href="#cb318-19" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(gradeK3, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, ]</span>
<span id="cb318-20"><a href="#cb318-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      Estimate Std. Error     t value     Pr(&gt;|t|)</span></span>
<span id="cb318-21"><a href="#cb318-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)       937.6831330 14.3726687  65.2407117 0.000000e+00</span></span>
<span id="cb318-22"><a href="#cb318-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; starksmall         15.8900507  2.1551817   7.3729516 1.908960e-13</span></span>
<span id="cb318-23"><a href="#cb318-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; starkregular+aide   1.7869378  1.9614592   0.9110247 3.623211e-01</span></span>
<span id="cb318-24"><a href="#cb318-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; experiencek         0.6627251  0.1659298   3.9940097 6.578846e-05</span></span>
<span id="cb318-25"><a href="#cb318-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; boy               -12.0905123  1.6726331  -7.2284306 5.533119e-13</span></span>
<span id="cb318-26"><a href="#cb318-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lunchkfree        -34.7033021  1.9870366 -17.4648529 1.437931e-66</span></span>
<span id="cb318-27"><a href="#cb318-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; black             -25.4305130  3.4986918  -7.2685776 4.125252e-13</span></span></code></pre></div>
<p>We now use <tt>stargazer()</tt> to gather all relevant information in a structured table.</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute robust standard errors for each model and gather them in a list</span></span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true" tabindex="-1"></a>rob_se_2 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(fmk, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb319-3"><a href="#cb319-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(gradeK1, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb319-4"><a href="#cb319-4" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(gradeK2, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb319-5"><a href="#cb319-5" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(gradeK3, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))))</span></code></pre></div>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(fmk, fm1, fm2, fm3,</span>
<span id="cb320-2"><a href="#cb320-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Project STAR - Differences Estimates with </span></span>
<span id="cb320-3"><a href="#cb320-3" aria-hidden="true" tabindex="-1"></a><span class="st">  Additional Regressors for Kindergarten&quot;</span>,</span>
<span id="cb320-4"><a href="#cb320-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">header =</span> <span class="cn">FALSE</span>, </span>
<span id="cb320-5"><a href="#cb320-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>,</span>
<span id="cb320-6"><a href="#cb320-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">model.numbers =</span> F,</span>
<span id="cb320-7"><a href="#cb320-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">omit.table.layout =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb320-8"><a href="#cb320-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">3</span>, </span>
<span id="cb320-9"><a href="#cb320-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">column.labels =</span> <span class="fu">c</span>(<span class="st">&quot;(1)&quot;</span>, <span class="st">&quot;(2)&quot;</span>, <span class="st">&quot;(3)&quot;</span>, <span class="st">&quot;(4)&quot;</span>),</span>
<span id="cb320-10"><a href="#cb320-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">dep.var.caption  =</span> <span class="st">&quot;Dependent Variable: Test Score in Kindergarten&quot;</span>,</span>
<span id="cb320-11"><a href="#cb320-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">dep.var.labels.include =</span> <span class="cn">FALSE</span>,</span>
<span id="cb320-12"><a href="#cb320-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> rob_se_2) </span></code></pre></div>



<table style="text-align:center"><tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"></td><td colspan="4">Dependent Variable: Test Score in Kindergarten</td></tr>
<tr><td></td><td colspan="4" style="border-bottom: 1px solid black"></td></tr>
<tr><td style="text-align:left"></td><td>(1)</td><td>(2)</td><td>(3)</td><td>(4)</td></tr>
<tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">starksmall</td><td>13.899<sup>***</sup></td><td>14.006<sup>***</sup></td><td>15.933<sup>***</sup></td><td>15.890<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(2.454)</td><td>(2.447)</td><td>(2.241)</td><td>(2.155)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">starkregular+aide</td><td>0.314</td><td>-0.601</td><td>1.215</td><td>1.787</td></tr>
<tr><td style="text-align:left"></td><td>(2.271)</td><td>(2.254)</td><td>(2.035)</td><td>(1.961)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">experiencek</td><td></td><td>1.469<sup>***</sup></td><td>0.743<sup>***</sup></td><td>0.663<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(0.169)</td><td>(0.170)</td><td>(0.166)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">boy</td><td></td><td></td><td></td><td>-12.091<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td>(1.673)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">lunchkfree</td><td></td><td></td><td></td><td>-34.703<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td>(1.987)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">black</td><td></td><td></td><td></td><td>-25.431<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td>(3.499)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">race</td><td></td><td></td><td></td><td>8.501</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td>(12.520)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">Constant</td><td>918.043<sup>***</sup></td><td>904.721<sup>***</sup></td><td>925.675<sup>***</sup></td><td>937.683<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(1.633)</td><td>(2.222)</td><td>(7.653)</td><td>(14.373)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">School indicators?</td><td>no</td><td>no</td><td>yes</td><td>yes</td></tr>
<tr><td style="text-align:left">Observations</td><td>5,786</td><td>5,766</td><td>5,766</td><td>5,748</td></tr>
<tr><td style="text-align:left">R<sup>2</sup></td><td>0.007</td><td>0.020</td><td>0.234</td><td>0.291</td></tr>
<tr><td style="text-align:left">Adjusted R<sup>2</sup></td><td>0.007</td><td>0.020</td><td>0.223</td><td>0.281</td></tr>
<tr><td style="text-align:left">Residual Std. Error</td><td>73.490 (df = 5783)</td><td>73.085 (df = 5762)</td><td>65.075 (df = 5684)</td><td>62.663 (df = 5662)</td></tr>
<tr><td style="text-align:left">F Statistic</td><td>21.263<sup>***</sup> (df = 2; 5783)</td><td>39.861<sup>***</sup> (df = 3; 5762)</td><td>21.413<sup>***</sup> (df = 81; 5684)</td><td>27.364<sup>***</sup> (df = 85; 5662)</td></tr>
<tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr></table>
<caption><p style='text-align:center'>(#tab:psdewarfk) Project STAR - Differences Estimates with Additional Regressors for Kindergarten</p></caption>


<p>The results in column (1) of Table @ref(tab:psdewarfk) just a repeat the results obtained for @ref(eq:starpopreg). Columns (2) to (4) reveal that adding student characteristics and school fixed effects does not lead to substantially different estimates of the treatment effects. This result makes it more plausible that the estimates of the effects obtained using model @ref(eq:starpopreg) do not suffer from failure of random assignment. There is some decrease in the standard errors and some increase in <span class="math inline">\(\bar{R}^2\)</span>, implying that the estimates are more precise.</p>
<p>Because teachers were randomly assigned to classes, inclusion of school fixed effect allows us to estimate the causal effect of a teacher’s experience on test scores of students in kindergarten. Regression (3) predicts the average effect of 10 years experience on test scores to be <span class="math inline">\(10\cdot 0.74=7.4\)</span> points. Be aware that the other estimates on student characteristics in regression (4) <em>do not</em> have causal interpretation due to nonrandom assignment (see Chapter 13.3 of the book for a detailed discussion).</p>
<p>Are the estimated effects presented in Table @ref(tab:psdewarfk) large or small in a practical sense? Let us translate the predicted changes in test scores to units of standard deviation in order to allow for a comparison (see Section @ref(etsacs) for a similar argument).</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the sample standard deviations of test scores</span></span>
<span id="cb321-2"><a href="#cb321-2" aria-hidden="true" tabindex="-1"></a>SSD <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;K&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">na.omit</span>(STAR<span class="sc">$</span>readk <span class="sc">+</span> STAR<span class="sc">$</span>mathk)),</span>
<span id="cb321-3"><a href="#cb321-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">na.omit</span>(STAR<span class="sc">$</span>read1 <span class="sc">+</span> STAR<span class="sc">$</span>math1)),</span>
<span id="cb321-4"><a href="#cb321-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">na.omit</span>(STAR<span class="sc">$</span>read2 <span class="sc">+</span> STAR<span class="sc">$</span>math2)),</span>
<span id="cb321-5"><a href="#cb321-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;3&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">na.omit</span>(STAR<span class="sc">$</span>read3 <span class="sc">+</span> STAR<span class="sc">$</span>math3)))</span>
<span id="cb321-6"><a href="#cb321-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-7"><a href="#cb321-7" aria-hidden="true" tabindex="-1"></a><span class="co"># translate the effects of small classes to standard deviations</span></span>
<span id="cb321-8"><a href="#cb321-8" aria-hidden="true" tabindex="-1"></a>Small <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;K&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">coef</span>(fmk)[<span class="dv">2</span>]<span class="sc">/</span>SSD[<span class="dv">1</span>]),</span>
<span id="cb321-9"><a href="#cb321-9" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">coef</span>(fm1)[<span class="dv">2</span>]<span class="sc">/</span>SSD[<span class="dv">2</span>]),</span>
<span id="cb321-10"><a href="#cb321-10" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">coef</span>(fm2)[<span class="dv">2</span>]<span class="sc">/</span>SSD[<span class="dv">3</span>]),</span>
<span id="cb321-11"><a href="#cb321-11" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;3&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">coef</span>(fm3)[<span class="dv">2</span>]<span class="sc">/</span>SSD[<span class="dv">4</span>]))</span>
<span id="cb321-12"><a href="#cb321-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-13"><a href="#cb321-13" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust the standard errors</span></span>
<span id="cb321-14"><a href="#cb321-14" aria-hidden="true" tabindex="-1"></a>SmallSE <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;K&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(rob_se_1[[<span class="dv">1</span>]][<span class="dv">2</span>]<span class="sc">/</span>SSD[<span class="dv">1</span>]),</span>
<span id="cb321-15"><a href="#cb321-15" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(rob_se_1[[<span class="dv">2</span>]][<span class="dv">2</span>]<span class="sc">/</span>SSD[<span class="dv">2</span>]),</span>
<span id="cb321-16"><a href="#cb321-16" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(rob_se_1[[<span class="dv">3</span>]][<span class="dv">2</span>]<span class="sc">/</span>SSD[<span class="dv">3</span>]),</span>
<span id="cb321-17"><a href="#cb321-17" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;3&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(rob_se_1[[<span class="dv">4</span>]][<span class="dv">2</span>]<span class="sc">/</span>SSD[<span class="dv">4</span>]))</span>
<span id="cb321-18"><a href="#cb321-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-19"><a href="#cb321-19" aria-hidden="true" tabindex="-1"></a><span class="co"># translate the effects of regular classes with aide to standard deviations</span></span>
<span id="cb321-20"><a href="#cb321-20" aria-hidden="true" tabindex="-1"></a>RegAide<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;K&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">coef</span>(fmk)[<span class="dv">3</span>]<span class="sc">/</span>SSD[<span class="dv">1</span>]),</span>
<span id="cb321-21"><a href="#cb321-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">coef</span>(fm1)[<span class="dv">3</span>]<span class="sc">/</span>SSD[<span class="dv">2</span>]),</span>
<span id="cb321-22"><a href="#cb321-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">coef</span>(fm2)[<span class="dv">3</span>]<span class="sc">/</span>SSD[<span class="dv">3</span>]),</span>
<span id="cb321-23"><a href="#cb321-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;3&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">coef</span>(fm3)[<span class="dv">3</span>]<span class="sc">/</span>SSD[<span class="dv">4</span>]))</span>
<span id="cb321-24"><a href="#cb321-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-25"><a href="#cb321-25" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust the standard errors</span></span>
<span id="cb321-26"><a href="#cb321-26" aria-hidden="true" tabindex="-1"></a>RegAideSE <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;K&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(rob_se_1[[<span class="dv">1</span>]][<span class="dv">3</span>]<span class="sc">/</span>SSD[<span class="dv">1</span>]),</span>
<span id="cb321-27"><a href="#cb321-27" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(rob_se_1[[<span class="dv">2</span>]][<span class="dv">3</span>]<span class="sc">/</span>SSD[<span class="dv">2</span>]),</span>
<span id="cb321-28"><a href="#cb321-28" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(rob_se_1[[<span class="dv">3</span>]][<span class="dv">3</span>]<span class="sc">/</span>SSD[<span class="dv">3</span>]),</span>
<span id="cb321-29"><a href="#cb321-29" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;3&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(rob_se_1[[<span class="dv">4</span>]][<span class="dv">3</span>]<span class="sc">/</span>SSD[<span class="dv">4</span>]))</span>
<span id="cb321-30"><a href="#cb321-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-31"><a href="#cb321-31" aria-hidden="true" tabindex="-1"></a><span class="co"># gather the results in a data.frame and round</span></span>
<span id="cb321-32"><a href="#cb321-32" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">round</span>(<span class="fu">data.frame</span>(</span>
<span id="cb321-33"><a href="#cb321-33" aria-hidden="true" tabindex="-1"></a>                        Small, SmallSE, RegAide, RegAideSE, SSD),</span>
<span id="cb321-34"><a href="#cb321-34" aria-hidden="true" tabindex="-1"></a>                        <span class="at">digits =</span>  <span class="dv">2</span>))</span></code></pre></div>
<p>It is fairly easy to turn the <tt>data.frame</tt> <tt>df</tt> into a table.</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate a simple table using stargazer</span></span>
<span id="cb322-2"><a href="#cb322-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(df,</span>
<span id="cb322-3"><a href="#cb322-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">&quot;Estimated Class Size Effects </span></span>
<span id="cb322-4"><a href="#cb322-4" aria-hidden="true" tabindex="-1"></a><span class="st">          (in Units of Standard Deviations)&quot;</span>,</span>
<span id="cb322-5"><a href="#cb322-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">&quot;html&quot;</span>, </span>
<span id="cb322-6"><a href="#cb322-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">summary =</span> <span class="cn">FALSE</span>,</span>
<span id="cb322-7"><a href="#cb322-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">header =</span> <span class="cn">FALSE</span></span>
<span id="cb322-8"><a href="#cb322-8" aria-hidden="true" tabindex="-1"></a>          )</span></code></pre></div>



<table style="text-align:center"><tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"></td><td>K</td><td>1</td><td>2</td><td>3</td></tr>
<tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">Small</td><td>0.190</td><td>0.330</td><td>0.230</td><td>0.210</td></tr>
<tr><td style="text-align:left">SmallSE</td><td>0.030</td><td>0.030</td><td>0.030</td><td>0.040</td></tr>
<tr><td style="text-align:left">RegAide</td><td>0</td><td>0.130</td><td>0.040</td><td>0</td></tr>
<tr><td style="text-align:left">RegAideSE</td><td>0.030</td><td>0.030</td><td>0.030</td><td>0.030</td></tr>
<tr><td style="text-align:left">SSD</td><td>73.750</td><td>91.280</td><td>84.080</td><td>73.270</td></tr>
<tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr></table>
<caption><p style='text-align:center'>(#tab:ecse) Estimated Class Size Effects 
          (in Units of Standard Deviations)</p></caption>


<p>The estimated effect of a small classes is largest for grade 1. As pointed out in the book, this is probably because students in the control group for grade 1 did poorly on the test for some unknown reason or simply due to random variation. The difference between the estimated effect of being in a small class and being in a regular classes with an aide is roughly 0.2 standard deviations for all grades. This leads to the conclusion that the effect of being in a regular sized class with an aide is zero and the effect of being in a small class is roughly the same for all grades.</p>
<p>The remainder of Chapter 13.3 in the book discusses to what extent these experimental estimates are comparable with observational estimates obtained using data on school districts in California and Massachusetts in Chapter @ref(asbomr). It turns out that the estimates are indeed very similar. Please refer to the aforementioned section in the book for a more detailed discussion.</p>
</div>
</div>
<div id="qe" class="section level2 hasAnchor" number="13.4">
<h2 class="hasAnchor"><span class="header-section-number">13.4</span> Quasi Experiments<a href="#qe" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In quasi-experiments, “as if” randomness is exploited to use methods similar to those that have been discussed in the previous chapter. There are two types of quasi-experiments:<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a></p>
<ol style="list-style-type: decimal">
<li><p>Random variations in individual circumstances allow to view the treatment “as if” it was randomly determined.</p></li>
<li><p>The treatment is only partially determined by “as if” random variation.</p></li>
</ol>
<p>The former allows to estimate the effect using either model @ref(eq:diffestwar), i.e., the <em>difference estimator with additional regressors</em>, or, if there is doubt that the “as if” randomness does not entirely ensure that there are no systematic differences between control and treatment group, using the <em>differences-in-differences</em> (DID) estimator. In the latter case, an IV approach for estimation of a model like @ref(eq:diffestwar) which uses the source of “as if” randomness in treatment assignment as the instrument may be applied.</p>
<p>Some more advanced techniques that are helpful in settings where the treatment assignment is (partially) determined by a threshold in a so-called running variable are <em>sharp regression discontinuity design</em> (RDD) and <em>fuzzy regression discontinuity design</em> (FRDD).</p>
<p>We briefly review these techniques and, since the book does not provide any empirical examples in this section, we will use our own simulated data in a minimal example to discuss how DID, RDD and FRDD can be applied in <tt>R</tt>.</p>
<div id="the-differences-in-differences-estimator" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">The Differences-in-Differences Estimator<a href="#the-differences-in-differences-estimator" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In quasi-experiments the source of “as if” randomness in treatment assignment can often not entirely prevent systematic differences between control and treatment groups. This problem was encountered by <span class="citation">Card and Krueger (<a href="#ref-card1994" role="doc-biblioref">1994</a>)</span> who use geography as the “as if” random treatment assignment to study the effect on employment in fast-food restaurants caused by an increase in the state minimum wage in New Jersey in the year of 1992. Their idea was to use the fact that the increase in minimum wage applied to employees in New Jersey (treatment group) but not to those living in neighboring Pennsylvania (control group).</p>
<p>It is quite conceivable that such a wage hike is not correlated with other determinants of employment. However, there still might be some state-specific differences and thus differences between control and treatment group. This would render the <em>differences estimator</em> biased and inconsistent. <span class="citation">Card and Krueger (<a href="#ref-card1994" role="doc-biblioref">1994</a>)</span> solved this by using a DID estimator: they collected data in February 1992 (before the treatment) and November 1992 (after the treatment) for the same restaurants and estimated the effect of the wage hike by analyzing differences in the differences in employment for New Jersey and Pennsylvania before and after the increase.<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a> The DID estimator is</p>
<p><span class="math display">\[\begin{align}
  \widehat{\beta}_1^{\text{diffs-in-diffs}} =&amp; \, (\overline{Y}^{\text{treatment,after}} - \overline{Y}^{\text{treatment,before}}) - (\overline{Y}^{\text{control,after}} - \overline{Y}^{\text{control,before}}) \\
  =&amp; \Delta \overline{Y}^{\text{treatment}} - \Delta \overline{Y}^{\text{control}} (\#eq:DID)
\end{align}\]</span></p>
<p>with</p>
<ul>
<li><p><span class="math inline">\(\overline{Y}^{\text{treatment,before}}\)</span> - the sample average in the treatment group before the treatment</p></li>
<li><p><span class="math inline">\(\overline{Y}^{\text{treatment,after}}\)</span> - the sample average in the treatment group after the treatment</p></li>
<li><p><span class="math inline">\(\overline{Y}^{\text{treatment,before}}\)</span> - the sample average in the control group before the treatment</p></li>
<li><p><span class="math inline">\(\overline{Y}^{\text{treatment,after}}\)</span> - the sample average in the control group after the treatment.</p></li>
</ul>
<p>We now use <tt>R</tt> to reproduce Figure 13.1 of the book.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize plot and add control group</span></span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">8</span>), </span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;p&quot;</span>,</span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">12</span>),</span>
<span id="cb323-5"><a href="#cb323-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">1.3</span>),</span>
<span id="cb323-6"><a href="#cb323-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;The Differences-in-Differences Estimator&quot;</span>,</span>
<span id="cb323-7"><a href="#cb323-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Period&quot;</span>,</span>
<span id="cb323-8"><a href="#cb323-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>,</span>
<span id="cb323-9"><a href="#cb323-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb323-10"><a href="#cb323-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb323-11"><a href="#cb323-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb323-12"><a href="#cb323-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">yaxt =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb323-13"><a href="#cb323-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-14"><a href="#cb323-14" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;before&quot;</span>, <span class="st">&quot;after&quot;</span>))</span>
<span id="cb323-15"><a href="#cb323-15" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">13</span>))</span>
<span id="cb323-16"><a href="#cb323-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-17"><a href="#cb323-17" aria-hidden="true" tabindex="-1"></a><span class="co"># add treatment group</span></span>
<span id="cb323-18"><a href="#cb323-18" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">11</span>), </span>
<span id="cb323-19"><a href="#cb323-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>,</span>
<span id="cb323-20"><a href="#cb323-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb323-21"><a href="#cb323-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-22"><a href="#cb323-22" aria-hidden="true" tabindex="-1"></a><span class="co"># add line segments</span></span>
<span id="cb323-23"><a href="#cb323-23" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">11</span>), <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb323-24"><a href="#cb323-24" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">8</span>), <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>)</span>
<span id="cb323-25"><a href="#cb323-25" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">9</span>), <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb323-26"><a href="#cb323-26" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">11</span>), <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb323-27"><a href="#cb323-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-28"><a href="#cb323-28" aria-hidden="true" tabindex="-1"></a><span class="co"># add annotations</span></span>
<span id="cb323-29"><a href="#cb323-29" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="fu">expression</span>(<span class="fu">hat</span>(beta)[<span class="dv">1</span>]<span class="sc">^</span>{DID}), <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">pos =</span> <span class="dv">4</span>)</span>
<span id="cb323-30"><a href="#cb323-30" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">0</span>, <span class="fl">5.5</span>, <span class="st">&quot;s. mean control&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span> , <span class="at">pos =</span> <span class="dv">4</span>)</span>
<span id="cb323-31"><a href="#cb323-31" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">0</span>, <span class="fl">6.8</span>, <span class="st">&quot;s. mean treatment&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span> , <span class="at">pos =</span> <span class="dv">4</span>)</span>
<span id="cb323-32"><a href="#cb323-32" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span>, <span class="fl">7.9</span>, <span class="st">&quot;s. mean control&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span> , <span class="at">pos =</span> <span class="dv">4</span>)</span>
<span id="cb323-33"><a href="#cb323-33" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span>, <span class="fl">11.1</span>, <span class="st">&quot;s. mean treatment&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span> , <span class="at">pos =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-549-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The DID estimator @ref(eq:DID) can also be written in regression notation: <span class="math inline">\(\widehat{\beta}_1^{\text{DID}}\)</span> is the OLS estimator of <span class="math inline">\(\beta_1\)</span> in
<span class="math display">\[\begin{align}
  \Delta Y_i = \beta_0 + \beta_1 X_i + u_i, (\#eq:did)
\end{align}\]</span>
where <span class="math inline">\(\Delta Y_i\)</span> denotes the difference in pre- and post-treatment outcomes of individual <span class="math inline">\(i\)</span> and <span class="math inline">\(X_i\)</span> is the treatment indicator.</p>
<p>Adding additional regressors that measure pre-treatment characteristics to @ref(eq:did) we obtain
<span class="math display">\[\begin{align}
  \Delta Y_i = \beta_0 + \beta_1 X_i + \beta_2 W_{1i} + \dots + \beta_{1+r} W_{ri} + u_i, (\#eq:didwar)
\end{align}\]</span>
the <em>difference-in-differences estimator</em> with additional regressors. The additional regressors may lead to a more precise estimate of <span class="math inline">\(\beta_1\)</span>.</p>
<p>We keep things simple and focus on estimation of the treatment effect using DID in the simplest case, that is a control and a treatment group observed for two time periods — one before and one after the treatment. In particular, we will see that there are three different ways to proceed.</p>
<p>First, we simulate pre- and post-treatment data using <tt>R</tt>.</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set sample size</span></span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb324-3"><a href="#cb324-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-4"><a href="#cb324-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define treatment effect</span></span>
<span id="cb324-5"><a href="#cb324-5" aria-hidden="true" tabindex="-1"></a>TEffect <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb324-6"><a href="#cb324-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-7"><a href="#cb324-7" aria-hidden="true" tabindex="-1"></a><span class="co"># generate treatment dummy</span></span>
<span id="cb324-8"><a href="#cb324-8" aria-hidden="true" tabindex="-1"></a>TDummy <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n<span class="sc">/</span><span class="dv">2</span>), <span class="fu">rep</span>(<span class="dv">1</span>, n<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb324-9"><a href="#cb324-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-10"><a href="#cb324-10" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate pre- and post-treatment values of the dependent variable</span></span>
<span id="cb324-11"><a href="#cb324-11" aria-hidden="true" tabindex="-1"></a>y_pre <span class="ot">&lt;-</span> <span class="dv">7</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb324-12"><a href="#cb324-12" aria-hidden="true" tabindex="-1"></a>y_pre[<span class="dv">1</span><span class="sc">:</span>n<span class="sc">/</span><span class="dv">2</span>] <span class="ot">&lt;-</span> y_pre[<span class="dv">1</span><span class="sc">:</span>n<span class="sc">/</span><span class="dv">2</span>] <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb324-13"><a href="#cb324-13" aria-hidden="true" tabindex="-1"></a>y_post <span class="ot">&lt;-</span> <span class="dv">7</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">+</span> TEffect <span class="sc">*</span> TDummy <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb324-14"><a href="#cb324-14" aria-hidden="true" tabindex="-1"></a>y_post[<span class="dv">1</span><span class="sc">:</span>n<span class="sc">/</span><span class="dv">2</span>] <span class="ot">&lt;-</span> y_post[<span class="dv">1</span><span class="sc">:</span>n<span class="sc">/</span><span class="dv">2</span>] <span class="sc">-</span> <span class="dv">1</span> </span></code></pre></div>
<p>Next plot the data. The function <tt>jitter()</tt> is used to add some artificial dispersion in the horizontal component of the points so that there is less overplotting. The function <tt>alpha()</tt> from the package <tt>scales</tt> allows to adjust the opacity of colors used in plots.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb325-2"><a href="#cb325-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-3"><a href="#cb325-3" aria-hidden="true" tabindex="-1"></a>pre <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(y_pre[TDummy<span class="sc">==</span><span class="dv">0</span>]))</span>
<span id="cb325-4"><a href="#cb325-4" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(y_pre[TDummy<span class="sc">==</span><span class="dv">0</span>]))</span>
<span id="cb325-5"><a href="#cb325-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-6"><a href="#cb325-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot control group in t=1</span></span>
<span id="cb325-7"><a href="#cb325-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">jitter</span>(pre, <span class="fl">0.6</span>), </span>
<span id="cb325-8"><a href="#cb325-8" aria-hidden="true" tabindex="-1"></a>     y_pre[TDummy <span class="sc">==</span> <span class="dv">0</span>], </span>
<span id="cb325-9"><a href="#cb325-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">16</span>), </span>
<span id="cb325-10"><a href="#cb325-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">&quot;steelblue&quot;</span>, <span class="fl">0.3</span>),</span>
<span id="cb325-11"><a href="#cb325-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, </span>
<span id="cb325-12"><a href="#cb325-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">1.5</span>),</span>
<span id="cb325-13"><a href="#cb325-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>,</span>
<span id="cb325-14"><a href="#cb325-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Period&quot;</span>,</span>
<span id="cb325-15"><a href="#cb325-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb325-16"><a href="#cb325-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Artificial Data for DID Estimation&quot;</span>)</span>
<span id="cb325-17"><a href="#cb325-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-18"><a href="#cb325-18" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;before&quot;</span>, <span class="st">&quot;after&quot;</span>))</span>
<span id="cb325-19"><a href="#cb325-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-20"><a href="#cb325-20" aria-hidden="true" tabindex="-1"></a><span class="co"># add treatment group in t=1</span></span>
<span id="cb325-21"><a href="#cb325-21" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">jitter</span>(pre, <span class="fl">0.6</span>), </span>
<span id="cb325-22"><a href="#cb325-22" aria-hidden="true" tabindex="-1"></a>       y_pre[TDummy <span class="sc">==</span> <span class="dv">1</span>], </span>
<span id="cb325-23"><a href="#cb325-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">&quot;darkred&quot;</span>, <span class="fl">0.3</span>), </span>
<span id="cb325-24"><a href="#cb325-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb325-25"><a href="#cb325-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-26"><a href="#cb325-26" aria-hidden="true" tabindex="-1"></a><span class="co"># add control group in t=2</span></span>
<span id="cb325-27"><a href="#cb325-27" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">jitter</span>(post, <span class="fl">0.6</span>),</span>
<span id="cb325-28"><a href="#cb325-28" aria-hidden="true" tabindex="-1"></a>       y_post[TDummy <span class="sc">==</span> <span class="dv">0</span>], </span>
<span id="cb325-29"><a href="#cb325-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">&quot;steelblue&quot;</span>, <span class="fl">0.5</span>),</span>
<span id="cb325-30"><a href="#cb325-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb325-31"><a href="#cb325-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-32"><a href="#cb325-32" aria-hidden="true" tabindex="-1"></a><span class="co"># add treatment group in t=2</span></span>
<span id="cb325-33"><a href="#cb325-33" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">jitter</span>(post, <span class="fl">0.6</span>), </span>
<span id="cb325-34"><a href="#cb325-34" aria-hidden="true" tabindex="-1"></a>       y_post[TDummy <span class="sc">==</span> <span class="dv">1</span>], </span>
<span id="cb325-35"><a href="#cb325-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">&quot;darkred&quot;</span>, <span class="fl">0.5</span>),</span>
<span id="cb325-36"><a href="#cb325-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-551-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Observations from both the control and treatment group have a higher mean after the treatment but that the increase is stronger for the treatment group. Using DID we may estimate how much of that difference is due to the treatment.</p>
<p>It is straightforward to compute the DID estimate in the fashion of @ref(eq:DID).</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the DID estimator for the treatment effect &#39;by hand&#39;</span></span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y_post[TDummy <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">mean</span>(y_pre[TDummy <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span> </span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mean</span>(y_post[TDummy <span class="sc">==</span> <span class="dv">0</span>]) <span class="sc">-</span> <span class="fu">mean</span>(y_pre[TDummy <span class="sc">==</span> <span class="dv">0</span>]))</span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3.960268</span></span></code></pre></div>
<p>Notice that the estimate is close to <span class="math inline">\(4\)</span>, the value chosen as the treatment effect <tt>TEffect</tt> above. Since @ref(eq:did) is a simple linear model, we may perform OLS estimation of this regression specification using <tt>lm()</tt>.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the DID estimator using a linear model</span></span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="fu">I</span>(y_post <span class="sc">-</span> y_pre) <span class="sc">~</span> TDummy)</span>
<span id="cb327-3"><a href="#cb327-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb327-4"><a href="#cb327-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb327-5"><a href="#cb327-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = I(y_post - y_pre) ~ TDummy)</span></span>
<span id="cb327-6"><a href="#cb327-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb327-7"><a href="#cb327-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb327-8"><a href="#cb327-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)       TDummy  </span></span>
<span id="cb327-9"><a href="#cb327-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       2.104        3.960</span></span></code></pre></div>
<p>We find that the estimates coincide. Furthermore, one can show that the DID estimate obtained by estimating specification @ref(eq:did) OLS is the same as the OLS estimate of <span class="math inline">\(\beta_{TE}\)</span> in
<span class="math display">\[\begin{align}
  Y_i =&amp; \beta_0 + \beta_1 D_i + \beta_2 Period_i + \beta_{TE} (Period_i \times D_i) + \varepsilon_i (\#eq:DIDint)
\end{align}\]</span>
where <span class="math inline">\(D_i\)</span> is the binary treatment indicator, <span class="math inline">\(Period_i\)</span> is a binary indicator for the after-treatment period and the <span class="math inline">\(Period_i \times D_i\)</span> is the interaction of both.</p>
<p>As for @ref(eq:did), estimation of @ref(eq:DIDint) using <tt>R</tt> is straightforward. See Chapter @ref(nrf) for a discussion of interaction terms.</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare data for DID regression using the interaction term </span></span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;Y&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(y_pre,y_post),</span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;Treatment&quot;</span> <span class="ot">=</span> TDummy, </span>
<span id="cb328-4"><a href="#cb328-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;Period&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;1&quot;</span>, n), <span class="fu">rep</span>(<span class="st">&quot;2&quot;</span>, n)))</span>
<span id="cb328-5"><a href="#cb328-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-6"><a href="#cb328-6" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model</span></span>
<span id="cb328-7"><a href="#cb328-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Y <span class="sc">~</span> Treatment <span class="sc">*</span> Period, <span class="at">data =</span> d)</span>
<span id="cb328-8"><a href="#cb328-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb328-9"><a href="#cb328-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb328-10"><a href="#cb328-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = Y ~ Treatment * Period, data = d)</span></span>
<span id="cb328-11"><a href="#cb328-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb328-12"><a href="#cb328-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb328-13"><a href="#cb328-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       (Intercept)          Treatment            Period2  Treatment:Period2  </span></span>
<span id="cb328-14"><a href="#cb328-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             5.858              1.197              2.104              3.960</span></span></code></pre></div>
<p>As expected, the estimate of the coefficient on the interaction of the treatment dummy and the time dummy coincide with the estimates obtained using @ref(eq:DID) and OLS estimation of @ref(eq:did).</p>
</div>
<div id="regression-discontinuity-estimators" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Regression Discontinuity Estimators<a href="#regression-discontinuity-estimators" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider the model
<span class="math display">\[\begin{align}
  Y_i =&amp; \beta_0 + \beta_1 X_i + \beta_2 W_i + u_i (\#eq:SRDDsetting)
\end{align}\]</span>
and let
<span class="math display">\[\begin{align*}
X_i =&amp;
  \begin{cases}
    1, &amp; W_i \geq c \\
    0, &amp; W_i &lt; c
  \end{cases}
\end{align*}\]</span>
so that the receipt of treatment, <span class="math inline">\(X_i\)</span>, is determined by some threshold <span class="math inline">\(c\)</span> of a continuous variable <span class="math inline">\(W_i\)</span>, the so called running variable. The idea of <em>regression discontinuity design</em> is to use observations with a <span class="math inline">\(W_i\)</span> close to <span class="math inline">\(c\)</span> for estimation of <span class="math inline">\(\beta_1\)</span>. <span class="math inline">\(\beta_1\)</span> is the average treatment effect for individuals with <span class="math inline">\(W_i = c\)</span> which is assumed to be a good approximation to the treatment effect in the population. @ref(eq:SRDDsetting) is called a <em>sharp regression discontinuity design</em> because treatment assignment is deterministic and discontinuous at the cutoff: all observations with <span class="math inline">\(W_i &lt; c\)</span> do not receive treatment and all observations where <span class="math inline">\(W_i \geq c\)</span> are treated.</p>
<p>The subsequent code chunks show how to estimate a linear SRDD using <tt>R</tt> and how to produce plots in the way of Figure 13.2 of the book.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate some sample data</span></span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb329-3"><a href="#cb329-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> W <span class="sc">+</span> <span class="dv">10</span> <span class="sc">*</span> (W<span class="sc">&gt;=</span><span class="dv">0</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>)</span></code></pre></div>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the package &#39;rddtools&#39;</span></span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rddtools)</span>
<span id="cb330-3"><a href="#cb330-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb330-4"><a href="#cb330-4" aria-hidden="true" tabindex="-1"></a><span class="co"># construct rdd_data </span></span>
<span id="cb330-5"><a href="#cb330-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rdd_data</span>(y, W, <span class="at">cutpoint =</span> <span class="dv">0</span>)</span>
<span id="cb330-6"><a href="#cb330-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb330-7"><a href="#cb330-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the sample data</span></span>
<span id="cb330-8"><a href="#cb330-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data,</span>
<span id="cb330-9"><a href="#cb330-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb330-10"><a href="#cb330-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.35</span>, </span>
<span id="cb330-11"><a href="#cb330-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;W&quot;</span>, </span>
<span id="cb330-12"><a href="#cb330-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-556-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The argument <tt>nbins</tt> sets the number of bins the running variable is divided into for aggregation. The dots represent bin averages of the outcome variable.</p>
<p>We may use the function <tt>rdd_reg_lm()</tt> to estimate the treatment effect using model @ref(eq:SRDDsetting) for the artificial data generated above. By choosing <tt>slope = “same”</tt> we restrict the slopes of the estimated regression function to be the same on both sides of the jump at the cutpoint <span class="math inline">\(W=0\)</span>.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the sharp RDD model</span></span>
<span id="cb331-2"><a href="#cb331-2" aria-hidden="true" tabindex="-1"></a>rdd_mod <span class="ot">&lt;-</span> <span class="fu">rdd_reg_lm</span>(<span class="at">rdd_object =</span> data, </span>
<span id="cb331-3"><a href="#cb331-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">slope =</span> <span class="st">&quot;same&quot;</span>)</span>
<span id="cb331-4"><a href="#cb331-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rdd_mod)</span>
<span id="cb331-5"><a href="#cb331-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb331-6"><a href="#cb331-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb331-7"><a href="#cb331-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ ., data = dat_step1, weights = weights)</span></span>
<span id="cb331-8"><a href="#cb331-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb331-9"><a href="#cb331-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb331-10"><a href="#cb331-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb331-11"><a href="#cb331-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -3.2361 -0.6779 -0.0039  0.7113  3.0096 </span></span>
<span id="cb331-12"><a href="#cb331-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb331-13"><a href="#cb331-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb331-14"><a href="#cb331-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb331-15"><a href="#cb331-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  2.93889    0.07082   41.50   &lt;2e-16 ***</span></span>
<span id="cb331-16"><a href="#cb331-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; D           10.12692    0.12631   80.18   &lt;2e-16 ***</span></span>
<span id="cb331-17"><a href="#cb331-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; x            1.88249    0.11074   17.00   &lt;2e-16 ***</span></span>
<span id="cb331-18"><a href="#cb331-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb331-19"><a href="#cb331-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb331-20"><a href="#cb331-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb331-21"><a href="#cb331-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 1.019 on 997 degrees of freedom</span></span>
<span id="cb331-22"><a href="#cb331-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.972,  Adjusted R-squared:  0.972 </span></span>
<span id="cb331-23"><a href="#cb331-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 1.732e+04 on 2 and 997 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>The coefficient estimate of interest is labeled <tt>D</tt>. The estimate is very close to the treatment effect chosen in the DGP above.</p>
<p>It is easy to visualize the result: simply call <tt>plot()</tt> on the estimated model object.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the RDD model along with binned observations</span></span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rdd_mod,</span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.35</span>, </span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;W&quot;</span>, </span>
<span id="cb332-6"><a href="#cb332-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-558-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>As above, the dots represent averages of binned observations.</p>
<p>So far we assumed that crossing of the threshold determines receipt of treatment so that the jump of the population regression functions at the threshold can be regarded as the causal effect of the treatment.</p>
<p>When crossing the threshold <span class="math inline">\(c\)</span> is not the only cause for receipt of the treatment, treatment is not a deterministic function of <span class="math inline">\(W_i\)</span>. Instead, it is useful to think of <span class="math inline">\(c\)</span> as a threshold where the <em>probability</em> of receiving the treatment jumps.</p>
<p>This jump may be due to unobservable variables that have impact on the probability of being treated. Thus, <span class="math inline">\(X_i\)</span> in @ref(eq:SRDDsetting) will be correlated with the error <span class="math inline">\(u_i\)</span> and it becomes more difficult to consistently estimate the treatment effect. In this setting, using a <em>fuzzy regression discontinuity design</em> which is based an IV approach may be a remedy: take the binary variable <span class="math inline">\(Z_i\)</span> as an indicator for crossing of the threshold,
<span class="math display">\[\begin{align*}
  Z_i = \begin{cases}
    1, &amp; W_i \geq c \\
    0, &amp; W_i &lt; c,
  \end{cases}
\end{align*}\]</span>
and assume that <span class="math inline">\(Z_i\)</span> relates to <span class="math inline">\(Y_i\)</span> only through the treatment indicator <span class="math inline">\(X_i\)</span>. Then <span class="math inline">\(Z_i\)</span> and <span class="math inline">\(u_i\)</span> are uncorrelated but <span class="math inline">\(Z_i\)</span> influences receipt of treatment so it is correlated with <span class="math inline">\(X_i\)</span>. Thus, <span class="math inline">\(Z_i\)</span> is a valid instrument for <span class="math inline">\(X_i\)</span> and @ref(eq:SRDDsetting) can be estimated using TSLS.</p>
<p>The following code chunk generates sample data where observations with a value of the running variable <span class="math inline">\(W_i\)</span> below the cutoff <span class="math inline">\(c=0\)</span> do not receive treatment and observations with <span class="math inline">\(W_i \geq 0\)</span> do receive treatment with a probability of <span class="math inline">\(80\%\)</span> so that treatment status is only partially determined by the running variable and the cutoff. Treatment leads to an increase in <span class="math inline">\(Y\)</span> by <span class="math inline">\(2\)</span> units. Observations with <span class="math inline">\(W_i \geq 0\)</span> that do not receive treatment are called <em>no-shows</em>: think of an individual that was assigned to receive the treatment but somehow manages to avoid it.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true" tabindex="-1"></a><span class="co"># generate sample data</span></span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb333-5"><a href="#cb333-5" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span>, <span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb333-6"><a href="#cb333-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-7"><a href="#cb333-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb333-8"><a href="#cb333-8" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">mvrnorm</span>(<span class="dv">2000</span>, mu, sigma))</span>
<span id="cb333-9"><a href="#cb333-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(d) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;W&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb333-10"><a href="#cb333-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-11"><a href="#cb333-11" aria-hidden="true" tabindex="-1"></a><span class="co"># introduce fuzziness</span></span>
<span id="cb333-12"><a href="#cb333-12" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>treatProb <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(d<span class="sc">$</span>W <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.8</span>)</span>
<span id="cb333-13"><a href="#cb333-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-14"><a href="#cb333-14" aria-hidden="true" tabindex="-1"></a>fuzz <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="at">X =</span> d<span class="sc">$</span>treatProb, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="at">prob =</span> x))</span>
<span id="cb333-15"><a href="#cb333-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-16"><a href="#cb333-16" aria-hidden="true" tabindex="-1"></a><span class="co"># treatment effect</span></span>
<span id="cb333-17"><a href="#cb333-17" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>Y <span class="ot">&lt;-</span> d<span class="sc">$</span>Y <span class="sc">+</span> fuzz <span class="sc">*</span> <span class="dv">2</span></span></code></pre></div>
<p><tt>sapply()</tt> applies the function provided to <tt>FUN</tt> to every element of the argument <tt>X</tt>. Here, <tt>d$treatProb</tt> is a vector and the result is a vector, too.</p>
<p>We plot all observations and use blue color to mark individuals that did not receive the treatment and use red color for those who received the treatment.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate a colored plot of treatment and control group</span></span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d<span class="sc">$</span>W, d<span class="sc">$</span>Y,</span>
<span id="cb334-3"><a href="#cb334-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;steelblue&quot;</span>, <span class="st">&quot;darkred&quot;</span>)[<span class="fu">factor</span>(fuzz)], </span>
<span id="cb334-4"><a href="#cb334-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch=</span> <span class="dv">20</span>, </span>
<span id="cb334-5"><a href="#cb334-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb334-6"><a href="#cb334-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>),</span>
<span id="cb334-7"><a href="#cb334-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="dv">5</span>),</span>
<span id="cb334-8"><a href="#cb334-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;W&quot;</span>,</span>
<span id="cb334-9"><a href="#cb334-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb334-10"><a href="#cb334-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-11"><a href="#cb334-11" aria-hidden="true" tabindex="-1"></a><span class="co"># add a dashed vertical line at cutoff</span></span>
<span id="cb334-12"><a href="#cb334-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-560-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Obviously, receipt of treatment is no longer a deterministic function of the running variable <span class="math inline">\(W\)</span>. Some observations with <span class="math inline">\(W\geq0\)</span> <em>did not</em> receive the treatment. We may estimate a FRDD by additionally setting <tt>treatProb</tt> as the assignment variable <tt>z</tt> in <tt>rdd_data()</tt>. Then <tt>rdd_reg_lm()</tt> applies the following TSLS procedure: treatment is predicted using <span class="math inline">\(W_i\)</span> and the cutoff dummy <span class="math inline">\(Z_i\)</span>, the instrumental variable, in the first stage regression. The fitted values from the first stage regression are used to obtain a consistent estimate of the treatment effect using the second stage where the outcome <span class="math inline">\(Y\)</span> is regressed on the fitted values and the running variable <span class="math inline">\(W\)</span>.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the Fuzzy RDD</span></span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rdd_data</span>(d<span class="sc">$</span>Y, d<span class="sc">$</span>W, </span>
<span id="cb335-3"><a href="#cb335-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cutpoint =</span> <span class="dv">0</span>, </span>
<span id="cb335-4"><a href="#cb335-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">z =</span> d<span class="sc">$</span>treatProb)</span>
<span id="cb335-5"><a href="#cb335-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-6"><a href="#cb335-6" aria-hidden="true" tabindex="-1"></a>frdd_mod <span class="ot">&lt;-</span> <span class="fu">rdd_reg_lm</span>(<span class="at">rdd_object =</span> data, </span>
<span id="cb335-7"><a href="#cb335-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">slope =</span> <span class="st">&quot;same&quot;</span>)</span>
<span id="cb335-8"><a href="#cb335-8" aria-hidden="true" tabindex="-1"></a>frdd_mod</span>
<span id="cb335-9"><a href="#cb335-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span><span class="al">###</span><span class="co"> RDD regression: parametric </span><span class="al">###</span></span>
<span id="cb335-10"><a href="#cb335-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Polynomial order:  1 </span></span>
<span id="cb335-11"><a href="#cb335-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Slopes:  same </span></span>
<span id="cb335-12"><a href="#cb335-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Number of obs: 2000 (left: 999, right: 1001)</span></span>
<span id="cb335-13"><a href="#cb335-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb335-14"><a href="#cb335-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Coefficient:</span></span>
<span id="cb335-15"><a href="#cb335-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb335-16"><a href="#cb335-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; D 1.981297   0.084696  23.393 &lt; 2.2e-16 ***</span></span>
<span id="cb335-17"><a href="#cb335-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb335-18"><a href="#cb335-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The estimate is close to <span class="math inline">\(2\)</span>, the population treatment effect. We may call <tt>plot()</tt> on the model object to obtain a figure consisting of binned data and the estimated regression function.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot estimated FRDD function</span></span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(frdd_mod, </span>
<span id="cb336-3"><a href="#cb336-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.5</span>, </span>
<span id="cb336-4"><a href="#cb336-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="fl">0.4</span>,</span>
<span id="cb336-5"><a href="#cb336-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb336-6"><a href="#cb336-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="dv">5</span>),</span>
<span id="cb336-7"><a href="#cb336-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;W&quot;</span>,</span>
<span id="cb336-8"><a href="#cb336-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-562-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>What if we used a SRDD instead, thereby ignoring the fact that treatment is not perfectly determined by the cutoff in <span class="math inline">\(W\)</span>? We may get an impression of the consequences by estimating an SRDD using the previously simulated data.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate SRDD</span></span>
<span id="cb337-2"><a href="#cb337-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rdd_data</span>(d<span class="sc">$</span>Y, </span>
<span id="cb337-3"><a href="#cb337-3" aria-hidden="true" tabindex="-1"></a>                 d<span class="sc">$</span>W, </span>
<span id="cb337-4"><a href="#cb337-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cutpoint =</span> <span class="dv">0</span>)</span>
<span id="cb337-5"><a href="#cb337-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-6"><a href="#cb337-6" aria-hidden="true" tabindex="-1"></a>srdd_mod <span class="ot">&lt;-</span> <span class="fu">rdd_reg_lm</span>(<span class="at">rdd_object =</span> data, </span>
<span id="cb337-7"><a href="#cb337-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">slope =</span> <span class="st">&quot;same&quot;</span>)</span>
<span id="cb337-8"><a href="#cb337-8" aria-hidden="true" tabindex="-1"></a>srdd_mod</span>
<span id="cb337-9"><a href="#cb337-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span><span class="al">###</span><span class="co"> RDD regression: parametric </span><span class="al">###</span></span>
<span id="cb337-10"><a href="#cb337-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Polynomial order:  1 </span></span>
<span id="cb337-11"><a href="#cb337-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Slopes:  same </span></span>
<span id="cb337-12"><a href="#cb337-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Number of obs: 2000 (left: 999, right: 1001)</span></span>
<span id="cb337-13"><a href="#cb337-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb337-14"><a href="#cb337-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Coefficient:</span></span>
<span id="cb337-15"><a href="#cb337-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb337-16"><a href="#cb337-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; D 1.585038   0.067756  23.393 &lt; 2.2e-16 ***</span></span>
<span id="cb337-17"><a href="#cb337-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb337-18"><a href="#cb337-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The estimate obtained using a SRDD is suggestive of a substantial downward bias. In fact, this procedure is inconsistent for the true causal effect so increasing the sample would not alleviate the bias.</p>
<p>The book continues with a discussion of potential problems with quasi-experiments. As for all empirical studies, these potential problems are related to internal and external validity. This part is followed by a technical discussion of treatment effect estimation when the causal effect of treatment is heterogeneous in the population. We encourage you to work on these sections on your own.</p>
<div id="summary-5" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Summary<a href="#summary-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This chapter has introduced the concept of causal effects in randomized controlled experiments and quasi-experiments where variations in circumstances or accidents of nature are treated as sources of “as if” random assignment to treatment. We have also discussed methods that allow for consistent estimation of these effects in both settings. These included the <em>differences estimator</em>, the <em>differences-in-differences estimator</em> as well as <em>sharp</em> and <em>fuzzy regression discontinuity design</em> estimators. It was shown how to apply these estimation techniques in <tt>R</tt>.</p>
<p>In an empirical application we have shown how to replicate the results of the analysis of the STAR data presented in Chapter 13.3 of the book using <tt>R</tt>. This study uses a randomized controlled experiment to assess whether smaller classes improve students’ performance on standardized tests. Being related to a randomized controlled experiment, the data of this study is fundamentally different to those used in the cross-section studies in Chapters @ref(lrwor) to @ref(nrf). We therefore have motivated usage of a <em>differences estimator</em>.</p>
<p>Chapter @ref(attdfc) demonstrated how estimates of treatment effects can be obtained when the design of the study is a quasi-experiment that allows for <em>differences-in-differences</em> or <em>regression discontinuity design</em> estimators. In particular, we have introduced functions of the package <tt>rddtools</tt> that are convenient for estimation as well as graphical analysis when estimating a regression discontinuity design.</p>
</div>
</div>
</div>
<div id="exercises-13" class="section level2 hasAnchor" number="13.5">
<h2 class="hasAnchor"><span class="header-section-number">13.5</span> Exercises<a href="#exercises-13" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The subsequent exercises guide you in reproducing some of the results presented in one of the most famous DID studies by <span class="citation">Card and Krueger (<a href="#ref-card1994" role="doc-biblioref">1994</a>)</span>. The authors use geography as the “as if” random treatment assignment to study the effect on employment in fast food restaurants caused by an increase in the state minimum wage in New Jersey in the year of 1992, see Chapter @ref(qe).</p>
<p>The study is based on survey data collected in February 1992 and in November 1992, after New Jersey’s minimum wage rose by <span class="math inline">\(\$0.80\)</span> from <span class="math inline">\(\$4.25\)</span> to <span class="math inline">\(\$5.05\)</span> in April 1992.</p>
<p>Estimating the effect of the wage increase simply by computing the change in employment in New Jersey (as you are asked to do in Exercise 3) would fail to control for omitted variables. By using Pennsylvania as a control in a difference-in-differences (DID) model one can control for variables with a common influence on New Jersey (treatment group) and Pennsylvania (control group). This reduces the risk of omitted variable bias enormously and even works when these variables are unobserved.</p>
<p>For the DID approach to work we must assume that New Jersey and Pennsylvania have parallel trends over time, i.e., we assume that the (unobserved) factors influence employment in Pennsylvania and New Jersey in the same manner. This allows to interpret an observed change in employment in Pennsylvania as the change New Jersey would have experienced if there was no increase in minimum wage (and vice versa).</p>
<p>Against to what standard economic theory would suggest, the authors did not find evidence that the increased minimum wage induced an increase in unemployment in New Jersey using the DID approach: quite the contrary, their results suggest that the <span class="math inline">\(\$0.80\)</span> minimum wage increase in New Jersey led to a 2.75 full-time equivalent (FTE) increase in employment.</p>
<div id="the-data-from-card-krueger-1994" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">1. The Data from Card &amp; Krueger (1994)<a href="#the-data-from-card-krueger-1994" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><tt>fastfood.dat</tt>, the dataset used by Card &amp; Krueger (1994) can be downloaded <a href="http://www.stat.ucla.edu/projects/datasets/fastfood.dta">here</a>. See this <a href="http://www.stat.ucla.edu/projects/datasets/fastfood-explanation.html">link</a> for a detailed explanation of the variables.</p>
<p>This exercise asks you to import the dataset in <tt>R</tt> and to perform some formatting necessary for the subsequent analysis. This can be tedious using base <tt>R</tt> functions but is easily done using the <tt>dplyr</tt> package introducted in Chapter @ref(aattggoe).</p>
<p>The URL to the dataset is saved in <tt>data_URL</tt>.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Attach the packages <tt>dplyr</tt> and <tt>foreign</tt>.</p></li>
<li><p>Read in the dataset <tt>fastfood.dta</tt> using <tt>data_URL</tt> and assign it to a <tt>data.frame</tt> named <tt>dat</tt>.</p></li>
</ul>
<p>In their study, Card &amp; Krueger (1994) measure employment in full time equivalents which they define as the number of full time employees (<tt>empft</tt> and <tt>empft2</tt>) plus the number of managers (<tt>nmgrs</tt> and <tt>nmgrs2</tt>) plus 0.5 times the number part-time employees (<tt>emppt</tt> / <tt>emppt2</tt>).
- Define full-time employment before (<tt>FTE</tt>) and after the wage increase (<tt>FTE2</tt>) and add both variables to <tt>dat</tt></p>
<iframe src="DCL/ex13_1.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p><tt>read.dta()</tt> from the <tt>foreign</tt> package reads <tt>.dta</tt> files, a format used by the statistical software package <em>STATA</em>.</p></li>
<li><p><tt>mutate()</tt> generates new columns using existing ones.</p></li>
</ul>
</div>
<div id="state-specific-estimates-of-full-time-employment-i" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">2. State Specific Estimates of Full-Time Employment — I<a href="#state-specific-estimates-of-full-time-employment-i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This exercise asks you to perform a quick calculation of state specific sample means in order to check whether our data on full-time employment is in alignment with the data used by Card &amp; Krueger (1994).</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Generate subsets of <tt>dat</tt> to seperate observations for New Jersey and Pennsylvania. Save them as <tt>dat_NJ</tt> and <tt>dat_PA</tt>.</p></li>
<li><p>Compute sample means of full-time employment equivalents for New Jersey and Pennsylvania both before and after the minium wage increase in New Jersey. It suffices if your code prints the correct values to the console.</p></li>
</ul>
<iframe src="DCL/ex13_2.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li>You may use <tt>group_by()</tt> in conjunction with <tt>summarise()</tt> to compute groupwise means. Both function come with the <tt>dplyr</tt> package.</li>
</ul>
</div>
<div id="state-specific-estimates-of-full-time-employment-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">3. State Specific Estimates of Full-Time Employment — II<a href="#state-specific-estimates-of-full-time-employment-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A naive approach to investigate the impact of the minimum wage increase on employment is to use the estimated difference in mean employment before and after the wage increase for New Jersey fast food restaurants.</p>
<p>This exercise asks you to do the aforementioned and further to test if the estimated difference is significantly different from zero using a <em>robust</em> <span class="math inline">\(t\)</span>-test.</p>
<p>The subsets <tt>dat_NJ</tt> and <tt>dat_PA</tt> from the previous exercise are available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Use <tt>dat_NJ</tt> for a robust test of the hypothesis that there is no difference in full-time employment before and after the wage hike in New Jersey at the level of <span class="math inline">\(5\%\)</span>.</li>
</ul>
<iframe src="DCL/ex13_3.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li>The testing problem amounts to a two-sample <span class="math inline">\(t\)</span>-test which is conveniently done using <tt>t.test()</tt>.</li>
</ul>
</div>
<div id="preparing-the-data-for-regression" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">4. Preparing the Data for Regression<a href="#preparing-the-data-for-regression" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The estimations done in Exercise 3 and the difference-in-differences approach we are working towards can be shown to produce the same results OLS applied to specific regression models, see Chapters @ref(poceaie) and @ref(aattggoe).</p>
<p>This exercise asks you to construct a dataset which is more convenient for this purpose than the dataset <tt>dat</tt>.</p>
<p><strong>Instructions:</strong></p>
<p>Generate the dataset <tt>reg_dat</tt> from <tt>dat</tt> in <em>long format</em>, i.e., make sure that for each restaurant (identified by <tt>sheet</tt>) one observation before and one after the minimum wage increase (identified by <tt>D</tt>) are included.</p>
<p>Only consider the following variables:</p>
<ul>
<li><p><tt>id</tt>: sheet number (unique store id)</p></li>
<li><p><tt>chain</tt>: chain 1=Burger King; 2=KFC; 3=Roy Rogers; 4=Wendys</p></li>
<li><p><tt>state</tt>: 1 if New Jersey; 0 if Pennsylvania</p></li>
<li><p><tt>empl</tt>: measure of full-time employment (<tt>FTE</tt> / <tt>FTE2</tt>)</p></li>
<li><p><tt>D</tt>: dummy indicating if the observation was made before or after the minimum wage increase in New Jersey.</p></li>
</ul>
<iframe src="DCL/ex13_4.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>The original dataset <tt>dat</tt> has 410 observations of 48 variables (check this using <tt>dim(dat)</tt>). The dataset <tt>reg_dat</tt> you are asked to generate must consist of 820 observations of the variables listed above.</p></li>
<li><p>It is straightforward to generate a <tt>data.frame</tt> from the columns of another <tt>data.frame</tt> using <tt>data.frame(…)</tt>.</p></li>
<li><p>Use <tt>rbind()</tt> to combine two objects of type <tt>data.frame</tt> by row.</p></li>
</ul>
</div>
<div id="a-difference-estimate-using-data-from-card-krueger-1994-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">5. A Difference Estimate using Data from Card &amp; Krueger (1994) — II<a href="#a-difference-estimate-using-data-from-card-krueger-1994-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><tt>reg_dat</tt> from Exercise 4 is a <em>panel dataset</em> as it has two observations for each fast food restaurant <span class="math inline">\(i=1,\dots,410\)</span>, at time periods <span class="math inline">\(t=0,1\)</span>.</p>
<p>Thus we may write down the simple regression model</p>
<p><span class="math display">\[employment_{i,t} = \beta_0 + \beta_1 D_t + \varepsilon_{i,t},\]</span></p>
<p>where <span class="math inline">\(D_t\)</span> is a dummy variable which equals <span class="math inline">\(0\)</span> if the observation was made before the minimum wage change (<span class="math inline">\(t=0\)</span>) and <span class="math inline">\(1\)</span> after the minimum wage change (<span class="math inline">\(t=1\)</span>), i.e.,</p>
<p><span class="math display">\[\begin{align*}
D_t = \begin{cases}
0, &amp; \, \text{if $t=0$ (before wage change),} \\
1, &amp; \, \text{if $t=1$ (after wage change)}
\end{cases}
\end{align*}\]</span></p>
<p>and assume that observations for <em>New Jersey restaurants only</em> are used in computing <span class="math inline">\(\hat\beta_1\)</span>, the OLS estimator of <span class="math inline">\(\beta_1\)</span>, which is also called the <em>differences estimator</em>.</p>
<p>The dataset <tt>reg_dat</tt> from Exercise 4 and the New Jersey subset <tt>dat_NJ</tt> are available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Estimate <span class="math inline">\(\beta_1\)</span> in the model above using OLS. Save the estimated model to <tt>emp_mod</tt>.</p></li>
<li><p>Obtain a robust summary of the results and interpret your findings.</p></li>
</ul>
<iframe src="DCL/ex13_5.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>Remember that dependencies of the <tt>AER</tt> package include functions for robust inference on regression models.</p></li>
<li><p>The argument <tt>subset</tt> in <tt>lm()</tt> takes a logical vector which identifies observations used for estimation.</p></li>
</ul>
</div>
<div id="a-difference-estimate-using-data-from-card-krueger-1994-ii-1" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">6. A Difference Estimate using Data from Card &amp; Krueger (1994) — II<a href="#a-difference-estimate-using-data-from-card-krueger-1994-ii-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The estimate obtained using <tt>t.test()</tt> on the New Jersey subset in Exercise 3 and the OLS estimate of <span class="math inline">\(\hat\beta_1\)</span> in Exercise 5 are numercially the same. This also holds for the reported <span class="math inline">\(t\)</span>-statistics if the same standard error formulas are used (<tt>t.test(…, var.equal = T)</tt> and <tt>coeftest(…, vcov. = vcovHC, type = “HC1”)</tt>).</p>
<p>This exercise asks you to check that the above statement is true.</p>
<p>The data from the previous exercises, the result of <tt>t.test(…)</tt> from Exercise 3 as well as the regression model object <tt>emp_mod</tt> from Exercise 5 are available in your working environment. The <tt>AER</tt> package has been attached.</p>
<p><em>No submission correctness tests are run.</em></p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Check that the estimate of <span class="math inline">\(\beta_1\)</span> in Exercise 5 is equal to the estimated difference in mean employment of New Jersey fastfood restaurants before and after the minimum wage increase from Exercise 3.</p></li>
<li><p>Convince yourself that the <span class="math inline">\(t\)</span>-statistics reported by <tt>coeftest(…)</tt> in Exercise 5 and <tt>t.test(…)</tt> in Exercise 3 match.</p></li>
</ul>
<iframe src="DCL/ex13_6.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="a-difference-in-differences-estimate-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4 class="unnumbered hasAnchor">7. A Difference-in-Differences Estimate — II<a href="#a-difference-in-differences-estimate-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As mentioned in Chapter @ref(aattggoe), the approach discussed in Exercises 5 and 6 is naive: <span class="math inline">\(\hat\beta_1\)</span> is a biased estimate of the average effect of the minimum wage increase on employment because we cannot control for other determinants of employment that correlate with <span class="math inline">\(D_t\)</span>. As an example, think about macro-economic developments which have a positive impact on the labor market such that employment is higher in the period after the minimum wage increase. It is likely that <span class="math inline">\(D_t\)</span> is positively correlated with the error term such that <span class="math inline">\(\hat\beta_1\)</span> <em>overestimates</em> the effect of the wage hike on employment.</p>
<p>This motivates usage of the difference-in-differences (DID) estimator outlined in Chapter @ref(aattggoe).</p>
<p>Consider the liner regression model</p>
<p><span class="math display">\[employment_{i,t} = \beta_0 + \beta_1 D_t + \beta_2 state_i + \beta_3 (D_t \times state_i) + \varepsilon_{i,t},\]</span></p>
<p>where we use indices <span class="math inline">\(i\)</span> and <span class="math inline">\(t\)</span> just as in the simple regression model in Exercise 5.
In this model, <span class="math inline">\(\beta_3\)</span> is the coefficient we are interested in as it is interpreted as the average difference in employment of New Jersey fastfood restaurants before and after the wage increase after controlling for unobservables which are common to New Jersey and Pennsylvania, the control group. The OLS estimator of <span class="math inline">\(\beta_3\)</span> is called a DID estimator.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Estimate the above model using OLS and obtain a robust summary.</p></li>
<li><p>Interpret your findings.</p></li>
</ul>
<iframe src="DCL/ex13_7.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<!--chapter:end:13-ch13.Rmd-->
</div>
</div>
<div id="ittsraf" class="section level1 hasAnchor" number="14">
<h1 class="hasAnchor"><span class="header-section-number">14</span> Introduction to Time Series Regression and Forecasting<a href="#ittsraf" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Time series data is collected for a single entity over time. This is fundamentally different from cross-section data which is data on multiple entities at the same point in time. Time series data allows estimation of the effect on <span class="math inline">\(Y\)</span> of a change in <span class="math inline">\(X\)</span> <em>over time</em>. This is what econometricians call a <em>dynamic causal effect</em>. Let us go back to the application to cigarette consumption of Chapter @ref(ivr) where we were interested in estimating the effect on cigarette demand of a price increase caused by a raise of the general sales tax. One might use time series data to assess the causal effect of a tax increase on smoking both initially and in subsequent periods.</p>
<p>Another application of time series data is forecasting. For example, weather services use time series data to predict tomorrow’s temperature by, inter alia, using today’s temperature and temperatures of the past. To motivate an economic example, central banks are interested in forecasting next month’s unemployment rates.</p>
<p>The remaining chapters in the book deal with econometric techniques for analyzing time series data, as well as their applications in forecasting and estimating dynamic causal effects. This section covers the basic concepts presented in Chapter 14 of the book, explains how to visualize time series data and demonstrates how to estimate simple autoregressive models, where the regressors are past values of the dependent variable or other variables. In this context we also discuss the concept of stationarity, an important property which has far-reaching consequences.</p>
<p>Most empirical applications in this chapter are concerned with forecasting and use data on U.S. macroeconomic indicators or financial time series like Gross Domestic Product (GDP), the unemployment rate or excess stock returns.</p>
<p>The following packages and their dependencies are needed for reproduction of the code chunks presented throughout this chapter:</p>
<ul>
<li><tt>AER</tt> <span class="citation">(<a href="#ref-R-AER" role="doc-biblioref">Christian Kleiber and Zeileis 2022</a>)</span></li>
<li><tt>dynlm</tt> <span class="citation">(<a href="#ref-R-dynlm" role="doc-biblioref">Zeileis 2019</a>)</span></li>
<li><tt>forecast</tt> <span class="citation">(<a href="#ref-R-forecast" role="doc-biblioref">Hyndman et al. 2023</a>)</span></li>
<li><tt>readxl</tt> <span class="citation">(<a href="#ref-R-readxl" role="doc-biblioref">Wickham and Bryan 2023</a>)</span></li>
<li><tt>stargazer</tt> <span class="citation">(<a href="#ref-R-stargazer" role="doc-biblioref">Hlavac 2022</a>)</span></li>
<li><tt>scales</tt> <span class="citation">(<a href="#ref-R-scales" role="doc-biblioref">Wickham and Seidel 2022</a>)</span></li>
<li><tt>quantmod</tt> <span class="citation">(<a href="#ref-R-quantmod" role="doc-biblioref">Ryan and Ulrich 2022</a>)</span></li>
<li><tt>urca</tt> <span class="citation">(<a href="#ref-R-urca" role="doc-biblioref">Pfaff 2022</a>)</span></li>
</ul>
<p>Please verify that the following code chunk runs on your machine without any errors.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dynlm)</span>
<span id="cb338-3"><a href="#cb338-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb338-4"><a href="#cb338-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb338-5"><a href="#cb338-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb338-6"><a href="#cb338-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb338-7"><a href="#cb338-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb338-8"><a href="#cb338-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(urca)</span></code></pre></div>
<div id="using-regression-models-for-forecasting" class="section level2 hasAnchor" number="14.1">
<h2 class="hasAnchor"><span class="header-section-number">14.1</span> Using Regression Models for Forecasting<a href="#using-regression-models-for-forecasting" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>What is the difference between estimating models for assessment of causal effects and forecasting? Consider again the simple example of estimating the causal effect of the student-teacher ratio on test scores introduced in Chapter @ref(lrwor).</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(CASchools)   </span>
<span id="cb339-3"><a href="#cb339-3" aria-hidden="true" tabindex="-1"></a>CASchools<span class="sc">$</span>STR <span class="ot">&lt;-</span> CASchools<span class="sc">$</span>students<span class="sc">/</span>CASchools<span class="sc">$</span>teachers       </span>
<span id="cb339-4"><a href="#cb339-4" aria-hidden="true" tabindex="-1"></a>CASchools<span class="sc">$</span>score <span class="ot">&lt;-</span> (CASchools<span class="sc">$</span>read <span class="sc">+</span> CASchools<span class="sc">$</span>math)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb339-5"><a href="#cb339-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-6"><a href="#cb339-6" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> STR, <span class="at">data =</span> CASchools)</span>
<span id="cb339-7"><a href="#cb339-7" aria-hidden="true" tabindex="-1"></a>mod</span>
<span id="cb339-8"><a href="#cb339-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb339-9"><a href="#cb339-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb339-10"><a href="#cb339-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = score ~ STR, data = CASchools)</span></span>
<span id="cb339-11"><a href="#cb339-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb339-12"><a href="#cb339-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb339-13"><a href="#cb339-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)          STR  </span></span>
<span id="cb339-14"><a href="#cb339-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      698.93        -2.28</span></span></code></pre></div>
<p>As has been stressed in Chapter @ref(rmwmr), the estimate of the coefficient on the student-teacher ratio does not have a causal interpretation due to omitted variable bias. However, in terms of deciding which school to send her child to, it might nevertheless be appealing for a parent to use <tt>mod</tt> for forecasting test scores in schooling districts where no public data on scores are available.</p>
<p>As an example, assume that the average class in a district has <span class="math inline">\(25\)</span> students. This is not a perfect forecast but the following one-liner might be helpful for the parent to decide.</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="st">&quot;STR&quot;</span> <span class="ot">=</span> <span class="dv">25</span>))</span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        1 </span></span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 641.9377</span></span></code></pre></div>
<p>In a time series context, the parent could use data on present and past years test scores to forecast next year’s test scores — a typical application for an autoregressive model.</p>
</div>
<div id="tsdasc" class="section level2 hasAnchor" number="14.2">
<h2 class="hasAnchor"><span class="header-section-number">14.2</span> Time Series Data and Serial Correlation<a href="#tsdasc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>GDP is commonly defined as the total value of goods and services produced during a given time period. The dataset us_macro_quarterly.xlsx, provided by the authors, can be downloaded <a href="http://wps.pearsoned.co.uk/wps/media/objects/16103/16489878/data3eu/us_macro_quarterly.xlsx">here</a>. It contains quarterly data on U.S. real GDP (i.e., inflation-adjusted) from 1947 to 2004.</p>
<p>As before, a good starting point is to plot the data. The package <tt>quantmod</tt> provides some convenient functions for plotting and computing with time series data. We also load the package <tt>readxl</tt> to read the data into <tt>R</tt>.</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="co"># attach the package &#39;quantmod&#39;</span></span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span></code></pre></div>
<p>We begin by importing the data set.</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load US macroeconomic data</span></span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true" tabindex="-1"></a>USMacroSWQ <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">&quot;Data/us_macro_quarterly.xlsx&quot;</span>,</span>
<span id="cb342-3"><a href="#cb342-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sheet =</span> <span class="dv">1</span>,</span>
<span id="cb342-4"><a href="#cb342-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">&quot;text&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;numeric&quot;</span>, <span class="dv">9</span>)))</span>
<span id="cb342-5"><a href="#cb342-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb342-6"><a href="#cb342-6" aria-hidden="true" tabindex="-1"></a><span class="co"># format date column</span></span>
<span id="cb342-7"><a href="#cb342-7" aria-hidden="true" tabindex="-1"></a>USMacroSWQ<span class="sc">$</span>...<span class="dv">1</span> <span class="ot">&lt;-</span> <span class="fu">as.yearqtr</span>(USMacroSWQ<span class="sc">$</span>...<span class="dv">1</span>, <span class="at">format =</span> <span class="st">&quot;%Y:0%q&quot;</span>)</span>
<span id="cb342-8"><a href="#cb342-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb342-9"><a href="#cb342-9" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust column names</span></span>
<span id="cb342-10"><a href="#cb342-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(USMacroSWQ) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Date&quot;</span>, <span class="st">&quot;GDPC96&quot;</span>, <span class="st">&quot;JAPAN_IP&quot;</span>, <span class="st">&quot;PCECTPI&quot;</span>, </span>
<span id="cb342-11"><a href="#cb342-11" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;GS10&quot;</span>, <span class="st">&quot;GS1&quot;</span>, <span class="st">&quot;TB3MS&quot;</span>, <span class="st">&quot;UNRATE&quot;</span>, <span class="st">&quot;EXUSUK&quot;</span>, <span class="st">&quot;CPIAUCSL&quot;</span>)</span></code></pre></div>
<p>The first column of <tt>us_macro_quarterly.xlsx</tt> contains text and the remaining ones are numeric. Using <tt>col_types = c(“text”, rep(“numeric”, 9))</tt>, we instruct <tt>read_xlsx()</tt> to consider this format when importing the data.</p>
<p>It is useful to work with time-series objects that keep track of the frequency of the data and are extensible. In what follows we will use objects of the class <tt>xts</tt>, see <code>?xts</code>. Since the data in <tt>USMacroSWQ</tt> are in quarterly frequency we convert the first column to <tt>yearqtr</tt> format before generating the <tt>xts</tt> object <tt>GDP</tt>.</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="co"># GDP series as xts object</span></span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a>GDP <span class="ot">&lt;-</span> <span class="fu">xts</span>(USMacroSWQ<span class="sc">$</span>GDPC96, USMacroSWQ<span class="sc">$</span>Date)[<span class="st">&quot;1960::2013&quot;</span>]</span>
<span id="cb343-3"><a href="#cb343-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-4"><a href="#cb343-4" aria-hidden="true" tabindex="-1"></a><span class="co"># GDP growth series as xts object</span></span>
<span id="cb343-5"><a href="#cb343-5" aria-hidden="true" tabindex="-1"></a>GDPGrowth <span class="ot">&lt;-</span> <span class="fu">xts</span>(<span class="dv">400</span> <span class="sc">*</span> <span class="fu">log</span>(GDP<span class="sc">/</span><span class="fu">lag</span>(GDP)))</span></code></pre></div>
<p>The following code chunks reproduce Figure 14.1 of the book.</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reproduce Figure 14.1 (a) of the book</span></span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(<span class="fu">as.zoo</span>(GDP)),</span>
<span id="cb344-3"><a href="#cb344-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb344-4"><a href="#cb344-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb344-5"><a href="#cb344-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Logarithm&quot;</span>,</span>
<span id="cb344-6"><a href="#cb344-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb344-7"><a href="#cb344-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;U.S. Quarterly Real GDP&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-578-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reproduce Figure 14.1 (b) of the book</span></span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.zoo</span>(GDPGrowth),</span>
<span id="cb345-3"><a href="#cb345-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb345-4"><a href="#cb345-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb345-5"><a href="#cb345-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Logarithm&quot;</span>,</span>
<span id="cb345-6"><a href="#cb345-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb345-7"><a href="#cb345-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;U.S. Real GDP Growth Rates&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-579-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div id="notation-lags-differences-logarithms-and-growth-rates" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Notation, Lags, Differences, Logarithms and Growth Rates<a href="#notation-lags-differences-logarithms-and-growth-rates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For observations of a variable <span class="math inline">\(Y\)</span> recorded over time, <span class="math inline">\(Y_t\)</span> denotes the value observed at time <span class="math inline">\(t\)</span>. The period between two sequential observations <span class="math inline">\(Y_t\)</span> and <span class="math inline">\(Y_{t-1}\)</span> is a unit of time: hours, days, weeks, months, quarters, years etc. Key Concept 14.1 introduces the essential terminology and notation for time series data we use in the subsequent sections.</p>
<div id="KC14.1" class="keyconcept">
<h3 class="right">
Key Concept 14.1
</h3>
<h3 class="left">
Lags, First Differences, Logarithms and Growth Rates
</h3>
<ul>
<li><p>Previous values of a time series are called <em>lags</em>. The first lag of <span class="math inline">\(Y_t\)</span> is <span class="math inline">\(Y_{t-1}\)</span>. The <span class="math inline">\(j^{th}\)</span> lag of <span class="math inline">\(Y_t\)</span> is <span class="math inline">\(Y_{t-j}\)</span>. In <tt><code>r ttcode("R")</code></tt>, lags of univariate or multivariate time series objects are conveniently computed by <tt>lag()</tt>, see <tt>?lag</tt>.</p></li>
<li><p>Sometimes we work with a differenced series. The first difference of a series is <span class="math inline">\(\Delta Y_{t} = Y_t - Y_{t-1}\)</span>, the difference between periods <span class="math inline">\(t\)</span> and <span class="math inline">\(t-1\)</span>. If <tt>Y</tt> is a time series, the series of first differences is computed as <tt>diff(Y)</tt>.</p></li>
<li><p>It may be convenient to work with the first difference in logarithms of a series. We denote this by <span class="math inline">\(\Delta \log(Y_t) = \log(Y_t) - \log(Y_{t-1})\)</span>. For a time series <tt>Y</tt>, this is obtained using <tt>log(Y/lag(Y))</tt>.</p></li>
<li><p><span class="math inline">\(100 \Delta \log (Y_t)\)</span> is an approximation for the percentage change between <span class="math inline">\(Y_t\)</span> and <span class="math inline">\(Y_{t-1}\)</span>.</p></li>
</ul>
</div>
<p>The definitions made in Key Concept 14.1 are useful because of two properties that are common to many economic time series:</p>
<ul>
<li><p>Exponential growth: some economic series grow approximately exponentially such that their logarithm is approximately linear.</p></li>
<li><p>The standard deviation of many economic time series is approximately proportional to their level. Therefore, the standard deviation of the logarithm of such a series is approximately constant.</p></li>
</ul>
<p>Furthermore, it is common to report growth rates in macroeconomic series which is why <span class="math inline">\(\log\)</span>-differences are often used.</p>
<p>Table 14.1 of the book presents the quarterly U.S. GDP time series, its logarithm, the annualized growth rate and the first lag of the annualized growth rate series for the period 2012:Q1 - 2013:Q1. The following simple function can be used to compute these quantities for a quarterly time series <tt>series</tt>.</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute logarithms, annual growth rates and 1st lag of growth rates</span></span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a>quants <span class="ot">&lt;-</span> <span class="cf">function</span>(series) {</span>
<span id="cb346-3"><a href="#cb346-3" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> series</span>
<span id="cb346-4"><a href="#cb346-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(</span>
<span id="cb346-5"><a href="#cb346-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(<span class="st">&quot;Level&quot;</span> <span class="ot">=</span> s,</span>
<span id="cb346-6"><a href="#cb346-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;Logarithm&quot;</span> <span class="ot">=</span> <span class="fu">log</span>(s),</span>
<span id="cb346-7"><a href="#cb346-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;AnnualGrowthRate&quot;</span> <span class="ot">=</span> <span class="dv">400</span> <span class="sc">*</span> <span class="fu">log</span>(s <span class="sc">/</span> <span class="fu">lag</span>(s)),</span>
<span id="cb346-8"><a href="#cb346-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;1stLagAnnualGrowthRate&quot;</span> <span class="ot">=</span> <span class="fu">lag</span>(<span class="dv">400</span> <span class="sc">*</span> <span class="fu">log</span>(s <span class="sc">/</span> <span class="fu">lag</span>(s))))</span>
<span id="cb346-9"><a href="#cb346-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb346-10"><a href="#cb346-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The annual growth rate is computed using the approximation <span class="math display">\[Annual Growth Y_t = 400 \cdot\Delta\log(Y_t)\]</span> since <span class="math inline">\(100\cdot\Delta\log(Y_t)\)</span> is an approximation of the quarterly percentage changes, see Key Concept 14.1.</p>
<p>We call <tt>quants()</tt> on observations for the period 2011:Q3 - 2013:Q1.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain a data.frame with level, logarithm, annual growth rate and its 1st lag of GDP</span></span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quants</span>(GDP[<span class="st">&quot;2011-07::2013-01&quot;</span>])</span>
<span id="cb347-3"><a href="#cb347-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            Level Logarithm AnnualGrowthRate X1stLagAnnualGrowthRate</span></span>
<span id="cb347-4"><a href="#cb347-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2011 Q3 15062.14  9.619940               NA                      NA</span></span>
<span id="cb347-5"><a href="#cb347-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2011 Q4 15242.14  9.631819        4.7518062                      NA</span></span>
<span id="cb347-6"><a href="#cb347-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2012 Q1 15381.56  9.640925        3.6422231               4.7518062</span></span>
<span id="cb347-7"><a href="#cb347-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2012 Q2 15427.67  9.643918        1.1972004               3.6422231</span></span>
<span id="cb347-8"><a href="#cb347-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2012 Q3 15533.99  9.650785        2.7470216               1.1972004</span></span>
<span id="cb347-9"><a href="#cb347-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2012 Q4 15539.63  9.651149        0.1452808               2.7470216</span></span>
<span id="cb347-10"><a href="#cb347-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2013 Q1 15583.95  9.653997        1.1392015               0.1452808</span></span></code></pre></div>
<div id="autocorrelation" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Autocorrelation<a href="#autocorrelation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Observations of a time series are typically correlated. This type of correlation is called <em>autocorrelation</em> or <em>serial correlation</em>. Key Concept 14.2 summarizes the concepts of population autocovariance and population autocorrelation and shows how to compute their sample equivalents.</p>
<div id="KC14.2" class="keyconcept">
<h3 class="right">
Key Concept 14.2
</h3>
<h3 class="left">
Autocorrelation and Autocovariance
</h3>
<p>The covariance between <span class="math inline">\(Y_t\)</span> and its <span class="math inline">\(j^{th}\)</span> lag, <span class="math inline">\(Y_{t-j}\)</span>, is called the <span class="math inline">\(j^{th}\)</span> <em>autocovariance</em> of the series <span class="math inline">\(Y_t\)</span>. The <span class="math inline">\(j^{th}\)</span> <em>autocorrelation coefficient</em>, also called the <em>serial correlation coefficient</em>, measures the correlation between <span class="math inline">\(Y_t\)</span> and <span class="math inline">\(Y_{t-j}\)</span>.</p>
<p>We thus have
<span class="math display">\[\begin{align*}
  j^{th} \text{autocovariance} =&amp; \, Cov(Y_t,Y_{t-j}), \\
  j^{th} \text{autocorrelation} = \rho_j =&amp; \, \rho_{Y_t,Y_{t-j}} = \frac{Cov(Y_t,Y_{t-j)}}{\sqrt{Var(Y_t)Var(Y_{t-j})}}.
\end{align*}\]</span></p>
<p>Population autocovariance and population autocorrelation can be estimated by <span class="math inline">\(\widehat{Cov(Y_t,Y_{t-j})}\)</span>, the sample autocovariance, and <span class="math inline">\(\widehat{\rho}_j\)</span>, the sample autocorrelation:</p>
<p><span class="math display">\[\begin{align*}
  \widehat{Cov(Y_t,Y_{t-j})} =&amp; \, \frac{1}{T} \sum_{t=j+1}^T (Y_t - \overline{Y}_{j+1:T})(Y_{t-j} - \overline{Y}_{1:T-j}), \\
  \widehat{\rho}_j =&amp; \, \frac{\widehat{Cov(Y_t,Y_{t-j})}}{\widehat{Var(Y_t)}}
\end{align*}\]</span></p>
<p><span class="math inline">\(\overline{Y}_{j+1:T}\)</span> denotes the average of <span class="math inline">\(Y_{j+1}, Y{j+2}, \dots, Y_T\)</span>.</p>
<p>In <tt>R</tt> the function <tt>acf()</tt> from the package <tt>stats</tt> computes the sample autocovariance or the sample autocorrelation function.</p>
</div>
<p>Using <tt>acf()</tt> it is straightforward to compute the first four sample autocorrelations of the series <tt>GDPGrowth</tt>.</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">na.omit</span>(GDPGrowth), <span class="at">lag.max =</span> <span class="dv">4</span>, <span class="at">plot =</span> F)</span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb348-3"><a href="#cb348-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Autocorrelations of series &#39;na.omit(GDPGrowth)&#39;, by lag</span></span>
<span id="cb348-4"><a href="#cb348-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb348-5"><a href="#cb348-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0.00  0.25  0.50  0.75  1.00 </span></span>
<span id="cb348-6"><a href="#cb348-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1.000 0.352 0.273 0.114 0.106</span></span></code></pre></div>
<p>This is evidence that there is mild positive autocorrelation in the growth of GDP: if GDP grows faster than average in one period, there is a tendency for it to grow faster than average in the following periods.</p>
</div>
<div id="other-examples-of-economic-time-series" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Other Examples of Economic Time Series<a href="#other-examples-of-economic-time-series" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Figure 14.2 of the book presents four plots: the U.S. unemployment rate, the U.S. Dollar / British Pound exchange rate, the logarithm of the Japanese industrial production index as well as daily changes in the Wilshire 5000 stock price index, a financial time series. The next code chunk reproduces the plots of the three macroeconomic series and adds percentage changes in the daily values of the New York Stock Exchange Composite index as a fourth one (the data set <tt>NYSESW</tt> comes with the <tt>AER</tt> package).</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define series as xts objects</span></span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a>USUnemp <span class="ot">&lt;-</span> <span class="fu">xts</span>(USMacroSWQ<span class="sc">$</span>UNRATE, USMacroSWQ<span class="sc">$</span>Date)[<span class="st">&quot;1960::2013&quot;</span>]</span>
<span id="cb349-3"><a href="#cb349-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-4"><a href="#cb349-4" aria-hidden="true" tabindex="-1"></a>DollarPoundFX <span class="ot">&lt;-</span> <span class="fu">xts</span>(USMacroSWQ<span class="sc">$</span>EXUSUK, USMacroSWQ<span class="sc">$</span>Date)[<span class="st">&quot;1960::2013&quot;</span>]</span>
<span id="cb349-5"><a href="#cb349-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb349-6"><a href="#cb349-6" aria-hidden="true" tabindex="-1"></a>JPIndProd <span class="ot">&lt;-</span> <span class="fu">xts</span>(<span class="fu">log</span>(USMacroSWQ<span class="sc">$</span>JAPAN_IP), USMacroSWQ<span class="sc">$</span>Date)[<span class="st">&quot;1960::2013&quot;</span>]</span>
<span id="cb349-7"><a href="#cb349-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-8"><a href="#cb349-8" aria-hidden="true" tabindex="-1"></a><span class="co"># attach NYSESW data</span></span>
<span id="cb349-9"><a href="#cb349-9" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;NYSESW&quot;</span>)  </span>
<span id="cb349-10"><a href="#cb349-10" aria-hidden="true" tabindex="-1"></a>NYSESW <span class="ot">&lt;-</span> <span class="fu">xts</span>(<span class="fu">Delt</span>(NYSESW))</span></code></pre></div>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="co"># divide plotting area into 2x2 matrix</span></span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the series</span></span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.zoo</span>(USUnemp),</span>
<span id="cb350-6"><a href="#cb350-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb350-7"><a href="#cb350-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb350-8"><a href="#cb350-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Percent&quot;</span>,</span>
<span id="cb350-9"><a href="#cb350-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb350-10"><a href="#cb350-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;US Unemployment Rate&quot;</span>,</span>
<span id="cb350-11"><a href="#cb350-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.main =</span> <span class="dv">1</span>)</span>
<span id="cb350-12"><a href="#cb350-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-13"><a href="#cb350-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.zoo</span>(DollarPoundFX),</span>
<span id="cb350-14"><a href="#cb350-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb350-15"><a href="#cb350-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb350-16"><a href="#cb350-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Dollar per pound&quot;</span>,</span>
<span id="cb350-17"><a href="#cb350-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb350-18"><a href="#cb350-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;U.S. Dollar / B. Pound Exchange Rate&quot;</span>,</span>
<span id="cb350-19"><a href="#cb350-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.main =</span> <span class="dv">1</span>)</span>
<span id="cb350-20"><a href="#cb350-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-21"><a href="#cb350-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.zoo</span>(JPIndProd),</span>
<span id="cb350-22"><a href="#cb350-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb350-23"><a href="#cb350-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb350-24"><a href="#cb350-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Logarithm&quot;</span>,</span>
<span id="cb350-25"><a href="#cb350-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb350-26"><a href="#cb350-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Japanese Industrial Production&quot;</span>,</span>
<span id="cb350-27"><a href="#cb350-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.main =</span> <span class="dv">1</span>)</span>
<span id="cb350-28"><a href="#cb350-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-29"><a href="#cb350-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.zoo</span>(NYSESW),</span>
<span id="cb350-30"><a href="#cb350-30" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb350-31"><a href="#cb350-31" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb350-32"><a href="#cb350-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Percent per Day&quot;</span>,</span>
<span id="cb350-33"><a href="#cb350-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb350-34"><a href="#cb350-34" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;New York Stock Exchange Composite Index&quot;</span>,</span>
<span id="cb350-35"><a href="#cb350-35" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.main =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-588-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The series show quite different characteristics. The unemployment rate increases during recessions and declines during economic recoveries and growth. The Dollar/Pound exchange rates shows a deterministic pattern until the end of the Bretton Woods system. Japan’s industrial production exhibits an upward trend and decreasing growth. Daily changes in the New York Stock Exchange composite index seem to fluctuate randomly around the zero line. The sample autocorrelations support this conjecture.</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute sample autocorrelation for the NYSESW series</span></span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">na.omit</span>(NYSESW), <span class="at">plot =</span> F, <span class="at">lag.max =</span> <span class="dv">10</span>)</span>
<span id="cb351-3"><a href="#cb351-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb351-4"><a href="#cb351-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Autocorrelations of series &#39;na.omit(NYSESW)&#39;, by lag</span></span>
<span id="cb351-5"><a href="#cb351-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb351-6"><a href="#cb351-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      0      1      2      3      4      5      6      7      8      9     10 </span></span>
<span id="cb351-7"><a href="#cb351-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1.000  0.040 -0.016 -0.023  0.000 -0.036 -0.027 -0.059  0.013  0.017  0.004</span></span></code></pre></div>
<p>The first 10 sample autocorrelation coefficients are very close to zero. The default plot generated by <code>acf()</code> provides further evidence.</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot sample autocorrelation for the NYSESW series</span></span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">na.omit</span>(NYSESW), <span class="at">main =</span> <span class="st">&quot;Sample Autocorrelation for NYSESW Data&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-590-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The blue dashed bands represent values beyond which the autocorrelations are significantly different from zero at <span class="math inline">\(5\%\)</span> level. Even when the true autocorrelations are zero, we need to expect a few exceedences — recall the definition of a type-I-error from Key Concept 3.5.
For most lags we see that the sample autocorrelation does not exceed the bands and there are only a few cases that lie marginally beyond the limits.</p>
<p>Furthermore, the <tt>NYSESW</tt> series exhibits what econometricians call <em>volatility clustering</em>: there are periods of high and periods of low variance. This is common for many financial time series.</p>
</div>
</div>
</div>
<div id="autoregressions" class="section level2 hasAnchor" number="14.3">
<h2 class="hasAnchor"><span class="header-section-number">14.3</span> Autoregressions<a href="#autoregressions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Autoregressive models are heavily used in economic forecasting. An autoregressive model relates a time series variable to its past values. This section discusses the basic ideas of autoregressions models, shows how they are estimated and discusses an application to forecasting GDP growth using <tt>R</tt>.</p>
<div id="the-first-order-autoregressive-model" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">The First-Order Autoregressive Model<a href="#the-first-order-autoregressive-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>It is intuitive that the immediate past of a variable should have power to predict its near future. The simplest autoregressive model uses only the most recent outcome of the time series observed to predict future values. For a time series <span class="math inline">\(Y_t\)</span> such a model is called a first-order autoregressive model, often abbreviated AR(1), where the 1 indicates that the order of autoregression is one:
<span class="math display">\[\begin{align*}
  Y_t = \beta_0 + \beta_1 Y_{t-1} + u_t
\end{align*}\]</span>
is the AR(1) population model of a time series <span class="math inline">\(Y_t\)</span>.</p>
<p>For the GDP growth series, an autoregressive model of order one uses only the information on GDP growth observed in the last quarter to predict a future growth rate. The first-order autoregression model of GDP growth can be estimated by computing OLS estimates in the regression of <span class="math inline">\(GDPGR_t\)</span> on <span class="math inline">\(GDPGR_{t-1}\)</span>,
<span class="math display">\[\begin{align}
  \widehat{GDPGR}_t = \hat\beta_0 + \hat\beta_1  GDPGR_{t-1}. (\#eq:GDPGRAR1)
\end{align}\]</span>
Following the book we use data from 1962 to 2012 to estimate @ref(eq:GDPGRAR1). This is easily done with the function <tt>ar.ols()</tt> from the package <tt>stats</tt>.</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subset data</span></span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a>GDPGRSub <span class="ot">&lt;-</span> GDPGrowth[<span class="st">&quot;1962::2012&quot;</span>]</span>
<span id="cb353-3"><a href="#cb353-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-4"><a href="#cb353-4" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model</span></span>
<span id="cb353-5"><a href="#cb353-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ar.ols</span>(GDPGRSub, </span>
<span id="cb353-6"><a href="#cb353-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">order.max =</span> <span class="dv">1</span>, </span>
<span id="cb353-7"><a href="#cb353-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">demean =</span> F, </span>
<span id="cb353-8"><a href="#cb353-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">intercept =</span> T)</span>
<span id="cb353-9"><a href="#cb353-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb353-10"><a href="#cb353-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb353-11"><a href="#cb353-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ar.ols(x = GDPGRSub, order.max = 1, demean = F, intercept = T)</span></span>
<span id="cb353-12"><a href="#cb353-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb353-13"><a href="#cb353-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb353-14"><a href="#cb353-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      1  </span></span>
<span id="cb353-15"><a href="#cb353-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.3384  </span></span>
<span id="cb353-16"><a href="#cb353-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb353-17"><a href="#cb353-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Intercept: 1.995 (0.2993) </span></span>
<span id="cb353-18"><a href="#cb353-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb353-19"><a href="#cb353-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Order selected 1  sigma^2 estimated as  9.886</span></span></code></pre></div>
<p>We can check that the computations done by <tt>ar.ols()</tt> are the same as done by <tt>lm()</tt>.</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="co"># length of data set</span></span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span><span class="fu">length</span>(GDPGRSub)</span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true" tabindex="-1"></a>GDPGR_level <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(GDPGRSub[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb354-5"><a href="#cb354-5" aria-hidden="true" tabindex="-1"></a>GDPGR_lags <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(GDPGRSub[<span class="sc">-</span>N])</span>
<span id="cb354-6"><a href="#cb354-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-7"><a href="#cb354-7" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model</span></span>
<span id="cb354-8"><a href="#cb354-8" aria-hidden="true" tabindex="-1"></a>armod <span class="ot">&lt;-</span> <span class="fu">lm</span>(GDPGR_level <span class="sc">~</span> GDPGR_lags)</span>
<span id="cb354-9"><a href="#cb354-9" aria-hidden="true" tabindex="-1"></a>armod</span>
<span id="cb354-10"><a href="#cb354-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb354-11"><a href="#cb354-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb354-12"><a href="#cb354-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = GDPGR_level ~ GDPGR_lags)</span></span>
<span id="cb354-13"><a href="#cb354-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb354-14"><a href="#cb354-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb354-15"><a href="#cb354-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)   GDPGR_lags  </span></span>
<span id="cb354-16"><a href="#cb354-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      1.9950       0.3384</span></span></code></pre></div>
<p>As usual, we may use <tt>coeftest()</tt> to obtain a robust summary on the estimated regression coefficients.</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="co"># robust summary</span></span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(armod, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb355-3"><a href="#cb355-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb355-4"><a href="#cb355-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb355-5"><a href="#cb355-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb355-6"><a href="#cb355-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb355-7"><a href="#cb355-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 1.994986   0.351274  5.6793 4.691e-08 ***</span></span>
<span id="cb355-8"><a href="#cb355-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GDPGR_lags  0.338436   0.076188  4.4421 1.470e-05 ***</span></span>
<span id="cb355-9"><a href="#cb355-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb355-10"><a href="#cb355-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Thus the estimated model is
<span class="math display">\[\begin{align}
  \widehat{GDPGR}_t = \underset{(0.351)}{1.995} + \underset{(0.076)}{0.338} GDPGR_{t-1} (\#eq:gdpgrar1).
\end{align}\]</span></p>
<p>We omit the first observation for <span class="math inline">\(GDPGR_{1962 \ Q1}\)</span> from the vector of the dependent variable since <span class="math inline">\(GDPGR_{1962 \ Q1 - 1} = GDPGR_{1961 \ Q4}\)</span>, is not included in the sample. Similarly, the last observation, <span class="math inline">\(GDPGR_{2012 \ Q4}\)</span>, is excluded from the predictor vector since the data does not include <span class="math inline">\(GDPGR_{2012 \ Q4 + 1} = GDPGR_{2013 \ Q1}\)</span>. Put differently, when estimating the model, one observation is lost because of the time series structure of the data.</p>
</div>
<div id="forecasts-and-forecast-errors" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Forecasts and Forecast Errors<a href="#forecasts-and-forecast-errors" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Suppose <span class="math inline">\(Y_t\)</span> follows an AR(1) model with an intercept and that you have an OLS estimate of the model on the basis of observations for <span class="math inline">\(T\)</span> periods. Then you may use the AR(1) model to obtain <span class="math inline">\(\widehat{Y}_{T+1\vert T}\)</span>, a forecast for <span class="math inline">\(Y_{T+1}\)</span> using data up to period <span class="math inline">\(T\)</span> where
<span class="math display">\[\begin{align*}
  \widehat{Y}_{T+1\vert T} = \hat{\beta}_0 + \hat{\beta}_1 Y_T.
\end{align*}\]</span></p>
<p>The forecast error is
<span class="math display">\[\begin{align*}
  \text{Forecast error} = Y_{T+1} - \widehat{Y}_{T+1\vert T}.
\end{align*}\]</span></p>
</div>
<div id="forecasts-and-forecasted-values" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Forecasts and Forecasted Values<a href="#forecasts-and-forecasted-values" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Forecasted values of <span class="math inline">\(Y_t\)</span> are <em>not</em> what we refer to as <em>OLS predicted values</em> of <span class="math inline">\(Y_t\)</span>. Also, the forecast error is <em>not</em> an OLS residual. Forecasts and forecast errors are obtained using <em>out-of-sample</em> values while predicted values and residuals are computed for <em>in-sample</em> values that were actually observed and used in estimating the model.</p>
<p>The root mean squared forecast error (RMSFE) measures the typical size of the forecast error and is defined as
<span class="math display">\[\begin{align*}
  RMSFE = \sqrt{E\left[\left(Y_{T+1} - \widehat{Y}_{T+1\vert T}\right)^2\right]}.
\end{align*}\]</span></p>
<p>The <span class="math inline">\(RMSFE\)</span> is composed of the future errors <span class="math inline">\(u_t\)</span> and the error made when estimating the coefficients. When the sample size is large, the former may be much larger than the latter so that <span class="math inline">\(RMSFE \approx \sqrt{Var()u_t}\)</span> which can be estimated by the standard error of the regression.</p>
</div>
<div id="application-to-gdp-growth" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Application to GDP Growth<a href="#application-to-gdp-growth" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Using @ref(eq:gdpgrar1), the estimated AR(1) model of GDP growth, we perform the forecast for GDP growth for 2013:Q1 (remember that the model was estimated using data for periods 1962:Q1 - 2012:Q4, so 2013:Q1 is an out-of-sample period). Plugging <span class="math inline">\(GDPGR_{2012:Q4} \approx 0.15\)</span> into @ref(eq:gdpgrar1),</p>
<p><span class="math display">\[\begin{align*}
  \widehat{GDPGR}_{2013:Q1} = 1.995 + 0.348 \cdot 0.15 = 2.047.
\end{align*}\]</span></p>
<p>The function <tt>forecast()</tt> from the <tt>forecast</tt> package has some useful features for forecasting time series data.</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb356-2"><a href="#cb356-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-3"><a href="#cb356-3" aria-hidden="true" tabindex="-1"></a><span class="co"># assign GDP growth rate in 2012:Q4</span></span>
<span id="cb356-4"><a href="#cb356-4" aria-hidden="true" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;GDPGR_lags&quot;</span> <span class="ot">=</span> GDPGR_level[N<span class="dv">-1</span>])</span>
<span id="cb356-5"><a href="#cb356-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-6"><a href="#cb356-6" aria-hidden="true" tabindex="-1"></a><span class="co"># forecast GDP growth rate in 2013:Q1</span></span>
<span id="cb356-7"><a href="#cb356-7" aria-hidden="true" tabindex="-1"></a><span class="fu">forecast</span>(armod, <span class="at">newdata =</span> new)</span>
<span id="cb356-8"><a href="#cb356-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Point Forecast     Lo 80    Hi 80     Lo 95    Hi 95</span></span>
<span id="cb356-9"><a href="#cb356-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       2.044155 -2.036225 6.124534 -4.213414 8.301723</span></span></code></pre></div>
<p>Using <tt>forecast()</tt>produces the same point forecast of about 2.0, along with <span class="math inline">\(80\%\)</span> and <span class="math inline">\(95\%\)</span> forecast intervals, see section @ref(apatadlm). We conclude that our AR(1) model forecasts GDP growth to be <span class="math inline">\(2\%\)</span> in 2013:Q1.</p>
<p>How accurate is this forecast? The forecast error is quite large: <span class="math inline">\(GDPGR_{2013:Q1} \approx 1.1\%\)</span> while our forecast is <span class="math inline">\(2\%\)</span>.
Second, by calling <code>summary(armod)</code> shows that the model explains only little of the variation in the growth rate of GDP and the <span class="math inline">\(SER\)</span> is about <span class="math inline">\(3.16\)</span>. Leaving aside forecast uncertainty due to estimation of the model coefficients <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, the <span class="math inline">\(RMSFE\)</span> must be at least <span class="math inline">\(3.16\%\)</span>, the estimate of the standard deviation of the errors. We conclude that this forecast is pretty inaccurate.</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the forecast error</span></span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a><span class="fu">forecast</span>(armod, <span class="at">newdata =</span> new)<span class="sc">$</span>mean <span class="sc">-</span> GDPGrowth[<span class="st">&quot;2013&quot;</span>][<span class="dv">1</span>]</span>
<span id="cb357-3"><a href="#cb357-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 x</span></span>
<span id="cb357-4"><a href="#cb357-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2013 Q1 0.9049532</span></span>
<span id="cb357-5"><a href="#cb357-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-6"><a href="#cb357-6" aria-hidden="true" tabindex="-1"></a><span class="co"># R^2</span></span>
<span id="cb357-7"><a href="#cb357-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(armod)<span class="sc">$</span>r.squared</span>
<span id="cb357-8"><a href="#cb357-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.1149576</span></span>
<span id="cb357-9"><a href="#cb357-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-10"><a href="#cb357-10" aria-hidden="true" tabindex="-1"></a><span class="co"># SER</span></span>
<span id="cb357-11"><a href="#cb357-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(armod)<span class="sc">$</span>sigma</span>
<span id="cb357-12"><a href="#cb357-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3.15979</span></span></code></pre></div>
</div>
<div id="autoregressive-models-of-order-p" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Autoregressive Models of Order <span class="math inline">\(p\)</span><a href="#autoregressive-models-of-order-p" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For forecasting GDP growth, the AR(<span class="math inline">\(1\)</span>) model @ref(eq:gdpgrar1) disregards any information in the past of the series that is more distant than one period. An AR(<span class="math inline">\(p\)</span>) model incorporates the information of <span class="math inline">\(p\)</span> lags of the series. The idea is explained in Key Concept 14.3.</p>
<div id="KC14.3" class="keyconcept">
<h3 class="right">
Key Concept 14.3
</h3>
<h3 class="left">
Autoregressions
</h3>
<p>
An AR(<span class="math inline">\(p\)</span>) model assumes that a time series <span class="math inline">\(Y_t\)</span> can be modeled by a linear function of the first <span class="math inline">\(p\)</span> of its lagged values.
<span class="math display">\[\begin{align*}
  Y_t = \beta_0 + \beta_1 Y_{t-1} + \beta_2 Y_{t-2} + \dots + \beta_p Y_{t-p} + u_t
\end{align*}\]</span>
is an autoregressive model of order <span class="math inline">\(p\)</span> where <span class="math inline">\(E(u_t\vert Y_{t-1}, Y_{t-2}, \dots,Y_{t-p})=0\)</span>.
</p>
</div>
<p>Following the book, we estimate an AR(<span class="math inline">\(2\)</span>) model of the GDP growth series from 1962:Q1 to 2012:Q4.</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the AR(2) model</span></span>
<span id="cb358-2"><a href="#cb358-2" aria-hidden="true" tabindex="-1"></a>GDPGR_AR2 <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(<span class="fu">ts</span>(GDPGR_level) <span class="sc">~</span> <span class="fu">L</span>(<span class="fu">ts</span>(GDPGR_level)) <span class="sc">+</span> <span class="fu">L</span>(<span class="fu">ts</span>(GDPGR_level), <span class="dv">2</span>))</span>
<span id="cb358-3"><a href="#cb358-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-4"><a href="#cb358-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(GDPGR_AR2, <span class="at">vcov. =</span> sandwich)</span>
<span id="cb358-5"><a href="#cb358-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb358-6"><a href="#cb358-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb358-7"><a href="#cb358-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb358-8"><a href="#cb358-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                       Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb358-9"><a href="#cb358-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)           1.631747   0.402023  4.0588 7.096e-05 ***</span></span>
<span id="cb358-10"><a href="#cb358-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; L(ts(GDPGR_level))    0.277787   0.079250  3.5052 0.0005643 ***</span></span>
<span id="cb358-11"><a href="#cb358-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; L(ts(GDPGR_level), 2) 0.179269   0.079951  2.2422 0.0260560 *  </span></span>
<span id="cb358-12"><a href="#cb358-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb358-13"><a href="#cb358-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The estimation yields
<span class="math display">\[\begin{align}
  \widehat{GDPGR}_t = \underset{(0.40)}{1.63} + \underset{(0.08)}{0.28} GDPGR_{t-1} + \underset{(0.08)}{0.18} GDPGR_{t-1}. (\#eq:GDPGRAR2)
\end{align}\]</span>
We see that the coefficient on the second lag is significantly different from zero. The fit improves slightly: <span class="math inline">\(\bar{R}^2\)</span> grows from <span class="math inline">\(0.11\)</span> for the AR(<span class="math inline">\(1\)</span>) model to about <span class="math inline">\(0.14\)</span> and the <span class="math inline">\(SER\)</span> reduces to <span class="math inline">\(3.13\)</span>.</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R^2</span></span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(GDPGR_AR2)<span class="sc">$</span>r.squared</span>
<span id="cb359-3"><a href="#cb359-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.1425484</span></span>
<span id="cb359-4"><a href="#cb359-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-5"><a href="#cb359-5" aria-hidden="true" tabindex="-1"></a><span class="co"># SER</span></span>
<span id="cb359-6"><a href="#cb359-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(GDPGR_AR2)<span class="sc">$</span>sigma</span>
<span id="cb359-7"><a href="#cb359-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3.132122</span></span></code></pre></div>
<p>We may use the AR(<span class="math inline">\(2\)</span>) model to obtain a forecast for GDP growth in 2013:Q1 in the same manner as for the AR(1) model.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AR(2) forecast of GDP growth in 2013:Q1 </span></span>
<span id="cb360-2"><a href="#cb360-2" aria-hidden="true" tabindex="-1"></a>forecast <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;2013:Q1&quot;</span> <span class="ot">=</span> <span class="fu">coef</span>(GDPGR_AR2) <span class="sc">%*%</span> <span class="fu">c</span>(<span class="dv">1</span>, GDPGR_level[N<span class="dv">-1</span>], GDPGR_level[N<span class="dv">-2</span>]))</span></code></pre></div>
<p>This leads to a forecast error of roughly <span class="math inline">\(-1\%\)</span>.</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute AR(2) forecast error </span></span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a>GDPGrowth[<span class="st">&quot;2013&quot;</span>][<span class="dv">1</span>] <span class="sc">-</span> forecast</span>
<span id="cb361-3"><a href="#cb361-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 x</span></span>
<span id="cb361-4"><a href="#cb361-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2013 Q1 -1.025358</span></span></code></pre></div>
</div>
</div>
<div id="cybtmpi" class="section level2 hasAnchor" number="14.4">
<h2 class="hasAnchor"><span class="header-section-number">14.4</span> Can You Beat the Market? (Part I)<a href="#cybtmpi" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The theory of efficient capital markets states that stock prices embody all currently available information. If this hypothesis holds, it should not be possible to estimate a useful model for forecasting future stock returns using publicly available information on past returns (this is also referred to as the weak-form efficiency hypothesis): if it was possible to forecast the market, traders would be able to arbitrage, e.g., by relying on an AR(<span class="math inline">\(2\)</span>) model, they would use information that is not already priced-in which would push prices until the expected return is zero.</p>
<p>This idea is presented in the box <em>Can You Beat the Market? (Part I)</em> on p. 582 of the book. This section reproduces the estimation results.</p>
<p>We start by importing monthly data from 1931:1 to 2002:12 on excess returns of a broad-based index of stock prices, the CRSP value-weighted index. The data are provided by the authors of the book as an excel sheet which can be downloaded <a href="https://wps.pearsoned.com/wps/media/objects/11422/11696965/data3eu/Stock_Returns_1931_2002.xlsx">here</a>.</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read in data on stock returns</span></span>
<span id="cb362-2"><a href="#cb362-2" aria-hidden="true" tabindex="-1"></a>SReturns <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">&quot;Data/Stock_Returns_1931_2002.xlsx&quot;</span>,</span>
<span id="cb362-3"><a href="#cb362-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">sheet =</span> <span class="dv">1</span>,</span>
<span id="cb362-4"><a href="#cb362-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col_types =</span> <span class="st">&quot;numeric&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Alternatively, ASC  cen be read directly from internet.</span></span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a>SReturns <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://www.princeton.edu/~mwatson/Stock-Watson_3u/Students/EE_Datasets/Stock_Returns_1931_2002.asc&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">header =</span> <span class="cn">FALSE</span> )</span>
<span id="cb363-4"><a href="#cb363-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-5"><a href="#cb363-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(SReturns) <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">&quot;Year&quot;</span>, <span class="st">&quot;Month&quot;</span>, <span class="st">&quot;ExReturn&quot;</span>, <span class="st">&quot;ln_DivYield&quot;</span> )</span></code></pre></div>
<p>We continue by converting the data to an object of class <tt>ts</tt>.</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to ts object</span></span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a>StockReturns <span class="ot">&lt;-</span> <span class="fu">ts</span>(SReturns[, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>], </span>
<span id="cb364-3"><a href="#cb364-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1931</span>, <span class="dv">1</span>), </span>
<span id="cb364-4"><a href="#cb364-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2002</span>, <span class="dv">12</span>), </span>
<span id="cb364-5"><a href="#cb364-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">frequency =</span> <span class="dv">12</span>)</span></code></pre></div>
<p>Next, we estimate AR(<span class="math inline">\(1\)</span>), AR(<span class="math inline">\(2\)</span>) and AR(<span class="math inline">\(4\)</span>) models of excess returns for the time period 1960:1 to 2002:12.</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate AR models:</span></span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-3"><a href="#cb365-3" aria-hidden="true" tabindex="-1"></a><span class="co"># AR(1)</span></span>
<span id="cb365-4"><a href="#cb365-4" aria-hidden="true" tabindex="-1"></a>SR_AR1 <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(ExReturn <span class="sc">~</span> <span class="fu">L</span>(ExReturn), </span>
<span id="cb365-5"><a href="#cb365-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> StockReturns, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1960</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2002</span>, <span class="dv">12</span>))</span>
<span id="cb365-6"><a href="#cb365-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-7"><a href="#cb365-7" aria-hidden="true" tabindex="-1"></a><span class="co"># AR(2)</span></span>
<span id="cb365-8"><a href="#cb365-8" aria-hidden="true" tabindex="-1"></a>SR_AR2 <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(ExReturn <span class="sc">~</span> <span class="fu">L</span>(ExReturn) <span class="sc">+</span> <span class="fu">L</span>(ExReturn, <span class="dv">2</span>), </span>
<span id="cb365-9"><a href="#cb365-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> StockReturns, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1960</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2002</span>, <span class="dv">12</span>))</span>
<span id="cb365-10"><a href="#cb365-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-11"><a href="#cb365-11" aria-hidden="true" tabindex="-1"></a><span class="co"># AR(4)</span></span>
<span id="cb365-12"><a href="#cb365-12" aria-hidden="true" tabindex="-1"></a>SR_AR4 <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(ExReturn <span class="sc">~</span> <span class="fu">L</span>(ExReturn) <span class="sc">+</span> <span class="fu">L</span>(ExReturn, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), </span>
<span id="cb365-13"><a href="#cb365-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> StockReturns, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1960</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2002</span>, <span class="dv">12</span>))</span></code></pre></div>
<p>After computing robust standard errors, we gather the results in a table generated by <tt>stargazer()</tt>.</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute robust standard errors</span></span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a>rob_se <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">sandwich</span>(SR_AR1))),</span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">sandwich</span>(SR_AR2))),</span>
<span id="cb366-4"><a href="#cb366-4" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">sandwich</span>(SR_AR4))))</span></code></pre></div>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate table using &#39;stargazer()&#39;</span></span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(SR_AR1, SR_AR2, SR_AR4,</span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Autoregressive Models of Monthly Excess Stock Returns&quot;</span>,</span>
<span id="cb367-4"><a href="#cb367-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">header =</span> <span class="cn">FALSE</span>, </span>
<span id="cb367-5"><a href="#cb367-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">model.numbers =</span> F,</span>
<span id="cb367-6"><a href="#cb367-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">omit.table.layout =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb367-7"><a href="#cb367-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">3</span>, </span>
<span id="cb367-8"><a href="#cb367-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">column.labels =</span> <span class="fu">c</span>(<span class="st">&quot;AR(1)&quot;</span>, <span class="st">&quot;AR(2)&quot;</span>, <span class="st">&quot;AR(4)&quot;</span>),</span>
<span id="cb367-9"><a href="#cb367-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">dep.var.caption  =</span> <span class="st">&quot;Dependent Variable: Excess Returns on the CSRP Value-Weighted Index&quot;</span>,</span>
<span id="cb367-10"><a href="#cb367-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">dep.var.labels.include =</span> <span class="cn">FALSE</span>,</span>
<span id="cb367-11"><a href="#cb367-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">covariate.labels =</span> <span class="fu">c</span>(<span class="st">&quot;$excess return_{t-1}$&quot;</span>, <span class="st">&quot;$excess return_{t-2}$&quot;</span>, </span>
<span id="cb367-12"><a href="#cb367-12" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;$excess return_{t-3}$&quot;</span>, <span class="st">&quot;$excess return_{t-4}$&quot;</span>, </span>
<span id="cb367-13"><a href="#cb367-13" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Intercept&quot;</span>),</span>
<span id="cb367-14"><a href="#cb367-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> rob_se,</span>
<span id="cb367-15"><a href="#cb367-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">omit.stat =</span> <span class="st">&quot;rsq&quot;</span>) </span></code></pre></div>



<table style="text-align:center"><tr><td colspan="4" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"></td><td colspan="3">Dependent Variable: Excess returns on the CSRP Value-Weighted Index</td></tr>
<tr><td></td><td colspan="3" style="border-bottom: 1px solid black"></td></tr>
<tr><td style="text-align:left"></td><td>AR(1)</td><td>AR(2)</td><td>AR(4)</td></tr>
<tr><td colspan="4" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">excess return<sub>t-1</sub></td><td>0.050</td><td>0.053</td><td>0.054</td></tr>
<tr><td style="text-align:left"></td><td>(0.051)</td><td>(0.051)</td><td>(0.051)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">excess return<sub>t-2</sub></td><td></td><td>-0.053</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(0.048)</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">excess return<sub>t-3</sub></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">excess return<sub>t-4</sub></td><td></td><td></td><td>-0.054</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td>(0.048)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">Intercept</td><td></td><td></td><td>0.009</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td>(0.050)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">L(ExReturn, 1:4)4</td><td></td><td></td><td>-0.016</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td>(0.047)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">Constant</td><td>0.312</td><td>0.328<sup>*</sup></td><td>0.331</td></tr>
<tr><td style="text-align:left"></td><td>(0.197)</td><td>(0.199)</td><td>(0.202)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td></tr>
<tr><td colspan="4" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">Observations</td><td>516</td><td>516</td><td>516</td></tr>
<tr><td style="text-align:left">Adjusted R<sup>2</sup></td><td>0.001</td><td>0.001</td><td>-0.002</td></tr>
<tr><td style="text-align:left">Residual Std. Error</td><td>4.334 (df = 514)</td><td>4.332 (df = 513)</td><td>4.340 (df = 511)</td></tr>
<tr><td style="text-align:left">F Statistic</td><td>1.306 (df = 1; 514)</td><td>1.367 (df = 2; 513)</td><td>0.721 (df = 4; 511)</td></tr>
<tr><td colspan="4" style="border-bottom: 1px solid black"></td></tr></table>
<caption><p style='text-align:center'>(#tab:amomesr) Autoregressive Models of Monthly Excess Stock Returns</p></caption>


<p>The results are consistent with the hypothesis of efficient financial markets: there are no statistically significant coefficients in any of the estimated models and the hypotheses that all coefficients are zero cannot be rejected. <span class="math inline">\(\bar{R}^2\)</span> is almost zero in all models and even negative for the AR(<span class="math inline">\(4\)</span>) model. This suggests that none of the models are useful for forecasting stock returns.</p>
</div>
<div id="apatadlm" class="section level2 hasAnchor" number="14.5">
<h2 class="hasAnchor"><span class="header-section-number">14.5</span> Additional Predictors and The ADL Model<a href="#apatadlm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Instead of only using the dependent variable’s lags as predictors, an autoregressive distributed lag (ADL) model also uses lags of other variables for forecasting. The general ADL model is summarized in Key Concept 14.4:</p>
<div id="KC14.4" class="keyconcept">
<h3 class="right">
Key Concept 14.4
</h3>
<h3 class="left">
The Autoregressive Distributed Lag Model
</h3>
<p>
An ADL(<span class="math inline">\(p\)</span>,<span class="math inline">\(q\)</span>) model assumes that a time series <span class="math inline">\(Y_t\)</span> can be represented by a linear function of <span class="math inline">\(p\)</span> of its lagged values and <span class="math inline">\(q\)</span> lags of another time series <span class="math inline">\(X_t\)</span>:
<span class="math display">\[\begin{align*}
  Y_t =&amp; \, \beta_0 + \beta_1 Y_{t-1} + \beta_2 Y_{t-2} + \dots + \beta_p Y_{t-p} \\
      &amp;+ \, \delta_1 X_{t-1} + \delta_2 X_{t-2} + \dots + \delta_q X_{t-q} + u_t.
\end{align*}\]</span>
is an <em>autoregressive distributed lag model</em> with <span class="math inline">\(p\)</span> lags of <span class="math inline">\(Y_t\)</span> and <span class="math inline">\(q\)</span> lags of <span class="math inline">\(X_t\)</span> where <span class="math display">\[E(u_t\vert Y_{t-1}, Y_{t-2}, \dots, X_{t-1}, X_{t-2}, \dots)=0.\]</span>
</p>
</div>
<div id="forecasting-gdp-growth-using-the-term-spread" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Forecasting GDP Growth Using the Term Spread<a href="#forecasting-gdp-growth-using-the-term-spread" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Interest rates on long-term and short term treasury bonds are closely linked to macroeconomic conditions. While interest rates on both types of bonds have the same long-run tendencies, they behave quite differently in the short run.
The difference in interest rates of two bonds with distinct maturity is called the <em>term spread</em>.</p>
<p>The following code chunks reproduce Figure 14.3 of the book which displays interest rates of 10-year U.S. Treasury bonds and 3-month U.S. Treasury bills from 1960 to 2012.</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3-month Treasury bills interest rate</span></span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a>TB3MS <span class="ot">&lt;-</span> <span class="fu">xts</span>(USMacroSWQ<span class="sc">$</span>TB3MS, USMacroSWQ<span class="sc">$</span>Date)[<span class="st">&quot;1960::2012&quot;</span>]</span>
<span id="cb368-3"><a href="#cb368-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-4"><a href="#cb368-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 10-year Treasury bonds interest rate</span></span>
<span id="cb368-5"><a href="#cb368-5" aria-hidden="true" tabindex="-1"></a>TB10YS <span class="ot">&lt;-</span> <span class="fu">xts</span>(USMacroSWQ<span class="sc">$</span>GS10, USMacroSWQ<span class="sc">$</span>Date)[<span class="st">&quot;1960::2012&quot;</span>]</span>
<span id="cb368-6"><a href="#cb368-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-7"><a href="#cb368-7" aria-hidden="true" tabindex="-1"></a><span class="co"># term spread</span></span>
<span id="cb368-8"><a href="#cb368-8" aria-hidden="true" tabindex="-1"></a>TSpread <span class="ot">&lt;-</span> TB10YS <span class="sc">-</span> TB3MS</span></code></pre></div>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reproduce Figure 14.2 (a) of the book</span></span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">merge</span>(<span class="fu">as.zoo</span>(TB3MS), <span class="fu">as.zoo</span>(TB10YS)), </span>
<span id="cb369-3"><a href="#cb369-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">plot.type =</span> <span class="st">&quot;single&quot;</span>, </span>
<span id="cb369-4"><a href="#cb369-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;steelblue&quot;</span>),</span>
<span id="cb369-5"><a href="#cb369-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb369-6"><a href="#cb369-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb369-7"><a href="#cb369-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Percent per annum&quot;</span>,</span>
<span id="cb369-8"><a href="#cb369-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Interest Rates&quot;</span>)</span>
<span id="cb369-9"><a href="#cb369-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-10"><a href="#cb369-10" aria-hidden="true" tabindex="-1"></a><span class="co"># define function that transform years to class &#39;yearqtr&#39;</span></span>
<span id="cb369-11"><a href="#cb369-11" aria-hidden="true" tabindex="-1"></a>YToYQTR <span class="ot">&lt;-</span> <span class="cf">function</span>(years) {</span>
<span id="cb369-12"><a href="#cb369-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(</span>
<span id="cb369-13"><a href="#cb369-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sort</span>(<span class="fu">as.yearqtr</span>(<span class="fu">sapply</span>(years, paste, <span class="fu">c</span>(<span class="st">&quot;Q1&quot;</span>, <span class="st">&quot;Q2&quot;</span>, <span class="st">&quot;Q3&quot;</span>, <span class="st">&quot;Q4&quot;</span>))))</span>
<span id="cb369-14"><a href="#cb369-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb369-15"><a href="#cb369-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb369-16"><a href="#cb369-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-17"><a href="#cb369-17" aria-hidden="true" tabindex="-1"></a><span class="co"># recessions</span></span>
<span id="cb369-18"><a href="#cb369-18" aria-hidden="true" tabindex="-1"></a>recessions <span class="ot">&lt;-</span> <span class="fu">YToYQTR</span>(<span class="fu">c</span>(<span class="dv">1961</span><span class="sc">:</span><span class="dv">1962</span>, <span class="dv">1970</span>, <span class="dv">1974</span><span class="sc">:</span><span class="dv">1975</span>, <span class="dv">1980</span><span class="sc">:</span><span class="dv">1982</span>, <span class="dv">1990</span><span class="sc">:</span><span class="dv">1991</span>, <span class="dv">2001</span>, <span class="dv">2007</span><span class="sc">:</span><span class="dv">2008</span>))</span>
<span id="cb369-19"><a href="#cb369-19" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb369-20"><a href="#cb369-20" aria-hidden="true" tabindex="-1"></a><span class="co"># add color shading for recessions</span></span>
<span id="cb369-21"><a href="#cb369-21" aria-hidden="true" tabindex="-1"></a><span class="fu">xblocks</span>(<span class="fu">time</span>(<span class="fu">as.zoo</span>(TB3MS)), </span>
<span id="cb369-22"><a href="#cb369-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="fu">time</span>(TB3MS) <span class="sc">%in%</span> recessions), </span>
<span id="cb369-23"><a href="#cb369-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">&quot;steelblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>))</span>
<span id="cb369-24"><a href="#cb369-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-25"><a href="#cb369-25" aria-hidden="true" tabindex="-1"></a><span class="co"># add a legend</span></span>
<span id="cb369-26"><a href="#cb369-26" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, </span>
<span id="cb369-27"><a href="#cb369-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;TB3MS&quot;</span>, <span class="st">&quot;TB10YS&quot;</span>),</span>
<span id="cb369-28"><a href="#cb369-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;steelblue&quot;</span>),</span>
<span id="cb369-29"><a href="#cb369-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-613-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a><span class="co"># reproduce Figure 14.2 (b) of the book</span></span>
<span id="cb370-3"><a href="#cb370-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.zoo</span>(TSpread), </span>
<span id="cb370-4"><a href="#cb370-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb370-5"><a href="#cb370-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb370-6"><a href="#cb370-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb370-7"><a href="#cb370-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Percent per annum&quot;</span>,</span>
<span id="cb370-8"><a href="#cb370-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Term Spread&quot;</span>)</span>
<span id="cb370-9"><a href="#cb370-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-10"><a href="#cb370-10" aria-hidden="true" tabindex="-1"></a><span class="co"># add color shading for recessions</span></span>
<span id="cb370-11"><a href="#cb370-11" aria-hidden="true" tabindex="-1"></a><span class="fu">xblocks</span>(<span class="fu">time</span>(<span class="fu">as.zoo</span>(TB3MS)), </span>
<span id="cb370-12"><a href="#cb370-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="fu">time</span>(TB3MS) <span class="sc">%in%</span> recessions), </span>
<span id="cb370-13"><a href="#cb370-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">&quot;steelblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>))</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-613-2.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Before recessions, the gap between interest rates on long-term bonds and short term bills narrows and consequently the term spread declines drastically towards zero or even becomes negative in times of economic stress. This information might be used to improve GDP growth forecasts of future.</p>
<p>We check this by estimating an ADL(<span class="math inline">\(2\)</span>, <span class="math inline">\(1\)</span>) model and an ADL(<span class="math inline">\(2\)</span>, <span class="math inline">\(2\)</span>) model of the GDP growth rate using lags of GDP growth and lags of the term spread as regressors. We then use both models for forecasting GDP growth in 2013:Q1.</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert growth and spread series to ts objects</span></span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a>GDPGrowth_ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(GDPGrowth, </span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1960</span>, <span class="dv">1</span>), </span>
<span id="cb371-4"><a href="#cb371-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2013</span>, <span class="dv">4</span>), </span>
<span id="cb371-5"><a href="#cb371-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb371-6"><a href="#cb371-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-7"><a href="#cb371-7" aria-hidden="true" tabindex="-1"></a>TSpread_ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(TSpread, </span>
<span id="cb371-8"><a href="#cb371-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1960</span>, <span class="dv">1</span>), </span>
<span id="cb371-9"><a href="#cb371-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>), </span>
<span id="cb371-10"><a href="#cb371-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb371-11"><a href="#cb371-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-12"><a href="#cb371-12" aria-hidden="true" tabindex="-1"></a><span class="co"># join both ts objects</span></span>
<span id="cb371-13"><a href="#cb371-13" aria-hidden="true" tabindex="-1"></a>ADLdata <span class="ot">&lt;-</span> <span class="fu">ts.union</span>(GDPGrowth_ts, TSpread_ts)</span></code></pre></div>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the ADL(2,1) model of GDP growth</span></span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a>GDPGR_ADL21 <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(GDPGrowth_ts <span class="sc">~</span> <span class="fu">L</span>(GDPGrowth_ts) <span class="sc">+</span> <span class="fu">L</span>(GDPGrowth_ts, <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">L</span>(TSpread_ts), </span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>))</span>
<span id="cb372-4"><a href="#cb372-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-5"><a href="#cb372-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(GDPGR_ADL21, <span class="at">vcov. =</span> sandwich)</span>
<span id="cb372-6"><a href="#cb372-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb372-7"><a href="#cb372-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb372-8"><a href="#cb372-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb372-9"><a href="#cb372-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                    Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span id="cb372-10"><a href="#cb372-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)        0.954990   0.486976  1.9611 0.051260 . </span></span>
<span id="cb372-11"><a href="#cb372-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; L(GDPGrowth_ts)    0.267729   0.082562  3.2428 0.001387 **</span></span>
<span id="cb372-12"><a href="#cb372-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; L(GDPGrowth_ts, 2) 0.192370   0.077683  2.4763 0.014104 * </span></span>
<span id="cb372-13"><a href="#cb372-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; L(TSpread_ts)      0.444047   0.182637  2.4313 0.015925 * </span></span>
<span id="cb372-14"><a href="#cb372-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb372-15"><a href="#cb372-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The estimated equation of the ADL(<span class="math inline">\(2\)</span>, <span class="math inline">\(1\)</span>) model is
<span class="math display">\[\begin{align}
  \widehat{GDPGR}_t = \underset{(0.49)}{0.96} + \underset{(0.08)}{0.26} GDPGR_{t-1} + \underset{(0.08)}{0.19} GDPGR_{t-2} + \underset{(0.18)}{0.44} TSpread_{t-1} (\#eq:gdpgradl21)
\end{align}\]</span></p>
<p>All coefficients are significant at the level of <span class="math inline">\(5\%\)</span>.</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2012:Q3 / 2012:Q4 data on GDP growth and term spread</span></span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a>subset <span class="ot">&lt;-</span> <span class="fu">window</span>(ADLdata, <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">3</span>), <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>))</span>
<span id="cb373-3"><a href="#cb373-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-4"><a href="#cb373-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ADL(2,1) GDP growth forecast for 2013:Q1</span></span>
<span id="cb373-5"><a href="#cb373-5" aria-hidden="true" tabindex="-1"></a>ADL21_forecast <span class="ot">&lt;-</span> <span class="fu">coef</span>(GDPGR_ADL21) <span class="sc">%*%</span> <span class="fu">c</span>(<span class="dv">1</span>, subset[<span class="dv">2</span>, <span class="dv">1</span>], subset[<span class="dv">1</span>, <span class="dv">1</span>], subset[<span class="dv">2</span>, <span class="dv">2</span>])</span>
<span id="cb373-6"><a href="#cb373-6" aria-hidden="true" tabindex="-1"></a>ADL21_forecast</span>
<span id="cb373-7"><a href="#cb373-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          [,1]</span></span>
<span id="cb373-8"><a href="#cb373-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 2.241689</span></span>
<span id="cb373-9"><a href="#cb373-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-10"><a href="#cb373-10" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the forecast error</span></span>
<span id="cb373-11"><a href="#cb373-11" aria-hidden="true" tabindex="-1"></a><span class="fu">window</span>(GDPGrowth_ts, <span class="fu">c</span>(<span class="dv">2013</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2013</span>, <span class="dv">1</span>)) <span class="sc">-</span> ADL21_forecast</span>
<span id="cb373-12"><a href="#cb373-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Qtr1</span></span>
<span id="cb373-13"><a href="#cb373-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2013 -1.102487</span></span></code></pre></div>
<p>Model @ref(eq:gdpgradl21) predicts the GDP growth in 2013:Q1 to be <span class="math inline">\(2.24\%\)</span> which leads to a forecast error of <span class="math inline">\(-1.10\%\)</span>.</p>
<p>We estimate the ADL(<span class="math inline">\(2\)</span>,<span class="math inline">\(2\)</span>) specification to see whether adding additional information on past term spread improves the forecast.</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the ADL(2,2) model of GDP growth</span></span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a>GDPGR_ADL22 <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(GDPGrowth_ts <span class="sc">~</span> <span class="fu">L</span>(GDPGrowth_ts) <span class="sc">+</span> <span class="fu">L</span>(GDPGrowth_ts, <span class="dv">2</span>) </span>
<span id="cb374-3"><a href="#cb374-3" aria-hidden="true" tabindex="-1"></a>                     <span class="sc">+</span> <span class="fu">L</span>(TSpread_ts) <span class="sc">+</span> <span class="fu">L</span>(TSpread_ts, <span class="dv">2</span>), </span>
<span id="cb374-4"><a href="#cb374-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>))</span>
<span id="cb374-5"><a href="#cb374-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-6"><a href="#cb374-6" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(GDPGR_ADL22, <span class="at">vcov. =</span> sandwich)</span>
<span id="cb374-7"><a href="#cb374-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb374-8"><a href="#cb374-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb374-9"><a href="#cb374-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb374-10"><a href="#cb374-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span id="cb374-11"><a href="#cb374-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)         0.967967   0.472470  2.0487 0.041800 * </span></span>
<span id="cb374-12"><a href="#cb374-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; L(GDPGrowth_ts)     0.243175   0.077836  3.1242 0.002049 **</span></span>
<span id="cb374-13"><a href="#cb374-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; L(GDPGrowth_ts, 2)  0.177070   0.077027  2.2988 0.022555 * </span></span>
<span id="cb374-14"><a href="#cb374-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; L(TSpread_ts)      -0.139554   0.422162 -0.3306 0.741317   </span></span>
<span id="cb374-15"><a href="#cb374-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; L(TSpread_ts, 2)    0.656347   0.429802  1.5271 0.128326   </span></span>
<span id="cb374-16"><a href="#cb374-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb374-17"><a href="#cb374-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>We obtain
<span class="math display">\[\begin{align}
  \begin{split}
    \widehat{GDPGR}_t =&amp; \underset{(0.47)}{0.98} + \underset{(0.08)}{0.24} GDPGR_{t-1} \\
    &amp; + \underset{(0.08)}{0.18} GDPGR_{t-2} -\underset{(0.42)}{0.14} TSpread_{t-1} + \underset{(0.43)}{0.66} TSpread_{t-2}.
  \end{split} (\#eq:gdpgradl22)
\end{align}\]</span></p>
<p>The coefficients on both lags of the term spread are not significant at the <span class="math inline">\(10\%\)</span> level.</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ADL(2,2) GDP growth forecast for 2013:Q1</span></span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a>ADL22_forecast <span class="ot">&lt;-</span> <span class="fu">coef</span>(GDPGR_ADL22) <span class="sc">%*%</span> <span class="fu">c</span>(<span class="dv">1</span>, subset[<span class="dv">2</span>, <span class="dv">1</span>], subset[<span class="dv">1</span>, <span class="dv">1</span>], subset[<span class="dv">2</span>, <span class="dv">2</span>], subset[<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb375-3"><a href="#cb375-3" aria-hidden="true" tabindex="-1"></a>ADL22_forecast</span>
<span id="cb375-4"><a href="#cb375-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          [,1]</span></span>
<span id="cb375-5"><a href="#cb375-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 2.274407</span></span>
<span id="cb375-6"><a href="#cb375-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7"><a href="#cb375-7" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the forecast error</span></span>
<span id="cb375-8"><a href="#cb375-8" aria-hidden="true" tabindex="-1"></a><span class="fu">window</span>(GDPGrowth_ts, <span class="fu">c</span>(<span class="dv">2013</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2013</span>, <span class="dv">1</span>)) <span class="sc">-</span> ADL22_forecast</span>
<span id="cb375-9"><a href="#cb375-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Qtr1</span></span>
<span id="cb375-10"><a href="#cb375-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2013 -1.135206</span></span></code></pre></div>
<p>The ADL(<span class="math inline">\(2\)</span>,<span class="math inline">\(2\)</span>) forecast of GDP growth in 2013:Q1 is <span class="math inline">\(2.27\%\)</span> which implies a forecast error of <span class="math inline">\(1.14\%\)</span>.</p>
<p>Do the ADL models @ref(eq:gdpgradl21) and @ref(eq:gdpgradl22) improve upon the simple AR(<span class="math inline">\(2\)</span>) model @ref(eq:GDPGRAR2)? The answer is yes: while <span class="math inline">\(SER\)</span> and <span class="math inline">\(\bar{R}^2\)</span> improve only slightly, an <span class="math inline">\(F\)</span>-test on the term spread coefficients in @ref(eq:gdpgradl22) provides evidence that the model does better in explaining GDP growth than the AR(<span class="math inline">\(2\)</span>) model as the hypothesis that both coefficients are zero cannot be rejected at the level of <span class="math inline">\(5\%\)</span>.</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare adj. R2</span></span>
<span id="cb376-2"><a href="#cb376-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;Adj.R2 AR(2)&quot;</span> <span class="ot">=</span> <span class="fu">summary</span>(GDPGR_AR2)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb376-3"><a href="#cb376-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Adj.R2 ADL(2,1)&quot;</span> <span class="ot">=</span> <span class="fu">summary</span>(GDPGR_ADL21)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb376-4"><a href="#cb376-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Adj.R2 ADL(2,2)&quot;</span> <span class="ot">=</span> <span class="fu">summary</span>(GDPGR_ADL22)<span class="sc">$</span>adj.r.squared)</span>
<span id="cb376-5"><a href="#cb376-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Adj.R2 AR(2) Adj.R2 ADL(2,1) Adj.R2 ADL(2,2) </span></span>
<span id="cb376-6"><a href="#cb376-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       0.1338873       0.1620156       0.1691531</span></span>
<span id="cb376-7"><a href="#cb376-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-8"><a href="#cb376-8" aria-hidden="true" tabindex="-1"></a><span class="co"># compare SER</span></span>
<span id="cb376-9"><a href="#cb376-9" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;SER AR(2)&quot;</span> <span class="ot">=</span> <span class="fu">summary</span>(GDPGR_AR2)<span class="sc">$</span>sigma,</span>
<span id="cb376-10"><a href="#cb376-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;SER ADL(2,1)&quot;</span> <span class="ot">=</span> <span class="fu">summary</span>(GDPGR_ADL21)<span class="sc">$</span>sigma,</span>
<span id="cb376-11"><a href="#cb376-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;SER ADL(2,2)&quot;</span> <span class="ot">=</span> <span class="fu">summary</span>(GDPGR_ADL22)<span class="sc">$</span>sigma)</span>
<span id="cb376-12"><a href="#cb376-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    SER AR(2) SER ADL(2,1) SER ADL(2,2) </span></span>
<span id="cb376-13"><a href="#cb376-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     3.132122     3.070760     3.057655</span></span>
<span id="cb376-14"><a href="#cb376-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-15"><a href="#cb376-15" aria-hidden="true" tabindex="-1"></a><span class="co"># F-test on coefficients of term spread</span></span>
<span id="cb376-16"><a href="#cb376-16" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(GDPGR_ADL22, </span>
<span id="cb376-17"><a href="#cb376-17" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">&quot;L(TSpread_ts)=0&quot;</span>, <span class="st">&quot;L(TSpread_ts, 2)=0&quot;</span>),</span>
<span id="cb376-18"><a href="#cb376-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> sandwich)</span>
<span id="cb376-19"><a href="#cb376-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb376-20"><a href="#cb376-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb376-21"><a href="#cb376-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb376-22"><a href="#cb376-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; L(TSpread_ts) = 0</span></span>
<span id="cb376-23"><a href="#cb376-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; L(TSpread_ts, 2) = 0</span></span>
<span id="cb376-24"><a href="#cb376-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb376-25"><a href="#cb376-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb376-26"><a href="#cb376-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: GDPGrowth_ts ~ L(GDPGrowth_ts) + L(GDPGrowth_ts, 2) + L(TSpread_ts) + </span></span>
<span id="cb376-27"><a href="#cb376-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     L(TSpread_ts, 2)</span></span>
<span id="cb376-28"><a href="#cb376-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb376-29"><a href="#cb376-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb376-30"><a href="#cb376-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb376-31"><a href="#cb376-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F  Pr(&gt;F)  </span></span>
<span id="cb376-32"><a href="#cb376-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    201                    </span></span>
<span id="cb376-33"><a href="#cb376-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    199  2 4.4344 0.01306 *</span></span>
<span id="cb376-34"><a href="#cb376-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb376-35"><a href="#cb376-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
</div>
<div id="stationarity" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Stationarity<a href="#stationarity" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In general, forecasts can be improved by using multiple predictors — just as in cross-sectional regression. When constructing time series models one should take into account whether the variables are <em>stationary</em> or <em>nonstationary</em>. Key Concept 14.5 explains what stationarity is.</p>
<div id="KC14.5" class="keyconcept">
<h3 class="right">
Key Concept 14.5
</h3>
<h3 class="left">
Stationarity
</h3>
<p>A time series <span class="math inline">\(Y_t\)</span> is stationary if its probability distribution is time independent, that is the joint distribution of <span class="math inline">\(Y_{s+1}, Y_{s+2},\dots,Y_{s+T}\)</span> does not change as <span class="math inline">\(s\)</span> is varied, regardless of <span class="math inline">\(T\)</span>.</p>
<p>Similarly, two time series <span class="math inline">\(X_t\)</span> and <span class="math inline">\(Y_t\)</span> are <em>jointly stationary</em> if the joint distribution of <span class="math inline">\((X_{s+1},Y_{s+1}, X_{s+2},Y_{s+2} \dots, X_{s+T},Y_{s+T})\)</span> does not depend on <span class="math inline">\(s\)</span>, regardless of <span class="math inline">\(T\)</span>.</p>
<p>Stationarity makes it easier to learn about the characteristics of past data.</p>
</div>
</div>
<div id="time-series-regression-with-multiple-predictors" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Time Series Regression with Multiple Predictors<a href="#time-series-regression-with-multiple-predictors" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The concept of stationarity is a key assumption in the general time series regression model with multiple predictors. Key Concept 14.6 lays out this model and its assumptions.</p>
<div id="KC14.6" class="keyconcept">
<h3 class="right">
Key Concept 14.6
</h3>
<h3 class="left">
Time Series Regression with Multiple Predictors
</h3>
<p>The general time series regression model extends the ADL model such that multiple regressors and their lags are included. It uses <span class="math inline">\(p\)</span> lags of the dependent variable and <span class="math inline">\(q_l\)</span> lags of <span class="math inline">\(l\)</span> additional predictors where <span class="math inline">\(l=1,\dots,k\)</span>:</p>
<p><span class="math display">\[\begin{equation}
  \begin{aligned}
  Y_t =&amp;  \beta_0 + \beta_1 Y_{t-1} + \beta_2 Y_{t-2} + \dots + \beta_{p} Y_{t-p} \\
      &amp;+  \delta_{11} X_{1,t-1} + \delta_{12} X_{1,t-2} + \dots + \delta_{1q} X_{1,t-q} \\
      &amp;+  \dots \\
      &amp;+  \delta_{k1} X_{k,t-1} + \delta_{k2} X_{k,t-2} + \dots + \delta_{kq} X_{k,t-q} \\
      &amp;+  u_t
  \end{aligned}
\end{equation}\]</span></p>
<p>For estimation we make the following assumptions:</p>
<ol style="list-style-type: decimal">
<li><p>The error term <span class="math inline">\(u_t\)</span> has conditional mean zero given all regressors and their lags: <span class="math display">\[E(u_t\vert Y_{t-1}, Y_{t-2}, \dots, X_{1,t-1}, X_{1,t-2} \dots, X_{k,t-1}, X_{k,t-2}, \dots)\]</span> This assumption is an extension of the conditional mean zero assumption used for AR and ADL models and guarantees that the general time series regression model stated above gives the best forecast of <span class="math inline">\(Y_t\)</span> given its lags, the additional regressors <span class="math inline">\(X_{1,t},\dots,X_{k,t}\)</span> and their lags.</p></li>
<li><p>The i.i.d. assumption for cross-sectional data is not (entirely) meaningful for time series data. We replace it by the following assumption witch consists of two parts:</p>
<ol style="list-style-type: lower-alpha">
<li><p>The <span class="math inline">\((Y_{t}, X_{1,t}, \dots, X_{k,t})\)</span> have a stationary distribution (the “identically distributed” part of the i.i.d. assumption for cross-setional data). If this does not hold, forecasts <em>may</em> be biased and inference <em>can</em> be strongly misleading.</p></li>
<li><p><span class="math inline">\((Y_{t}, X_{1,t}, \dots, X_{k,t})\)</span> and <span class="math inline">\((Y_{t-j}, X_{1,t-j}, \dots, X_{k,t-j})\)</span> become independent as <span class="math inline">\(j\)</span> gets large (the “idependently” distributed part of the i.i.d. assumption for cross-sectional data). This assumption is also called <em>weak dependence</em>. It ensures that the WLLN and the CLT hold in large samples.</p></li>
</ol></li>
<li><p>Large outliers are unlikely: <span class="math inline">\(E(X_{1,t}^4), E(X_{2,t}^4), \dots, E(X_{k,t}^4)\)</span> and <span class="math inline">\(E(Y_t^4)\)</span> have nonzero, finite fourth moments.</p></li>
<li><p>No perfect multicollinearity.</p></li>
</ol>
</div>
<p>Since many economic time series appear to be nonstationary, assumption two of Key Concept 14.6 is a crucial one in applied macroeconomics and finance which is why statistical test for stationarity or nonstationarity have been developed. Chapters @ref(llsuic) and @ref(nit) are devoted to this topic.</p>
</div>
<div id="statistical-inference-and-the-granger-causality-test" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Statistical inference and the Granger causality test<a href="#statistical-inference-and-the-granger-causality-test" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If a <span class="math inline">\(X\)</span> is a useful predictor for <span class="math inline">\(Y\)</span>, in a regression of <span class="math inline">\(Y_t\)</span> on lags of its own and lags of <span class="math inline">\(X_t\)</span>, not all of the coefficients on the lags on <span class="math inline">\(X_t\)</span> are zero. This concept is called <em>Granger causality</em> and is an interesting hypothesis to test. Key Concept 14.7 summarizes the idea.</p>
<div id="KC14.7" class="keyconcept">
<h3 class="right">
Key Concept 14.7
</h3>
<h3 class="left">
Granger Causality Tests
</h3>
<p>The Granger causality test <span class="citation">Granger (<a href="#ref-granger1969" role="doc-biblioref">1969</a>)</span> is an <span class="math inline">\(F\)</span> test of the null hypothesis that <em>all</em> lags of a variable <span class="math inline">\(X\)</span> included in a time series regression model do not have predictive power for <span class="math inline">\(Y_t\)</span>. The Granger causality test does not test whether <span class="math inline">\(X\)</span> actually <em>causes</em> <span class="math inline">\(Y\)</span> but whether the included lags are informative in terms of predicting <span class="math inline">\(Y\)</span>.</p>
</div>
<p>We have already performed a Granger causality test on the coefficients of term spread in @ref(eq:gdpgradl22), the ADL(<span class="math inline">\(2\)</span>,<span class="math inline">\(2\)</span>) model of GDP growth and concluded that at least one of the first two lags of term spread has predictive power for GDP growth.</p>
</div>
<div id="forecast-uncertainty-and-forecast-intervals" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Forecast Uncertainty and Forecast Intervals<a href="#forecast-uncertainty-and-forecast-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In general, it is good practice to report a measure of the uncertainty when presenting results that are affected by the latter. Uncertainty is particularly of interest when forecasting a time series. For example, consider a simple ADL<span class="math inline">\((1,1)\)</span> model
<span class="math display">\[\begin{align*}
  Y_t = \beta_0 + \beta_1 Y_{t-1} + \delta_1 X_{t-1} + u_t
\end{align*}\]</span>
where <span class="math inline">\(u_t\)</span> is a homoskedastic error term. The forecast error is
<span class="math display">\[\begin{align*}
  Y_{T+1} - \widehat{Y}_{T+1\vert T} = u_{T+1} - \left[(\widehat{\beta}_0 - \beta_0) + (\widehat{\beta}_1 - \beta_1) Y_T + (\widehat{\delta_1} - \delta_1) X_T \right].
\end{align*}\]</span>
The mean squared forecast error (MSFE) and the RMFSE are
<span class="math display">\[\begin{align*}
  MFSE =&amp; \, E\left[(Y_{T+1} - \widehat{Y}_{T+1\vert T})^2 \right] \\
       =&amp; \, \sigma_u^2 + Var\left[ (\widehat{\beta}_0 - \beta_0) + (\widehat{\beta}_1 - \beta_1) Y_T + (\widehat{\delta_1} - \delta_1) X_T \right], \\
  RMFSE =&amp; \, \sqrt{\sigma_u^2 + Var\left[ (\widehat{\beta}_0 - \beta_0) + (\widehat{\beta}_1 - \beta_1) Y_T + (\widehat{\delta_1} - \delta_1) X_T \right]}.
\end{align*}\]</span></p>
<p>A <span class="math inline">\(95\%\)</span> forecast interval is an interval that covers the true value of <span class="math inline">\(Y_{T+1}\)</span> in <span class="math inline">\(95\%\)</span> of repeated applications. There is a major difference in computing a confidence interval and a forecast interval: when computing a confidence interval of a point estimate we use large sample approximations that are justified by the CLT and thus are valid for a large range of error term distributions. For computation of a forecast interval of <span class="math inline">\(Y_{T+1}\)</span>, however, we must make an additional assumption about the distribution of <span class="math inline">\(u_{T+1}\)</span>, the error term in period <span class="math inline">\(T+1\)</span>. Assuming that <span class="math inline">\(u_{T+1}\)</span> is normally distributed one can construct a <span class="math inline">\(95\%\)</span> <em>forecast interval</em> for <span class="math inline">\(Y_{T+1}\)</span> using <span class="math inline">\(SE(Y_{T+1} - \widehat{Y}_{T+1\vert T})\)</span>, an estimate of the RMSFE:
<span class="math display">\[\begin{align*}
  \widehat{Y}_{T+1\vert T} \pm 1.96 \cdot SE(Y_{T+1} - \widehat{Y}_{T+1\vert T})
\end{align*}\]</span>
Of course, the computation gets more complicated when the error term is heteroskedastic or if we are interested in computing a forecast interval for <span class="math inline">\(T+s, s&gt;1\)</span>.</p>
<p>In some applications it is useful to report multiple forecast intervals for subsequent periods, see the box <em>The River of Blood</em> on p. 592 of the book. These can be visualized in a so-called fan chart. We will not replicate the fan chart presented in Figure 14.2 of book because the underlying model is by far more complex than the simple AR and ADL models treated here. Instead, in the example below we use simulated time series data and estimate an AR(<span class="math inline">\(2\)</span>) model which is then used for forecasting the subsequent <span class="math inline">\(25\)</span> future outcomes of the series.</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb377-2"><a href="#cb377-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb377-3"><a href="#cb377-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-4"><a href="#cb377-4" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate the time series</span></span>
<span id="cb377-5"><a href="#cb377-5" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">arima.sim</span>(<span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">ar =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>)),  <span class="at">n =</span> <span class="dv">200</span>)</span>
<span id="cb377-6"><a href="#cb377-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-7"><a href="#cb377-7" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate an AR(2) model using &#39;arima()&#39;, see ?arima</span></span>
<span id="cb377-8"><a href="#cb377-8" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">arima</span>(Y, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb377-9"><a href="#cb377-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-10"><a href="#cb377-10" aria-hidden="true" tabindex="-1"></a><span class="co"># compute points forecasts and prediction intervals for the next 25 periods</span></span>
<span id="cb377-11"><a href="#cb377-11" aria-hidden="true" tabindex="-1"></a>fc <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model, <span class="at">h =</span> <span class="dv">25</span>, <span class="at">level =</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">99</span>, <span class="dv">10</span>))</span>
<span id="cb377-12"><a href="#cb377-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-13"><a href="#cb377-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plot a fan chart</span></span>
<span id="cb377-14"><a href="#cb377-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fc, </span>
<span id="cb377-15"><a href="#cb377-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Forecast Fan Chart for AR(2) Model of Simulated Data&quot;</span>, </span>
<span id="cb377-16"><a href="#cb377-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">showgap =</span> F, </span>
<span id="cb377-17"><a href="#cb377-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">fcol =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb377-18"><a href="#cb377-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">flty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-626-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><tt>arima.sim()</tt> simulates autoregressive integrated moving average (ARIMA) models. AR models belong to this class of models. We use <tt>list(order = c(2, 0, 0), ar = c(0.2, 0.2))</tt> so the DGP is <span class="math display">\[Y_t = 0.2 Y_{t-1} + 0.2 Y_{t-2} + u_t.\]</span></p>
<p>We choose <tt>level = seq(5, 99, 10)</tt> in the call of <tt>forecast()</tt> such that forecast intervals with levels <span class="math inline">\(5\%, 15\%, \dots, 95\%\)</span> are computed for each point forecast of the series.</p>
<p>The dashed red line shows point forecasts of the series for the next 25 periods based on an <span class="math inline">\(ADL(1,1)\)</span> model and the shaded areas represent the prediction intervals. The degree of shading indicates the level of the prediction interval. The darkest of the blue bands displays the <span class="math inline">\(5\%\)</span> forecast intervals and the color fades towards grey as the level of the intervals increases.</p>
</div>
</div>
<div id="llsuic" class="section level2 hasAnchor" number="14.6">
<h2 class="hasAnchor"><span class="header-section-number">14.6</span> Lag Length Selection Using Information Criteria<a href="#llsuic" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The selection of lag lengths in AR and ADL models can sometimes be guided by economic theory. However, there are statistical methods that are helpful to determine how many lags should be included as regressors. In general, too many lags inflate the standard errors of coefficient estimates and thus imply an increase in the forecast error while omitting lags that should be included in the model may result in an estimation bias.</p>
<p>The order of an AR model can be determined using two approaches:</p>
<ol style="list-style-type: decimal">
<li><p><strong>The F-test approach</strong></p>
<p>Estimate an AR(<span class="math inline">\(p\)</span>) model and test the significance of the largest lag(s). If the test rejects, drop the respective lag(s) from the model. This approach has the tendency to produce models where the order is too large: in a significance test we always face the risk of rejecting a true null hypothesis!</p></li>
<li><p><strong>Relying on an information criterion</strong></p>
<p>To circumvent the issue of producing too large models, one may choose the lag order that minimizes one of the following two information criteria:</p>
<ul>
<li><p>The <em>Bayes information criterion</em> (BIC):</p>
<p><span class="math display">\[BIC(p) = \log\left(\frac{SSR(p)}{T}\right) + (p + 1) \frac{\log(T)}{T}\]</span></p></li>
<li><p>The <em>Akaike information criterion</em> (AIC):</p>
<p><span class="math display">\[AIC(p) = \log\left(\frac{SSR(p)}{T}\right) + (p + 1) \frac{2}{T}\]</span></p></li>
</ul>
<p>Both criteria are estimators of the optimal lag length <span class="math inline">\(p\)</span>. The lag order <span class="math inline">\(\widehat{p}\)</span> that minimizes the respective criterion is called the <em>BIC estimate</em> or the <em>AIC estimate</em> of the optimal model order. The basic idea of both criteria is that the <span class="math inline">\(SSR\)</span> decreases as additional lags are added to the model such that the first term decreases whereas the second increases as the lag order grows. One can show that the the <span class="math inline">\(BIC\)</span> is a consistent estimator of the true lag order while the AIC is not which is due to the differing factors in the second addend. Nevertheless, both estimators are used in practice where the <span class="math inline">\(AIC\)</span> is sometimes used as an alternative when the <span class="math inline">\(BIC\)</span> yields a model with “too few” lags.</p></li>
</ol>
<p>The function <tt>dynlm()</tt> does not compute information criteria by default. We will therefore write a short function that reports the <span class="math inline">\(BIC\)</span> (along with the chosen lag order <span class="math inline">\(p\)</span> and <span class="math inline">\(R^2\)</span>) for objects of class <tt>dynlm</tt>.</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute BIC for AR model objects of class &#39;dynlm&#39;</span></span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a>BIC <span class="ot">&lt;-</span> <span class="cf">function</span>(model) {</span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb378-4"><a href="#cb378-4" aria-hidden="true" tabindex="-1"></a>  ssr <span class="ot">&lt;-</span> <span class="fu">sum</span>(model<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb378-5"><a href="#cb378-5" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">length</span>(model<span class="sc">$</span>residuals)</span>
<span id="cb378-6"><a href="#cb378-6" aria-hidden="true" tabindex="-1"></a>  npar <span class="ot">&lt;-</span> <span class="fu">length</span>(model<span class="sc">$</span>coef)</span>
<span id="cb378-7"><a href="#cb378-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb378-8"><a href="#cb378-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(</span>
<span id="cb378-9"><a href="#cb378-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">c</span>(<span class="st">&quot;p&quot;</span> <span class="ot">=</span> npar <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb378-10"><a href="#cb378-10" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;BIC&quot;</span> <span class="ot">=</span> <span class="fu">log</span>(ssr<span class="sc">/</span>t) <span class="sc">+</span> npar <span class="sc">*</span> <span class="fu">log</span>(t)<span class="sc">/</span>t,</span>
<span id="cb378-11"><a href="#cb378-11" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;R2&quot;</span> <span class="ot">=</span> <span class="fu">summary</span>(model)<span class="sc">$</span>r.squared), <span class="dv">4</span>)</span>
<span id="cb378-12"><a href="#cb378-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb378-13"><a href="#cb378-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Table 14.3 of the book presents a breakdown of how the <span class="math inline">\(BIC\)</span> is computed for AR(<span class="math inline">\(p\)</span>) models of GDP growth with order <span class="math inline">\(p=1,\dots,6\)</span>. The final result can easily be reproduced using <tt>sapply()</tt> and the function <tt>BIC()</tt> defined above.</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="co"># apply the BIC() to an intercept-only model of GDP growth</span></span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(<span class="fu">dynlm</span>(<span class="fu">ts</span>(GDPGR_level) <span class="sc">~</span> <span class="dv">1</span>))</span>
<span id="cb379-3"><a href="#cb379-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      p    BIC     R2 </span></span>
<span id="cb379-4"><a href="#cb379-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.0000 2.4394 0.0000</span></span>
<span id="cb379-5"><a href="#cb379-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-6"><a href="#cb379-6" aria-hidden="true" tabindex="-1"></a><span class="co"># loop BIC over models of different orders</span></span>
<span id="cb379-7"><a href="#cb379-7" aria-hidden="true" tabindex="-1"></a>order <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb379-8"><a href="#cb379-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-9"><a href="#cb379-9" aria-hidden="true" tabindex="-1"></a>BICs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(order, <span class="cf">function</span>(x) </span>
<span id="cb379-10"><a href="#cb379-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;AR&quot;</span> <span class="ot">=</span> <span class="fu">BIC</span>(<span class="fu">dynlm</span>(<span class="fu">ts</span>(GDPGR_level) <span class="sc">~</span> <span class="fu">L</span>(<span class="fu">ts</span>(GDPGR_level), <span class="dv">1</span><span class="sc">:</span>x))))</span>
<span id="cb379-11"><a href="#cb379-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-12"><a href="#cb379-12" aria-hidden="true" tabindex="-1"></a>BICs</span>
<span id="cb379-13"><a href="#cb379-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       [,1]   [,2]   [,3]   [,4]   [,5]   [,6]</span></span>
<span id="cb379-14"><a href="#cb379-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; p   1.0000 2.0000 3.0000 4.0000 5.0000 6.0000</span></span>
<span id="cb379-15"><a href="#cb379-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BIC 2.3486 2.3475 2.3774 2.4034 2.4188 2.4429</span></span>
<span id="cb379-16"><a href="#cb379-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R2  0.1143 0.1425 0.1434 0.1478 0.1604 0.1591</span></span></code></pre></div>
<p>Note that increasing the lag order increases <span class="math inline">\(R^2\)</span> because the <span class="math inline">\(SSR\)</span> decreases as additional lags are added to the model but according to the <span class="math inline">\(BIC\)</span>, we should settle for the AR(<span class="math inline">\(2\)</span>) model instead of the AR(<span class="math inline">\(6\)</span>) model. It helps us to decide whether the decrease in <span class="math inline">\(SSR\)</span> is enough to justify adding an additional regressor.</p>
<p>If we had to compare a bigger set of models, a convenient way to select the model with the lowest <span class="math inline">\(BIC\)</span> is using the function <tt>which.min()</tt>.</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select the AR model with the smallest BIC</span></span>
<span id="cb380-2"><a href="#cb380-2" aria-hidden="true" tabindex="-1"></a>BICs[, <span class="fu">which.min</span>(BICs[<span class="dv">2</span>, ])]</span>
<span id="cb380-3"><a href="#cb380-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      p    BIC     R2 </span></span>
<span id="cb380-4"><a href="#cb380-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2.0000 2.3475 0.1425</span></span></code></pre></div>
<p>The <span class="math inline">\(BIC\)</span> may also be used to select lag lengths in time series regression models with multiple predictors. In a model with <span class="math inline">\(K\)</span> coefficients, including the intercept, we have
<span class="math display">\[\begin{align*}
    BIC(K) = \log\left(\frac{SSR(K)}{T}\right) + K \frac{\log(T)}{T}.
\end{align*}\]</span>
Notice that choosing the optimal model according to the <span class="math inline">\(BIC\)</span> can be computationally demanding because there may be many different combinations of lag lengths when there are multiple predictors.</p>
<p>To give an example, we estimate ADL(<span class="math inline">\(p\)</span>,<span class="math inline">\(q\)</span>) models of GDP growth where, as above, the additional variable is the term spread between short-term and long-term bonds. We impose the restriction that <span class="math inline">\(p=q_1=\dots=q_k\)</span> so that only <span class="math inline">\(p_{max}\)</span> models (<span class="math inline">\(p=1,\dots,p_{max}\)</span>) need to be estimated. In the example below we choose <span class="math inline">\(p_{max} = 12\)</span>.</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="co"># loop &#39;BIC()&#39; over multiple ADL models </span></span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true" tabindex="-1"></a>order <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb381-3"><a href="#cb381-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-4"><a href="#cb381-4" aria-hidden="true" tabindex="-1"></a>BICs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(order, <span class="cf">function</span>(x) </span>
<span id="cb381-5"><a href="#cb381-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">BIC</span>(<span class="fu">dynlm</span>(GDPGrowth_ts <span class="sc">~</span> <span class="fu">L</span>(GDPGrowth_ts, <span class="dv">1</span><span class="sc">:</span>x) <span class="sc">+</span> <span class="fu">L</span>(TSpread_ts, <span class="dv">1</span><span class="sc">:</span>x), </span>
<span id="cb381-6"><a href="#cb381-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>))))</span>
<span id="cb381-7"><a href="#cb381-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-8"><a href="#cb381-8" aria-hidden="true" tabindex="-1"></a>BICs</span>
<span id="cb381-9"><a href="#cb381-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       [,1]   [,2]   [,3]   [,4]    [,5]    [,6]    [,7]    [,8]    [,9]   [,10]</span></span>
<span id="cb381-10"><a href="#cb381-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; p   2.0000 4.0000 6.0000 8.0000 10.0000 12.0000 14.0000 16.0000 18.0000 20.0000</span></span>
<span id="cb381-11"><a href="#cb381-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BIC 2.3411 2.3408 2.3813 2.4181  2.4568  2.5048  2.5539  2.6029  2.6182  2.6646</span></span>
<span id="cb381-12"><a href="#cb381-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R2  0.1417 0.1855 0.1950 0.2072  0.2178  0.2211  0.2234  0.2253  0.2581  0.2678</span></span>
<span id="cb381-13"><a href="#cb381-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       [,11]   [,12]</span></span>
<span id="cb381-14"><a href="#cb381-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; p   22.0000 24.0000</span></span>
<span id="cb381-15"><a href="#cb381-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BIC  2.7205  2.7664</span></span>
<span id="cb381-16"><a href="#cb381-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R2   0.2702  0.2803</span></span></code></pre></div>
<p>From the definition of <tt>BIC()</tt>, for ADL models with <span class="math inline">\(p=q\)</span> it follows that <tt>p</tt> reports the number of estimated coefficients <em>excluding</em> the intercept. Thus the lag order is obtained by dividing <tt>p</tt> by 2.</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select the ADL model with the smallest BIC</span></span>
<span id="cb382-2"><a href="#cb382-2" aria-hidden="true" tabindex="-1"></a>BICs[, <span class="fu">which.min</span>(BICs[<span class="dv">2</span>, ])]</span>
<span id="cb382-3"><a href="#cb382-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      p    BIC     R2 </span></span>
<span id="cb382-4"><a href="#cb382-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4.0000 2.3408 0.1855</span></span></code></pre></div>
<p>The <span class="math inline">\(BIC\)</span> is in favor of the ADL(<span class="math inline">\(2\)</span>,<span class="math inline">\(2\)</span>) model @ref(eq:gdpgradl22) we have estimated before.</p>
</div>
<div id="nit" class="section level2 hasAnchor" number="14.7">
<h2 class="hasAnchor"><span class="header-section-number">14.7</span> Nonstationarity I: Trends<a href="#nit" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If a series is nonstationary, conventional hypothesis tests, confidence intervals and forecasts can be strongly misleading. The assumption of stationarity is violated if a series exhibits trends or breaks and the resulting complications in an econometric analysis depend on the specific type of the nonstationarity. This section focuses on time series that exhibit trends.</p>
<p>A series is said to exhibit a trend if it has a persistent long-term movement. One distinguishes between <em>deterministic</em> and <em>stochastic</em> trends.</p>
<ul>
<li><p>A trend is <em>deterministic</em> if it is a nonrandom function of time.</p></li>
<li><p>A trend is said to be <em>stochastic</em> if it is a random function of time.</p></li>
</ul>
<p>The figures we have produced in Chapter @ref(tsdasc) reveal that many economic time series show a trending behavior that is probably best modeled by stochastic trends. This is why the book focuses on the treatment of stochastic trends.</p>
<div id="the-random-walk-model-of-a-trend" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">The Random Walk Model of a Trend<a href="#the-random-walk-model-of-a-trend" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The simplest way to model a time series <span class="math inline">\(Y_t\)</span> that has stochastic trend is the <em>random walk</em>
<span class="math display">\[\begin{align}
  Y_t = Y_{t-1} + u_t, (\#eq:randomwalk)
\end{align}\]</span>
where the <span class="math inline">\(u_t\)</span> are i.i.d. errors with <span class="math inline">\(E(u_t\vert Y_{t-1}, Y_{t-2}, \dots) = 0\)</span>. Note that
<span class="math display">\[\begin{align*}
  E(Y_t\vert Y_{t-1}, Y_{t-2}\dots) =&amp; \, E(Y_{t-1}\vert Y_{t-1}, Y_{t-2}\dots) + E(u_t\vert Y_{t-1}, Y_{t-2}\dots) \\
  =&amp; \, Y_{t-1}
\end{align*}\]</span>
so the best forecast for <span class="math inline">\(Y_t\)</span> is yesterday’s observation <span class="math inline">\(Y_{t-1}\)</span>. Hence the difference between <span class="math inline">\(Y_t\)</span> and <span class="math inline">\(Y_{t-1}\)</span> is unpredictable. The path followed by <span class="math inline">\(Y_t\)</span> consists of random steps <span class="math inline">\(u_t\)</span>, hence it is called a random walk.</p>
<p>Assume that <span class="math inline">\(Y_0\)</span>, the starting value of the random walk is <span class="math inline">\(0\)</span>. Another way to write @ref(eq:randomwalk) is
<span class="math display">\[\begin{align*}
  Y_0 =&amp; \, 0 \\
  Y_1 =&amp; \, 0 + u_1 \\
  Y_2 =&amp; \, 0 + u_1 + u_2 \\
  \vdots &amp; \, \\
  Y_t =&amp; \, \sum_{i=1}^t u_i.
\end{align*}\]</span>
Therefore we have
<span class="math display">\[\begin{align*}
  Var(Y_t) =&amp; \, Var(u_1 + u_2 + \dots + u_t) \\
           =&amp; \, t \sigma_u^2.
\end{align*}\]</span>
Thus the variance of a random walk depends on <span class="math inline">\(t\)</span> which violates the assumption presented in Key Concept 14.5: a random walk is nonstationary.</p>
<p>Obviously, @ref(eq:randomwalk) is a special case of an AR(<span class="math inline">\(1\)</span>) model where <span class="math inline">\(\beta_1 = 1\)</span>. One can show that a time series that follows an AR(<span class="math inline">\(1\)</span>) model is stationary if <span class="math inline">\(\lvert\beta_1\rvert &lt; 1\)</span>. In a general AR(<span class="math inline">\(p\)</span>) model, stationarity is linked to the roots of the polynomial <span class="math display">\[1-\beta_1 z - \beta_2 z^2 - \beta_3 z^3 - \dots - \beta_p z^p.\]</span> If all roots are greater than <span class="math inline">\(1\)</span> in absolute value, the AR(<span class="math inline">\(p\)</span>) series is stationary. If at least one root equals <span class="math inline">\(1\)</span>, the AR(<span class="math inline">\(p\)</span>) is said to have a <em>unit root</em> and thus has a stochastic trend.</p>
<p>It is straightforward to simulate random walks in <tt>R</tt> using <tt>arima.sim()</tt>. The function <tt>matplot()</tt> is convenient for simple plots of the columns of a matrix.</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate and plot random walks starting at 0</span></span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb383-3"><a href="#cb383-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-4"><a href="#cb383-4" aria-hidden="true" tabindex="-1"></a>RWs <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">4</span>, </span>
<span id="cb383-5"><a href="#cb383-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">arima.sim</span>(<span class="at">model =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span> ,<span class="dv">0</span>)), <span class="at">n =</span> <span class="dv">100</span>)))</span>
<span id="cb383-6"><a href="#cb383-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-7"><a href="#cb383-7" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(RWs, </span>
<span id="cb383-8"><a href="#cb383-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb383-9"><a href="#cb383-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;steelblue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;orange&quot;</span>), </span>
<span id="cb383-10"><a href="#cb383-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">lty =</span> <span class="dv">1</span>, </span>
<span id="cb383-11"><a href="#cb383-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb383-12"><a href="#cb383-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Four Random Walks&quot;</span>,</span>
<span id="cb383-13"><a href="#cb383-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Time&quot;</span>,</span>
<span id="cb383-14"><a href="#cb383-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Value&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-632-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Adding a constant to @ref(eq:randomwalk) yields
<span class="math display">\[\begin{align}
  Y_t = \beta_0 + Y_{t-1} + u_t (\#eq:randomwalkdrift),
\end{align}\]</span>
a <em>random walk model with a drift</em> which allows to model the tendency of a series to move upwards or downwards. If <span class="math inline">\(\beta_0\)</span> is positive, the series drifts upwards and it follows a downward trend if <span class="math inline">\(\beta_0\)</span> is negative.</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate and plot random walks with drift</span></span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb384-3"><a href="#cb384-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-4"><a href="#cb384-4" aria-hidden="true" tabindex="-1"></a>RWsd <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">4</span>, </span>
<span id="cb384-5"><a href="#cb384-5" aria-hidden="true" tabindex="-1"></a>           <span class="fu">arima.sim</span>(<span class="at">model =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)), </span>
<span id="cb384-6"><a href="#cb384-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">n =</span> <span class="dv">100</span>,</span>
<span id="cb384-7"><a href="#cb384-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">mean =</span> <span class="sc">-</span><span class="fl">0.2</span>)))</span>
<span id="cb384-8"><a href="#cb384-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-9"><a href="#cb384-9" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(RWsd, </span>
<span id="cb384-10"><a href="#cb384-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb384-11"><a href="#cb384-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;steelblue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;orange&quot;</span>), </span>
<span id="cb384-12"><a href="#cb384-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">lty =</span> <span class="dv">1</span>, </span>
<span id="cb384-13"><a href="#cb384-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb384-14"><a href="#cb384-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Four Random Walks with Drift&quot;</span>,</span>
<span id="cb384-15"><a href="#cb384-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Time&quot;</span>,</span>
<span id="cb384-16"><a href="#cb384-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Value&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-633-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="problems-caused-by-stochastic-trends" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Problems Caused by Stochastic Trends<a href="#problems-caused-by-stochastic-trends" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>OLS estimation of the coefficients on regressors that have a stochastic trend is problematic because the distribution of the estimator and its <span class="math inline">\(t\)</span>-statistic is non-normal, even asymptotically. This has various consequences:</p>
<ul>
<li><p><strong>Downward bias of autoregressive coefficients</strong>:</p>
<p>If <span class="math inline">\(Y_t\)</span> is a random walk, <span class="math inline">\(\beta_1\)</span> can be consistently estimated by OLS but the estimator is biased toward zero. This bias is roughly <span class="math inline">\(E(\widehat{\beta}_1) \approx 1 - 5.3/T\)</span> which is substantial for sample sizes typically encountered in macroeconomics. This estimation bias causes forecasts of <span class="math inline">\(Y_t\)</span> to perform worse than a pure random walk model.</p></li>
<li><p><strong>Non-normally distributed <span class="math inline">\(t\)</span>-statistics</strong>:</p>
<p>The nonnormal distribution of the estimated coefficient of a stochastic regressor translates to a nonnormal distribution of its <span class="math inline">\(t\)</span>-statistic so that normal critical values are invalid and therefore usual confidence intervals and hypothesis tests are invalid, too, and the true distribution of the <span class="math inline">\(t\)</span>-statistic cannot be readily determined.</p></li>
<li><p><strong>Spurious Regression</strong>:</p>
<p>When two stochastically trending time series are regressed onto each other, the estimated relationship may appear highly significant using conventional normal critical values although the series are unrelated. This is what econometricians call a <em>spurious</em> relationship.</p></li>
</ul>
<p>As an example for spurious regression, consider again the green and the red random walks that we have simulated above. We know that there is no relationship between both series: they are generated independently of each other.</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot spurious relationship</span></span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(RWs[, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)], </span>
<span id="cb385-3"><a href="#cb385-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb385-4"><a href="#cb385-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb385-5"><a href="#cb385-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb385-6"><a href="#cb385-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;darkred&quot;</span>),</span>
<span id="cb385-7"><a href="#cb385-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Time&quot;</span>,</span>
<span id="cb385-8"><a href="#cb385-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb385-9"><a href="#cb385-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;A Spurious Relationship&quot;</span>)    </span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-634-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Imagine we did not have this information and instead conjectured that the green series is useful for predicting the red series and thus end up estimating the ADL(<span class="math inline">\(0\)</span>,<span class="math inline">\(1\)</span>) model
<span class="math display">\[\begin{align*}
  Red_t = \beta_0 + \beta_1 Green_{t-1} + u_t.
\end{align*}\]</span></p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate spurious AR model</span></span>
<span id="cb386-2"><a href="#cb386-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">dynlm</span>(RWs[, <span class="dv">2</span>] <span class="sc">~</span> <span class="fu">L</span>(RWs[, <span class="dv">3</span>])))<span class="sc">$</span>coefficients</span>
<span id="cb386-3"><a href="#cb386-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error   t value     Pr(&gt;|t|)</span></span>
<span id="cb386-4"><a href="#cb386-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -3.459488  0.3635104 -9.516889 1.354156e-15</span></span>
<span id="cb386-5"><a href="#cb386-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; L(RWs[, 3])  1.047195  0.1450874  7.217687 1.135828e-10</span></span></code></pre></div>
<p>The result is obviously spurious: the coefficient on <span class="math inline">\(Green_{t-1}\)</span> is estimated to be about <span class="math inline">\(1\)</span> and the <span class="math inline">\(p\)</span>-value of <span class="math inline">\(1.14 \cdot 10^{-10}\)</span> of the corresponding <span class="math inline">\(t\)</span>-test indicates that the coefficient is highly significant while its true value is in fact zero.</p>
<p>As an empirical example, consider the U.S. unemployment rate and the Japanese industrial production. Both series show an upward trending behavior from the mid-1960s through the early 1980s.</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot U.S. unemployment rate &amp; Japanese industrial production</span></span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">merge</span>(<span class="fu">as.zoo</span>(USUnemp), <span class="fu">as.zoo</span>(JPIndProd)), </span>
<span id="cb387-3"><a href="#cb387-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">plot.type =</span> <span class="st">&quot;single&quot;</span>, </span>
<span id="cb387-4"><a href="#cb387-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;steelblue&quot;</span>),</span>
<span id="cb387-5"><a href="#cb387-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb387-6"><a href="#cb387-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb387-7"><a href="#cb387-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb387-8"><a href="#cb387-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Spurious Regression: Macroeconomic Time series&quot;</span>)</span>
<span id="cb387-9"><a href="#cb387-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-10"><a href="#cb387-10" aria-hidden="true" tabindex="-1"></a><span class="co"># add a legend</span></span>
<span id="cb387-11"><a href="#cb387-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, </span>
<span id="cb387-12"><a href="#cb387-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;USUnemp&quot;</span>, <span class="st">&quot;JPIndProd&quot;</span>),</span>
<span id="cb387-13"><a href="#cb387-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;steelblue&quot;</span>),</span>
<span id="cb387-14"><a href="#cb387-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-636-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate regression using data from 1962 to 1985</span></span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a>SR_Unemp1 <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(<span class="fu">ts</span>(USUnemp[<span class="st">&quot;1962::1985&quot;</span>]) <span class="sc">~</span> <span class="fu">ts</span>(JPIndProd[<span class="st">&quot;1962::1985&quot;</span>]))</span>
<span id="cb388-3"><a href="#cb388-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(SR_Unemp1, <span class="at">vcov =</span> sandwich)</span>
<span id="cb388-4"><a href="#cb388-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb388-5"><a href="#cb388-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb388-6"><a href="#cb388-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb388-7"><a href="#cb388-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                             Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb388-8"><a href="#cb388-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                 -2.37452    1.12041 -2.1193    0.0367 *  </span></span>
<span id="cb388-9"><a href="#cb388-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ts(JPIndProd[&quot;1962::1985&quot;])  2.22057    0.29233  7.5961 2.227e-11 ***</span></span>
<span id="cb388-10"><a href="#cb388-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb388-11"><a href="#cb388-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>A simple regression of the U.S. unemployment rate on Japanese industrial production using data from 1962 to 1985 yields
<span class="math display">\[\begin{align}
  \widehat{U.S. UR}_t = -\underset{(1.12)}{2.37} + \underset{(0.29)}{2.22} \log(JapaneseIP_t). (\#eq:urjpip1)
\end{align}\]</span>
This appears to be a significant relationship: the <span class="math inline">\(t\)</span>-statistic of the coefficient on <span class="math inline">\(\log(JapaneseIP_t)\)</span> is bigger than 7.</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate regression using data from 1986 to 2012</span></span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a>SR_Unemp2 <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(<span class="fu">ts</span>(USUnemp[<span class="st">&quot;1986::2012&quot;</span>]) <span class="sc">~</span> <span class="fu">ts</span>(JPIndProd[<span class="st">&quot;1986::2012&quot;</span>]))</span>
<span id="cb389-3"><a href="#cb389-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(SR_Unemp2, <span class="at">vcov =</span> sandwich)</span>
<span id="cb389-4"><a href="#cb389-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb389-5"><a href="#cb389-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb389-6"><a href="#cb389-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb389-7"><a href="#cb389-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                             Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb389-8"><a href="#cb389-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                  41.7763     5.4066  7.7270 6.596e-12 ***</span></span>
<span id="cb389-9"><a href="#cb389-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ts(JPIndProd[&quot;1986::2012&quot;])  -7.7771     1.1714 -6.6391 1.386e-09 ***</span></span>
<span id="cb389-10"><a href="#cb389-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb389-11"><a href="#cb389-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>When estimating the same model, this time with data from 1986 to 2012, we obtain
<span class="math display">\[\begin{align}
  \widehat{U.S. UR}_t = \underset{(5.41)}{41.78} -\underset{(1.17)}{7.78} \log(JapaneseIP)_t (\#eq:urjpip2)
\end{align}\]</span>
which surprisingly is quite different. @ref(eq:urjpip1) indicates a moderate positive relationship, in contrast to the large negative coefficient in @ref(eq:urjpip2). This phenomenon can be attributed to stochastic trends in the series: since there is no economic reasoning that relates both trends, both regressions may be spurious.</p>
</div>
<div id="testing-for-a-unit-ar-root" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Testing for a Unit AR Root<a href="#testing-for-a-unit-ar-root" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A formal test for a stochastic trend has been proposed by <span class="citation">Dickey and Fuller (<a href="#ref-dickey1979" role="doc-biblioref">1979</a>)</span> which thus is termed the <em>Dickey-Fuller test</em>. As discussed above, a time series that follows an AR(<span class="math inline">\(1\)</span>) model with <span class="math inline">\(\beta_1 = 1\)</span> has a stochastic trend. Thus, the testing problem is
<span class="math display">\[\begin{align*}
  H_0: \beta_1 = 1 \ \ \ \text{vs.} \ \ \ H_1: \lvert\beta_1\rvert &lt; 1.
\end{align*}\]</span>
The null hypothesis is that the AR(<span class="math inline">\(1\)</span>) model has a unit root and the alternative hypothesis is that it is stationary. One often rewrites the AR(<span class="math inline">\(1\)</span>) model by subtracting <span class="math inline">\(Y_{t-1}\)</span> on both sides:
<span class="math display">\[\begin{align}
  Y_t = \beta_0 + \beta_1 Y_{t-1} + u_t \ \ \Leftrightarrow \ \ \Delta Y_t = \beta_0 + \delta Y_{t-1} + u_t (\#eq:dfmod)
\end{align}\]</span>
where <span class="math inline">\(\delta = \beta_1 - 1\)</span>. The testing problem then becomes
<span class="math display">\[\begin{align*}
  H_0: \delta = 0 \ \ \ \text{vs.} \ \ \ H_1: \delta &lt; 0
\end{align*}\]</span>
which is convenient since the corresponding test statistic is reported by many relevant <tt>R</tt> functions.<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a></p>
<p>The Dickey-Fuller test can also be applied in an AR(<span class="math inline">\(p\)</span>) model. The <em>Augmented Dickey-Fuller (ADF) test</em> is summarized in Key Concept 14.8.</p>
<div id="KC14.8" class="keyconcept">
<h3 class="right">
Key Concept 14.8
</h3>
<h3 class="left">
The ADF Test for a Unit Root
</h3>
<p>
<p>Consider the regression
<span class="math display">\[\begin{align}
  \Delta Y_t = \beta_0 + \delta Y_{t-1} + \gamma_1 \Delta_1 Y_{t-1} + \gamma_2 \Delta Y_{t-2} + \dots + \gamma_p \Delta Y_{t-p} + u_t. (\#eq:ADFreg1)
\end{align}\]</span></p>
<p>The ADF test for a unit autoregressive root tests the hypothesis <span class="math inline">\(H_0: \delta = 0\)</span> (stochastic trend) against the one-sided alternative <span class="math inline">\(H_1: \delta &lt; 0\)</span> (stationarity) using the usual OLS <span class="math inline">\(t\)</span>-statistic.</p>
<p>If it is assumed that <span class="math inline">\(Y_t\)</span> is stationary around a deterministic linear time trend, the model is augmented by the regressor <span class="math inline">\(t\)</span>:
<span class="math display">\[\begin{align}
  \Delta Y_t = \beta_0 + at + \delta Y_{t-1} + \gamma_1 \Delta_1 Y_{t-1} + \gamma_2 \Delta Y_{t-2} + \dots + \gamma_p \Delta Y_{t-p} + u_t,  (\#eq:ADFreg2)
\end{align}\]</span>
where again <span class="math inline">\(H_0: \delta = 0\)</span> is tested against <span class="math inline">\(H_1: \delta &lt; 0\)</span>.</p>
<p>The optimal lag length <span class="math inline">\(p\)</span> can be estimated using information criteria. In @ref(eq:ADFreg1), <span class="math inline">\(p=0\)</span> (no lags of <span class="math inline">\(\Delta Y_t\)</span> are used as regressors) corresponds to a simple AR(<span class="math inline">\(1\)</span>).</p>
Under the null, the <span class="math inline">\(t\)</span>-statistic corresponding to <span class="math inline">\(H_0: \delta = 0\)</span> does not have a normal distribution. The critical values can only be obtained from simulation and differ for regressions @ref(eq:ADFreg1) and @ref(eq:ADFreg2) since the distribution of the ADF test statistic is sensitive to the deterministic components included in the regression.
</p>
</div>
</div>
<div id="critical-values-for-the-adf-statistic" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Critical Values for the ADF Statistic<a href="#critical-values-for-the-adf-statistic" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Key Concept 14.8 states that the critical values for the ADF test in the regressions @ref(eq:ADFreg1) and @ref(eq:ADFreg2) can only be determined using simulation. The idea of the simulation study is to simulate a large number of ADF test statistics and use them to estimate quantiles of their <em>asymptotic</em> distribution. This section shows how this can be done using <tt>R</tt>.</p>
<p>First, consider the following AR(<span class="math inline">\(1\)</span>) model with intercept
<span class="math display">\[\begin{align*}
  Y_t =&amp; \, \alpha + z_t, \ \ z_t = \rho z_{t-1} + u_t.
\end{align*}\]</span>
This can be written as
<span class="math display">\[\begin{align*}
  Y_t =&amp; \, (1-\rho) \alpha + \rho y_{t-1} + u_t,
\end{align*}\]</span>
i.e., <span class="math inline">\(Y_t\)</span> is a random walk without drift under the null <span class="math inline">\(\rho = 1\)</span>. One can show that <span class="math inline">\(Y_t\)</span> is a stationary process with mean <span class="math inline">\(\alpha\)</span> for <span class="math inline">\(\lvert\rho\rvert&lt;1\)</span>.</p>
<p>The procedure for simulating critical values of a unit root test using the <span class="math inline">\(t\)</span>-ratio of <span class="math inline">\(\delta\)</span> in @ref(eq:dfmod) is as follows:</p>
<ul>
<li><p>Simulate <span class="math inline">\(N\)</span> random walks with <span class="math inline">\(n\)</span> observations using the data generating process
<span class="math display">\[\begin{align*}
Y_t =&amp; \, a + z_t, \ \ z_t = \rho z_{t-1} + u_t,
\end{align*}\]</span>
<span class="math inline">\(t=1,\dots,n\)</span> where <span class="math inline">\(N\)</span> and <span class="math inline">\(n\)</span> are large numbers, <span class="math inline">\(a\)</span> is a constant and <span class="math inline">\(u\)</span> is a zero mean error term.</p></li>
<li><p>For each random walk, estimate the regression
<span class="math display">\[\begin{align*}
\Delta Y_t =&amp; \, \beta_0 + \delta Y_{t-1} + u_t
\end{align*}\]</span>
and compute the ADF test statistic. Save all <span class="math inline">\(N\)</span> test statistics.</p></li>
<li><p>Estimate quantiles of the distribution of the ADF test statistic using the <span class="math inline">\(N\)</span> test statistics obtained from the simulation.</p></li>
</ul>
<p>For the case with drift <em>and</em> linear time trend we replace the data generating process by
<span class="math display">\[\begin{align}
  Y_t =&amp; \, a + b \cdot t + z_t, \ \ z_t = \rho z_{t-1} + u_t (\#eq:rwdt)
\end{align}\]</span>
where <span class="math inline">\(b \cdot t\)</span> is a linear time trend. <span class="math inline">\(Y_t\)</span> in @ref(eq:rwdt) is a random walk with (without) drift if <span class="math inline">\(b\neq0\)</span> (<span class="math inline">\(b=0\)</span>) under the null of <span class="math inline">\(\rho=1\)</span> (can you show this?). We estimate the regression
<span class="math display">\[\begin{align*}
  \Delta Y_t =&amp; \, \beta_0 + \alpha \cdot t + \delta Y_{t-1} + u_t.
\end{align*}\]</span></p>
<p>Loosely speaking, the precision of the estimated quantiles depends on two factors: <span class="math inline">\(n\)</span>, the length of the underlying series and <span class="math inline">\(N\)</span>, the number of test statistics used. Since we are interested in estimating quantiles of the <em>asymptotic</em> distribution (the Dickey-Fuller distribution) of the ADF test statistic both using many observations and large number of simulated test statistics will increase the precision of the estimated quantiles. We choose <span class="math inline">\(n=N=1000\)</span> as the computational burden grows quickly with <span class="math inline">\(n\)</span> and <span class="math inline">\(N\)</span>.</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a><span class="co"># repetitions</span></span>
<span id="cb390-2"><a href="#cb390-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb390-3"><a href="#cb390-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-4"><a href="#cb390-4" aria-hidden="true" tabindex="-1"></a><span class="co"># observations</span></span>
<span id="cb390-5"><a href="#cb390-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb390-6"><a href="#cb390-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-7"><a href="#cb390-7" aria-hidden="true" tabindex="-1"></a><span class="co"># define constant, trend and rho</span></span>
<span id="cb390-8"><a href="#cb390-8" aria-hidden="true" tabindex="-1"></a>drift <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb390-9"><a href="#cb390-9" aria-hidden="true" tabindex="-1"></a>trend <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb390-10"><a href="#cb390-10" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb390-11"><a href="#cb390-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-12"><a href="#cb390-12" aria-hidden="true" tabindex="-1"></a><span class="co"># function which simulates an AR(1) process</span></span>
<span id="cb390-13"><a href="#cb390-13" aria-hidden="true" tabindex="-1"></a>AR1 <span class="ot">&lt;-</span> <span class="cf">function</span>(rho) {</span>
<span id="cb390-14"><a href="#cb390-14" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb390-15"><a href="#cb390-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb390-16"><a href="#cb390-16" aria-hidden="true" tabindex="-1"></a>    out[i] <span class="ot">&lt;-</span> rho <span class="sc">*</span> out[i<span class="dv">-1</span>] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb390-17"><a href="#cb390-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb390-18"><a href="#cb390-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb390-19"><a href="#cb390-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb390-20"><a href="#cb390-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-21"><a href="#cb390-21" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate from DGP with constant </span></span>
<span id="cb390-22"><a href="#cb390-22" aria-hidden="true" tabindex="-1"></a>RWD <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">replicate</span>(<span class="at">n =</span> N, drift <span class="sc">+</span> <span class="fu">AR1</span>(rho)))</span>
<span id="cb390-23"><a href="#cb390-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-24"><a href="#cb390-24" aria-hidden="true" tabindex="-1"></a><span class="co"># compute ADF test statistics and store them in &#39;ADFD&#39;</span></span>
<span id="cb390-25"><a href="#cb390-25" aria-hidden="true" tabindex="-1"></a>ADFD <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb390-26"><a href="#cb390-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-27"><a href="#cb390-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(RWD)) {</span>
<span id="cb390-28"><a href="#cb390-28" aria-hidden="true" tabindex="-1"></a>  ADFD[i] <span class="ot">&lt;-</span> <span class="fu">summary</span>(</span>
<span id="cb390-29"><a href="#cb390-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dynlm</span>(<span class="fu">diff</span>(RWD[, i], <span class="dv">1</span>) <span class="sc">~</span> <span class="fu">L</span>(RWD[, i], <span class="dv">1</span>)))<span class="sc">$</span>coef[<span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb390-30"><a href="#cb390-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb390-31"><a href="#cb390-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-32"><a href="#cb390-32" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate from DGP with constant and trend</span></span>
<span id="cb390-33"><a href="#cb390-33" aria-hidden="true" tabindex="-1"></a>RWDT <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">replicate</span>(<span class="at">n =</span> N, drift <span class="sc">+</span> trend <span class="sc">+</span> <span class="fu">AR1</span>(rho)))</span>
<span id="cb390-34"><a href="#cb390-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-35"><a href="#cb390-35" aria-hidden="true" tabindex="-1"></a><span class="co"># compute ADF test statistics and store them in &#39;ADFDT&#39;</span></span>
<span id="cb390-36"><a href="#cb390-36" aria-hidden="true" tabindex="-1"></a>ADFDT <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb390-37"><a href="#cb390-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-38"><a href="#cb390-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(RWDT)) {</span>
<span id="cb390-39"><a href="#cb390-39" aria-hidden="true" tabindex="-1"></a>  ADFDT[i] <span class="ot">&lt;-</span> <span class="fu">summary</span>(</span>
<span id="cb390-40"><a href="#cb390-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dynlm</span>(<span class="fu">diff</span>(RWDT[, i], <span class="dv">1</span>) <span class="sc">~</span> <span class="fu">L</span>(RWDT[, i], <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">trend</span>(RWDT[, i]))</span>
<span id="cb390-41"><a href="#cb390-41" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">$</span>coef[<span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb390-42"><a href="#cb390-42" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate quantiles for ADF regression with a drift</span></span>
<span id="cb391-2"><a href="#cb391-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">quantile</span>(ADFD, <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span>)), <span class="dv">2</span>)</span>
<span id="cb391-3"><a href="#cb391-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   10%    5%    1% </span></span>
<span id="cb391-4"><a href="#cb391-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -2.62 -2.83 -3.39</span></span>
<span id="cb391-5"><a href="#cb391-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-6"><a href="#cb391-6" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate quantiles for ADF regression with drift and trend</span></span>
<span id="cb391-7"><a href="#cb391-7" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">quantile</span>(ADFDT, <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span>)), <span class="dv">2</span>)</span>
<span id="cb391-8"><a href="#cb391-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   10%    5%    1% </span></span>
<span id="cb391-9"><a href="#cb391-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -3.11 -3.43 -3.97</span></span></code></pre></div>
<p>The estimated quantiles are close to the large-sample critical values of the ADF test statistic reported in Table 14.4 of the book.</p>
<table>
<caption>(#tab:DFcrits) Large Sample Critical Values of ADF Test</caption>
<thead>
<tr class="header">
<th align="left">Deterministic Regressors</th>
<th align="left">10%</th>
<th align="left">5%</th>
<th align="left">1%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Intercept only</td>
<td align="left">-2.57</td>
<td align="left">-2.86</td>
<td align="left">-3.43</td>
</tr>
<tr class="even">
<td align="left">Intercept and time trend</td>
<td align="left">-3.12</td>
<td align="left">-3.41</td>
<td align="left">-3.96</td>
</tr>
</tbody>
</table>
<p>The results show that using standard normal critical values is erroneous: the 5% critical value of the standard normal distribution is <span class="math inline">\(-1.64\)</span>. For the Dickey-Fuller distributions the estimated critical values are <span class="math inline">\(-2.87\)</span> (drift) and <span class="math inline">\(-3.43\)</span> (drift and linear time trend). This implies that a true null (the series has a stochastic trend) would be rejected far too often if inappropriate normal critical values were used.</p>
<p>We may use the simulated test statistics for a graphical comparison of the standard normal density and (estimates of) both Dickey-Fuller densities.</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot standard normal density</span></span>
<span id="cb392-2"><a href="#cb392-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x), </span>
<span id="cb392-3"><a href="#cb392-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">from =</span> <span class="sc">-</span><span class="dv">6</span>, <span class="at">to =</span> <span class="dv">3</span>, </span>
<span id="cb392-4"><a href="#cb392-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.6</span>), </span>
<span id="cb392-5"><a href="#cb392-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb392-6"><a href="#cb392-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>,</span>
<span id="cb392-7"><a href="#cb392-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;t-Statistic&quot;</span>,</span>
<span id="cb392-8"><a href="#cb392-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">&quot;Distributions of ADF Test Statistics&quot;</span>,</span>
<span id="cb392-9"><a href="#cb392-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>, </span>
<span id="cb392-10"><a href="#cb392-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb392-11"><a href="#cb392-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-12"><a href="#cb392-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plot density estimates of both Dickey-Fuller distributions</span></span>
<span id="cb392-13"><a href="#cb392-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(ADFD), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>)</span>
<span id="cb392-14"><a href="#cb392-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(ADFDT), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb392-15"><a href="#cb392-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-16"><a href="#cb392-16" aria-hidden="true" tabindex="-1"></a><span class="co"># add a legend</span></span>
<span id="cb392-17"><a href="#cb392-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, </span>
<span id="cb392-18"><a href="#cb392-18" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">&quot;N(0,1)&quot;</span>, <span class="st">&quot;Drift&quot;</span>, <span class="st">&quot;Drift+Trend&quot;</span>),</span>
<span id="cb392-19"><a href="#cb392-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb392-20"><a href="#cb392-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb392-21"><a href="#cb392-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-643-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The deviations from the standard normal distribution are significant: both Dickey-Fuller distributions are skewed to the left and have a heavier left tail than the standard normal distribution.</p>
</div>
<div id="does-u.s.-gdp-have-a-unit-root" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Does U.S. GDP Have a Unit Root?<a href="#does-u.s.-gdp-have-a-unit-root" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As an empirical example, we use the ADF test to assess whether there is a stochastic trend in U.S. GDP using the regression
<span class="math display">\[\begin{align*}
  \Delta\log(GDP_t) = \beta_0 + \alpha t + \beta_1 \log(GDP_{t-1}) + \beta_2 \Delta \log(GDP_{t-1}) + \beta_3 \Delta \log(GDP_{t-2}) + u_t.
\end{align*}\]</span></p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate log GDP series</span></span>
<span id="cb393-2"><a href="#cb393-2" aria-hidden="true" tabindex="-1"></a>LogGDP <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">log</span>(GDP[<span class="st">&quot;1962::2012&quot;</span>]))</span>
<span id="cb393-3"><a href="#cb393-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb393-4"><a href="#cb393-4" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model</span></span>
<span id="cb393-5"><a href="#cb393-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(</span>
<span id="cb393-6"><a href="#cb393-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dynlm</span>(<span class="fu">diff</span>(LogGDP) <span class="sc">~</span> <span class="fu">trend</span>(LogGDP, <span class="at">scale =</span> F) <span class="sc">+</span> <span class="fu">L</span>(LogGDP) </span>
<span id="cb393-7"><a href="#cb393-7" aria-hidden="true" tabindex="-1"></a>                     <span class="sc">+</span> <span class="fu">diff</span>(<span class="fu">L</span>(LogGDP)) <span class="sc">+</span> <span class="fu">diff</span>(<span class="fu">L</span>(LogGDP), <span class="dv">2</span>)))</span>
<span id="cb393-8"><a href="#cb393-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb393-9"><a href="#cb393-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb393-10"><a href="#cb393-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb393-11"><a href="#cb393-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                             Estimate  Std. Error t value Pr(&gt;|t|)   </span></span>
<span id="cb393-12"><a href="#cb393-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)               0.27877045  0.11793233  2.3638 0.019066 * </span></span>
<span id="cb393-13"><a href="#cb393-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; trend(LogGDP, scale = F)  0.00023818  0.00011090  2.1476 0.032970 * </span></span>
<span id="cb393-14"><a href="#cb393-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; L(LogGDP)                -0.03332452  0.01441436 -2.3119 0.021822 * </span></span>
<span id="cb393-15"><a href="#cb393-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; diff(L(LogGDP))           0.08317976  0.11295542  0.7364 0.462371   </span></span>
<span id="cb393-16"><a href="#cb393-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; diff(L(LogGDP), 2)        0.18763384  0.07055574  2.6594 0.008476 **</span></span>
<span id="cb393-17"><a href="#cb393-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb393-18"><a href="#cb393-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The estimation yields
<span class="math display">\[\begin{align*}
  \Delta\log(GDP_t) =&amp; \underset{(0.118)}{0.28} + \underset{(0.0001)}{0.0002} t -\underset{(0.014)}{0.033} \log(GDP_{t-1}) \\
   &amp; + \underset{(0.113)}{0.083} \Delta \log(GDP_{t-1}) + \underset{(0.071)}{0.188} \Delta \log(GDP_{t-2}) + u_t,
\end{align*}\]</span>
so the ADF test statistic is <span class="math inline">\(t=-0.033/0.014 = - 2.35\)</span>. The corresponding <span class="math inline">\(5\%\)</span> critical value from Table @ref(tab:DFcrits) is <span class="math inline">\(-3.41\)</span> so we cannot reject the null hypothesis that <span class="math inline">\(\log(GDP)\)</span> has a stochastic trend in favor of the alternative that it is stationary around a deterministic linear time trend.</p>
<p>The ADF test can be done conveniently using <tt>ur.df()</tt> from the package <tt>urca</tt>.</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test for unit root in GDP using &#39;ur.df()&#39; from the package &#39;urca&#39;</span></span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">ur.df</span>(LogGDP, </span>
<span id="cb394-3"><a href="#cb394-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&quot;trend&quot;</span>, </span>
<span id="cb394-4"><a href="#cb394-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">lags =</span> <span class="dv">2</span>, </span>
<span id="cb394-5"><a href="#cb394-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">selectlags =</span> <span class="st">&quot;Fixed&quot;</span>))</span>
<span id="cb394-6"><a href="#cb394-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb394-7"><a href="#cb394-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ############################################### </span></span>
<span id="cb394-8"><a href="#cb394-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Augmented Dickey-Fuller Test Unit Root Test # </span></span>
<span id="cb394-9"><a href="#cb394-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ############################################### </span></span>
<span id="cb394-10"><a href="#cb394-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb394-11"><a href="#cb394-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test regression trend </span></span>
<span id="cb394-12"><a href="#cb394-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb394-13"><a href="#cb394-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb394-14"><a href="#cb394-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb394-15"><a href="#cb394-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = z.diff ~ z.lag.1 + 1 + tt + z.diff.lag)</span></span>
<span id="cb394-16"><a href="#cb394-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb394-17"><a href="#cb394-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb394-18"><a href="#cb394-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Min        1Q    Median        3Q       Max </span></span>
<span id="cb394-19"><a href="#cb394-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -0.025580 -0.004109  0.000321  0.004869  0.032781 </span></span>
<span id="cb394-20"><a href="#cb394-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb394-21"><a href="#cb394-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb394-22"><a href="#cb394-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb394-23"><a href="#cb394-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  0.2790086  0.1180427   2.364 0.019076 *  </span></span>
<span id="cb394-24"><a href="#cb394-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; z.lag.1     -0.0333245  0.0144144  -2.312 0.021822 *  </span></span>
<span id="cb394-25"><a href="#cb394-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tt           0.0002382  0.0001109   2.148 0.032970 *  </span></span>
<span id="cb394-26"><a href="#cb394-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; z.diff.lag1  0.2708136  0.0697696   3.882 0.000142 ***</span></span>
<span id="cb394-27"><a href="#cb394-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; z.diff.lag2  0.1876338  0.0705557   2.659 0.008476 ** </span></span>
<span id="cb394-28"><a href="#cb394-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb394-29"><a href="#cb394-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb394-30"><a href="#cb394-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb394-31"><a href="#cb394-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.007704 on 196 degrees of freedom</span></span>
<span id="cb394-32"><a href="#cb394-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.1783, Adjusted R-squared:  0.1616 </span></span>
<span id="cb394-33"><a href="#cb394-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 10.63 on 4 and 196 DF,  p-value: 8.076e-08</span></span>
<span id="cb394-34"><a href="#cb394-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb394-35"><a href="#cb394-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb394-36"><a href="#cb394-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Value of test-statistic is: -2.3119 11.2558 4.267 </span></span>
<span id="cb394-37"><a href="#cb394-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb394-38"><a href="#cb394-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Critical values for test statistics: </span></span>
<span id="cb394-39"><a href="#cb394-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       1pct  5pct 10pct</span></span>
<span id="cb394-40"><a href="#cb394-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tau3 -3.99 -3.43 -3.13</span></span>
<span id="cb394-41"><a href="#cb394-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; phi2  6.22  4.75  4.07</span></span>
<span id="cb394-42"><a href="#cb394-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; phi3  8.43  6.49  5.47</span></span></code></pre></div>
<p>The first test statistic at the bottom of the output is the one we are interested in. The number of test statistics reported depends on the test regression. For <tt>type = “trend”</tt>, the second statistics corresponds to the test that there is no unit root and no time trend while the third one corresponds to a test of the hypothesis that there is a unit root, no time trend and no drift term.</p>
</div>
</div>
<div id="niib" class="section level2 hasAnchor" number="14.8">
<h2 class="hasAnchor"><span class="header-section-number">14.8</span> Nonstationarity II: Breaks<a href="#niib" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When there are discrete (at a distinct date) or gradual (over time) changes in the population regression coefficients, the series is nonstationary. These changes are called <em>breaks</em>. There is a variety of reasons why breaks can occur in macroeconomic time series but most often they are related to changes in economic policy or major changes in the structure of the economy. See Chapter 14.7 of the book for some examples.</p>
<p>If breaks are not accounted for in the regression model, OLS estimates will reflect the average relationship. Since these estimates might be strongly misleading and result in poor forecast quality, we are interested in testing for breaks. One distinguishes between testing for a break when the date is known and testing for a break with an unknown break date.</p>
<p>Let <span class="math inline">\(\tau\)</span> denote a known break date and let <span class="math inline">\(D_t(\tau)\)</span> be a binary variable indicating time periods before and after the break. Incorporating the break in an ADL(<span class="math inline">\(1\)</span>,<span class="math inline">\(1\)</span>) regression model yields
<span class="math display">\[\begin{align*}
  Y_t =&amp; \beta_0 + \beta_1 Y_{t-1} + \delta_1 X_{t-1} + \gamma_0 D_t(\tau) + \gamma_1\left[D_t(\tau) \cdot Y_{t-1}\right] \\
  &amp;+ \, \gamma_2\left[ D_t(\tau) \cdot X_{t-1} \right] + u_t,
\end{align*}\]</span>
where we allow for discrete changes in <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span> at the break date <span class="math inline">\(\tau\)</span>. The null hypothesis of no break, <span class="math display">\[H_0: \gamma_0=\gamma_1=\gamma_2=0,\]</span> can be tested against the alternative that at least one of the <span class="math inline">\(\gamma\)</span>’s is not zero using an <span class="math inline">\(F\)</span>-Test. This idea is called a Chow test after Gregory <span class="citation">Chow (<a href="#ref-chow1960" role="doc-biblioref">1960</a>)</span>.</p>
<p>When the break date is unknown the <em>Quandt likelihood ratio</em> (QLR) <em>test</em> <span class="citation">(<a href="#ref-quandt1960" role="doc-biblioref">Quandt 1960</a>)</span> may be used. It is a modified version of the Chow test which uses the largest of all <span class="math inline">\(F\)</span>-statistics obtained when applying the Chow test for all possible break dates in a predetermined range <span class="math inline">\(\left[\tau_0,\tau_1\right]\)</span>. The QLR test is summarized in Key Concept 14.9.</p>
<div id="KC14.9" class="keyconcept">
<h3 class="right">
Key Concept 14.9
</h3>
<h3 class="left">
The QLR Test for Coefficient Stability
</h3>
<p>
The QLR test can be used to test for a break in the population regression function if the date of the break is unknown. The QLR test statistic is the largest (Chow) <span class="math inline">\(F(\tau)\)</span> statistic computed over a range of eligible break dates <span class="math inline">\(\tau_0 \leq \tau \leq \tau_1\)</span>:
<span class="math display">\[\begin{align}
  QLR = \max\left[F(\tau_0),F(\tau_0 +1),\dots,F(\tau_1)\right]. (\#eq:QLRstatistic)
\end{align}\]</span>
</p>
<p>The most important properties are:</p>
<ul>
<li><p>The QLR test can be applied to test whether a subset of the coefficients in the population regression function breaks but the test also rejects if there is a slow evolution of the regression function.</p></li>
<li><p>When there is a single discrete break in the population regression function that lying at a date within the range tested, the <span class="math inline">\(QLR\)</span> test statistic is <span class="math inline">\(F(\widehat{\tau})\)</span> and <span class="math inline">\(\widehat{\tau}/T\)</span> is a consistent estimator of fraction of the sample at which the break is.</p></li>
<li><p>The large-sample distribution of <span class="math inline">\(QLR\)</span> depends on <span class="math inline">\(q\)</span>, the number of restrictions being tested and both ratios of end points to the sample size, <span class="math inline">\(\tau_0/T, \tau_1/T\)</span>.</p></li>
<li><p>Similar to the ADF test, the large-sample distribution of <span class="math inline">\(QLR\)</span> is nonstandard. Critical values are presented in Table 14.5 of the book.</p></li>
</ul>
</div>
<div id="has-the-predictive-power-of-the-term-spread-been-stable" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Has the Predictive Power of the term spread been stable?<a href="#has-the-predictive-power-of-the-term-spread-been-stable" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Using the QLR statistic we may test whether there is a break in the coefficients on the lags of the term spread in @ref(eq:gdpgradl22), the ADL(<span class="math inline">\(2\)</span>,<span class="math inline">\(2\)</span>) regression model of GDP growth. Following Key Concept 14.9 we modify the specification of @ref(eq:gdpgradl22) by adding a break dummy <span class="math inline">\(D(\tau)\)</span> and its interactions with both lags of term spread and choose the range of break points to be tested as 1970:Q1 - 2005:Q2 (these periods are the center 70% of the sample data from 1962:Q2 - 2012:Q4). Thus, the model becomes
<span class="math display">\[\begin{align*}
    GDPGR_t =&amp;\, \beta_0 + \beta_1 GDPGR_{t-1} + \beta_2 GDPGR_{t-2} \\
            &amp;+\,  \beta_3  TSpread_{t-1} + \beta_4 TSpread_{t-2} \\
            &amp;+\, \gamma_1 D(\tau) + \gamma_2 (D(\tau) \cdot TSpread_{t-1}) \\
            &amp;+\, \gamma_3 (D(\tau) \cdot TSpread_{t-2}) \\
            &amp;+\, u_t.
\end{align*}\]</span></p>
<p>Next, we estimate the model for each break point and compute the <span class="math inline">\(F\)</span>-statistic corresponding to the null hypothesis <span class="math inline">\(H_0: \gamma_1=\gamma_2=\gamma_3=0\)</span>. The <span class="math inline">\(QLR\)</span>-statistic is the largest of the <span class="math inline">\(F\)</span>-statistics obtained in this manner.</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up a range of possible break dates</span></span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1970</span>, <span class="dv">2005</span>, <span class="fl">0.25</span>)</span>
<span id="cb395-3"><a href="#cb395-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-4"><a href="#cb395-4" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize vector of F-statistics</span></span>
<span id="cb395-5"><a href="#cb395-5" aria-hidden="true" tabindex="-1"></a>Fstats <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(tau))</span>
<span id="cb395-6"><a href="#cb395-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-7"><a href="#cb395-7" aria-hidden="true" tabindex="-1"></a><span class="co"># estimation loop over break dates</span></span>
<span id="cb395-8"><a href="#cb395-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(tau)) {</span>
<span id="cb395-9"><a href="#cb395-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-10"><a href="#cb395-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set up dummy variable</span></span>
<span id="cb395-11"><a href="#cb395-11" aria-hidden="true" tabindex="-1"></a>  D <span class="ot">&lt;-</span> <span class="fu">time</span>(GDPGrowth_ts) <span class="sc">&gt;</span> tau[i]</span>
<span id="cb395-12"><a href="#cb395-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-13"><a href="#cb395-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># estimate ADL(2,2) model with intercations</span></span>
<span id="cb395-14"><a href="#cb395-14" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(GDPGrowth_ts <span class="sc">~</span> <span class="fu">L</span>(GDPGrowth_ts) <span class="sc">+</span> <span class="fu">L</span>(GDPGrowth_ts, <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb395-15"><a href="#cb395-15" aria-hidden="true" tabindex="-1"></a>                D<span class="sc">*</span><span class="fu">L</span>(TSpread_ts) <span class="sc">+</span> D<span class="sc">*</span><span class="fu">L</span>(TSpread_ts, <span class="dv">2</span>),</span>
<span id="cb395-16"><a href="#cb395-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">1</span>), </span>
<span id="cb395-17"><a href="#cb395-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>))</span>
<span id="cb395-18"><a href="#cb395-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb395-19"><a href="#cb395-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute and save the F-statistic</span></span>
<span id="cb395-20"><a href="#cb395-20" aria-hidden="true" tabindex="-1"></a>  Fstats[i] <span class="ot">&lt;-</span> <span class="fu">linearHypothesis</span>(test, </span>
<span id="cb395-21"><a href="#cb395-21" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">c</span>(<span class="st">&quot;DTRUE=0&quot;</span>, <span class="st">&quot;DTRUE:L(TSpread_ts)&quot;</span>, </span>
<span id="cb395-22"><a href="#cb395-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;DTRUE:L(TSpread_ts, 2)&quot;</span>),</span>
<span id="cb395-23"><a href="#cb395-23" aria-hidden="true" tabindex="-1"></a>                                <span class="at">vcov. =</span> sandwich)<span class="sc">$</span>F[<span class="dv">2</span>]</span>
<span id="cb395-24"><a href="#cb395-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-25"><a href="#cb395-25" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We determine the <span class="math inline">\(QLR\)</span> statistic using <tt>max()</tt>.</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="co"># identify QLR statistic</span></span>
<span id="cb396-2"><a href="#cb396-2" aria-hidden="true" tabindex="-1"></a>QLR <span class="ot">&lt;-</span> <span class="fu">max</span>(Fstats)</span>
<span id="cb396-3"><a href="#cb396-3" aria-hidden="true" tabindex="-1"></a>QLR</span>
<span id="cb396-4"><a href="#cb396-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 6.651156</span></span></code></pre></div>
<p>Let us check that the <span class="math inline">\(QLR\)</span>-statistic is the <span class="math inline">\(F\)</span>-statistic obtained for the regression where 1980:Q4 is chosen as the break date.</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="co"># identify the time period where the QLR-statistic is observed</span></span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.yearqtr</span>(tau[<span class="fu">which.max</span>(Fstats)])</span>
<span id="cb397-3"><a href="#cb397-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;1980 Q4&quot;</span></span></code></pre></div>
<p>Since <span class="math inline">\(q=3\)</span> hypotheses are tested and the central <span class="math inline">\(70\%\)</span> of the sample are considered to contain breaks, the corresponding <span class="math inline">\(1\%\)</span> critical value of the <span class="math inline">\(QLR\)</span> test is <span class="math inline">\(6.02\)</span>. We reject the null hypothesis that all coefficients (the coefficients on both lags of term spread and the intercept) are stable since the computed <span class="math inline">\(QLR\)</span>-statistic exceeds this threshold. Thus evidence from the <span class="math inline">\(QLR\)</span> test suggests that there is a break in the ADL(<span class="math inline">\(2\)</span>,<span class="math inline">\(2\)</span>) model of GDP growth in the early 1980s.</p>
<p>To reproduce Figure 14.5 of the book, we convert the vector of sequential break-point <span class="math inline">\(F\)</span>-statistics into a time series object and then generate a simple plot with some annotations.</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="co"># series of F-statistics</span></span>
<span id="cb398-2"><a href="#cb398-2" aria-hidden="true" tabindex="-1"></a>Fstatsseries <span class="ot">&lt;-</span> <span class="fu">ts</span>(Fstats, </span>
<span id="cb398-3"><a href="#cb398-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">start =</span> tau[<span class="dv">1</span>], </span>
<span id="cb398-4"><a href="#cb398-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">end =</span> tau[<span class="fu">length</span>(tau)], </span>
<span id="cb398-5"><a href="#cb398-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb398-6"><a href="#cb398-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-7"><a href="#cb398-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the F-statistics </span></span>
<span id="cb398-8"><a href="#cb398-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Fstatsseries, </span>
<span id="cb398-9"><a href="#cb398-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>, <span class="dv">2015</span>),</span>
<span id="cb398-10"><a href="#cb398-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">7.5</span>),</span>
<span id="cb398-11"><a href="#cb398-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb398-12"><a href="#cb398-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb398-13"><a href="#cb398-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;F-Statistic&quot;</span>,</span>
<span id="cb398-14"><a href="#cb398-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Break Date&quot;</span>,</span>
<span id="cb398-15"><a href="#cb398-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Testing for a Break in GDP ADL(2,2) Regression at Different Dates&quot;</span>)</span>
<span id="cb398-16"><a href="#cb398-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-17"><a href="#cb398-17" aria-hidden="true" tabindex="-1"></a><span class="co"># dashed horizontal lines for critical values and QLR statistic</span></span>
<span id="cb398-18"><a href="#cb398-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">4.71</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb398-19"><a href="#cb398-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">6.02</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb398-20"><a href="#cb398-20" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">0</span>, QLR, <span class="fl">1980.75</span>, QLR, <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb398-21"><a href="#cb398-21" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">2010</span>, <span class="fl">6.2</span>, <span class="st">&quot;1% Critical Value&quot;</span>)</span>
<span id="cb398-22"><a href="#cb398-22" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">2010</span>, <span class="fl">4.9</span>, <span class="st">&quot;5% Critical Value&quot;</span>)</span>
<span id="cb398-23"><a href="#cb398-23" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1980.75</span>, QLR<span class="fl">+0.2</span>, <span class="st">&quot;QLR Statistic&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-651-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="pseudo-out-of-sample-forecasting" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Pseudo Out-of-Sample Forecasting<a href="#pseudo-out-of-sample-forecasting" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pseudo out-of-sample forecasts are used to simulate the out-of-sample performance (the real time forecast performance) of a time series regression model. In particular, pseudo out-of-sample forecasts allow estimation of the <span class="math inline">\(RMSFE\)</span> of the model and enable researchers to compare different model specifications with respect to their predictive power. Key Concept 14.10 summarizes this idea.</p>
<div id="KC14.10" class="keyconcept">
<h3 class="right">
Key Concept 14.10
</h3>
<h3 class="left">
Pseudo Out-of-Sample Forecasting
</h3>
<ol style="list-style-type: decimal">
<li><p>Divide the sample data into <span class="math inline">\(s=T-P\)</span> and <span class="math inline">\(P\)</span> subsequent observations. The <span class="math inline">\(P\)</span> observations are used as pseudo-out-of-sample observations.</p></li>
<li><p>Estimate the model using the first <span class="math inline">\(s\)</span> observations.</p></li>
<li><p>Compute the pseudo-forecast <span class="math inline">\(\overset{\sim}{Y}_{s+1\vert s}\)</span>.</p></li>
<li><p>Compute the pseudo-forecast-error <span class="math inline">\(\overset{\sim}{u}_{s+1} = Y_{s+1} - \overset{\sim}{Y}_{s+1\vert s}\)</span>.</p></li>
<li><p>Repeat steps 2 trough 4 for all remaining pseudo-out-of-sample dates.</p></li>
</ol>
</div>
</div>
<div id="did-the-predictive-power-of-the-term-spread-change-during-the-2000s" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Did the Predictive Power of the Term Spread Change During the 2000s?<a href="#did-the-predictive-power-of-the-term-spread-change-during-the-2000s" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The insight gained in the previous section gives reason to presume that the pseudo-out-of-sample performance of ADL(<span class="math inline">\(2\)</span>,<span class="math inline">\(2\)</span>) models estimated using data <em>after</em> the break in the early 1980s should not deteriorate relative to using the whole sample: provided that the coefficients of the population regression function are stable after the potential break in 1980:Q4, these models should have good predictive power. We check this by computing pseudo-out-of-sample forecasts for the period 2003:Q1 - 2012:Q4, a range covering 40 periods, where the forecast for 2003:Q1 is done using data from 1981:Q1 - 2002:Q4, the forecast for 2003:Q2 is based on data from 1981:Q1 - 2003:Q1 and so on.</p>
<p>Similarly as for the <span class="math inline">\(QLR\)</span>-test we use a <tt>for()</tt> loop for estimation of all 40 models and gather their <span class="math inline">\(SER\)</span>s and the obtained forecasts in a vector which is then used to compute pseudo-out-of-sample forecast errors.</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="co"># end of sample dates</span></span>
<span id="cb399-2"><a href="#cb399-2" aria-hidden="true" tabindex="-1"></a>EndOfSample <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">2002.75</span>, <span class="fl">2012.5</span>, <span class="fl">0.25</span>)</span>
<span id="cb399-3"><a href="#cb399-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-4"><a href="#cb399-4" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize matrix forecasts</span></span>
<span id="cb399-5"><a href="#cb399-5" aria-hidden="true" tabindex="-1"></a>forecasts <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">1</span>, </span>
<span id="cb399-6"><a href="#cb399-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ncol =</span> <span class="fu">length</span>(EndOfSample))</span>
<span id="cb399-7"><a href="#cb399-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-8"><a href="#cb399-8" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize vector SER</span></span>
<span id="cb399-9"><a href="#cb399-9" aria-hidden="true" tabindex="-1"></a>SER  <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(EndOfSample))</span>
<span id="cb399-10"><a href="#cb399-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-11"><a href="#cb399-11" aria-hidden="true" tabindex="-1"></a><span class="co"># estimation loop over end of sample dates</span></span>
<span id="cb399-12"><a href="#cb399-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(EndOfSample)) {</span>
<span id="cb399-13"><a href="#cb399-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-14"><a href="#cb399-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># estimate ADL(2,2) model</span></span>
<span id="cb399-15"><a href="#cb399-15" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(GDPGrowth_ts <span class="sc">~</span> <span class="fu">L</span>(GDPGrowth_ts) <span class="sc">+</span> <span class="fu">L</span>(GDPGrowth_ts, <span class="dv">2</span>) </span>
<span id="cb399-16"><a href="#cb399-16" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">+</span> <span class="fu">L</span>(TSpread_ts) <span class="sc">+</span> <span class="fu">L</span>(TSpread_ts, <span class="dv">2</span>), </span>
<span id="cb399-17"><a href="#cb399-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1981</span>, <span class="dv">1</span>), </span>
<span id="cb399-18"><a href="#cb399-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">end =</span> EndOfSample[i])</span>
<span id="cb399-19"><a href="#cb399-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb399-20"><a href="#cb399-20" aria-hidden="true" tabindex="-1"></a>  SER[i] <span class="ot">&lt;-</span> <span class="fu">summary</span>(m)<span class="sc">$</span>sigma</span>
<span id="cb399-21"><a href="#cb399-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb399-22"><a href="#cb399-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sample data for one-period ahead forecast</span></span>
<span id="cb399-23"><a href="#cb399-23" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">window</span>(ADLdata, EndOfSample[i] <span class="sc">-</span> <span class="fl">0.25</span>, EndOfSample[i])</span>
<span id="cb399-24"><a href="#cb399-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb399-25"><a href="#cb399-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute forecast</span></span>
<span id="cb399-26"><a href="#cb399-26" aria-hidden="true" tabindex="-1"></a>  forecasts[i] <span class="ot">&lt;-</span> <span class="fu">coef</span>(m) <span class="sc">%*%</span> <span class="fu">c</span>(<span class="dv">1</span>, s[<span class="dv">1</span>, <span class="dv">1</span>], s[<span class="dv">2</span>, <span class="dv">1</span>], s[<span class="dv">1</span>, <span class="dv">2</span>], s[<span class="dv">2</span>, <span class="dv">2</span>]) </span>
<span id="cb399-27"><a href="#cb399-27" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute psuedo-out-of-sample forecast errors</span></span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true" tabindex="-1"></a>POOSFCE <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">window</span>(GDPGrowth_ts, <span class="fu">c</span>(<span class="dv">2003</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>))) <span class="sc">-</span> forecasts</span></code></pre></div>
<p>We next translate the pseudo-out-of-sample forecasts into an object of class <tt>ts</tt> and plot the real GDP growth rate against the forecasted series.</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="co"># series of pseudo-out-of-sample forecasts</span></span>
<span id="cb401-2"><a href="#cb401-2" aria-hidden="true" tabindex="-1"></a>PSOSSFc <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">c</span>(forecasts), </span>
<span id="cb401-3"><a href="#cb401-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="dv">2003</span>, </span>
<span id="cb401-4"><a href="#cb401-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">end =</span> <span class="fl">2012.75</span>, </span>
<span id="cb401-5"><a href="#cb401-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb401-6"><a href="#cb401-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-7"><a href="#cb401-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the GDP growth time series</span></span>
<span id="cb401-8"><a href="#cb401-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">window</span>(GDPGrowth_ts, <span class="fu">c</span>(<span class="dv">2003</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>)),</span>
<span id="cb401-9"><a href="#cb401-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb401-10"><a href="#cb401-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb401-11"><a href="#cb401-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Percent&quot;</span>,</span>
<span id="cb401-12"><a href="#cb401-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Pseudo-Out-Of-Sample Forecasts of GDP Growth&quot;</span>)</span>
<span id="cb401-13"><a href="#cb401-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-14"><a href="#cb401-14" aria-hidden="true" tabindex="-1"></a><span class="co"># add the series of pseudo-out-of-sample forecasts</span></span>
<span id="cb401-15"><a href="#cb401-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(PSOSSFc, </span>
<span id="cb401-16"><a href="#cb401-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb401-17"><a href="#cb401-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb401-18"><a href="#cb401-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-19"><a href="#cb401-19" aria-hidden="true" tabindex="-1"></a><span class="co"># shade area between curves (the pseudo forecast error)</span></span>
<span id="cb401-20"><a href="#cb401-20" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(<span class="fu">time</span>(PSOSSFc), <span class="fu">rev</span>(<span class="fu">time</span>(PSOSSFc))), </span>
<span id="cb401-21"><a href="#cb401-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="fu">window</span>(GDPGrowth_ts, <span class="fu">c</span>(<span class="dv">2003</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>)), <span class="fu">rev</span>(PSOSSFc)),</span>
<span id="cb401-22"><a href="#cb401-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb401-23"><a href="#cb401-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb401-24"><a href="#cb401-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-25"><a href="#cb401-25" aria-hidden="true" tabindex="-1"></a><span class="co"># add a legend</span></span>
<span id="cb401-26"><a href="#cb401-26" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, </span>
<span id="cb401-27"><a href="#cb401-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb401-28"><a href="#cb401-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">10</span>),</span>
<span id="cb401-29"><a href="#cb401-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;steelblue&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="fu">alpha</span>(<span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>)), </span>
<span id="cb401-30"><a href="#cb401-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Actual GDP growth rate&quot;</span>,</span>
<span id="cb401-31"><a href="#cb401-31" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Forecasted GDP growth rate&quot;</span>,</span>
<span id="cb401-32"><a href="#cb401-32" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Pseudo forecast Error&quot;</span>))</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-656-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Apparently, the pseudo forecasts track the actual GDP growth rate quite well, except for the kink in 2009 which can be attributed to the recent financial crisis.</p>
<p>The <span class="math inline">\(SER\)</span> of the first model (estimated using data from 1981:Q1 to 2002:Q4) is <span class="math inline">\(2.39\)</span> so based on the in-sample fit we would expect the out of sample forecast errors to have mean zero and a root mean squared forecast error of about <span class="math inline">\(2.39\)</span>.</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SER of ADL(2,2) mode using data from 1981:Q1 - 2002:Q4</span></span>
<span id="cb402-2"><a href="#cb402-2" aria-hidden="true" tabindex="-1"></a>SER[<span class="dv">1</span>]</span>
<span id="cb402-3"><a href="#cb402-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2.389773</span></span></code></pre></div>
<p>The root mean squared forecast error of the pseudo-out-of-sample forecasts is somewhat larger.</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute root mean squared forecast error</span></span>
<span id="cb403-2"><a href="#cb403-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(POOSFCE)</span>
<span id="cb403-3"><a href="#cb403-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2.667612</span></span></code></pre></div>
<p>An interesting hypothesis is whether the mean forecast error is zero, that is the ADL(<span class="math inline">\(2\)</span>,<span class="math inline">\(2\)</span>) forecasts are right, on average. This hypothesis is easily tested using the function <tt>t.test()</tt>.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test if mean forecast error is zero</span></span>
<span id="cb404-2"><a href="#cb404-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(POOSFCE)</span>
<span id="cb404-3"><a href="#cb404-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb404-4"><a href="#cb404-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  One Sample t-test</span></span>
<span id="cb404-5"><a href="#cb404-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb404-6"><a href="#cb404-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  POOSFCE</span></span>
<span id="cb404-7"><a href="#cb404-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t = -1.5523, df = 39, p-value = 0.1287</span></span>
<span id="cb404-8"><a href="#cb404-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true mean is not equal to 0</span></span>
<span id="cb404-9"><a href="#cb404-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb404-10"><a href="#cb404-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  -1.5078876  0.1984001</span></span>
<span id="cb404-11"><a href="#cb404-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb404-12"><a href="#cb404-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  mean of x </span></span>
<span id="cb404-13"><a href="#cb404-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -0.6547438</span></span></code></pre></div>
<p>The hypothesis cannot be rejected at the <span class="math inline">\(10\%\)</span> significance level. Altogether the analysis suggests that the ADL(<span class="math inline">\(2\)</span>,<span class="math inline">\(2\)</span>) model coefficients have been stable since the presumed break in the early 1980s.</p>
</div>
</div>
<div id="can-you-beat-the-market-part-ii" class="section level2 hasAnchor" number="14.9">
<h2 class="hasAnchor"><span class="header-section-number">14.9</span> Can You Beat the Market? (Part II)<a href="#can-you-beat-the-market-part-ii" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The dividend yield (the ratio of current dividends to the stock price) can be considered as an indicator of future dividends: if a stock has a high current dividend yield, it can be considered undervalued and it can be presumed that the price of the stock goes up in the future, meaning that future excess returns go up.</p>
<p>This presumption can be examined using ADL models of excess returns, where lags of the logarithm of the stock’s dividend yield serve as additional regressors.</p>
<p>Unfortunately, a graphical inspection of the time series of the logarithm of the dividend yield casts doubt on the assumption that the series is stationary which, as has been discussed in Chapter @ref(nit), is necessary to conduct standard inference in a regression analysis.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot logarithm of dividend yield series</span></span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(StockReturns[, <span class="dv">2</span>], </span>
<span id="cb405-3"><a href="#cb405-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb405-4"><a href="#cb405-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb405-5"><a href="#cb405-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Logarithm&quot;</span>, </span>
<span id="cb405-6"><a href="#cb405-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Dividend Yield for CRSP Index&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-660-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The Dickey-Fuller test statistic for an autoregressive unit root in an AR(<span class="math inline">\(1\)</span>) model with drift provides further evidence that the series might be nonstationary.</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test for unit root in GDP using &#39;ur.df()&#39; from the package &#39;urca&#39;</span></span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">ur.df</span>(<span class="fu">window</span>(StockReturns[, <span class="dv">2</span>], </span>
<span id="cb406-3"><a href="#cb406-3" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">1</span>), </span>
<span id="cb406-4"><a href="#cb406-4" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="dv">2002</span>, <span class="dv">12</span>)), </span>
<span id="cb406-5"><a href="#cb406-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&quot;drift&quot;</span>, </span>
<span id="cb406-6"><a href="#cb406-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">lags =</span> <span class="dv">0</span>))</span>
<span id="cb406-7"><a href="#cb406-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb406-8"><a href="#cb406-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ############################################### </span></span>
<span id="cb406-9"><a href="#cb406-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Augmented Dickey-Fuller Test Unit Root Test # </span></span>
<span id="cb406-10"><a href="#cb406-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ############################################### </span></span>
<span id="cb406-11"><a href="#cb406-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb406-12"><a href="#cb406-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test regression drift </span></span>
<span id="cb406-13"><a href="#cb406-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb406-14"><a href="#cb406-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb406-15"><a href="#cb406-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb406-16"><a href="#cb406-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = z.diff ~ z.lag.1 + 1)</span></span>
<span id="cb406-17"><a href="#cb406-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb406-18"><a href="#cb406-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb406-19"><a href="#cb406-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb406-20"><a href="#cb406-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -14.3540  -2.9118  -0.2953   2.6375  25.5169 </span></span>
<span id="cb406-21"><a href="#cb406-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb406-22"><a href="#cb406-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb406-23"><a href="#cb406-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span id="cb406-24"><a href="#cb406-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -2.740964   2.080038  -1.318    0.188</span></span>
<span id="cb406-25"><a href="#cb406-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; z.lag.1     -0.007652   0.005989  -1.278    0.202</span></span>
<span id="cb406-26"><a href="#cb406-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb406-27"><a href="#cb406-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 4.45 on 513 degrees of freedom</span></span>
<span id="cb406-28"><a href="#cb406-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.003172,   Adjusted R-squared:  0.001229 </span></span>
<span id="cb406-29"><a href="#cb406-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 1.633 on 1 and 513 DF,  p-value: 0.2019</span></span>
<span id="cb406-30"><a href="#cb406-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb406-31"><a href="#cb406-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb406-32"><a href="#cb406-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Value of test-statistic is: -1.2777 0.9339 </span></span>
<span id="cb406-33"><a href="#cb406-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb406-34"><a href="#cb406-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Critical values for test statistics: </span></span>
<span id="cb406-35"><a href="#cb406-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       1pct  5pct 10pct</span></span>
<span id="cb406-36"><a href="#cb406-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tau2 -3.43 -2.86 -2.57</span></span>
<span id="cb406-37"><a href="#cb406-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; phi1  6.43  4.59  3.78</span></span></code></pre></div>
<p>We use <tt>window()</tt> to get observations from January 1960 to December 2012 only.</p>
<p>Since the <span class="math inline">\(t\)</span>-value for the coefficient on the lagged logarithm of the dividend yield is <span class="math inline">\(-1.27\)</span>, the hypothesis that the true coefficient is zero cannot be rejected, even at the <span class="math inline">\(10\%\)</span> significance level.</p>
<p>However, it is possible to examine whether the dividend yield has predictive power for excess returns by using its differences in an ADL(<span class="math inline">\(1\)</span>,<span class="math inline">\(1\)</span>) and an ADL(<span class="math inline">\(2\)</span>,<span class="math inline">\(2\)</span>) model (remember that differencing a series with a unit root yields a stationary series), although these model specifications do not correspond to the economic reasoning mentioned above. Thus, we also estimate an ADL(<span class="math inline">\(1\)</span>,<span class="math inline">\(1\)</span>) regression using the level of the logarithm of the dividend yield.</p>
<p>That is we estimate three different specifications:</p>
<p><span class="math display">\[\begin{align*}
  excess \, returns_t =&amp; \, \beta_0 + \beta_1 excess \, returns_{t-1} + \beta_3 \Delta \log(dividend yield_{t-1}) + u_t \\
  \\
  excess \, returns_t =&amp; \, \beta_0 + \beta_1 excess \, returns_{t-1} + \beta_2 excess \, returns_{t-2} \\ &amp;+ \, \beta_3 \Delta \log(dividend yield_{t-1}) + \beta_4 \Delta \log(dividend yield_{t-2}) + u_t \\
  \\
  excess \, returns_t =&amp; \, \beta_0 + \beta_1 excess \, returns_{t-1} + \beta_5 \log(dividend yield_{t-1}) + u_t \\
\end{align*}\]</span></p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ADL(1,1) (1st difference of log dividend yield)</span></span>
<span id="cb407-2"><a href="#cb407-2" aria-hidden="true" tabindex="-1"></a>CRSP_ADL_1 <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(ExReturn <span class="sc">~</span> <span class="fu">L</span>(ExReturn) <span class="sc">+</span> <span class="fu">d</span>(<span class="fu">L</span>(ln_DivYield)), </span>
<span id="cb407-3"><a href="#cb407-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> StockReturns,</span>
<span id="cb407-4"><a href="#cb407-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1960</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2002</span>, <span class="dv">12</span>))</span>
<span id="cb407-5"><a href="#cb407-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-6"><a href="#cb407-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ADL(2,2) (1st &amp; 2nd differences of log dividend yield)</span></span>
<span id="cb407-7"><a href="#cb407-7" aria-hidden="true" tabindex="-1"></a>CRSP_ADL_2 <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(ExReturn <span class="sc">~</span> <span class="fu">L</span>(ExReturn) <span class="sc">+</span> <span class="fu">L</span>(ExReturn, <span class="dv">2</span>) </span>
<span id="cb407-8"><a href="#cb407-8" aria-hidden="true" tabindex="-1"></a>                    <span class="sc">+</span> <span class="fu">d</span>(<span class="fu">L</span>(ln_DivYield)) <span class="sc">+</span> <span class="fu">d</span>(<span class="fu">L</span>(ln_DivYield, <span class="dv">2</span>)), </span>
<span id="cb407-9"><a href="#cb407-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> StockReturns,</span>
<span id="cb407-10"><a href="#cb407-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1960</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2002</span>, <span class="dv">12</span>))</span>
<span id="cb407-11"><a href="#cb407-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-12"><a href="#cb407-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ADL(1,1) (level of log dividend yield)</span></span>
<span id="cb407-13"><a href="#cb407-13" aria-hidden="true" tabindex="-1"></a>CRSP_ADL_3 <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(ExReturn <span class="sc">~</span> <span class="fu">L</span>(ExReturn) <span class="sc">+</span> <span class="fu">L</span>(ln_DivYield),</span>
<span id="cb407-14"><a href="#cb407-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> StockReturns,</span>
<span id="cb407-15"><a href="#cb407-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1960</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">1992</span>, <span class="dv">12</span>))</span></code></pre></div>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gather robust standard errors</span></span>
<span id="cb408-2"><a href="#cb408-2" aria-hidden="true" tabindex="-1"></a>rob_se_CRSP_ADL <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">sandwich</span>(CRSP_ADL_1))),</span>
<span id="cb408-3"><a href="#cb408-3" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">sandwich</span>(CRSP_ADL_2))),</span>
<span id="cb408-4"><a href="#cb408-4" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">sandwich</span>(CRSP_ADL_3))))</span></code></pre></div>
<p>A tabular representation of the results can then be generated using <tt>stargazer()</tt>.</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(CRSP_ADL_1, CRSP_ADL_2, CRSP_ADL_3,</span>
<span id="cb409-2"><a href="#cb409-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;ADL Models of Monthly Excess Stock Returns&quot;</span>,</span>
<span id="cb409-3"><a href="#cb409-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">header =</span> <span class="cn">FALSE</span>, </span>
<span id="cb409-4"><a href="#cb409-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>,</span>
<span id="cb409-5"><a href="#cb409-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">column.sep.width =</span> <span class="st">&quot;-5pt&quot;</span>,</span>
<span id="cb409-6"><a href="#cb409-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">no.space =</span> T,</span>
<span id="cb409-7"><a href="#cb409-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">3</span>, </span>
<span id="cb409-8"><a href="#cb409-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">column.labels =</span> <span class="fu">c</span>(<span class="st">&quot;ADL(1,1)&quot;</span>, <span class="st">&quot;ADL(2,2)&quot;</span>, <span class="st">&quot;ADL(1,1)&quot;</span>),</span>
<span id="cb409-9"><a href="#cb409-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">dep.var.caption  =</span> <span class="st">&quot;Dependent Variable: Excess returns on the CSRP value-weighted index&quot;</span>,</span>
<span id="cb409-10"><a href="#cb409-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">dep.var.labels.include =</span> <span class="cn">FALSE</span>,</span>
<span id="cb409-11"><a href="#cb409-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">covariate.labels =</span> <span class="fu">c</span>(<span class="st">&quot;$excess return_{t-1}$&quot;</span>, </span>
<span id="cb409-12"><a href="#cb409-12" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;$excess return_{t-2}$&quot;</span>, </span>
<span id="cb409-13"><a href="#cb409-13" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;$1^{st} diff log(dividend yield_{t-1})$&quot;</span>, </span>
<span id="cb409-14"><a href="#cb409-14" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;$1^{st} diff log(dividend yield_{t-2})$&quot;</span>, </span>
<span id="cb409-15"><a href="#cb409-15" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;$log(dividend yield_{t-1})$&quot;</span>, </span>
<span id="cb409-16"><a href="#cb409-16" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Constant&quot;</span>),</span>
<span id="cb409-17"><a href="#cb409-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> rob_se_CRSP_ADL) </span></code></pre></div>



<table style="text-align:center"><tr><td colspan="4" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"></td><td colspan="3">Dependent Variable: Excess Returns on the CSRP Value-Weighted Index</td></tr>
<tr><td></td><td colspan="3" style="border-bottom: 1px solid black"></td></tr>
<tr><td style="text-align:left"></td><td>ADL(1,1)</td><td>ADL(2,2)</td><td>ADL(1,1)</td></tr>
<tr><td style="text-align:left"></td><td>(1)</td><td>(2)</td><td>(3)</td></tr>
<tr><td colspan="4" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">excess return<sub>t-1</sub></td><td>0.059</td><td>0.042</td><td>0.078</td></tr>
<tr><td style="text-align:left"></td><td>(0.158)</td><td>(0.162)</td><td>(0.057)</td></tr>
<tr><td style="text-align:left">excess return<sub>t-2</sub></td><td></td><td>-0.213</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(0.193)</td><td></td></tr>
<tr><td style="text-align:left">1<sup>st</sup> diff log(dividend yield<sub>t-1</sub>)</td><td>0.009</td><td>-0.012</td><td></td></tr>
<tr><td style="text-align:left"></td><td>(0.157)</td><td>(0.163)</td><td></td></tr>
<tr><td style="text-align:left">1<sup>st</sup> diff log(dividend yield<sub>t-2</sub>)</td><td></td><td>-0.161</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(0.185)</td><td></td></tr>
<tr><td style="text-align:left">log(dividend yield<sub>t-1</sub>)</td><td></td><td></td><td>0.026<sup>**</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td>(0.012)</td></tr>
<tr><td style="text-align:left">Constant</td><td>0.309</td><td>0.372<sup>*</sup></td><td>8.987<sup>**</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.199)</td><td>(0.208)</td><td>(3.912)</td></tr>
<tr><td colspan="4" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">Observations</td><td>516</td><td>516</td><td>396</td></tr>
<tr><td style="text-align:left">R<sup>2</sup></td><td>0.003</td><td>0.007</td><td>0.018</td></tr>
<tr><td style="text-align:left">Adjusted R<sup>2</sup></td><td>-0.001</td><td>-0.001</td><td>0.013</td></tr>
<tr><td style="text-align:left">Residual Std. Error</td><td>4.338 (df = 513)</td><td>4.337 (df = 511)</td><td>4.407 (df = 393)</td></tr>
<tr><td style="text-align:left">F Statistic</td><td>0.653 (df = 2; 513)</td><td>0.897 (df = 4; 511)</td><td>3.683<sup>**</sup> (df = 2; 393)</td></tr>
<tr><td colspan="4" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"><em>Note:</em></td><td colspan="3" style="text-align:right"><sup>*</sup>p<0.1; <sup>**</sup>p<0.05; <sup>***</sup>p<0.01</td></tr>
</table>
<caption><p style='text-align:center'>(#tab:adlmomesr) ADL Models of Monthly Excess Stock Returns</p></caption>


<p>For models (1) and (2) none of the individual <span class="math inline">\(t\)</span>-statistics suggest that the coefficients are different from zero. Also, we cannot reject the hypothesis that none of the lags have predictive power for excess returns at any common level of significance (an <span class="math inline">\(F\)</span>-test that the lags have predictive power does not reject for both models).</p>
<p>Things are different for model (3). The coefficient on the level of the logarithm of the dividend yield is different from zero at the <span class="math inline">\(5\%\)</span> level and the <span class="math inline">\(F\)</span>-test rejects, too. But we should be suspicious: the high degree of persistence in the dividend yield series probably renders this inference dubious because <span class="math inline">\(t\)</span>- and <span class="math inline">\(F\)</span>-statistics may follow distributions that deviate considerably from their theoretical large-sample distributions such that the usual critical values cannot be applied.</p>
<p>If model (3) were of use for predicting excess returns, pseudo-out-of-sample forecasts based on (3) should at least outperform forecasts of an intercept-only model in terms of the sample RMSFE. We can perform this type of comparison using <tt>R</tt> code in the fashion of the applications of Chapter @ref(niib).</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="co"># end of sample dates</span></span>
<span id="cb410-2"><a href="#cb410-2" aria-hidden="true" tabindex="-1"></a>EndOfSample <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">window</span>(<span class="fu">time</span>(StockReturns), <span class="fu">c</span>(<span class="dv">1992</span>, <span class="dv">12</span>), <span class="fu">c</span>(<span class="dv">2002</span>, <span class="dv">11</span>)))</span>
<span id="cb410-3"><a href="#cb410-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-4"><a href="#cb410-4" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize matrix  forecasts</span></span>
<span id="cb410-5"><a href="#cb410-5" aria-hidden="true" tabindex="-1"></a>forecasts <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">2</span>, </span>
<span id="cb410-6"><a href="#cb410-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ncol =</span> <span class="fu">length</span>(EndOfSample))</span>
<span id="cb410-7"><a href="#cb410-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-8"><a href="#cb410-8" aria-hidden="true" tabindex="-1"></a><span class="co"># estimation loop over end of sample dates</span></span>
<span id="cb410-9"><a href="#cb410-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(EndOfSample)) {</span>
<span id="cb410-10"><a href="#cb410-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-11"><a href="#cb410-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># estimate model (3)</span></span>
<span id="cb410-12"><a href="#cb410-12" aria-hidden="true" tabindex="-1"></a>  mod3 <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(ExReturn <span class="sc">~</span> <span class="fu">L</span>(ExReturn) <span class="sc">+</span> <span class="fu">L</span>(ln_DivYield), <span class="at">data =</span> StockReturns, </span>
<span id="cb410-13"><a href="#cb410-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1960</span>, <span class="dv">1</span>), </span>
<span id="cb410-14"><a href="#cb410-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">end =</span> EndOfSample[i])</span>
<span id="cb410-15"><a href="#cb410-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb410-16"><a href="#cb410-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># estimate intercept only model</span></span>
<span id="cb410-17"><a href="#cb410-17" aria-hidden="true" tabindex="-1"></a>  modconst <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(ExReturn <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> StockReturns, </span>
<span id="cb410-18"><a href="#cb410-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1960</span>, <span class="dv">1</span>), </span>
<span id="cb410-19"><a href="#cb410-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">end =</span> EndOfSample[i])</span>
<span id="cb410-20"><a href="#cb410-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb410-21"><a href="#cb410-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sample data for one-period ahead forecast</span></span>
<span id="cb410-22"><a href="#cb410-22" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">window</span>(StockReturns, EndOfSample[i], EndOfSample[i])</span>
<span id="cb410-23"><a href="#cb410-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb410-24"><a href="#cb410-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute forecast</span></span>
<span id="cb410-25"><a href="#cb410-25" aria-hidden="true" tabindex="-1"></a>  forecasts[, i] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">coef</span>(mod3) <span class="sc">%*%</span> <span class="fu">c</span>(<span class="dv">1</span>, t[<span class="dv">1</span>], t[<span class="dv">2</span>]), <span class="fu">coef</span>(modconst))</span>
<span id="cb410-26"><a href="#cb410-26" aria-hidden="true" tabindex="-1"></a>                     </span>
<span id="cb410-27"><a href="#cb410-27" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gather data</span></span>
<span id="cb411-2"><a href="#cb411-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">&quot;Excess Returns&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">window</span>(StockReturns[,<span class="dv">1</span>], <span class="fu">c</span>(<span class="dv">1993</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2002</span>, <span class="dv">12</span>))),</span>
<span id="cb411-3"><a href="#cb411-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;Model (3)&quot;</span> <span class="ot">=</span> forecasts[<span class="dv">1</span>,], </span>
<span id="cb411-4"><a href="#cb411-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;Intercept Only&quot;</span> <span class="ot">=</span> forecasts[<span class="dv">2</span>,], </span>
<span id="cb411-5"><a href="#cb411-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;Always Zero&quot;</span> <span class="ot">=</span>  <span class="dv">0</span>)</span>
<span id="cb411-6"><a href="#cb411-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb411-7"><a href="#cb411-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute RMSFEs</span></span>
<span id="cb411-8"><a href="#cb411-8" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;ADL model (3)&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(d[, <span class="dv">1</span>] <span class="sc">-</span> d[, <span class="dv">2</span>]),</span>
<span id="cb411-9"><a href="#cb411-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Intercept-only model&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(d[, <span class="dv">1</span>] <span class="sc">-</span> d[, <span class="dv">3</span>]),</span>
<span id="cb411-10"><a href="#cb411-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Always zero&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(d[,<span class="dv">1</span>] <span class="sc">-</span> d[, <span class="dv">4</span>]))</span>
<span id="cb411-11"><a href="#cb411-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        ADL model (3) Intercept-only model          Always zero </span></span>
<span id="cb411-12"><a href="#cb411-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             4.043754             4.000218             3.995425</span></span></code></pre></div>
<p>The comparison indicates that model (3) is not useful since it is outperformed in terms of sample RMSFE by the intercept-only model. A model forecasting excess returns always to be zero has an even lower sample RMSFE. This finding is consistent with the weak-form efficiency hypothesis which states that all publicly available information is accounted for in stock prices such that there is no way to predict future stock prices or excess returns using past observations, implying that the perceived significant relationship indicated by model (3) is wrong.</p>
<div id="summary-6" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Summary<a href="#summary-6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This chapter dealt with introductory topics in time series regression analysis, where variables are generally correlated from one observation to the next, a concept termed serial correlation. We presented several ways of storing and plotting time series data using <tt>R</tt> and used these for informal analysis of economic data.</p>
<p>We have introduced AR and ADL models and applied them in the context of forecasting of macroeconomic and financial time series using <tt>R</tt>. The discussion also included the topic of lag length selection. It was shown how to set up a simple function that computes the BIC for a model object supplied.</p>
<p>We have also seen how to write simple <tt>R</tt> code for performing and evaluating forecasts and demonstrated some more sophisticated approaches to conduct pseudo-out-of-sample forecasts for assessment of a model’s predictive power for unobserved future outcomes of a series, to check model stability and to compare different models.</p>
<p>Furthermore, some more technical aspects like the concept of stationarity were addressed. This included applications to testing for an autoregressive unit root with the Dickey-Fuller test and the detection of a break in the population regression function using the <span class="math inline">\(QLR\)</span> statistic. For both methods, the distribution of the relevant test statistic is non-normal, even in large samples. Concerning the Dickey-Fuller test we have used <tt>R</tt>’s random number generation facilities to produce evidence for this by means of a Monte-Carlo simulation and motivated usage of the quantiles tabulated in the book.</p>
<p>Also, empirical studies regarding the validity of the weak and the strong form efficiency hypothesis which are presented in the applications <em>Can You Beat the Market? Part I &amp; II</em> in the book have been reproduced using <tt>R</tt>.</p>
<p>In all applications of this chapter, the focus was on forecasting future outcomes rather than estimation of causal relationships between time series variables. However, the methods needed for the latter are quite similar. Chapter @ref(eodce) is devoted to estimation of so called <em>dynamic causal effects</em>.</p>
<!--chapter:end:14-ch14.Rmd-->
</div>
</div>
</div>
<div id="eodce" class="section level1 hasAnchor" number="15">
<h1 class="hasAnchor"><span class="header-section-number">15</span> Estimation of Dynamic Causal Effects<a href="#eodce" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>It sometimes is of interest to know the size of current and future reaction of <span class="math inline">\(Y\)</span> to a change in <span class="math inline">\(X\)</span>. This is called the <em>dynamic causal effect</em> on <span class="math inline">\(Y\)</span> of a change in <span class="math inline">\(X\)</span>. In this Chapter we discuss how to estimate dynamic causal effects in <tt>R</tt> applications, where we investigate the dynamic effect of cold weather in Florida on the price of orange juice concentrate.</p>
<p>The discussion covers:</p>
<ul>
<li>estimation of distributed lag models</li>
<li>heteroskedasticity- and autocorrelation-consistent (HAC) standard errors</li>
<li>generalized least squares (GLS) estimation of ADL models</li>
</ul>
<p>To reproduce code examples, install the <tt>R</tt> packages listed below beforehand and make sure that the subsequent code chunk executes without any errors.</p>
<ul>
<li><tt>AER</tt> <span class="citation">(<a href="#ref-R-AER" role="doc-biblioref">Christian Kleiber and Zeileis 2022</a>)</span></li>
<li><tt>dynlm</tt> <span class="citation">(<a href="#ref-R-dynlm" role="doc-biblioref">Zeileis 2019</a>)</span></li>
<li><tt>nlme</tt> <span class="citation">(<a href="#ref-R-nlme" role="doc-biblioref">Pinheiro, Bates, and R Core Team 2023</a>)</span></li>
<li><tt>orcutt</tt> <span class="citation">(<a href="#ref-R-orcutt" role="doc-biblioref">Spada 2018</a>)</span></li>
<li><tt>quantmod</tt> <span class="citation">(<a href="#ref-R-quantmod" role="doc-biblioref">Ryan and Ulrich 2022</a>)</span></li>
<li><tt>stargazer</tt> <span class="citation">(<a href="#ref-R-stargazer" role="doc-biblioref">Hlavac 2022</a>)</span></li>
</ul>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb412-2"><a href="#cb412-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb412-3"><a href="#cb412-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dynlm)</span>
<span id="cb412-4"><a href="#cb412-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(orcutt)</span>
<span id="cb412-5"><a href="#cb412-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb412-6"><a href="#cb412-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span></code></pre></div>
<div id="the-orange-juice-data" class="section level2 hasAnchor" number="15.1">
<h2 class="hasAnchor"><span class="header-section-number">15.1</span> The Orange Juice Data<a href="#the-orange-juice-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The largest cultivation region for oranges in the U.S. is located in Florida which usually has ideal climate for the fruit growth. It thus is the source of almost all frozen juice concentrate produced in the country. However, from time to time and depending on their severeness, cold snaps cause a loss of harvests such that the supply of oranges decreases and consequently the price of frozen juice concentrate rises. The timing of the price increases is complicated: a cut in today’s supply of concentrate influences not just today’s price but also future prices because supply in future periods will decrease, too. Clearly, the magnitude of today’s and future prices increases due to freeze is an empirical question that can be investigated using a distributed lag model — a time series model that relates price changes to weather conditions.</p>
<p>To begin with the analysis, we reproduce Figure 15.1 of the book which displays plots of the price index for frozen concentrated orange juice, percentage changes in the price as well as monthly freezing degree days in Orlando, the center of Florida’s orange-growing region.</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the frozen orange juice data set</span></span>
<span id="cb413-2"><a href="#cb413-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;FrozenJuice&quot;</span>)</span>
<span id="cb413-3"><a href="#cb413-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-4"><a href="#cb413-4" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the price index for frozen concentrated juice</span></span>
<span id="cb413-5"><a href="#cb413-5" aria-hidden="true" tabindex="-1"></a>FOJCPI <span class="ot">&lt;-</span> FrozenJuice[, <span class="st">&quot;price&quot;</span>]<span class="sc">/</span>FrozenJuice[, <span class="st">&quot;ppi&quot;</span>]</span>
<span id="cb413-6"><a href="#cb413-6" aria-hidden="true" tabindex="-1"></a>FOJC_pctc <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fu">diff</span>(<span class="fu">log</span>(FOJCPI))</span>
<span id="cb413-7"><a href="#cb413-7" aria-hidden="true" tabindex="-1"></a>FDD <span class="ot">&lt;-</span> FrozenJuice[, <span class="st">&quot;fdd&quot;</span>]</span></code></pre></div>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert series to xts objects</span></span>
<span id="cb414-2"><a href="#cb414-2" aria-hidden="true" tabindex="-1"></a>FOJCPI_xts <span class="ot">&lt;-</span> <span class="fu">as.xts</span>(FOJCPI)</span>
<span id="cb414-3"><a href="#cb414-3" aria-hidden="true" tabindex="-1"></a>FDD_xts <span class="ot">&lt;-</span> <span class="fu">as.xts</span>(FrozenJuice[, <span class="dv">3</span>])</span>
<span id="cb414-4"><a href="#cb414-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb414-5"><a href="#cb414-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot orange juice price index</span></span>
<span id="cb414-6"><a href="#cb414-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.zoo</span>(FOJCPI),</span>
<span id="cb414-7"><a href="#cb414-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb414-8"><a href="#cb414-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb414-9"><a href="#cb414-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb414-10"><a href="#cb414-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Price index&quot;</span>, </span>
<span id="cb414-11"><a href="#cb414-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Frozen Concentrated Orange Juice&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-671-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="co"># divide plotting area</span></span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb415-3"><a href="#cb415-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb415-4"><a href="#cb415-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot percentage changes in prices</span></span>
<span id="cb415-5"><a href="#cb415-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.zoo</span>(FOJC_pctc),</span>
<span id="cb415-6"><a href="#cb415-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb415-7"><a href="#cb415-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb415-8"><a href="#cb415-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb415-9"><a href="#cb415-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Percent&quot;</span>,</span>
<span id="cb415-10"><a href="#cb415-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Monthly Changes in the Price of Frozen Conentrated Orange Juice&quot;</span>)</span>
<span id="cb415-11"><a href="#cb415-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb415-12"><a href="#cb415-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plot freezing degree days</span></span>
<span id="cb415-13"><a href="#cb415-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.zoo</span>(FDD),</span>
<span id="cb415-14"><a href="#cb415-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb415-15"><a href="#cb415-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb415-16"><a href="#cb415-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb415-17"><a href="#cb415-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Freezing degree days&quot;</span>,</span>
<span id="cb415-18"><a href="#cb415-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Monthly Freezing Degree Days in Orlando, FL&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-672-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Periods with a high amount of freezing degree days are followed by large month-to-month price changes. These coinciding movements motivate a simple regression of price changes (<span class="math inline">\(\%ChgOJC_t\)</span>) on freezing degree days (<span class="math inline">\(FDD_t\)</span>) to estimate the effect of an additional freezing degree day one the price in the current month. For this, as for all other regressions in this chapter, we use <span class="math inline">\(T=611\)</span> observations (January 1950 to December 2000).</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simple regression of percentage changes on freezing degree days</span></span>
<span id="cb416-2"><a href="#cb416-2" aria-hidden="true" tabindex="-1"></a>orange_SR <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(FOJC_pctc <span class="sc">~</span> FDD)</span>
<span id="cb416-3"><a href="#cb416-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(orange_SR, <span class="at">vcov. =</span> vcovHAC)</span>
<span id="cb416-4"><a href="#cb416-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb416-5"><a href="#cb416-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb416-6"><a href="#cb416-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb416-7"><a href="#cb416-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb416-8"><a href="#cb416-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.42095    0.18683 -2.2531 0.0246064 *  </span></span>
<span id="cb416-9"><a href="#cb416-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; FDD          0.46724    0.13385  3.4906 0.0005167 ***</span></span>
<span id="cb416-10"><a href="#cb416-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb416-11"><a href="#cb416-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Notice that the standard errors are computed using a “HAC” estimator of the variance-covariance matrix, see Chapter @ref(apatadlm) for a discussion of this estimator.</p>
<p><span class="math display">\[\begin{align*}
  \widehat{\%ChgOJC_t} = -\underset{(0.19)}{0.42} + \underset{(0.13)}{0.47} FDD_t
\end{align*}\]</span></p>
<p>The estimated coefficient on <span class="math inline">\(FDD_t\)</span> has the following interpretation: an additional freezing degree day in month <span class="math inline">\(t\)</span> leads to a price increase 0f <span class="math inline">\(0.47\)</span> percentage points in the same month.</p>
<p>To consider effects of cold snaps on the orange juice price over the subsequent periods, we include lagged values of <span class="math inline">\(FDD_t\)</span> in our model which leads to a <em>distributed lag regression model</em>. We estimate a specification using a contemporaneous and six lagged values of <span class="math inline">\(FDD_t\)</span> as regressors.</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="co"># distributed lag model with 6 lags of freezing degree days</span></span>
<span id="cb417-2"><a href="#cb417-2" aria-hidden="true" tabindex="-1"></a>orange_DLM <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(FOJC_pctc <span class="sc">~</span> FDD <span class="sc">+</span> <span class="fu">L</span>(FDD, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>))</span>
<span id="cb417-3"><a href="#cb417-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(orange_DLM, <span class="at">vcov. =</span> vcovHAC)</span>
<span id="cb417-4"><a href="#cb417-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb417-5"><a href="#cb417-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb417-6"><a href="#cb417-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb417-7"><a href="#cb417-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb417-8"><a href="#cb417-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -0.692961   0.212445 -3.2618 0.0011700 ** </span></span>
<span id="cb417-9"><a href="#cb417-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; FDD           0.471433   0.135195  3.4871 0.0005242 ***</span></span>
<span id="cb417-10"><a href="#cb417-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; L(FDD, 1:6)1  0.145021   0.081557  1.7782 0.0758853 .  </span></span>
<span id="cb417-11"><a href="#cb417-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; L(FDD, 1:6)2  0.058364   0.058911  0.9907 0.3222318    </span></span>
<span id="cb417-12"><a href="#cb417-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; L(FDD, 1:6)3  0.074166   0.047143  1.5732 0.1162007    </span></span>
<span id="cb417-13"><a href="#cb417-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; L(FDD, 1:6)4  0.036304   0.029335  1.2376 0.2163670    </span></span>
<span id="cb417-14"><a href="#cb417-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; L(FDD, 1:6)5  0.048756   0.031370  1.5543 0.1206535    </span></span>
<span id="cb417-15"><a href="#cb417-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; L(FDD, 1:6)6  0.050246   0.045129  1.1134 0.2659919    </span></span>
<span id="cb417-16"><a href="#cb417-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb417-17"><a href="#cb417-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>As the result we obtain</p>
<p><span class="math display">\[\begin{align}
  \begin{split}
  \widehat{\%ChgOJC_t} =&amp; -\underset{(0.21)}{0.69} + \underset{(0.14)}{0.47} FDD_t + \underset{(0.08)}{0.15} FDD_{t-1} + \underset{(0.06)}{0.06} FDD_{t-2} + \underset{(0.05)}{0.07} FDD_{t-3} \\ &amp;+ \underset{(0.03)}{0.04} FDD_{t-4} + \underset{(0.03)}{0.05} FDD_{t-5} + \underset{(0.05)}{0.05} FDD_{t-6},
  \end{split}
  (\#eq:orangemod1)
\end{align}\]</span></p>
<p>where the coefficient on <span class="math inline">\(FDD_{t-1}\)</span> estimates the price increase in period <span class="math inline">\(t\)</span> caused by an additional freezing degree day in the preceding month, the coefficient on <span class="math inline">\(FDD_{t-2}\)</span> estimates the effect of an additional freezing degree day two month ago and so on. Consequently, the coefficients in @ref(eq:orangemod1) can be interpreted as price changes in current and future periods due to a unit increase in the current month’ freezing degree days.</p>
</div>
<div id="dynamic-causal-effects" class="section level2 hasAnchor" number="15.2">
<h2 class="hasAnchor"><span class="header-section-number">15.2</span> Dynamic Causal Effects<a href="#dynamic-causal-effects" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section of the book describes the general idea of a dynamic causal effect and how the concept of a randomized controlled experiment can be translated to time series applications, using several examples.</p>
<p>In general, for empirical attempts to measure a dynamic causal effect, the assumptions of stationarity (see Key Concept 14.5) and exogeneity must hold. In time series applications up until here we have assumed that the model error term has conditional mean zero given current and past values of the regressors. For estimation of a dynamic causal effect using a distributed lag model, assuming a stronger form termed <em>strict exogeneity</em> may be useful. Strict exogeneity states that the error term has mean zero conditional on past, present <em>and future</em> values of the independent variables.</p>
<p>The two concepts of exogeneity and the distributed lag model are summarized in Key Concept 15.1.</p>
<div id="KC15.1" class="keyconcept">
<h3 class="right">
Key Concept 15.1
</h3>
<h3 class="left">
The Distributed Lag Model and Exogeneity
</h3>
<p>
<p>The general distributed lag model is
<span class="math display">\[\begin{align}
  Y_t = \beta_0 + \beta_1 X_t + \beta_2 X_{t-1} + \beta_3 X_{t-2} + \dots + \beta_{r+1} X_{t-r} + u_t, (\#eq:dlm)
\end{align}\]</span>
where it is assumed that</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(X\)</span> is an exogenous variable, <span class="math display">\[E(u_t\vert X_t, X_{t-1}, X_{t-2},\dots) = 0.\]</span></p></li>
<li><ul>
<li>a <span class="math inline">\(X_t,Y_t\)</span> have a stationary distribution.</li>
<li>b <span class="math inline">\((Y_t,X_t)\)</span> and <span class="math inline">\((Y_{t-j},X_{t-j})\)</span> become independently distributed as <span class="math inline">\(j\)</span> gets large.</li>
</ul></li>
<li><p>Large outliers are unlikely. In particular, we need that all the variables have more than eight nonzero and finite moments — a stronger assumption than before (four finite nonzero moments) that is required for computation of the HAC covariance matrix estimator.</p></li>
<li><p>There is no perfect multicollinearity.</p></li>
</ol>
<p>The distributed lag model may be extended to include contemporaneous and past values of additional regressors.</p>
<p><strong>On the assumption of exogeneity</strong></p>
<ul>
<li><p>There is another form of exogeneity termed <em>strict exogeneity</em> which assumes <span class="math display">\[E(u_t\vert \dots, X_{t+2},X_{t+1},X_t,X_{t-1},X_{t-2},\dots)=0,\]</span> that is the error term has mean zero conditional on past, present and future values of <span class="math inline">\(X\)</span>. Strict exogeneity implies exogeneity (as defined in 1. above) but not the other way around. From this point on we will therefore distinguish between exogeneity and strict exogeneity.</p></li>
<li><p>Exogeneity as in 1. suffices for the OLS estimators of the coefficient in distributed lag models to be consistent. However, if the the assumption of strict exogeneity is valid, more efficient estimators can be applied.</p></li>
</ul>
</p>
</div>
</div>
<div id="dynamic-multipliers-and-cumulative-dynamic-multipliers" class="section level2 hasAnchor" number="15.3">
<h2 class="hasAnchor"><span class="header-section-number">15.3</span> Dynamic Multipliers and Cumulative Dynamic Multipliers<a href="#dynamic-multipliers-and-cumulative-dynamic-multipliers" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following terminology regarding the coefficients in the distributed lag model @ref(eq:dlm) is useful for upcoming applications:</p>
<ul>
<li><p>The dynamic causal effect is also called the <em>dynamic multiplier</em>. <span class="math inline">\(\beta_{h+1}\)</span> in @ref(eq:dlm) is the <span class="math inline">\(h\)</span>-period dynamic multiplier.</p></li>
<li><p>The contemporaneous effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span>, <span class="math inline">\(\beta_1\)</span>, is termed the <em>impact effect</em>.</p></li>
<li><p>The <span class="math inline">\(h\)</span>-period <em>cumulative dynamic multiplier</em> of a unit change in <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is defined as the cumulative sum of the dynamic multipliers. In particular, <span class="math inline">\(\beta_1\)</span> is the zero-period cumulative dynamic multiplier, <span class="math inline">\(\beta_1 + \beta_2\)</span> is the one-period cumulative dynamic multiplier and so forth.</p>
<p>The cumulative dynamic multipliers of the distributed lag model @ref(eq:dlm) are the coefficients <span class="math inline">\(\delta_1,\delta_2,\dots,\delta_r,\delta_{r+1}\)</span> in the modified regression
<span class="math display">\[\begin{align}
Y_t =&amp; \, \delta_0 + \delta_1 \Delta X_t + \delta_2 \Delta X_{t-1} + \dots + \delta_r \Delta X_{t-r+1} + \delta_{r+1} X_{t-r} + u_t (\#eq:DCMreg)
\end{align}\]</span> and thus can be directly estimated using OLS which makes it convenient to compute their HAC standard errors. <span class="math inline">\(\delta_{r+1}\)</span> is called the <em>long-run cumulative dynamic multiplier</em>.</p></li>
</ul>
<p>It is straightforward to compute the cumulative dynamic multipliers for @ref(eq:orangemod1), the estimated distributed lag regression of changes in orange juice concentrate prices on freezing degree days, using the corresponding model object <tt>orange_DLM</tt> and the function <tt>cumsum()</tt>.</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute cumulative multipliers</span></span>
<span id="cb418-2"><a href="#cb418-2" aria-hidden="true" tabindex="-1"></a>cum_mult <span class="ot">&lt;-</span><span class="fu">cumsum</span>(orange_DLM<span class="sc">$</span>coefficients[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb418-3"><a href="#cb418-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb418-4"><a href="#cb418-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rename entries</span></span>
<span id="cb418-5"><a href="#cb418-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cum_mult) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">sep =</span> <span class="st">&quot;-&quot;</span>, <span class="st">&quot;period CDM&quot;</span>)</span>
<span id="cb418-6"><a href="#cb418-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb418-7"><a href="#cb418-7" aria-hidden="true" tabindex="-1"></a>cum_mult</span>
<span id="cb418-8"><a href="#cb418-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0-period CDM 1-period CDM 2-period CDM 3-period CDM 4-period CDM 5-period CDM </span></span>
<span id="cb418-9"><a href="#cb418-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    0.4714329    0.6164542    0.6748177    0.7489835    0.7852874    0.8340436 </span></span>
<span id="cb418-10"><a href="#cb418-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6-period CDM </span></span>
<span id="cb418-11"><a href="#cb418-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    0.8842895</span></span></code></pre></div>
<p>Translating the distributed lag model with six lags of <span class="math inline">\(FDD\)</span> to @ref(eq:DCMreg), we see that the OLS coefficient estimates in this model coincide with the multipliers stored in <tt>cum_mult</tt>.</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate cumulative dynamic multipliers using the modified regression</span></span>
<span id="cb419-2"><a href="#cb419-2" aria-hidden="true" tabindex="-1"></a>cum_mult_reg <span class="ot">&lt;-</span><span class="fu">dynlm</span>(FOJC_pctc <span class="sc">~</span> <span class="fu">d</span>(FDD) <span class="sc">+</span> <span class="fu">d</span>(<span class="fu">L</span>(FDD,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)) <span class="sc">+</span> <span class="fu">L</span>(FDD,<span class="dv">6</span>))</span>
<span id="cb419-3"><a href="#cb419-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(cum_mult_reg)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb419-4"><a href="#cb419-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          d(FDD) d(L(FDD, 1:5))1 d(L(FDD, 1:5))2 d(L(FDD, 1:5))3 d(L(FDD, 1:5))4 </span></span>
<span id="cb419-5"><a href="#cb419-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       0.4714329       0.6164542       0.6748177       0.7489835       0.7852874 </span></span>
<span id="cb419-6"><a href="#cb419-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; d(L(FDD, 1:5))5       L(FDD, 6) </span></span>
<span id="cb419-7"><a href="#cb419-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       0.8340436       0.8842895</span></span></code></pre></div>
<p>As noted above, using a model specification as in @ref(eq:DCMreg) allows to easily obtain standard errors for the estimated dynamic cumulative multipliers.</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain coefficient summary that reports HAC standard errors</span></span>
<span id="cb420-2"><a href="#cb420-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cum_mult_reg, <span class="at">vcov. =</span> vcovHAC)</span>
<span id="cb420-3"><a href="#cb420-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb420-4"><a href="#cb420-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb420-5"><a href="#cb420-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb420-6"><a href="#cb420-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb420-7"><a href="#cb420-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)     -0.69296    0.23668 -2.9278 0.0035431 ** </span></span>
<span id="cb420-8"><a href="#cb420-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; d(FDD)           0.47143    0.13583  3.4709 0.0005562 ***</span></span>
<span id="cb420-9"><a href="#cb420-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; d(L(FDD, 1:5))1  0.61645    0.13145  4.6896 3.395e-06 ***</span></span>
<span id="cb420-10"><a href="#cb420-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; d(L(FDD, 1:5))2  0.67482    0.16009  4.2151 2.882e-05 ***</span></span>
<span id="cb420-11"><a href="#cb420-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; d(L(FDD, 1:5))3  0.74898    0.17263  4.3387 1.682e-05 ***</span></span>
<span id="cb420-12"><a href="#cb420-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; d(L(FDD, 1:5))4  0.78529    0.17351  4.5260 7.255e-06 ***</span></span>
<span id="cb420-13"><a href="#cb420-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; d(L(FDD, 1:5))5  0.83404    0.18236  4.5737 5.827e-06 ***</span></span>
<span id="cb420-14"><a href="#cb420-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; L(FDD, 6)        0.88429    0.19303  4.5810 5.634e-06 ***</span></span>
<span id="cb420-15"><a href="#cb420-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb420-16"><a href="#cb420-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
</div>
<div id="hac-standard-errors" class="section level2 hasAnchor" number="15.4">
<h2 class="hasAnchor"><span class="header-section-number">15.4</span> HAC Standard Errors<a href="#hac-standard-errors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The error term <span class="math inline">\(u_t\)</span> in the distributed lag model @ref(eq:dlm) may be serially correlated due to serially correlated determinants of <span class="math inline">\(Y_t\)</span> that are not included as regressors. When these factors are not correlated with the regressors included in the model, serially correlated errors do not violate the assumption of exogeneity such that the OLS estimator remains unbiased and consistent.</p>
<p>However, autocorrelated standard errors render the usual homoskedasticity-only <em>and</em> heteroskedasticity-robust standard errors invalid and may cause misleading inference. HAC errors are a remedy.</p>
<div id="KC15.2" class="keyconcept">
<h3 class="right">
Key Concept 15.2
</h3>
<h3 class="left">
HAC Standard errors
</h3>
<p>
<p><strong>Problem</strong>:</p>
<p>If the error term <span class="math inline">\(u_t\)</span> in the distributed lag model @ref(eq:dlm) is serially correlated, statistical inference that rests on usual (heteroskedasticity-robust) standard errors can be strongly misleading.</p>
<p><strong>Solution</strong>:</p>
<p>Heteroskedasticity- and autocorrelation-consistent (HAC) estimators of the variance-covariance matrix circumvent this issue. There are <tt>R</tt> functions like <tt>vcovHAC()</tt> from the package <tt>sandwich</tt> which are convenient for computation of such estimators.</p>
The package <tt>sandwich</tt> also contains the function <tt>NeweyWest()</tt>, an implementation of the HAC variance-covariance estimator proposed by <span class="citation">Newey and West (<a href="#ref-newey1987" role="doc-biblioref">1987</a>)</span>.
</p>
</div>
<p>Consider the distributed lag regression model with no lags and a single regressor <span class="math inline">\(X_t\)</span>
<span class="math display">\[\begin{align*}
  Y_t = \beta_0 + \beta_1 X_t + u_t.
\end{align*}\]</span>
with autocorrelated errors. A brief derivation of
<span class="math display">\[\begin{align}
  \overset{\sim}{\sigma}^2_{\widehat{\beta}_1} = \widehat{\sigma}^2_{\widehat{\beta}_1} \widehat{f}_t (\#eq:nwhac)
\end{align}\]</span>
the so-called <em>Newey-West variance estimator</em> for the variance of the OLS estimator of <span class="math inline">\(\beta_1\)</span> is presented in Chapter 15.4 of the book. <span class="math inline">\(\widehat{\sigma}^2_{\widehat{\beta}_1}\)</span> in @ref(eq:nwhac) is the heteroskedasticity-robust variance estimate of <span class="math inline">\(\widehat{\beta}_1\)</span> and
<span class="math display">\[\begin{align}
  \widehat{f}_t = 1 + 2 \sum_{j=1}^{m-1} \left(\frac{m-j}{m}\right) \overset{\sim}{\rho}_j (\#eq:nwhacf)
\end{align}\]</span>
is a correction factor that adjusts for serially correlated errors and involves estimates of <span class="math inline">\(m-1\)</span> autocorrelation coefficients <span class="math inline">\(\overset{\sim}{\rho}_j\)</span>. As it turns out, using the sample autocorrelation as implemented in <tt>acf()</tt> to estimate the autocorrelation coefficients renders @ref(eq:nwhac) inconsistent, see pp. 650-651 of the book for a detailed argument. Therefore, we use a somewhat different estimator. For a time series <span class="math inline">\(X\)</span> we have <span class="math display">\[ \ \overset{\sim}{\rho}_j = \frac{\sum_{t=j+1}^T \hat v_t \hat v_{t-j}}{\sum_{t=1}^T \hat v_t^2}, \ \text{with} \ \hat v= (X_t-\overline{X}) \hat u_t. \]</span> We implement this estimator in the function <tt>acf_c()</tt> below.</p>
<p><span class="math inline">\(m\)</span> in @ref(eq:nwhacf) is a truncation parameter to be chosen. A rule of thumb for choosing <span class="math inline">\(m\)</span> is
<span class="math display">\[\begin{align}
  m = \left \lceil{0.75 \cdot T^{1/3}}\right\rceil. (\#eq:hactruncrot)
\end{align}\]</span></p>
<p>We simulate a time series that, as stated above, follows a distributed lag model with autocorrelated errors and then show how to compute the Newey-West HAC estimate of <span class="math inline">\(SE(\widehat{\beta}_1)\)</span> using <tt>R</tt>. This is done via two separate but, as we will see, identical approaches: at first we follow the derivation presented in the book step-by-step and compute the estimate “manually”. We then show that the result is exactly the estimate obtained when using the function <tt>NeweyWest()</tt>.</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function that computes rho tilde</span></span>
<span id="cb421-2"><a href="#cb421-2" aria-hidden="true" tabindex="-1"></a>acf_c <span class="ot">&lt;-</span> <span class="cf">function</span>(x, j) {</span>
<span id="cb421-3"><a href="#cb421-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(</span>
<span id="cb421-4"><a href="#cb421-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>(x[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>j)]) <span class="sc">%*%</span> <span class="fu">na.omit</span>(<span class="fu">Lag</span>(x, j)) <span class="sc">/</span> <span class="fu">t</span>(x) <span class="sc">%*%</span> x</span>
<span id="cb421-5"><a href="#cb421-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb421-6"><a href="#cb421-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb421-7"><a href="#cb421-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb421-8"><a href="#cb421-8" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate time series with serially correlated errors</span></span>
<span id="cb421-9"><a href="#cb421-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb421-10"><a href="#cb421-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb421-11"><a href="#cb421-11" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb421-12"><a href="#cb421-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb421-13"><a href="#cb421-13" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fu">arima.sim</span>(<span class="at">n =</span> N, <span class="at">model =</span> <span class="fu">list</span>(<span class="at">ma =</span> <span class="fl">0.5</span>))</span>
<span id="cb421-14"><a href="#cb421-14" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb421-15"><a href="#cb421-15" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> X <span class="sc">+</span> eps</span>
<span id="cb421-16"><a href="#cb421-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb421-17"><a href="#cb421-17" aria-hidden="true" tabindex="-1"></a><span class="co"># compute OLS residuals</span></span>
<span id="cb421-18"><a href="#cb421-18" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X)<span class="sc">$</span>res</span>
<span id="cb421-19"><a href="#cb421-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb421-20"><a href="#cb421-20" aria-hidden="true" tabindex="-1"></a><span class="co"># compute v</span></span>
<span id="cb421-21"><a href="#cb421-21" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> (X <span class="sc">-</span> <span class="fu">mean</span>(X)) <span class="sc">*</span> res</span>
<span id="cb421-22"><a href="#cb421-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb421-23"><a href="#cb421-23" aria-hidden="true" tabindex="-1"></a><span class="co"># compute robust estimate of beta_1 variance</span></span>
<span id="cb421-24"><a href="#cb421-24" aria-hidden="true" tabindex="-1"></a>var_beta_hat <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>N <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>(N<span class="dv">-2</span>) <span class="sc">*</span> <span class="fu">sum</span>((X <span class="sc">-</span> <span class="fu">mean</span>(X))<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> res<span class="sc">^</span><span class="dv">2</span>) ) <span class="sc">/</span> </span>
<span id="cb421-25"><a href="#cb421-25" aria-hidden="true" tabindex="-1"></a>                        (<span class="dv">1</span><span class="sc">/</span>N <span class="sc">*</span> <span class="fu">sum</span>((X <span class="sc">-</span> <span class="fu">mean</span>(X))<span class="sc">^</span><span class="dv">2</span>))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb421-26"><a href="#cb421-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb421-27"><a href="#cb421-27" aria-hidden="true" tabindex="-1"></a><span class="co"># rule of thumb truncation parameter</span></span>
<span id="cb421-28"><a href="#cb421-28" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fl">0.75</span> <span class="sc">*</span> N<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>))</span>
<span id="cb421-29"><a href="#cb421-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb421-30"><a href="#cb421-30" aria-hidden="true" tabindex="-1"></a><span class="co"># compute correction factor</span></span>
<span id="cb421-31"><a href="#cb421-31" aria-hidden="true" tabindex="-1"></a>f_hat_T <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(</span>
<span id="cb421-32"><a href="#cb421-32" aria-hidden="true" tabindex="-1"></a>  (m <span class="sc">-</span> <span class="dv">1</span><span class="sc">:</span>(m<span class="dv">-1</span>))<span class="sc">/</span>m <span class="sc">*</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>(m <span class="sc">-</span> <span class="dv">1</span>), <span class="cf">function</span>(i) <span class="fu">acf_c</span>(<span class="at">x =</span> v, <span class="at">j =</span> i))</span>
<span id="cb421-33"><a href="#cb421-33" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb421-34"><a href="#cb421-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb421-35"><a href="#cb421-35" aria-hidden="true" tabindex="-1"></a><span class="co"># compute Newey-West HAC estimate of the standard error </span></span>
<span id="cb421-36"><a href="#cb421-36" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(var_beta_hat <span class="sc">*</span> f_hat_T)</span>
<span id="cb421-37"><a href="#cb421-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.04036208</span></span></code></pre></div>
<p>For the code to be reusable in other applications, we use <tt>sapply()</tt> to estimate the <span class="math inline">\(m-1\)</span> autocorrelations <span class="math inline">\(\overset{\sim}{\rho}_j\)</span>.</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using NeweyWest():</span></span>
<span id="cb422-2"><a href="#cb422-2" aria-hidden="true" tabindex="-1"></a>NW_VCOV <span class="ot">&lt;-</span> <span class="fu">NeweyWest</span>(<span class="fu">lm</span>(Y <span class="sc">~</span> X), </span>
<span id="cb422-3"><a href="#cb422-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">lag =</span> m <span class="sc">-</span> <span class="dv">1</span>, <span class="at">prewhite =</span> F, </span>
<span id="cb422-4"><a href="#cb422-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">adjust =</span> T)</span>
<span id="cb422-5"><a href="#cb422-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-6"><a href="#cb422-6" aria-hidden="true" tabindex="-1"></a><span class="co"># compute standard error</span></span>
<span id="cb422-7"><a href="#cb422-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">diag</span>(NW_VCOV))[<span class="dv">2</span>]</span>
<span id="cb422-8"><a href="#cb422-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          X </span></span>
<span id="cb422-9"><a href="#cb422-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.04036208</span></span></code></pre></div>
<p>By choosing <tt>lag = m-1</tt> we ensure that the maximum order of autocorrelations used is <span class="math inline">\(m-1\)</span> — just as in equation @ref(eq:nwhacf). Notice that we set the arguments <tt>prewhite = F</tt> and <tt>adjust = T</tt> to ensure that the formula @ref(eq:nwhac) is used and finite sample adjustments are made.</p>
<p>We find that the computed standard errors coincide. Of course, a variance-covariance matrix estimate as computed by <tt>NeweyWest()</tt> can be supplied as the argument <tt>vcov</tt> in <tt>coeftest()</tt> such that HAC <span class="math inline">\(t\)</span>-statistics and <span class="math inline">\(p\)</span>-values are provided by the latter.</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a>example_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X)</span>
<span id="cb423-2"><a href="#cb423-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(example_mod, <span class="at">vcov =</span> NW_VCOV)</span>
<span id="cb423-3"><a href="#cb423-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb423-4"><a href="#cb423-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb423-5"><a href="#cb423-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb423-6"><a href="#cb423-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb423-7"><a href="#cb423-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 0.542310   0.235423  2.3036  0.02336 *  </span></span>
<span id="cb423-8"><a href="#cb423-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X           0.423305   0.040362 10.4877  &lt; 2e-16 ***</span></span>
<span id="cb423-9"><a href="#cb423-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb423-10"><a href="#cb423-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
</div>
<div id="estimation-of-dynamic-causal-effects-with-strictly-exogeneous-regressors" class="section level2 hasAnchor" number="15.5">
<h2 class="hasAnchor"><span class="header-section-number">15.5</span> Estimation of Dynamic Causal Effects with Strictly Exogeneous Regressors<a href="#estimation-of-dynamic-causal-effects-with-strictly-exogeneous-regressors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In general, the errors in a distributed lag model are correlated which necessitates usage of HAC standard errors for valid inference. If, however, the assumption of exogeneity (the first assumption stated in Key Concept 15.1) is replaced by strict exogeneity, that is <span class="math display">\[E(u_t\vert \dots, X_{t+1}, X_{t}, X_{t-1}, \dots) = 0,\]</span> more efficient approaches than OLS estimation of the coefficients are available. For a general distributed lag model with <span class="math inline">\(r\)</span> lags and AR(<span class="math inline">\(p\)</span>) errors, these approaches are summarized in Key Concept 15.4.</p>
<div id="KC15.4" class="keyconcept">
<h3 class="right">
Key Concept 15.4
</h3>
<h3 class="left">
Estimation of Dynamic Multipliers Under Strict Exogeneity
</h3>
<p>
<p>Consider the general distributed lag model with <span class="math inline">\(r\)</span> lags and errors following an AR(<span class="math inline">\(p\)</span>) process,
<span class="math display">\[\begin{align}
  Y_t =&amp; \, \beta_0 + \beta_1 X_t + \beta_2 X_{t-1} + \dots + \beta_{r+1} X_{t-r} + u_t (\#eq:dlmar) \\
  u_t =&amp; \, \phi_1 u_{t-1} + \phi u_{t-2} + \dots + \phi_p u_{t-p} + \overset{\sim}{u}_t. (\#eq:dlmarerrors)
\end{align}\]</span>
Under strict exogeneity of <span class="math inline">\(X_t\)</span>, one may rewrite the above model in the ADL specification
<span class="math display">\[\begin{align*}
  Y_t =&amp; \, \alpha_0 + \phi_1 Y_{t-1} + \phi_2 Y_{t-2} + \dots + \phi_p Y_{t-p} \\
      &amp;+ \, \delta_0 X_t + \delta_1 X_{t-1} + \dots + \delta_q X_{t-q} + \overset{\sim}{u}_t
\end{align*}\]</span>
where <span class="math inline">\(q=r+p\)</span> and compute estimates of the dynamic multipliers <span class="math inline">\(\beta_1, \beta_2, \dots, \beta_{r+1}\)</span> using OLS estimates of <span class="math inline">\(\phi_1, \phi_2, \dots, \phi_p, \delta_0, \delta_1, \dots, \delta_q\)</span>.</p>
<p>An alternative is to estimate the dynamic multipliers using feasible GLS, that is to apply the OLS estimator to a quasi-difference specification of @ref(eq:dlmar). Under strict exogeneity, the feasible GLS approach is the BLUE estimator for the dynamic multipliers in large samples.</p>
On the one hand, as demonstrated in Chapter 15.5 of the book, OLS estimation of the ADL representation can be beneficial for estimation of the dynamic multipliers in large distributed lag models because it allows for a more parsimonious model that may be a good approximation to the large model. On the other hand, the GLS approach is more efficient than the ADL estimator if the sample size is large.
</p>
</div>
<p>We shortly review how the different representations of a small distributed lag model can be obtained and show how this specification can be estimated by OLS and GLS using <tt>R</tt>.</p>
<p>The model is
<span class="math display">\[\begin{align}
  Y_t = \beta_0 + \beta_1 X_t + \beta_2 X_{t-1} + u_t, (\#eq:dldynamic)
\end{align}\]</span>
so a change in <span class="math inline">\(X\)</span> is modeled to effect <span class="math inline">\(Y\)</span> contemporaneously (<span class="math inline">\(\beta_1\)</span>) and in the next period (<span class="math inline">\(\beta_2\)</span>). The error term <span class="math inline">\(u_t\)</span> is assumed to follow an AR(<span class="math inline">\(1\)</span>) process,<span class="math display">\[u_t = \phi_1 u_{t-1} + \overset{\sim}{u_t},\]</span> where <span class="math inline">\(\overset{\sim}{u_t}\)</span> is serially uncorrelated.</p>
<p>One can show that the ADL representation of this model is
<span class="math display">\[\begin{align}
  Y_t = \alpha_0 + \phi_1 Y_{t-1} + \delta_0 X_t + \delta_1 X_{t-1} + \delta_2 X_{t-2} + \overset{\sim}{u}_t, (\#eq:adl21dynamic)
\end{align}\]</span>
with the restrictions
<span class="math display">\[\begin{align*}
  \beta_1 =&amp; \, \delta_0, \\
  \beta_2 =&amp; \, \delta_1 + \phi_1 \delta_0,
\end{align*}\]</span>
see p. 657 of the book.</p>
<div id="quasi-differences" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Quasi-Differences<a href="#quasi-differences" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Another way of writing the ADL(<span class="math inline">\(1\)</span>,<span class="math inline">\(2\)</span>) representation @ref(eq:adl21dynamic) is the <em>quasi-difference model</em>
<span class="math display">\[\begin{align}
  \overset{\sim}{Y}_t = \alpha_0 + \beta_1 \overset{\sim}{X}_t + \beta_2   \overset{\sim}{X}_{t-1} + \overset{\sim}{u}_t, (\#eq:qdm)
\end{align}\]</span>
where <span class="math inline">\(\overset{\sim}{Y}_t = Y_t - \phi_1 Y_{t-1}\)</span> and <span class="math inline">\(\overset{\sim}{X}_t = X_t - \phi_1 X_{t-1}\)</span>. Notice that the error term <span class="math inline">\(\overset{\sim}{u}_t\)</span> is uncorrelated in both models and, as shown in Chapter 15.5 of the book, <span class="math display">\[E(u_t\vert X_{t+1}, X_t, X_{t-1}, \dots) = 0,\]</span> which is implied by the assumption of strict exogeneity.</p>
<p>We continue by simulating a time series of <span class="math inline">\(500\)</span> observations using the model @ref(eq:dldynamic) with <span class="math inline">\(\beta_1 = 0.1\)</span>, <span class="math inline">\(\beta_2 = 0.25\)</span>, <span class="math inline">\(\phi = 0.5\)</span> and <span class="math inline">\(\overset{\sim}{u}_t \sim \mathcal{N}(0,1)\)</span> and estimate the different representations, starting with the distributed lag model @ref(eq:dldynamic).</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for reproducibility</span></span>
<span id="cb424-2"><a href="#cb424-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb424-3"><a href="#cb424-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb424-4"><a href="#cb424-4" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate a time series with serially correlated errors</span></span>
<span id="cb424-5"><a href="#cb424-5" aria-hidden="true" tabindex="-1"></a>obs <span class="ot">&lt;-</span> <span class="dv">501</span></span>
<span id="cb424-6"><a href="#cb424-6" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fu">arima.sim</span>(<span class="at">n =</span> obs<span class="dv">-1</span> , <span class="at">model =</span> <span class="fu">list</span>(<span class="at">ar =</span> <span class="fl">0.5</span>))</span>
<span id="cb424-7"><a href="#cb424-7" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">arima.sim</span>(<span class="at">n =</span> obs, <span class="at">model =</span> <span class="fu">list</span>(<span class="at">ar =</span> <span class="fl">0.25</span>))</span>
<span id="cb424-8"><a href="#cb424-8" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="sc">*</span> X[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">+</span> <span class="fl">0.25</span> <span class="sc">*</span> X[<span class="sc">-</span>obs] <span class="sc">+</span> eps</span>
<span id="cb424-9"><a href="#cb424-9" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">ts</span>(X[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb424-10"><a href="#cb424-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb424-11"><a href="#cb424-11" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the distributed lag model</span></span>
<span id="cb424-12"><a href="#cb424-12" aria-hidden="true" tabindex="-1"></a>dlm <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(Y <span class="sc">~</span> X <span class="sc">+</span> <span class="fu">L</span>(X))</span></code></pre></div>
<p>Let us check that the residuals of this model exhibit autocorrelation using <tt>acf()</tt>.</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check that the residuals are serially correlated</span></span>
<span id="cb425-2"><a href="#cb425-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">residuals</span>(dlm))</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-688-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>In particular, the pattern reveals that the residuals follow an autoregressive process, as the sample autocorrelation function decays quickly for the first few lags and is probably zero for higher lag orders. In any case, HAC standard errors should be used.</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="co"># coefficient summary using the Newey-West SE estimates</span></span>
<span id="cb426-2"><a href="#cb426-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(dlm, <span class="at">vcov =</span> NeweyWest, <span class="at">prewhite =</span> F, <span class="at">adjust =</span> T)</span>
<span id="cb426-3"><a href="#cb426-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb426-4"><a href="#cb426-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb426-5"><a href="#cb426-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb426-6"><a href="#cb426-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb426-7"><a href="#cb426-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 0.038340   0.073411  0.5223  0.601717    </span></span>
<span id="cb426-8"><a href="#cb426-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X           0.123661   0.046710  2.6474  0.008368 ** </span></span>
<span id="cb426-9"><a href="#cb426-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; L(X)        0.247406   0.046377  5.3347 1.458e-07 ***</span></span>
<span id="cb426-10"><a href="#cb426-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb426-11"><a href="#cb426-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
</div>
<div id="ols-estimation-of-the-adl-model" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">OLS Estimation of the ADL Model<a href="#ols-estimation-of-the-adl-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Next, we estimate the ADL(<span class="math inline">\(1\)</span>,<span class="math inline">\(2\)</span>) model @ref(eq:adl21dynamic) using OLS. The errors are uncorrelated in this representation of the model. This statement is supported by a plot of the sample autocorrelation function of the residual series.</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the ADL(2,1) representation of the distributed lag model</span></span>
<span id="cb427-2"><a href="#cb427-2" aria-hidden="true" tabindex="-1"></a>adl21_dynamic <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(Y <span class="sc">~</span> <span class="fu">L</span>(Y) <span class="sc">+</span> X <span class="sc">+</span> <span class="fu">L</span>(X, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>))</span>
<span id="cb427-3"><a href="#cb427-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-4"><a href="#cb427-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the sample autocorrelaltions of residuals</span></span>
<span id="cb427-5"><a href="#cb427-5" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(adl21_dynamic<span class="sc">$</span>residuals)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-690-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The estimated coefficients of <code>adl21_dynamic$coefficients</code> are <em>not</em> the dynamic multipliers we are interested in, but instead can be computed according to the restrictions in @ref(eq:adl21dynamic), where the true coefficients are replaced by the OLS estimates.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute estimated dynamic effects using coefficient restrictions</span></span>
<span id="cb428-2"><a href="#cb428-2" aria-hidden="true" tabindex="-1"></a><span class="co"># in the ADL(2,1) representation</span></span>
<span id="cb428-3"><a href="#cb428-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> adl21_dynamic<span class="sc">$</span>coefficients</span>
<span id="cb428-4"><a href="#cb428-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb428-5"><a href="#cb428-5" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;hat_beta_1&quot;</span> <span class="ot">=</span> t[<span class="dv">3</span>],</span>
<span id="cb428-6"><a href="#cb428-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;hat_beta_2&quot;</span> <span class="ot">=</span> t[<span class="dv">4</span>] <span class="sc">+</span> t[<span class="dv">3</span>] <span class="sc">*</span> t[<span class="dv">2</span>])</span>
<span id="cb428-7"><a href="#cb428-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          hat_beta_1.X hat_beta_2.L(X, 1:2)1 </span></span>
<span id="cb428-8"><a href="#cb428-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             0.1176425             0.2478484</span></span></code></pre></div>
</div>
<div id="gls-estimation" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">GLS Estimation<a href="#gls-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Strict exogeneity allows for OLS estimation of the quasi-difference model @ref(eq:qdm). The idea of applying the OLS estimator to a model where the variables are linearly transformed, such that the model errors are uncorrelated and homoskedastic, is called <em>generalized least squares</em> (GLS).</p>
<p>The OLS estimator in @ref(eq:qdm) is called the <em>infeasible GLS</em> estimator because <span class="math inline">\(\overset{\sim}{Y}\)</span> and <span class="math inline">\(\overset{\sim}{X}\)</span> cannot be computed without knowing <span class="math inline">\(\phi_1\)</span>, the autoregressive coefficient in the error AR(<span class="math inline">\(1\)</span>) model, which is generally unknown in practice.</p>
<p>Assume we knew that <span class="math inline">\(\phi = 0.5\)</span>. We then may obtain the infeasible GLS estimates of the dynamic multipliers in @ref(eq:dldynamic) by applying OLS to the transformed data.</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="#cb429-1" aria-hidden="true" tabindex="-1"></a><span class="co"># GLS: estimate quasi-differenced specification by OLS</span></span>
<span id="cb429-2"><a href="#cb429-2" aria-hidden="true" tabindex="-1"></a>iGLS_dynamic <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(<span class="fu">I</span>(Y<span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">L</span>(Y)) <span class="sc">~</span> <span class="fu">I</span>(X <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">L</span>(X)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">L</span>(X) <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">L</span>(X, <span class="dv">2</span>)))</span>
<span id="cb429-3"><a href="#cb429-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-4"><a href="#cb429-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iGLS_dynamic)</span>
<span id="cb429-5"><a href="#cb429-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb429-6"><a href="#cb429-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time series regression with &quot;ts&quot; data:</span></span>
<span id="cb429-7"><a href="#cb429-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Start = 3, End = 500</span></span>
<span id="cb429-8"><a href="#cb429-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb429-9"><a href="#cb429-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb429-10"><a href="#cb429-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dynlm(formula = I(Y - 0.5 * L(Y)) ~ I(X - 0.5 * L(X)) + I(L(X) - </span></span>
<span id="cb429-11"><a href="#cb429-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     0.5 * L(X, 2)))</span></span>
<span id="cb429-12"><a href="#cb429-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb429-13"><a href="#cb429-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb429-14"><a href="#cb429-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb429-15"><a href="#cb429-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -3.0325 -0.6375 -0.0499  0.6658  3.7724 </span></span>
<span id="cb429-16"><a href="#cb429-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb429-17"><a href="#cb429-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb429-18"><a href="#cb429-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                         Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb429-19"><a href="#cb429-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)              0.01620    0.04564   0.355  0.72273    </span></span>
<span id="cb429-20"><a href="#cb429-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I(X - 0.5 * L(X))        0.12000    0.04237   2.832  0.00481 ** </span></span>
<span id="cb429-21"><a href="#cb429-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I(L(X) - 0.5 * L(X, 2))  0.25266    0.04237   5.963 4.72e-09 ***</span></span>
<span id="cb429-22"><a href="#cb429-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb429-23"><a href="#cb429-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb429-24"><a href="#cb429-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb429-25"><a href="#cb429-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 1.017 on 495 degrees of freedom</span></span>
<span id="cb429-26"><a href="#cb429-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.07035,    Adjusted R-squared:  0.0666 </span></span>
<span id="cb429-27"><a href="#cb429-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 18.73 on 2 and 495 DF,  p-value: 1.442e-08</span></span></code></pre></div>
<p>The <em>feasible GLS</em> estimator uses preliminary estimation of the coefficients in the presumed error term model, computes the quasi-differenced data and then estimates the model using OLS. This idea was introduced by <span class="citation">Cochrane and Orcutt (<a href="#ref-cochrane1949" role="doc-biblioref">1949</a>)</span> and can be extended by continuing this process iteratively. Such a procedure is implemented in the function <tt>cochrane.orcutt()</tt> from the package <tt>orcutt</tt>.</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a>X_t <span class="ot">&lt;-</span> <span class="fu">c</span>(X[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb430-2"><a href="#cb430-2" aria-hidden="true" tabindex="-1"></a><span class="co"># create first lag</span></span>
<span id="cb430-3"><a href="#cb430-3" aria-hidden="true" tabindex="-1"></a>X_l1 <span class="ot">&lt;-</span> <span class="fu">c</span>(X[<span class="sc">-</span><span class="dv">500</span>])</span>
<span id="cb430-4"><a href="#cb430-4" aria-hidden="true" tabindex="-1"></a>Y_t <span class="ot">&lt;-</span> <span class="fu">c</span>(Y[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb430-5"><a href="#cb430-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-6"><a href="#cb430-6" aria-hidden="true" tabindex="-1"></a><span class="co"># iterated cochrane-orcutt procedure</span></span>
<span id="cb430-7"><a href="#cb430-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">cochrane.orcutt</span>(<span class="fu">lm</span>(Y_t <span class="sc">~</span> X_t <span class="sc">+</span> X_l1)))</span>
<span id="cb430-8"><a href="#cb430-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb430-9"><a href="#cb430-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = Y_t ~ X_t + X_l1)</span></span>
<span id="cb430-10"><a href="#cb430-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb430-11"><a href="#cb430-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb430-12"><a href="#cb430-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 0.032885   0.085163   0.386   0.69956    </span></span>
<span id="cb430-13"><a href="#cb430-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X_t         0.120128   0.042534   2.824   0.00493 ** </span></span>
<span id="cb430-14"><a href="#cb430-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X_l1        0.252406   0.042538   5.934 5.572e-09 ***</span></span>
<span id="cb430-15"><a href="#cb430-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb430-16"><a href="#cb430-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb430-17"><a href="#cb430-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb430-18"><a href="#cb430-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 1.0165 on 495 degrees of freedom</span></span>
<span id="cb430-19"><a href="#cb430-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.0704 ,  Adjusted R-squared:  0.0666</span></span>
<span id="cb430-20"><a href="#cb430-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 18.7 on 2 and 495 DF,  p-value: &lt; 1.429e-08</span></span>
<span id="cb430-21"><a href="#cb430-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb430-22"><a href="#cb430-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Durbin-Watson statistic </span></span>
<span id="cb430-23"><a href="#cb430-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (original):    1.06907 , p-value: 1.05e-25</span></span>
<span id="cb430-24"><a href="#cb430-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (transformed): 1.98192 , p-value: 4.246e-01</span></span></code></pre></div>
<p>Some more sophisticated methods for GLS estimation are provided with the package <tt>nlme</tt>. The function <tt>gls()</tt> can be used to fit linear models by maximum likelihood estimation algorithms and allows to specify a correlation structure for the error term.</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="co"># feasible GLS maximum likelihood estimation procedure</span></span>
<span id="cb431-2"><a href="#cb431-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">gls</span>(Y_t <span class="sc">~</span> X_t <span class="sc">+</span> X_l1, <span class="at">correlation =</span> <span class="fu">corAR1</span>()))</span>
<span id="cb431-3"><a href="#cb431-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Generalized least squares fit by REML</span></span>
<span id="cb431-4"><a href="#cb431-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Model: Y_t ~ X_t + X_l1 </span></span>
<span id="cb431-5"><a href="#cb431-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Data: NULL </span></span>
<span id="cb431-6"><a href="#cb431-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        AIC     BIC    logLik</span></span>
<span id="cb431-7"><a href="#cb431-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   1451.847 1472.88 -720.9235</span></span>
<span id="cb431-8"><a href="#cb431-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb431-9"><a href="#cb431-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Correlation Structure: AR(1)</span></span>
<span id="cb431-10"><a href="#cb431-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Formula: ~1 </span></span>
<span id="cb431-11"><a href="#cb431-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Parameter estimate(s):</span></span>
<span id="cb431-12"><a href="#cb431-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Phi </span></span>
<span id="cb431-13"><a href="#cb431-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.4668343 </span></span>
<span id="cb431-14"><a href="#cb431-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb431-15"><a href="#cb431-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb431-16"><a href="#cb431-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  Value  Std.Error  t-value p-value</span></span>
<span id="cb431-17"><a href="#cb431-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 0.03929124 0.08530544 0.460595  0.6453</span></span>
<span id="cb431-18"><a href="#cb431-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X_t         0.11986994 0.04252270 2.818963  0.0050</span></span>
<span id="cb431-19"><a href="#cb431-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X_l1        0.25287471 0.04252497 5.946500  0.0000</span></span>
<span id="cb431-20"><a href="#cb431-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb431-21"><a href="#cb431-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Correlation: </span></span>
<span id="cb431-22"><a href="#cb431-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      (Intr) X_t  </span></span>
<span id="cb431-23"><a href="#cb431-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X_t  0.039       </span></span>
<span id="cb431-24"><a href="#cb431-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X_l1 0.037  0.230</span></span>
<span id="cb431-25"><a href="#cb431-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb431-26"><a href="#cb431-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Standardized residuals:</span></span>
<span id="cb431-27"><a href="#cb431-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Min          Q1         Med          Q3         Max </span></span>
<span id="cb431-28"><a href="#cb431-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -3.00075518 -0.64255522 -0.05400347  0.69101814  3.28555793 </span></span>
<span id="cb431-29"><a href="#cb431-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb431-30"><a href="#cb431-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 1.14952 </span></span>
<span id="cb431-31"><a href="#cb431-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Degrees of freedom: 499 total; 496 residual</span></span></code></pre></div>
<p>Notice that in this example, the coefficient estimates produced by GLS are somewhat closer to their true values and that the standard errors are the smallest for the GLS estimator.</p>
</div>
</div>
<div id="orange-juice-prices-and-cold-weather" class="section level2 hasAnchor" number="15.6">
<h2 class="hasAnchor"><span class="header-section-number">15.6</span> Orange Juice Prices and Cold Weather<a href="#orange-juice-prices-and-cold-weather" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section investigates the following two questions using the time series regression methods discussed here:</p>
<ul>
<li><p>How persistent is the effect of a single freeze on orange juice concentrate prices?</p></li>
<li><p>Has the effect been stable over the whole time span?</p></li>
</ul>
<p>We start by estimating dynamic causal effects with a distributed lag model where <span class="math inline">\(\%ChgOJC_t\)</span> is regressed on <span class="math inline">\(FDD_t\)</span> and 18 lags. A second model specification considers a transformation of the the distributed lag model which allows to estimate the 19 cumulative dynamic multipliers using OLS. The third model, adds 11 binary variables (one for each of the months from February to December) to adjust for a possible omitted variable bias arising from correlation of <span class="math inline">\(FDD_t\)</span> and seasons by adding <tt>season(FDD)</tt> to the right hand side of the formula of the second model.</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate distributed lag models of frozen orange juice price changes</span></span>
<span id="cb432-2"><a href="#cb432-2" aria-hidden="true" tabindex="-1"></a>FOJC_mod_DM <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(FOJC_pctc <span class="sc">~</span> <span class="fu">L</span>(FDD, <span class="dv">0</span><span class="sc">:</span><span class="dv">18</span>))</span>
<span id="cb432-3"><a href="#cb432-3" aria-hidden="true" tabindex="-1"></a>FOJC_mod_CM1 <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(FOJC_pctc <span class="sc">~</span> <span class="fu">L</span>(<span class="fu">d</span>(FDD), <span class="dv">0</span><span class="sc">:</span><span class="dv">17</span>) <span class="sc">+</span> <span class="fu">L</span>(FDD, <span class="dv">18</span>))</span>
<span id="cb432-4"><a href="#cb432-4" aria-hidden="true" tabindex="-1"></a>FOJC_mod_CM2 <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(FOJC_pctc <span class="sc">~</span> <span class="fu">L</span>(<span class="fu">d</span>(FDD), <span class="dv">0</span><span class="sc">:</span><span class="dv">17</span>) <span class="sc">+</span> <span class="fu">L</span>(FDD, <span class="dv">18</span>) <span class="sc">+</span> <span class="fu">season</span>(FDD))</span></code></pre></div>
<p>The above models include a large number of lags with default labels that correspond to the degree of differencing and the lag orders which makes it somewhat cumbersome to read the output. The regressor labels of a model object may be altered by overriding the attribute <tt>names</tt> of the coefficient section using the function <tt>attr()</tt>. Thus, for better readability we use the lag orders as regressor labels.</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set lag orders as regressor labels </span></span>
<span id="cb433-2"><a href="#cb433-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(FOJC_mod_DM<span class="sc">$</span>coefficients, <span class="st">&quot;names&quot;</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;(Intercept)&quot;</span>, <span class="fu">as.character</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">18</span>))</span>
<span id="cb433-3"><a href="#cb433-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(FOJC_mod_CM1<span class="sc">$</span>coefficients, <span class="st">&quot;names&quot;</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;(Intercept)&quot;</span>, <span class="fu">as.character</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">18</span>))</span>
<span id="cb433-4"><a href="#cb433-4" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(FOJC_mod_CM2<span class="sc">$</span>coefficients, <span class="st">&quot;names&quot;</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;(Intercept)&quot;</span>, <span class="fu">as.character</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">18</span>))</span></code></pre></div>
<p>Next, we compute HAC standard errors standard errors for each model using <tt>NeweyWest()</tt> and gather the results in a list which is then supplied as the argument <tt>se</tt> to the function <tt>stargazer()</tt>, see below. The sample consists of 612 observations:</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(FDD)</span>
<span id="cb434-2"><a href="#cb434-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 612</span></span></code></pre></div>
<p>According to @ref(eq:hactruncrot), the rule of thumb for choosing the HAC standard error truncation parameter <span class="math inline">\(m\)</span>, we choose
<span class="math display">\[m = \left\lceil0.75 \cdot 612^{1/3} \right\rceil = \lceil6.37\rceil = 7.\]</span>
To check for sensitivity of the standard errors to different choices of the truncation parameter in the model that is used to estimate the cumulative multipliers, we also compute the Newey-West estimator for <span class="math inline">\(m=14\)</span>.</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gather HAC standard error errors in a list</span></span>
<span id="cb435-2"><a href="#cb435-2" aria-hidden="true" tabindex="-1"></a>SEs <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">NeweyWest</span>(FOJC_mod_DM, <span class="at">lag =</span> <span class="dv">7</span>, <span class="at">prewhite =</span> F))), </span>
<span id="cb435-3"><a href="#cb435-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">NeweyWest</span>(FOJC_mod_CM1, <span class="at">lag =</span> <span class="dv">7</span>, <span class="at">prewhite =</span> F))), </span>
<span id="cb435-4"><a href="#cb435-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">NeweyWest</span>(FOJC_mod_CM1, <span class="at">lag =</span> <span class="dv">14</span>, <span class="at">prewhite =</span> F))),</span>
<span id="cb435-5"><a href="#cb435-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">NeweyWest</span>(FOJC_mod_CM2, <span class="at">lag =</span> <span class="dv">7</span>, <span class="at">prewhite =</span> F))))</span></code></pre></div>
<p>The results are then used to reproduce the outcomes presented in Table 15.1 of the book.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(FOJC_mod_DM , FOJC_mod_CM1, FOJC_mod_CM1, FOJC_mod_CM2,</span>
<span id="cb436-2"><a href="#cb436-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Dynamic Effects of a Freezing Degree Day on the Price of Orange Juice&quot;</span>,</span>
<span id="cb436-3"><a href="#cb436-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">header =</span> <span class="cn">FALSE</span>, </span>
<span id="cb436-4"><a href="#cb436-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">3</span>, </span>
<span id="cb436-5"><a href="#cb436-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">column.labels =</span> <span class="fu">c</span>(<span class="st">&quot;Dynamic Multipliers&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;Dynamic Cumulative Multipliers&quot;</span>, <span class="dv">3</span>)),</span>
<span id="cb436-6"><a href="#cb436-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">dep.var.caption  =</span> <span class="st">&quot;Dependent Variable: Monthly Percentage Change in Orange Juice Price&quot;</span>,</span>
<span id="cb436-7"><a href="#cb436-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">dep.var.labels.include =</span> <span class="cn">FALSE</span>,</span>
<span id="cb436-8"><a href="#cb436-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">covariate.labels =</span> <span class="fu">as.character</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">18</span>),</span>
<span id="cb436-9"><a href="#cb436-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">omit =</span> <span class="st">&quot;season&quot;</span>,</span>
<span id="cb436-10"><a href="#cb436-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> SEs,</span>
<span id="cb436-11"><a href="#cb436-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">no.space =</span> T,</span>
<span id="cb436-12"><a href="#cb436-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">add.lines =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;Monthly indicators?&quot;</span>,<span class="st">&quot;no&quot;</span>, <span class="st">&quot;no&quot;</span>, <span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>),</span>
<span id="cb436-13"><a href="#cb436-13" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">c</span>(<span class="st">&quot;HAC truncation&quot;</span>,<span class="st">&quot;7&quot;</span>, <span class="st">&quot;7&quot;</span>, <span class="st">&quot;14&quot;</span>, <span class="st">&quot;7&quot;</span>)),</span>
<span id="cb436-14"><a href="#cb436-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">omit.stat =</span> <span class="fu">c</span>(<span class="st">&quot;rsq&quot;</span>, <span class="st">&quot;f&quot;</span>,<span class="st">&quot;ser&quot;</span>)) </span></code></pre></div>



<table style="text-align:center"><tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"></td><td colspan="4">Dependent Variable: Monthly Percentage Change in Orange Juice Price</td></tr>
<tr><td></td><td colspan="4" style="border-bottom: 1px solid black"></td></tr>
<tr><td style="text-align:left"></td><td>Dynamic Multipliers</td><td>Dynamic Cumulative Multipliers</td><td>Dynamic Cumulative Multipliers</td><td>Dynamic Cumulative Multipliers</td></tr>
<tr><td style="text-align:left"></td><td>(1)</td><td>(2)</td><td>(3)</td><td>(4)</td></tr>
<tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">0</td><td>0.508<sup>***</sup></td><td>0.508<sup>***</sup></td><td>0.508<sup>***</sup></td><td>0.524<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.137)</td><td>(0.137)</td><td>(0.139)</td><td>(0.142)</td></tr>
<tr><td style="text-align:left">1</td><td>0.172<sup>**</sup></td><td>0.680<sup>***</sup></td><td>0.680<sup>***</sup></td><td>0.720<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.088)</td><td>(0.134)</td><td>(0.130)</td><td>(0.142)</td></tr>
<tr><td style="text-align:left">2</td><td>0.068</td><td>0.748<sup>***</sup></td><td>0.748<sup>***</sup></td><td>0.781<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.060)</td><td>(0.165)</td><td>(0.162)</td><td>(0.173)</td></tr>
<tr><td style="text-align:left">3</td><td>0.070</td><td>0.819<sup>***</sup></td><td>0.819<sup>***</sup></td><td>0.861<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.044)</td><td>(0.181)</td><td>(0.181)</td><td>(0.190)</td></tr>
<tr><td style="text-align:left">4</td><td>0.022</td><td>0.841<sup>***</sup></td><td>0.841<sup>***</sup></td><td>0.892<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.031)</td><td>(0.183)</td><td>(0.184)</td><td>(0.194)</td></tr>
<tr><td style="text-align:left">5</td><td>0.027</td><td>0.868<sup>***</sup></td><td>0.868<sup>***</sup></td><td>0.904<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.030)</td><td>(0.189)</td><td>(0.189)</td><td>(0.199)</td></tr>
<tr><td style="text-align:left">6</td><td>0.031</td><td>0.900<sup>***</sup></td><td>0.900<sup>***</sup></td><td>0.922<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.047)</td><td>(0.202)</td><td>(0.208)</td><td>(0.210)</td></tr>
<tr><td style="text-align:left">7</td><td>0.015</td><td>0.915<sup>***</sup></td><td>0.915<sup>***</sup></td><td>0.939<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.015)</td><td>(0.205)</td><td>(0.210)</td><td>(0.212)</td></tr>
<tr><td style="text-align:left">8</td><td>-0.042</td><td>0.873<sup>***</sup></td><td>0.873<sup>***</sup></td><td>0.904<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.034)</td><td>(0.214)</td><td>(0.218)</td><td>(0.219)</td></tr>
<tr><td style="text-align:left">9</td><td>-0.010</td><td>0.862<sup>***</sup></td><td>0.862<sup>***</sup></td><td>0.884<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.051)</td><td>(0.236)</td><td>(0.245)</td><td>(0.239)</td></tr>
<tr><td style="text-align:left">10</td><td>-0.116<sup>*</sup></td><td>0.746<sup>***</sup></td><td>0.746<sup>***</sup></td><td>0.752<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.069)</td><td>(0.257)</td><td>(0.262)</td><td>(0.259)</td></tr>
<tr><td style="text-align:left">11</td><td>-0.067</td><td>0.680<sup>**</sup></td><td>0.680<sup>**</sup></td><td>0.677<sup>**</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.052)</td><td>(0.266)</td><td>(0.272)</td><td>(0.267)</td></tr>
<tr><td style="text-align:left">12</td><td>-0.143<sup>*</sup></td><td>0.537<sup>**</sup></td><td>0.537<sup>**</sup></td><td>0.551<sup>**</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.076)</td><td>(0.268)</td><td>(0.271)</td><td>(0.272)</td></tr>
<tr><td style="text-align:left">13</td><td>-0.083<sup>*</sup></td><td>0.454<sup>*</sup></td><td>0.454<sup>*</sup></td><td>0.491<sup>*</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.043)</td><td>(0.267)</td><td>(0.273)</td><td>(0.275)</td></tr>
<tr><td style="text-align:left">14</td><td>-0.057</td><td>0.397</td><td>0.397</td><td>0.427</td></tr>
<tr><td style="text-align:left"></td><td>(0.035)</td><td>(0.273)</td><td>(0.284)</td><td>(0.278)</td></tr>
<tr><td style="text-align:left">15</td><td>-0.032</td><td>0.366</td><td>0.366</td><td>0.406</td></tr>
<tr><td style="text-align:left"></td><td>(0.028)</td><td>(0.276)</td><td>(0.287)</td><td>(0.280)</td></tr>
<tr><td style="text-align:left">16</td><td>-0.005</td><td>0.360</td><td>0.360</td><td>0.408</td></tr>
<tr><td style="text-align:left"></td><td>(0.055)</td><td>(0.283)</td><td>(0.293)</td><td>(0.286)</td></tr>
<tr><td style="text-align:left">17</td><td>0.003</td><td>0.363</td><td>0.363</td><td>0.395</td></tr>
<tr><td style="text-align:left"></td><td>(0.018)</td><td>(0.287)</td><td>(0.294)</td><td>(0.290)</td></tr>
<tr><td style="text-align:left">18</td><td>0.003</td><td>0.366</td><td>0.366</td><td>0.386</td></tr>
<tr><td style="text-align:left"></td><td>(0.017)</td><td>(0.293)</td><td>(0.301)</td><td>(0.295)</td></tr>
<tr><td style="text-align:left">Constant</td><td>-0.343</td><td>-0.343</td><td>-0.343</td><td>-0.241</td></tr>
<tr><td style="text-align:left"></td><td>(0.269)</td><td>(0.269)</td><td>(0.256)</td><td>(0.934)</td></tr>
<tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">Monthly indicators?</td><td>no</td><td>no</td><td>no</td><td>yes</td></tr>
<tr><td style="text-align:left">HAC truncation</td><td>7</td><td>7</td><td>14</td><td>7</td></tr>
<tr><td style="text-align:left">Observations</td><td>594</td><td>594</td><td>594</td><td>594</td></tr>
<tr><td style="text-align:left">Adjusted R<sup>2</sup></td><td>0.109</td><td>0.109</td><td>0.109</td><td>0.101</td></tr>
<tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"><em>Note:</em></td><td colspan="4" style="text-align:right"><sup>*</sup>p<0.1; <sup>**</sup>p<0.05; <sup>***</sup>p<0.01</td></tr>
</table>
<caption><p style='text-align:center'>(#tab:deoafddotpooj) Dynamic Effects of a Freezing Degree Day on the Price of Orange Juice</p></caption>


<p>According to column (1) of Table @ref(tab:deoafddotpooj), the contemporaneous effect of a freezing degree day is an increase of <span class="math inline">\(0.5\%\)</span> in orange juice prices. The estimated effect is only <span class="math inline">\(0.17\%\)</span> for the next month and close to zero for subsequent months. In fact, for all lags larger than 1, we cannot reject the null hypotheses that the respective coefficients are zero using individual <span class="math inline">\(t\)</span>-tests. The model <tt>FOJC_mod_DM</tt> only explains little of the variation in the dependent variable (<span class="math inline">\(\bar{R}^2 = 0.11\)</span>).</p>
<p>Columns (2) and (3) present estimates of the dynamic cumulative multipliers of model <tt>FOJC_mod_CM1</tt>. Apparently, it does not matter whether we choose <span class="math inline">\(m=7\)</span> or <span class="math inline">\(m=14\)</span> when computing HAC standard errors so we stick with <span class="math inline">\(m=7\)</span> and the standard errors reported in column (2).</p>
<p>If the demand for orange juice is higher in winter, <span class="math inline">\(FDD_t\)</span> would be correlated with the error term since freezes occur rather in winter so we would face omitted variable bias. The fourth model estimate, <tt>FOJC_mod_CM2</tt>, accounts for this possible issue by using an additional set of 11 monthly dummies. For brevity, estimates of the dummy coefficients are excluded from the output produced by stargazer (this is achieved by setting <tt>omit = ‘season’</tt>). We may check that the dummy for January was omitted to prevent perfect multicollinearity.</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="#cb437-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimates on mothly dummies</span></span>
<span id="cb437-2"><a href="#cb437-2" aria-hidden="true" tabindex="-1"></a>FOJC_mod_CM2<span class="sc">$</span>coefficients[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)]</span>
<span id="cb437-3"><a href="#cb437-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; season(FDD)Feb season(FDD)Mar season(FDD)Apr season(FDD)May season(FDD)Jun </span></span>
<span id="cb437-4"><a href="#cb437-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     -0.9565759     -0.6358007      0.5006770     -1.0801764      0.3195624 </span></span>
<span id="cb437-5"><a href="#cb437-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; season(FDD)Jul season(FDD)Aug season(FDD)Sep season(FDD)Oct season(FDD)Nov </span></span>
<span id="cb437-6"><a href="#cb437-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      0.1951113      0.3644312     -0.4130969     -0.1566622      0.3116534 </span></span>
<span id="cb437-7"><a href="#cb437-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; season(FDD)Dec </span></span>
<span id="cb437-8"><a href="#cb437-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      0.1481589</span></span></code></pre></div>
<p>A comparison of the estimates presented in columns (2) and (4) indicates that adding monthly dummies has a negligible effect. Further evidence for this comes from a joint test of the hypothesis that the 11 dummy coefficients are zero. Instead of using <tt>linearHypothesis()</tt>, we use the function <tt>waldtest()</tt> and supply two model objects instead: <tt>unres_model</tt>, the unrestricted model object which is the same as <tt>FOJC_mod_CM2</tt> (except for the coefficient names since we have modified them above) and <tt>res_model</tt>, the model where the restriction that all dummy coefficients are zero is imposed. <tt>res_model</tt> is conveniently obtained using the function <tt>update()</tt>. It extracts the argument <tt>formula</tt> of a model object, updates it as specified and then re-fits the model. By setting <tt>formula = . ~ . - season(FDD)</tt> we impose that the monthly dummies do not enter the model.</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test if coefficients on monthly dummies are zero</span></span>
<span id="cb438-2"><a href="#cb438-2" aria-hidden="true" tabindex="-1"></a>unres_model <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(FOJC_pctc <span class="sc">~</span> <span class="fu">L</span>(<span class="fu">d</span>(FDD), <span class="dv">0</span><span class="sc">:</span><span class="dv">17</span>) <span class="sc">+</span> <span class="fu">L</span>(FDD, <span class="dv">18</span>) <span class="sc">+</span> <span class="fu">season</span>(FDD))</span>
<span id="cb438-3"><a href="#cb438-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb438-4"><a href="#cb438-4" aria-hidden="true" tabindex="-1"></a>res_model <span class="ot">&lt;-</span> <span class="fu">update</span>(unres_model, <span class="at">formula =</span> . <span class="sc">~</span> . <span class="sc">-</span> <span class="fu">season</span>(FDD))</span>
<span id="cb438-5"><a href="#cb438-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb438-6"><a href="#cb438-6" aria-hidden="true" tabindex="-1"></a><span class="fu">waldtest</span>(unres_model, </span>
<span id="cb438-7"><a href="#cb438-7" aria-hidden="true" tabindex="-1"></a>         res_model, </span>
<span id="cb438-8"><a href="#cb438-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">vcov =</span> <span class="fu">NeweyWest</span>(unres_model, <span class="at">lag =</span> <span class="dv">7</span>, <span class="at">prewhite =</span> F))</span>
<span id="cb438-9"><a href="#cb438-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Wald test</span></span>
<span id="cb438-10"><a href="#cb438-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb438-11"><a href="#cb438-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: FOJC_pctc ~ L(d(FDD), 0:17) + L(FDD, 18) + season(FDD)</span></span>
<span id="cb438-12"><a href="#cb438-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: FOJC_pctc ~ L(d(FDD), 0:17) + L(FDD, 18)</span></span>
<span id="cb438-13"><a href="#cb438-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df  Df      F Pr(&gt;F)</span></span>
<span id="cb438-14"><a href="#cb438-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    563                  </span></span>
<span id="cb438-15"><a href="#cb438-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    574 -11 0.9683 0.4743</span></span></code></pre></div>
<p>The <span class="math inline">\(p\)</span>-value is <span class="math inline">\(0.47\)</span> so we cannot reject the hypothesis that the coefficients on the monthly dummies are zero, even at the <span class="math inline">\(10\%\)</span> level. We conclude that the seasonal fluctuations in demand for orange juice do not pose a serious threat to internal validity of the model.</p>
<p>It is convenient to use plots of dynamic multipliers and cumulative dynamic multipliers. The following two code chunks reproduce Figures 15.2 (a) and 15.2 (b) of the book which display point estimates of dynamic and cumulative multipliers along with upper and lower bounds of their <span class="math inline">\(95\%\)</span> confidence intervals computed using the above HAC standard errors.</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% CI bounds</span></span>
<span id="cb439-2"><a href="#cb439-2" aria-hidden="true" tabindex="-1"></a>point_estimates <span class="ot">&lt;-</span> FOJC_mod_DM<span class="sc">$</span>coefficients</span>
<span id="cb439-3"><a href="#cb439-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-4"><a href="#cb439-4" aria-hidden="true" tabindex="-1"></a>CI_bounds <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">&quot;lower&quot;</span> <span class="ot">=</span> point_estimates <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> SEs[[<span class="dv">1</span>]],</span>
<span id="cb439-5"><a href="#cb439-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;upper&quot;</span> <span class="ot">=</span> point_estimates <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> SEs[[<span class="dv">1</span>]])[<span class="sc">-</span><span class="dv">1</span>, ]</span>
<span id="cb439-6"><a href="#cb439-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-7"><a href="#cb439-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the estimated dynamic multipliers</span></span>
<span id="cb439-8"><a href="#cb439-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">18</span>, point_estimates[<span class="sc">-</span><span class="dv">1</span>], </span>
<span id="cb439-9"><a href="#cb439-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb439-10"><a href="#cb439-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb439-11"><a href="#cb439-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb439-12"><a href="#cb439-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>, <span class="dv">1</span>),</span>
<span id="cb439-13"><a href="#cb439-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Lag&quot;</span>,</span>
<span id="cb439-14"><a href="#cb439-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Dynamic multiplier&quot;</span>,</span>
<span id="cb439-15"><a href="#cb439-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Dynamic Effect of FDD on Orange Juice Price&quot;</span>)</span>
<span id="cb439-16"><a href="#cb439-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-17"><a href="#cb439-17" aria-hidden="true" tabindex="-1"></a><span class="co"># add a dashed line at 0</span></span>
<span id="cb439-18"><a href="#cb439-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb439-19"><a href="#cb439-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-20"><a href="#cb439-20" aria-hidden="true" tabindex="-1"></a><span class="co"># add CI bounds</span></span>
<span id="cb439-21"><a href="#cb439-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">18</span>, CI_bounds[,<span class="dv">1</span>], <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb439-22"><a href="#cb439-22" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">18</span>, CI_bounds[,<span class="dv">2</span>], <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="ITER_files/figure-html/DM-1.png" alt="Dynamic Multipliers" width="80%" />
<p class="caption">
(#fig:DM)Dynamic Multipliers
</p>
</div>
<p>The <span class="math inline">\(95\%\)</span> confidence intervals plotted in Figure @ref(fig:DM) indeed include zero for lags larger than 1 such that the null of a zero multiplier cannot be rejected for these lags.</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% CI bounds</span></span>
<span id="cb440-2"><a href="#cb440-2" aria-hidden="true" tabindex="-1"></a>point_estimates <span class="ot">&lt;-</span> FOJC_mod_CM1<span class="sc">$</span>coefficients</span>
<span id="cb440-3"><a href="#cb440-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-4"><a href="#cb440-4" aria-hidden="true" tabindex="-1"></a>CI_bounds <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">&quot;lower&quot;</span> <span class="ot">=</span> point_estimates <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> SEs[[<span class="dv">2</span>]],</span>
<span id="cb440-5"><a href="#cb440-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;upper&quot;</span> <span class="ot">=</span> point_estimates <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> SEs[[<span class="dv">2</span>]])[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb440-6"><a href="#cb440-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-7"><a href="#cb440-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-8"><a href="#cb440-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot estimated dynamic multipliers</span></span>
<span id="cb440-9"><a href="#cb440-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">18</span>, point_estimates[<span class="sc">-</span><span class="dv">1</span>], </span>
<span id="cb440-10"><a href="#cb440-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb440-11"><a href="#cb440-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb440-12"><a href="#cb440-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb440-13"><a href="#cb440-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>, <span class="fl">1.6</span>),</span>
<span id="cb440-14"><a href="#cb440-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Lag&quot;</span>,</span>
<span id="cb440-15"><a href="#cb440-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Cumulative dynamic multiplier&quot;</span>,</span>
<span id="cb440-16"><a href="#cb440-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Cumulative Dynamic Effect of FDD on Orange Juice Price&quot;</span>)</span>
<span id="cb440-17"><a href="#cb440-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-18"><a href="#cb440-18" aria-hidden="true" tabindex="-1"></a><span class="co"># add dashed line at 0</span></span>
<span id="cb440-19"><a href="#cb440-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb440-20"><a href="#cb440-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-21"><a href="#cb440-21" aria-hidden="true" tabindex="-1"></a><span class="co"># add CI bounds</span></span>
<span id="cb440-22"><a href="#cb440-22" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">18</span>, CI_bounds[, <span class="dv">1</span>], <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb440-23"><a href="#cb440-23" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">18</span>, CI_bounds[, <span class="dv">2</span>], <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="ITER_files/figure-html/DCM-1.png" alt="Dynamic Cumulative Multipliers" width="80%" />
<p class="caption">
(#fig:DCM)Dynamic Cumulative Multipliers
</p>
</div>
<p>As can be seen from Figure @ref(fig:DCM), the estimated dynamic cumulative multipliers grow until the seventh month up to a price increase of about <span class="math inline">\(0.91\%\)</span> and then decrease slightly to the estimated long-run cumulative multiplier of <span class="math inline">\(0.37\%\)</span> which, however, is not significantly different from zero at the <span class="math inline">\(5\%\)</span> level.</p>
<p>Have the dynamic multipliers been stable over time? One way to see this is to estimate these multipliers for different subperiods of the sample span. For example, consider periods 1950 - 1966, 1967 - 1983 and 1984 - 2000. If the multipliers are the same for all three periods the estimates should be close and thus the estimated cumulative multipliers should be similar, too. We investigate this by re-estimating <tt>FOJC_mod_CM1</tt> for the three different time spans and then plot the estimated cumulative dynamic multipliers for the comparison.</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate cumulative multiplieres using different sample periods</span></span>
<span id="cb441-2"><a href="#cb441-2" aria-hidden="true" tabindex="-1"></a>FOJC_mod_CM1950 <span class="ot">&lt;-</span> <span class="fu">update</span>(FOJC_mod_CM1, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1950</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">1966</span>, <span class="dv">12</span>))</span>
<span id="cb441-3"><a href="#cb441-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-4"><a href="#cb441-4" aria-hidden="true" tabindex="-1"></a>FOJC_mod_CM1967 <span class="ot">&lt;-</span> <span class="fu">update</span>(FOJC_mod_CM1, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1967</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">1983</span>, <span class="dv">12</span>))</span>
<span id="cb441-5"><a href="#cb441-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-6"><a href="#cb441-6" aria-hidden="true" tabindex="-1"></a>FOJC_mod_CM1984 <span class="ot">&lt;-</span> <span class="fu">update</span>(FOJC_mod_CM1, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1984</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">12</span>))</span></code></pre></div>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot estimated dynamic cumulative multipliers (1950-1966)</span></span>
<span id="cb442-2"><a href="#cb442-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">18</span>, FOJC_mod_CM1950<span class="sc">$</span>coefficients[<span class="sc">-</span><span class="dv">1</span>], </span>
<span id="cb442-3"><a href="#cb442-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb442-4"><a href="#cb442-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb442-5"><a href="#cb442-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb442-6"><a href="#cb442-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>),</span>
<span id="cb442-7"><a href="#cb442-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="dv">2</span>),</span>
<span id="cb442-8"><a href="#cb442-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Lag&quot;</span>,</span>
<span id="cb442-9"><a href="#cb442-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Cumulative dynamic multiplier&quot;</span>,</span>
<span id="cb442-10"><a href="#cb442-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Cumulative Dynamic Effect for Different Sample Periods&quot;</span>)</span>
<span id="cb442-11"><a href="#cb442-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-12"><a href="#cb442-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plot estimated dynamic multipliers (1967-1983)</span></span>
<span id="cb442-13"><a href="#cb442-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">18</span>, FOJC_mod_CM1967<span class="sc">$</span>coefficients[<span class="sc">-</span><span class="dv">1</span>], <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb442-14"><a href="#cb442-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-15"><a href="#cb442-15" aria-hidden="true" tabindex="-1"></a><span class="co"># plot estimated dynamic multipliers (1984-2000)</span></span>
<span id="cb442-16"><a href="#cb442-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">18</span>, FOJC_mod_CM1984<span class="sc">$</span>coefficients[<span class="sc">-</span><span class="dv">1</span>], <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>)</span>
<span id="cb442-17"><a href="#cb442-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-18"><a href="#cb442-18" aria-hidden="true" tabindex="-1"></a><span class="co"># add dashed line at 0</span></span>
<span id="cb442-19"><a href="#cb442-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb442-20"><a href="#cb442-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-21"><a href="#cb442-21" aria-hidden="true" tabindex="-1"></a><span class="co"># add annotations</span></span>
<span id="cb442-22"><a href="#cb442-22" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">18</span>, <span class="sc">-</span><span class="fl">0.24</span>, <span class="st">&quot;1984 - 2000&quot;</span>)</span>
<span id="cb442-23"><a href="#cb442-23" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">18</span>, <span class="fl">0.6</span>, <span class="st">&quot;1967 - 1983&quot;</span>)</span>
<span id="cb442-24"><a href="#cb442-24" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">18</span>, <span class="fl">1.2</span>, <span class="st">&quot;1950 - 1966&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-705-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Clearly, the cumulative dynamic multipliers have changed considerably over time. The effect of a freeze was stronger and more persistent in the 1950s and 1960s. For the 1970s the magnitude of the effect was lower but still highly persistent. We observe an even lower magnitude for the final third of the sample span (1984 - 2000) where the long-run effect is much less persistent and essentially zero after a year.</p>
<p>A QLR test for a break in the distributed lag regression of column (1) in Table @ref(tab:deoafddotpooj) with <span class="math inline">\(15\%\)</span> trimming using a HAC variance-covariance matrix estimate supports the conjecture that the population regression coefficients have changed over time.</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="#cb443-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up a range of possible break dates</span></span>
<span id="cb443-2"><a href="#cb443-2" aria-hidden="true" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">window</span>(<span class="fu">time</span>(FDD), </span>
<span id="cb443-3"><a href="#cb443-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">time</span>(FDD)[<span class="fu">round</span>(<span class="dv">612</span><span class="sc">/</span><span class="dv">100</span><span class="sc">*</span><span class="dv">15</span>)], </span>
<span id="cb443-4"><a href="#cb443-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">time</span>(FDD)[<span class="fu">round</span>(<span class="dv">612</span><span class="sc">/</span><span class="dv">100</span><span class="sc">*</span><span class="dv">85</span>)]))</span>
<span id="cb443-5"><a href="#cb443-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb443-6"><a href="#cb443-6" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize the vector of F-statistics</span></span>
<span id="cb443-7"><a href="#cb443-7" aria-hidden="true" tabindex="-1"></a>Fstats <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(tau))</span>
<span id="cb443-8"><a href="#cb443-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb443-9"><a href="#cb443-9" aria-hidden="true" tabindex="-1"></a><span class="co"># the restricted model</span></span>
<span id="cb443-10"><a href="#cb443-10" aria-hidden="true" tabindex="-1"></a>res_model <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(FOJC_pctc <span class="sc">~</span> <span class="fu">L</span>(FDD, <span class="dv">0</span><span class="sc">:</span><span class="dv">18</span>))</span>
<span id="cb443-11"><a href="#cb443-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb443-12"><a href="#cb443-12" aria-hidden="true" tabindex="-1"></a><span class="co"># estimation, loop over break dates</span></span>
<span id="cb443-13"><a href="#cb443-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(tau)) {</span>
<span id="cb443-14"><a href="#cb443-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb443-15"><a href="#cb443-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set up dummy variable</span></span>
<span id="cb443-16"><a href="#cb443-16" aria-hidden="true" tabindex="-1"></a>  D <span class="ot">&lt;-</span> <span class="fu">time</span>(FOJC_pctc) <span class="sc">&gt;</span> tau[i]</span>
<span id="cb443-17"><a href="#cb443-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb443-18"><a href="#cb443-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># estimate DL model with intercations</span></span>
<span id="cb443-19"><a href="#cb443-19" aria-hidden="true" tabindex="-1"></a>  unres_model <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(FOJC_pctc <span class="sc">~</span> D <span class="sc">*</span> <span class="fu">L</span>(FDD, <span class="dv">0</span><span class="sc">:</span><span class="dv">18</span>))</span>
<span id="cb443-20"><a href="#cb443-20" aria-hidden="true" tabindex="-1"></a>                 </span>
<span id="cb443-21"><a href="#cb443-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute and save F-statistic</span></span>
<span id="cb443-22"><a href="#cb443-22" aria-hidden="true" tabindex="-1"></a>  Fstats[i] <span class="ot">&lt;-</span> <span class="fu">waldtest</span>(res_model, </span>
<span id="cb443-23"><a href="#cb443-23" aria-hidden="true" tabindex="-1"></a>                        unres_model, </span>
<span id="cb443-24"><a href="#cb443-24" aria-hidden="true" tabindex="-1"></a>                        <span class="at">vcov =</span> <span class="fu">NeweyWest</span>(unres_model, <span class="at">lag =</span> <span class="dv">7</span>, <span class="at">prewhite =</span> F))<span class="sc">$</span>F[<span class="dv">2</span>]</span>
<span id="cb443-25"><a href="#cb443-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb443-26"><a href="#cb443-26" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Note that this code takes a couple of seconds to run since a total of <tt>length(tau)</tt> regressions with <span class="math inline">\(40\)</span> model coefficients each are estimated.</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true" tabindex="-1"></a><span class="co"># QLR test statistic</span></span>
<span id="cb444-2"><a href="#cb444-2" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(Fstats)</span>
<span id="cb444-3"><a href="#cb444-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 36.76819</span></span></code></pre></div>
<p>The QLR statistic is <span class="math inline">\(36.77\)</span>. From Table 14.5 of the book we see that the <span class="math inline">\(1\%\)</span> critical value for the QLR test with <span class="math inline">\(15\%\)</span> trimming and <span class="math inline">\(q=20\)</span> restrictions is <span class="math inline">\(2.43\)</span>. Since this is a right-sided test, the QLR statistic clearly lies in the region of rejection so we can discard the null hypothesis of no break in the population regression function.</p>
<p>See Chapter 15.7 of the book for a discussion of empirical examples where it is questionable whether the assumption of (past and present) exogeneity of the regressors is plausible.</p>
<div id="summary-7" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Summary<a href="#summary-7" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>We have seen how <tt>R</tt> can be used to estimate the time path of the effect on <span class="math inline">\(Y\)</span> of a change in <span class="math inline">\(X\)</span> (the dynamic causal effect on <span class="math inline">\(Y\)</span> of a change in <span class="math inline">\(X\)</span>) using time series data on both. The corresponding model is called the distributed lag model. Distributed lag models are conveniently estimated using the function <tt>dynlm()</tt> from the package <tt>dynlm</tt>.</p></li>
<li><p>The regression error in distributed lag models is often serially correlated such that standard errors which are robust to heteroskedasticity <em>and</em> autocorrelation should be used to obtain valid inference. The package <tt>sandwich</tt> provides functions for computation of so-called HAC covariance matrix estimators, for example <tt>vcovHAC()</tt> and <tt>NeweyWest()</tt>.</p></li>
<li><p>When <span class="math inline">\(X\)</span> is <em>strictly exogeneous</em>, more efficient estimates can be obtained using an ADL model or by GLS estimation. Feasible GLS algorithms can be found in the <tt>R</tt> packages <tt>orcutt</tt> and <tt>nlme</tt>. Chapter 15.7 of the book emphasizes that the assumption of strict exogeneity is often implausible in empirical applications.</p></li>
</ul>
<!--chapter:end:15-ch15.Rmd-->
</div>
</div>
</div>
<div id="atitsr" class="section level1 hasAnchor" number="16">
<h1 class="hasAnchor"><span class="header-section-number">16</span> Additional Topics in Time Series Regression<a href="#atitsr" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter discusses the following advanced topics in time series regression and demonstrates how core techniques can be applied using <tt>R</tt>:</p>
<ul>
<li><em>Vector autoregressions</em> (VARs). We focus on using VARs for forecasting. Another branch of the literature is concerned with so-called <em>Structural VARs</em> which are, however, beyond the scope of this chapter.</li>
<li>Multiperiod forecasts. This includes a discussion of iterated and direct (multivariate) forecasts.</li>
<li>The DF-GLS test, a modification of the ADF test that has more power than the latter when the series has deterministic components and is close to being nonstationarity.</li>
<li>Cointegration analysis with an application to short- and long-term interest rates. We demonstrate how to estimate a vector error correction model.</li>
<li>Autoregressive conditional heteroskedasticity (ARCH) models. We show how a simple generalized ARCH (GARCH) model can be helpful in quantifying the risk associated with investing in the stock market in terms of estimation and forecasting of the volatility of asset returns.</li>
</ul>
<p>To reproduce the code examples, install the <tt>R</tt> packages listed below and make sure that the subsequent code chunk executes without any errors.</p>
<ul>
<li><tt>AER</tt> <span class="citation">(<a href="#ref-R-AER" role="doc-biblioref">Christian Kleiber and Zeileis 2022</a>)</span></li>
<li><tt>dynlm</tt> <span class="citation">(<a href="#ref-R-dynlm" role="doc-biblioref">Zeileis 2019</a>)</span></li>
<li><tt>fGarch</tt> <span class="citation">(<a href="#ref-R-fGarch" role="doc-biblioref">Wuertz et al. 2022</a>)</span></li>
<li><tt>quantmod</tt> <span class="citation">(<a href="#ref-R-quantmod" role="doc-biblioref">Ryan and Ulrich 2022</a>)</span></li>
<li><tt>readxl</tt> <span class="citation">(<a href="#ref-R-readxl" role="doc-biblioref">Wickham and Bryan 2023</a>)</span></li>
<li><tt>scales</tt> <span class="citation">(<a href="#ref-R-scales" role="doc-biblioref">Wickham and Seidel 2022</a>)</span></li>
<li><tt>vars</tt> <span class="citation">(<a href="#ref-R-vars" role="doc-biblioref">Pfaff 2023</a>)</span></li>
</ul>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb445-2"><a href="#cb445-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb445-3"><a href="#cb445-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dynlm)</span>
<span id="cb445-4"><a href="#cb445-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vars)</span>
<span id="cb445-5"><a href="#cb445-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb445-6"><a href="#cb445-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb445-7"><a href="#cb445-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fGarch)</span></code></pre></div>
<div id="vector-autoregressions" class="section level2 hasAnchor" number="16.1">
<h2 class="hasAnchor"><span class="header-section-number">16.1</span> Vector Autoregressions<a href="#vector-autoregressions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A Vector autoregressive (VAR) model is useful when one is interested in predicting multiple time series variables using a single model. At its core, the VAR model is an extension of the univariate autoregressive model we have dealt with in Chapters @ref(ittsraf) and @ref(eodce). Key Concept 16.1 summarizes the essentials of VAR.</p>
<div id="KC16.1" class="keyconcept">
<h3 class="right">
Key Concept <br> 16.1
</h3>
<h3 class="left">
Vector Autoregressions
</h3>
<p>
<p>The vector autoregression (VAR) model extends the idea of univariate autoregression to <span class="math inline">\(k\)</span> time series regressions, where the lagged values of <em>all</em> <span class="math inline">\(k\)</span> series appear as regressors. Put differently, in a VAR model we regress a <em>vector</em> of time series variables on lagged vectors of these variables. As for AR(<span class="math inline">\(p\)</span>) models, the lag order is denoted by <span class="math inline">\(p\)</span> so the VAR(<span class="math inline">\(p\)</span>) model of two variables <span class="math inline">\(X_t\)</span> and <span class="math inline">\(Y_t\)</span> (<span class="math inline">\(k=2\)</span>) is given by the equations</p>
<p><span class="math display">\[\begin{align*}
  Y_t =&amp; \, \beta_{10} + \beta_{11} Y_{t-1} + \dots + \beta_{1p} Y_{t-p} + \gamma_{11} X_{t-1} + \dots + \gamma_{1p} X_{t-p} + u_{1t}, \\
  X_t =&amp; \, \beta_{20} + \beta_{21} Y_{t-1} + \dots + \beta_{2p} Y_{t-p} + \gamma_{21} X_{t-1} + \dots + \gamma_{2p} X_{t-p} + u_{2t}.
\end{align*}\]</span></p>
<p>The <span class="math inline">\(\beta\)</span>s and <span class="math inline">\(\gamma\)</span>s can be estimated using OLS on each equation. The assumptions for VARs are the time series assumptions presented in Key Concept 14.6 applied to each of the equations.</p>
<p>It is straightforward to estimate VAR models in <tt>R</tt>. A feasible approach is to simply use <tt>lm()</tt> for estimation of the individual equations. Furthermore, the <tt>R</tt>package <tt>vars</tt> provides standard tools for estimation, diagnostic testing and prediction using this type of models.</p>
</p>
</div>
<p>When the assumptions of Key Concept 16.1 hold, the OLS estimators of the VAR coefficients are consistent and jointly normal in large samples so that the usual inferential methods such as confidence intervals and <span class="math inline">\(t\)</span>-statistics can be used.</p>
<p>The structure of VARs also allows to jointly test restrictions across multiple equations. For instance, it may be of interest to test whether the coefficients on all regressors of the lag <span class="math inline">\(p\)</span> are zero. This corresponds to testing the null that the lag order <span class="math inline">\(p-1\)</span> is correct. Large sample joint normality of the coefficient estimates is convenient because it implies that we may simply use an <span class="math inline">\(F\)</span>-test for this testing problem. The explicit formula for such a test statistic is rather complicated but fortunately such computations are easily done using the <tt>R</tt> functions we work with in this chapter. Another way to determine optimal lag lengths are information criteria like the <span class="math inline">\(BIC\)</span> which we have introduced for univariate time series regressions in Chapter @ref(llsuic). Just as in the case of a single equation, for a multiple equation model we choose the specification which has the smallest <span class="math inline">\(BIC(p)\)</span>, where
<span class="math display">\[\begin{align*}
  BIC(p) =&amp; \, \log\left[\text{det}(\widehat{\Sigma}_u)\right] + k(kp+1) \frac{\log(T)}{T}.
\end{align*}\]</span>
with <span class="math inline">\(\widehat{\Sigma}_u\)</span> denoting the estimate of the <span class="math inline">\(k \times k\)</span> covariance matrix of the VAR errors and <span class="math inline">\(\text{det}(\cdot)\)</span> denotes the determinant.</p>
<p>As for univariate distributed lag models, one should think carefully about variables to include in a VAR, as adding unrelated variables reduces the forecast accuracy by increasing the estimation error. This is particularly important because the number of parameters to be estimated grows qudratically to the number of variables modeled by the VAR. In the application below we shall see that economic theory and empirical evidence are helpful for this decision.</p>
<div id="a-var-model-of-the-growth-rate-of-gdp-and-the-term-spread" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">A VAR Model of the Growth Rate of GDP and the Term Spread<a href="#a-var-model-of-the-growth-rate-of-gdp-and-the-term-spread" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We now show how to estimate a VAR model of the GDP growth rate, <span class="math inline">\(GDPGR\)</span>, and the term spread, <span class="math inline">\(TSpread\)</span>. As following the discussion on nonstationarity of GDP growth in Chapter @ref(nit) (recall the possible break in the early 1980s detected by the <span class="math inline">\(QLR\)</span> test statistic), we use data from 1981:Q1 to 2012:Q4. The two model equations are</p>
<p><span class="math display">\[\begin{align*}
GDPGR_t =&amp; \, \beta_{10} + \beta_{11} GDPGR_{t-1} + \beta_{12} GDPGR_{t-2} + \gamma_{11} TSpread_{t-1} + \gamma_{12} TSpread_{t-2} + u_{1t}, \\
TSpread_t =&amp; \, \beta_{20} + \beta_{21} GDPGR_{t-1} + \beta_{22} GDPGR_{t-2} + \gamma_{21} TSpread_{t-1} + \gamma_{22} TSpread_{t-2} + u_{2t}.
\end{align*}\]</span></p>
<p>The data set <tt>us_macro_quarterly.xlsx</tt> is provided on the companion website to <span class="citation">Stock and Watson (<a href="#ref-stock2015" role="doc-biblioref">2015</a>)</span> and can be downloaded <a href="https://wps.pearsoned.com/wps/media/objects/11422/11696965/data3eu/us_macro_quarterly.xlsx">here</a>. It contains quarterly data on U.S. real (i.e., inflation adjusted) GDP from 1957 to 2004. We begin by importing the data set and do some formatting (we already worked with this data set in Chapter @ref(ittsraf) so you may skip these steps if you have already loaded the data in your working environment).</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the U.S. macroeconomic data set</span></span>
<span id="cb446-2"><a href="#cb446-2" aria-hidden="true" tabindex="-1"></a>USMacroSWQ <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">&quot;Data/us_macro_quarterly.xlsx&quot;</span>,</span>
<span id="cb446-3"><a href="#cb446-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sheet =</span> <span class="dv">1</span>,</span>
<span id="cb446-4"><a href="#cb446-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">&quot;text&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;numeric&quot;</span>, <span class="dv">9</span>)))</span>
<span id="cb446-5"><a href="#cb446-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-6"><a href="#cb446-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the name of the first column</span></span>
<span id="cb446-7"><a href="#cb446-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(USMacroSWQ)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Date&quot;</span></span>
<span id="cb446-8"><a href="#cb446-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-9"><a href="#cb446-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-10"><a href="#cb446-10" aria-hidden="true" tabindex="-1"></a><span class="co"># format the date column</span></span>
<span id="cb446-11"><a href="#cb446-11" aria-hidden="true" tabindex="-1"></a>USMacroSWQ<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.yearqtr</span>(USMacroSWQ<span class="sc">$</span>Date, <span class="at">format =</span> <span class="st">&quot;%Y:0%q&quot;</span>)</span>
<span id="cb446-12"><a href="#cb446-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-13"><a href="#cb446-13" aria-hidden="true" tabindex="-1"></a><span class="co"># define GDP as ts object</span></span>
<span id="cb446-14"><a href="#cb446-14" aria-hidden="true" tabindex="-1"></a>GDP <span class="ot">&lt;-</span> <span class="fu">ts</span>(USMacroSWQ<span class="sc">$</span>GDPC96,</span>
<span id="cb446-15"><a href="#cb446-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1957</span>, <span class="dv">1</span>), </span>
<span id="cb446-16"><a href="#cb446-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2013</span>, <span class="dv">4</span>), </span>
<span id="cb446-17"><a href="#cb446-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb446-18"><a href="#cb446-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-19"><a href="#cb446-19" aria-hidden="true" tabindex="-1"></a><span class="co"># define GDP growth as a ts object</span></span>
<span id="cb446-20"><a href="#cb446-20" aria-hidden="true" tabindex="-1"></a>GDPGrowth <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="dv">400</span><span class="sc">*</span><span class="fu">log</span>(GDP[<span class="sc">-</span><span class="dv">1</span>]<span class="sc">/</span>GDP[<span class="sc">-</span><span class="fu">length</span>(GDP)]),</span>
<span id="cb446-21"><a href="#cb446-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1957</span>, <span class="dv">2</span>), </span>
<span id="cb446-22"><a href="#cb446-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2013</span>, <span class="dv">4</span>), </span>
<span id="cb446-23"><a href="#cb446-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb446-24"><a href="#cb446-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-25"><a href="#cb446-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 3-months Treasury bill interest rate as a &#39;ts&#39; object</span></span>
<span id="cb446-26"><a href="#cb446-26" aria-hidden="true" tabindex="-1"></a>TB3MS <span class="ot">&lt;-</span> <span class="fu">ts</span>(USMacroSWQ<span class="sc">$</span>TB3MS,</span>
<span id="cb446-27"><a href="#cb446-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1957</span>, <span class="dv">1</span>), </span>
<span id="cb446-28"><a href="#cb446-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2013</span>, <span class="dv">4</span>), </span>
<span id="cb446-29"><a href="#cb446-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb446-30"><a href="#cb446-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-31"><a href="#cb446-31" aria-hidden="true" tabindex="-1"></a><span class="co"># 10-years Treasury bonds interest rate as a &#39;ts&#39; object</span></span>
<span id="cb446-32"><a href="#cb446-32" aria-hidden="true" tabindex="-1"></a>TB10YS <span class="ot">&lt;-</span> <span class="fu">ts</span>(USMacroSWQ<span class="sc">$</span>GS10, </span>
<span id="cb446-33"><a href="#cb446-33" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1957</span>, <span class="dv">1</span>), </span>
<span id="cb446-34"><a href="#cb446-34" aria-hidden="true" tabindex="-1"></a>              <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2013</span>, <span class="dv">4</span>), </span>
<span id="cb446-35"><a href="#cb446-35" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb446-36"><a href="#cb446-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-37"><a href="#cb446-37" aria-hidden="true" tabindex="-1"></a><span class="co"># generate the term spread series</span></span>
<span id="cb446-38"><a href="#cb446-38" aria-hidden="true" tabindex="-1"></a>TSpread <span class="ot">&lt;-</span> TB10YS <span class="sc">-</span> TB3MS</span></code></pre></div>
<p>We estimate both equations separately by OLS and use <tt>coeftest()</tt> to obtain robust standard errors.</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate both equations using &#39;dynlm()&#39;</span></span>
<span id="cb447-2"><a href="#cb447-2" aria-hidden="true" tabindex="-1"></a>VAR_EQ1 <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(GDPGrowth <span class="sc">~</span> <span class="fu">L</span>(GDPGrowth, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">L</span>(TSpread, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>), </span>
<span id="cb447-3"><a href="#cb447-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1981</span>, <span class="dv">1</span>), </span>
<span id="cb447-4"><a href="#cb447-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>))</span>
<span id="cb447-5"><a href="#cb447-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb447-6"><a href="#cb447-6" aria-hidden="true" tabindex="-1"></a>VAR_EQ2 <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(TSpread <span class="sc">~</span> <span class="fu">L</span>(GDPGrowth, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">L</span>(TSpread, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>),</span>
<span id="cb447-7"><a href="#cb447-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1981</span>, <span class="dv">1</span>),</span>
<span id="cb447-8"><a href="#cb447-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>))</span>
<span id="cb447-9"><a href="#cb447-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb447-10"><a href="#cb447-10" aria-hidden="true" tabindex="-1"></a><span class="co"># rename regressors for better readability</span></span>
<span id="cb447-11"><a href="#cb447-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(VAR_EQ1<span class="sc">$</span>coefficients) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Growth_t-1&quot;</span>, </span>
<span id="cb447-12"><a href="#cb447-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Growth_t-2&quot;</span>, <span class="st">&quot;TSpread_t-1&quot;</span>, <span class="st">&quot;TSpread_t-2&quot;</span>)</span>
<span id="cb447-13"><a href="#cb447-13" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(VAR_EQ2<span class="sc">$</span>coefficients) <span class="ot">&lt;-</span> <span class="fu">names</span>(VAR_EQ1<span class="sc">$</span>coefficients)</span>
<span id="cb447-14"><a href="#cb447-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb447-15"><a href="#cb447-15" aria-hidden="true" tabindex="-1"></a><span class="co"># robust coefficient summaries</span></span>
<span id="cb447-16"><a href="#cb447-16" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(VAR_EQ1, <span class="at">vcov. =</span> sandwich)</span>
<span id="cb447-17"><a href="#cb447-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb447-18"><a href="#cb447-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb447-19"><a href="#cb447-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb447-20"><a href="#cb447-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb447-21"><a href="#cb447-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Intercept    0.516344   0.524429  0.9846 0.3267616    </span></span>
<span id="cb447-22"><a href="#cb447-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Growth_t-1   0.289553   0.110827  2.6127 0.0101038 *  </span></span>
<span id="cb447-23"><a href="#cb447-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Growth_t-2   0.216392   0.085879  2.5197 0.0130255 *  </span></span>
<span id="cb447-24"><a href="#cb447-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; TSpread_t-1 -0.902549   0.358290 -2.5190 0.0130498 *  </span></span>
<span id="cb447-25"><a href="#cb447-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; TSpread_t-2  1.329831   0.392660  3.3867 0.0009503 ***</span></span>
<span id="cb447-26"><a href="#cb447-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb447-27"><a href="#cb447-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb447-28"><a href="#cb447-28" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(VAR_EQ2, <span class="at">vcov. =</span> sandwich)</span>
<span id="cb447-29"><a href="#cb447-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb447-30"><a href="#cb447-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb447-31"><a href="#cb447-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb447-32"><a href="#cb447-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb447-33"><a href="#cb447-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Intercept    0.4557740  0.1214227  3.7536 0.0002674 ***</span></span>
<span id="cb447-34"><a href="#cb447-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Growth_t-1   0.0099785  0.0218424  0.4568 0.6485920    </span></span>
<span id="cb447-35"><a href="#cb447-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Growth_t-2  -0.0572451  0.0264099 -2.1676 0.0321186 *  </span></span>
<span id="cb447-36"><a href="#cb447-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; TSpread_t-1  1.0582279  0.0983750 10.7571 &lt; 2.2e-16 ***</span></span>
<span id="cb447-37"><a href="#cb447-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; TSpread_t-2 -0.2191902  0.1086198 -2.0180 0.0457712 *  </span></span>
<span id="cb447-38"><a href="#cb447-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb447-39"><a href="#cb447-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>We end up with the following results:</p>
<p><span class="math display">\[\begin{align*}
GDPGR_t =&amp; \, \underset{(0.46)}{0.52} + \underset{(0.11)}{0.29} GDPGR_{t-1} + \underset{(0.09)}{0.22} GDPGR_{t-2} -\underset{(0.36)}{0.90} TSpread_{t-1} + \underset{(0.39)}{1.33} TSpread_{t-2} \\
TSpread_t =&amp; \, \underset{(0.12)}{0.46} + \underset{(0.02)}{0.01} GDPGR_{t-1} -\underset{(0.03)}{0.06} GDPGR_{t-2} + \underset{(0.10)}{1.06} TSpread_{t-1} -\underset{(0.11)}{0.22} TSpread_{t-2}
\end{align*}\]</span></p>
<p>The function <tt>VAR()</tt> can be used to obtain the same coefficient estimates as presented above since it applies OLS per equation, too.</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up data for estimation using `VAR()`</span></span>
<span id="cb448-2"><a href="#cb448-2" aria-hidden="true" tabindex="-1"></a>VAR_data <span class="ot">&lt;-</span> <span class="fu">window</span>(<span class="fu">ts.union</span>(GDPGrowth, TSpread), <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1980</span>, <span class="dv">3</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>))</span>
<span id="cb448-3"><a href="#cb448-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb448-4"><a href="#cb448-4" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate model coefficients using `VAR()`</span></span>
<span id="cb448-5"><a href="#cb448-5" aria-hidden="true" tabindex="-1"></a>VAR_est <span class="ot">&lt;-</span> <span class="fu">VAR</span>(<span class="at">y =</span> VAR_data, <span class="at">p =</span> <span class="dv">2</span>)</span>
<span id="cb448-6"><a href="#cb448-6" aria-hidden="true" tabindex="-1"></a>VAR_est</span>
<span id="cb448-7"><a href="#cb448-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb448-8"><a href="#cb448-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; VAR Estimation Results:</span></span>
<span id="cb448-9"><a href="#cb448-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ======================= </span></span>
<span id="cb448-10"><a href="#cb448-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb448-11"><a href="#cb448-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimated coefficients for equation GDPGrowth: </span></span>
<span id="cb448-12"><a href="#cb448-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ============================================== </span></span>
<span id="cb448-13"><a href="#cb448-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb448-14"><a href="#cb448-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GDPGrowth = GDPGrowth.l1 + TSpread.l1 + GDPGrowth.l2 + TSpread.l2 + const </span></span>
<span id="cb448-15"><a href="#cb448-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb448-16"><a href="#cb448-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GDPGrowth.l1   TSpread.l1 GDPGrowth.l2   TSpread.l2        const </span></span>
<span id="cb448-17"><a href="#cb448-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    0.2895533   -0.9025493    0.2163919    1.3298305    0.5163440 </span></span>
<span id="cb448-18"><a href="#cb448-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb448-19"><a href="#cb448-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb448-20"><a href="#cb448-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimated coefficients for equation TSpread: </span></span>
<span id="cb448-21"><a href="#cb448-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ============================================ </span></span>
<span id="cb448-22"><a href="#cb448-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb448-23"><a href="#cb448-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; TSpread = GDPGrowth.l1 + TSpread.l1 + GDPGrowth.l2 + TSpread.l2 + const </span></span>
<span id="cb448-24"><a href="#cb448-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb448-25"><a href="#cb448-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GDPGrowth.l1   TSpread.l1 GDPGrowth.l2   TSpread.l2        const </span></span>
<span id="cb448-26"><a href="#cb448-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0.009978489  1.058227945 -0.057245123 -0.219190243  0.455773969</span></span></code></pre></div>
<p><tt>VAR()</tt> returns a <tt>list</tt> of <tt>lm</tt> objects which can be passed to the usual functions, for example <tt>summary()</tt> and so it is straightforward to obtain model statistics for the individual equations.</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain the adj. R^2 from the output of &#39;VAR()&#39;</span></span>
<span id="cb449-2"><a href="#cb449-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(VAR_est<span class="sc">$</span>varresult<span class="sc">$</span>GDPGrowth)<span class="sc">$</span>adj.r.squared</span>
<span id="cb449-3"><a href="#cb449-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.2887223</span></span>
<span id="cb449-4"><a href="#cb449-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(VAR_est<span class="sc">$</span>varresult<span class="sc">$</span>TSpread)<span class="sc">$</span>adj.r.squared</span>
<span id="cb449-5"><a href="#cb449-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.8254311</span></span></code></pre></div>
<p>We may use the individual model objects to conduct Granger causality tests.</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="#cb450-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Granger causality tests:</span></span>
<span id="cb450-2"><a href="#cb450-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb450-3"><a href="#cb450-3" aria-hidden="true" tabindex="-1"></a><span class="co"># test if term spread has no power in explaining GDP growth</span></span>
<span id="cb450-4"><a href="#cb450-4" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(VAR_EQ1, </span>
<span id="cb450-5"><a href="#cb450-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">hypothesis.matrix =</span> <span class="fu">c</span>(<span class="st">&quot;TSpread_t-1&quot;</span>, <span class="st">&quot;TSpread_t-2&quot;</span>),</span>
<span id="cb450-6"><a href="#cb450-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> sandwich)</span>
<span id="cb450-7"><a href="#cb450-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb450-8"><a href="#cb450-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb450-9"><a href="#cb450-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb450-10"><a href="#cb450-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; TSpread_t-1</span></span>
<span id="cb450-11"><a href="#cb450-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; TSpread_t-2</span></span>
<span id="cb450-12"><a href="#cb450-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb450-13"><a href="#cb450-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb450-14"><a href="#cb450-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: GDPGrowth ~ L(GDPGrowth, 1:2) + L(TSpread, 1:2)</span></span>
<span id="cb450-15"><a href="#cb450-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb450-16"><a href="#cb450-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb450-17"><a href="#cb450-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb450-18"><a href="#cb450-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F   Pr(&gt;F)   </span></span>
<span id="cb450-19"><a href="#cb450-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    125                      </span></span>
<span id="cb450-20"><a href="#cb450-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    123  2 5.9094 0.003544 **</span></span>
<span id="cb450-21"><a href="#cb450-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb450-22"><a href="#cb450-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb450-23"><a href="#cb450-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb450-24"><a href="#cb450-24" aria-hidden="true" tabindex="-1"></a><span class="co"># test if GDP growth has no power in explaining term spread</span></span>
<span id="cb450-25"><a href="#cb450-25" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(VAR_EQ2, </span>
<span id="cb450-26"><a href="#cb450-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">hypothesis.matrix =</span> <span class="fu">c</span>(<span class="st">&quot;Growth_t-1&quot;</span>, <span class="st">&quot;Growth_t-2&quot;</span>),</span>
<span id="cb450-27"><a href="#cb450-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> sandwich)</span>
<span id="cb450-28"><a href="#cb450-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb450-29"><a href="#cb450-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb450-30"><a href="#cb450-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb450-31"><a href="#cb450-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Growth_t-1</span></span>
<span id="cb450-32"><a href="#cb450-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Growth_t-2</span></span>
<span id="cb450-33"><a href="#cb450-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb450-34"><a href="#cb450-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb450-35"><a href="#cb450-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: TSpread ~ L(GDPGrowth, 1:2) + L(TSpread, 1:2)</span></span>
<span id="cb450-36"><a href="#cb450-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb450-37"><a href="#cb450-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb450-38"><a href="#cb450-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb450-39"><a href="#cb450-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F  Pr(&gt;F)  </span></span>
<span id="cb450-40"><a href="#cb450-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    125                    </span></span>
<span id="cb450-41"><a href="#cb450-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    123  2 3.4777 0.03395 *</span></span>
<span id="cb450-42"><a href="#cb450-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb450-43"><a href="#cb450-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Both Granger causality tests reject at the level of <span class="math inline">\(5\%\)</span>. This is evidence in favor of the conjecture that the term spread has power in explaining GDP growth and vice versa.</p>
</div>
<div id="iterated-multivariate-forecasts-using-an-iterated-var" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Iterated Multivariate Forecasts using an Iterated VAR<a href="#iterated-multivariate-forecasts-using-an-iterated-var" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The idea of an iterated forecast for period <span class="math inline">\(T+2\)</span> based on observations up to period <span class="math inline">\(T\)</span> is to use the one-period-ahead forecast as an intermediate step. That is, the forecast for period <span class="math inline">\(T+1\)</span> is used as an observation when predicting the level of a series for period <span class="math inline">\(T+2\)</span>. This can be generalized to a <span class="math inline">\(h\)</span>-period-ahead forecast where all intervening periods between <span class="math inline">\(T\)</span> and <span class="math inline">\(T+h\)</span> must be forecasted as they are used as observations in the process (see Chapter 16.2 of the book for a more detailed argument on this concept). Iterated multiperiod forecasts are summarized in Key Concept 16.2.</p>
<div id="KC16.2" class="keyconcept">
<h3 class="right">
Key Concept <br> 16.2
</h3>
<h3 class="left">
Iterated Multiperiod Forecasts
</h3>
<p>
<p>The steps for an <em>iterated multiperiod AR forecast</em> are:</p>
<ol style="list-style-type: decimal">
<li><p>Estimate the AR(<span class="math inline">\(p\)</span>) model using OLS and compute the one-period-ahead forecast.</p></li>
<li><p>Use the one-period-ahead forecast to obtain the two-period-ahead forecast.</p></li>
<li><p>Continue by iterating to obtain forecasts farther into the future.</p></li>
</ol>
<p>An <em>iterated multiperiod VAR forecast</em> is done as follows:</p>
<ol style="list-style-type: decimal">
<li><p>Estimate the VAR(<span class="math inline">\(p\)</span>) model using OLS per equation and compute the one-period-ahead forecast for <em>all</em> variables in the VAR.</p></li>
<li><p>Use the one-period-ahead forecasts to obtain the two-period-ahead forecasts.</p></li>
<li><p>Continue by iterating to obtain forecasts of all variables in the VAR farther into the future.</p></li>
</ol>
</p>
</div>
<p>Since a VAR models all variables using lags of the respective other variables, we need to compute forecasts for <em>all</em> variables. It can be cumbersome to do so when the VAR is large but fortunately there are <tt>R</tt> functions that facilitate this. For example, the function <tt>predict()</tt> can be used to obtain iterated multivariate forecasts for VAR models estimated by the function <tt>VAR()</tt>.</p>
<p>The following code chunk shows how to compute iterated forecasts for GDP growth and the term spread up to period 2015:Q1, that is <span class="math inline">\(h=10\)</span>, using the model object <tt>VAR_est</tt>.</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute iterated forecasts for GDP growth and term spread for the next 10 quarters</span></span>
<span id="cb451-2"><a href="#cb451-2" aria-hidden="true" tabindex="-1"></a>forecasts <span class="ot">&lt;-</span> <span class="fu">predict</span>(VAR_est)</span>
<span id="cb451-3"><a href="#cb451-3" aria-hidden="true" tabindex="-1"></a>forecasts</span>
<span id="cb451-4"><a href="#cb451-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $GDPGrowth</span></span>
<span id="cb451-5"><a href="#cb451-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           fcst     lower    upper       CI</span></span>
<span id="cb451-6"><a href="#cb451-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 1.738653 -3.006124 6.483430 4.744777</span></span>
<span id="cb451-7"><a href="#cb451-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 1.692193 -3.312731 6.697118 5.004925</span></span>
<span id="cb451-8"><a href="#cb451-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 1.911852 -3.282880 7.106583 5.194731</span></span>
<span id="cb451-9"><a href="#cb451-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 2.137070 -3.164247 7.438386 5.301317</span></span>
<span id="cb451-10"><a href="#cb451-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 2.329667 -3.041435 7.700769 5.371102</span></span>
<span id="cb451-11"><a href="#cb451-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 2.496815 -2.931819 7.925449 5.428634</span></span>
<span id="cb451-12"><a href="#cb451-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 2.631849 -2.846390 8.110088 5.478239</span></span>
<span id="cb451-13"><a href="#cb451-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 2.734819 -2.785426 8.255064 5.520245</span></span>
<span id="cb451-14"><a href="#cb451-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 2.808291 -2.745597 8.362180 5.553889</span></span>
<span id="cb451-15"><a href="#cb451-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 2.856169 -2.722905 8.435243 5.579074</span></span>
<span id="cb451-16"><a href="#cb451-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb451-17"><a href="#cb451-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $TSpread</span></span>
<span id="cb451-18"><a href="#cb451-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           fcst        lower    upper        CI</span></span>
<span id="cb451-19"><a href="#cb451-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 1.676746  0.708471226 2.645021 0.9682751</span></span>
<span id="cb451-20"><a href="#cb451-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 1.884098  0.471880228 3.296316 1.4122179</span></span>
<span id="cb451-21"><a href="#cb451-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 1.999409  0.336348101 3.662470 1.6630609</span></span>
<span id="cb451-22"><a href="#cb451-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 2.080836  0.242407507 3.919265 1.8384285</span></span>
<span id="cb451-23"><a href="#cb451-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 2.131402  0.175797245 4.087008 1.9556052</span></span>
<span id="cb451-24"><a href="#cb451-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 2.156094  0.125220562 4.186968 2.0308738</span></span>
<span id="cb451-25"><a href="#cb451-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 2.161783  0.085037834 4.238528 2.0767452</span></span>
<span id="cb451-26"><a href="#cb451-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 2.154170  0.051061544 4.257278 2.1031082</span></span>
<span id="cb451-27"><a href="#cb451-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 2.138164  0.020749780 4.255578 2.1174139</span></span>
<span id="cb451-28"><a href="#cb451-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 2.117733 -0.007139213 4.242605 2.1248722</span></span></code></pre></div>
<p>This reveals that the two-quarter-ahead forecast of GDP growth in 2013:Q2 using data through 2012:Q4 is <span class="math inline">\(1.69\)</span>. For the same period, the iterated VAR forecast for the term spread is <span class="math inline">\(1.88\)</span>.</p>
<p>The matrices returned by <code>predict(VAR_est)</code> also include <span class="math inline">\(95\%\)</span> prediction intervals (however, the function does not adjust for autocorrelation or heteroskedasticity of the errors!).</p>
<p>We may also plot the iterated forecasts for both variables by calling <tt>plot()</tt> on the output of <code>predict(VAR_est)</code>.</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize the iterated forecasts</span></span>
<span id="cb452-2"><a href="#cb452-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(forecasts)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-720-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="direct-multiperiod-forecasts" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Direct Multiperiod Forecasts<a href="#direct-multiperiod-forecasts" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A direct multiperiod forecast uses a model where the predictors are lagged appropriately such that the available observations can be used <em>directly</em> to do the forecast. The idea of direct multiperiod forecasting is summarized in Key Concept 16.3.</p>
<div id="KC16.3" class="keyconcept">
<h3 class="right">
Key Concept <br> 16.3
</h3>
<h3 class="left">
Direct Multiperiod Forecasts
</h3>
<p>
<p>A <em>direct multiperiod forecast</em> that forecasts <span class="math inline">\(h\)</span> periods into the future using a model of <span class="math inline">\(Y_t\)</span> and an additional predictor <span class="math inline">\(X_t\)</span> with <span class="math inline">\(p\)</span> lags is done by first estimating</p>
<p><span class="math display">\[\begin{align*}
  Y_t =&amp; \, \delta_0 + \delta_1 Y_{t-h} + \dots + \delta_{p} Y_{t-p-h+1} + \delta_{p+1} X_{t-h} \\
  +&amp; \dots + \delta_{2p} Y_{t-p-h+1} + u_t,  
\end{align*}\]</span></p>
which is then used to compute the forecast of <span class="math inline">\(Y_{T+h}\)</span> based on observations through period <span class="math inline">\(T\)</span>.
</p>
</div>
<p>For example, to obtain two-quarter-ahead forecasts of GDP growth and the term spread we first estimate the equations</p>
<p><span class="math display">\[\begin{align*}
GDPGR_t =&amp; \, \beta_{10} + \beta_{11} GDPGR_{t-2} + \beta_{12} GDPGR_{t-3} + \gamma_{11} TSpread_{t-2} + \gamma_{12} TSpread_{t-3} + u_{1t}, \\
TSpread_t =&amp; \, \beta_{20} + \beta_{21} GDPGR_{t-2} + \beta_{22} GDPGR_{t-3} + \gamma_{21} TSpread_{t-2} + \gamma_{22} TSpread_{t-3} + u_{2t}
\end{align*}\]</span></p>
<p>and then substitute the values of <span class="math inline">\(GDPGR_{2012:Q4}\)</span>, <span class="math inline">\(GDPGR_{2012:Q3}\)</span>, <span class="math inline">\(TSpread_{2012:Q4}\)</span> and <span class="math inline">\(TSpread_{2012:Q3}\)</span> into both equations. This is easily done manually.</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="#cb453-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate models for direct two-quarter-ahead forecasts</span></span>
<span id="cb453-2"><a href="#cb453-2" aria-hidden="true" tabindex="-1"></a>VAR_EQ1_direct <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(GDPGrowth <span class="sc">~</span> <span class="fu">L</span>(GDPGrowth, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">L</span>(TSpread, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>), </span>
<span id="cb453-3"><a href="#cb453-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1981</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>))</span>
<span id="cb453-4"><a href="#cb453-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb453-5"><a href="#cb453-5" aria-hidden="true" tabindex="-1"></a>VAR_EQ2_direct <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(TSpread <span class="sc">~</span> <span class="fu">L</span>(GDPGrowth, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">L</span>(TSpread, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>), </span>
<span id="cb453-6"><a href="#cb453-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1981</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>))</span>
<span id="cb453-7"><a href="#cb453-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb453-8"><a href="#cb453-8" aria-hidden="true" tabindex="-1"></a><span class="co"># compute direct two-quarter-ahead forecasts</span></span>
<span id="cb453-9"><a href="#cb453-9" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(VAR_EQ1_direct) <span class="sc">%*%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="co"># intercept</span></span>
<span id="cb453-10"><a href="#cb453-10" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">window</span>(GDPGrowth, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">3</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>)), </span>
<span id="cb453-11"><a href="#cb453-11" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">window</span>(TSpread, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">3</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>)))</span>
<span id="cb453-12"><a href="#cb453-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          [,1]</span></span>
<span id="cb453-13"><a href="#cb453-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 2.439497</span></span>
<span id="cb453-14"><a href="#cb453-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb453-15"><a href="#cb453-15" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(VAR_EQ2_direct) <span class="sc">%*%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="co"># intercept</span></span>
<span id="cb453-16"><a href="#cb453-16" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">window</span>(GDPGrowth, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">3</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>)), </span>
<span id="cb453-17"><a href="#cb453-17" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">window</span>(TSpread, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">3</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>)))</span>
<span id="cb453-18"><a href="#cb453-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         [,1]</span></span>
<span id="cb453-19"><a href="#cb453-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 1.66578</span></span></code></pre></div>
<p>Applied economists often use the iterated method since this forecasts are more reliable in terms of <span class="math inline">\(MSFE\)</span>, provided that the one-period-ahead model is correctly specified. If this is not the case, for example because one equation in a VAR is believed to be misspecified, it can be beneficial to use direct forecasts since the iterated method will then be biased and thus have a higher <span class="math inline">\(MSFE\)</span> than the direct method. See Chapter @ref(ooiatdfglsurt) for a more detailed discussion on advantages and disadvantages of both methods.</p>
</div>
</div>
<div id="ooiatdfglsurt" class="section level2 hasAnchor" number="16.2">
<h2 class="hasAnchor"><span class="header-section-number">16.2</span> Orders of Integration and the DF-GLS Unit Root Test<a href="#ooiatdfglsurt" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Some economic time series have smoother trends than variables that can be described by random walk models. A way to model these time series is <span class="math display">\[\Delta Y_t = \beta_0 + \Delta Y_{t-1} + u_t,\]</span> where <span class="math inline">\(u_t\)</span> is a serially uncorrelated error term. This model states that the first difference of a series is a random walk. Consequently, the series of second differences of <span class="math inline">\(Y_t\)</span> is stationary. Key Concept 16.4 summarizes the notation.</p>
<div id="KC16.4" class="keyconcept">
<h3 class="right">
Key Concept <br> 16.4
</h3>
<h3 class="left">
Orders of Integration, Differencing and Stationarity
</h3>
<p>
<ul>
<li><p>When a time series <span class="math inline">\(Y_t\)</span> has a unit autoregressive root, <span class="math inline">\(Y_t\)</span> is integrated of order one. This is often denoted by <span class="math inline">\(Y_t \sim I(1)\)</span>. We simply say that <span class="math inline">\(Y_t\)</span> is <span class="math inline">\(I(1)\)</span>. If <span class="math inline">\(Y_t\)</span> is <span class="math inline">\(I(1)\)</span>, its first difference <span class="math inline">\(\Delta Y_t\)</span> is stationary.</p></li>
<li><p><span class="math inline">\(Y_t\)</span> is <span class="math inline">\(I(2)\)</span> when <span class="math inline">\(Y_t\)</span> needs to be differenced twice in order to obtain a stationary series. Using the notation introduced here, if <span class="math inline">\(Y_t\)</span> is <span class="math inline">\(I(2)\)</span>, its first difference <span class="math inline">\(\Delta Y_t\)</span> is <span class="math inline">\(I(1)\)</span> and its second difference <span class="math inline">\(\Delta^2 Y_t\)</span> is stationary. <span class="math inline">\(Y_t\)</span> is <span class="math inline">\(I(d)\)</span> when <span class="math inline">\(Y_t\)</span> must be differenced <span class="math inline">\(d\)</span> times to obtain a stationary series.</p></li>
<li><p>When <span class="math inline">\(Y_t\)</span> is stationary, it is integrated of order <span class="math inline">\(0\)</span> so <span class="math inline">\(Y_t\)</span> is <span class="math inline">\(I(0)\)</span>.</p></li>
</ul>
<p>It is fairly easy to obtain differences of time series in <tt>R</tt>. For example, the function <tt>diff()</tt> returns suitably lagged and iterated differences of numeric vectors, matrices and time series objects of the class <tt>ts</tt>.</p>
</p>
</div>
<p>Following the book, we take the price level of the U.S. measured by the <em>Personal Consumption Expenditures Price Index</em> as an example.</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define ts object of the U.S. PCE Price Index</span></span>
<span id="cb454-2"><a href="#cb454-2" aria-hidden="true" tabindex="-1"></a>PCECTPI <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">log</span>(USMacroSWQ<span class="sc">$</span>PCECTPI), </span>
<span id="cb454-3"><a href="#cb454-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1957</span>, <span class="dv">1</span>), </span>
<span id="cb454-4"><a href="#cb454-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>), </span>
<span id="cb454-5"><a href="#cb454-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">freq =</span> <span class="dv">4</span>)</span>
<span id="cb454-6"><a href="#cb454-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-7"><a href="#cb454-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot logarithm of the PCE Price Index</span></span>
<span id="cb454-8"><a href="#cb454-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(PCECTPI,</span>
<span id="cb454-9"><a href="#cb454-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Log of United States PCE Price Index&quot;</span>,</span>
<span id="cb454-10"><a href="#cb454-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Logarithm&quot;</span>,</span>
<span id="cb454-11"><a href="#cb454-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb454-12"><a href="#cb454-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-726-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The logarithm of the price level has a smoothly varying trend. This is typical for an <span class="math inline">\(I(2)\)</span> series. If the price level is indeed <span class="math inline">\(I(2)\)</span>, the first differences of this series should be <span class="math inline">\(I(1)\)</span>. Since we are considering the logarithm of the price level, we obtain growth rates by taking first differences. Therefore, the differenced price level series is the series of quarterly inflation rates. This is quickly done in <tt>R</tt> using the function <tt>diff()</tt> from the package <tt>base</tt>. As explained in Chapter @ref(tsdasc), multiplying the quarterly inflation rates by <span class="math inline">\(400\)</span> yields the quarterly rate of inflation, measured in percentage points at an annual rate.</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="#cb455-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot U.S. Inflation Rate</span></span>
<span id="cb455-2"><a href="#cb455-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">400</span> <span class="sc">*</span> <span class="fu">diff</span>(PCECTPI),</span>
<span id="cb455-3"><a href="#cb455-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;United States Inflation Rate&quot;</span>,</span>
<span id="cb455-4"><a href="#cb455-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Percent per annum&quot;</span>,</span>
<span id="cb455-5"><a href="#cb455-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb455-6"><a href="#cb455-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb455-7"><a href="#cb455-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-8"><a href="#cb455-8" aria-hidden="true" tabindex="-1"></a><span class="co"># add a dashed line at y =  0 </span></span>
<span id="cb455-9"><a href="#cb455-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-727-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The inflation rate behaves much more erratically than the smooth graph of the logarithm of the PCE price index.</p>
<div id="the-df-gls-test-for-a-unit-root" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">The DF-GLS Test for a Unit Root<a href="#the-df-gls-test-for-a-unit-root" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The DF-GLS test for a unit root has been developed by <span class="citation">Elliott, Rothenberg, and Stock (<a href="#ref-elliott1996" role="doc-biblioref">1996</a>)</span> and has higher power than the ADF test when the autoregressive root is large but less than one. That is, the DF-GLS has a higher probability of rejecting the false null of a stochastic trend when the sample data stems from a time series that is close to being integrated.</p>
<p>The idea of the DF-GLS test is to test for an autoregressive unit root in the detrended series, whereby GLS estimates of the deterministic components are used to obtain the detrended version of the original series. See Chapter 16.3 of the book for a more detailed explanation of the approach.</p>
<p>A function that performs the DF-GLS test is implemented in the package <tt>urca</tt> (this package is a dependency of the package <tt>vars</tt> so it should be already loaded if <tt>vars</tt> is attached). The function that computes the test statistic is <tt>ur.ers</tt>.</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DF-GLS test for unit root in GDP</span></span>
<span id="cb456-2"><a href="#cb456-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">ur.ers</span>(<span class="fu">log</span>(<span class="fu">window</span>(GDP, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>))),</span>
<span id="cb456-3"><a href="#cb456-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">model =</span> <span class="st">&quot;trend&quot;</span>, </span>
<span id="cb456-4"><a href="#cb456-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">lag.max =</span> <span class="dv">2</span>))</span>
<span id="cb456-5"><a href="#cb456-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb456-6"><a href="#cb456-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ############################################### </span></span>
<span id="cb456-7"><a href="#cb456-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Elliot, Rothenberg and Stock Unit Root Test # </span></span>
<span id="cb456-8"><a href="#cb456-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ############################################### </span></span>
<span id="cb456-9"><a href="#cb456-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb456-10"><a href="#cb456-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test of type DF-GLS </span></span>
<span id="cb456-11"><a href="#cb456-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; detrending of series with intercept and trend </span></span>
<span id="cb456-12"><a href="#cb456-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb456-13"><a href="#cb456-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb456-14"><a href="#cb456-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb456-15"><a href="#cb456-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = dfgls.form, data = data.dfgls)</span></span>
<span id="cb456-16"><a href="#cb456-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb456-17"><a href="#cb456-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb456-18"><a href="#cb456-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Min        1Q    Median        3Q       Max </span></span>
<span id="cb456-19"><a href="#cb456-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -0.025739 -0.004054  0.000017  0.004619  0.033620 </span></span>
<span id="cb456-20"><a href="#cb456-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb456-21"><a href="#cb456-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb456-22"><a href="#cb456-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb456-23"><a href="#cb456-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; yd.lag       -0.01213    0.01012  -1.199  0.23207    </span></span>
<span id="cb456-24"><a href="#cb456-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; yd.diff.lag1  0.28583    0.07002   4.082 6.47e-05 ***</span></span>
<span id="cb456-25"><a href="#cb456-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; yd.diff.lag2  0.19320    0.07058   2.737  0.00676 ** </span></span>
<span id="cb456-26"><a href="#cb456-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb456-27"><a href="#cb456-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb456-28"><a href="#cb456-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb456-29"><a href="#cb456-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.007807 on 198 degrees of freedom</span></span>
<span id="cb456-30"><a href="#cb456-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.1504, Adjusted R-squared:  0.1376 </span></span>
<span id="cb456-31"><a href="#cb456-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 11.69 on 3 and 198 DF,  p-value: 4.392e-07</span></span>
<span id="cb456-32"><a href="#cb456-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb456-33"><a href="#cb456-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb456-34"><a href="#cb456-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Value of test-statistic is: -1.1987 </span></span>
<span id="cb456-35"><a href="#cb456-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb456-36"><a href="#cb456-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Critical values of DF-GLS are:</span></span>
<span id="cb456-37"><a href="#cb456-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  1pct  5pct 10pct</span></span>
<span id="cb456-38"><a href="#cb456-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; critical values -3.48 -2.89 -2.57</span></span></code></pre></div>
<p>The summary of the test shows that the test statistic is about <span class="math inline">\(-1.2\)</span>. The <span class="math inline">\(10\%\)</span> critical value for the DF-GLS test is <span class="math inline">\(-2.57\)</span>. This is, however, <strong>not</strong> the appropriate critical value for the ADF test when an intercept and a time trend are included in the Dickey-Fuller regression: the asymptotic distributions of both test statistics differ and so do their critical values!</p>
<p>The test is left-sided so we cannot reject the null hypothesis that U.S. inflation is nonstationary, using the DF-GLS test.</p>
</div>
</div>
<div id="cointegration" class="section level2 hasAnchor" number="16.3">
<h2 class="hasAnchor"><span class="header-section-number">16.3</span> Cointegration<a href="#cointegration" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="KC16.5" class="keyconcept">
<h3 class="right">
Key Concept <br> 16.5
</h3>
<h3 class="left">
Cointegration
</h3>
<p>
<p>When <span class="math inline">\(X_t\)</span> and <span class="math inline">\(Y_t\)</span> are <span class="math inline">\(I(1)\)</span> and if there is a <span class="math inline">\(\theta\)</span> such that <span class="math inline">\(Y_t - \theta X_t\)</span> is <span class="math inline">\(I(0)\)</span>, <span class="math inline">\(X_t\)</span> and <span class="math inline">\(Y_t\)</span> are cointegrated. Put differently, cointegration of <span class="math inline">\(X_t\)</span> and <span class="math inline">\(Y_t\)</span> means that <span class="math inline">\(X_t\)</span> and <span class="math inline">\(Y_t\)</span> have the same or a common stochastic trend and that this trend can be eliminated by taking a specific difference of the series such that the resulting series is stationary.</p>
<p><tt>R</tt> functions for cointegration analysis are implemented in the package <tt>urca</tt>.</p>
</p>
</div>
<p>As an example, reconsider the relation between short- and long-term interest rates by the example of U.S. 3-month treasury bills, U.S. 10-years treasury bonds and the spread in their interest rates which have been introduced in Chapter @ref(cybtmpi). The next code chunk shows how to reproduce Figure 16.2 of the book.</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="#cb457-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reproduce Figure 16.2 of the book</span></span>
<span id="cb457-2"><a href="#cb457-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb457-3"><a href="#cb457-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot both interest series</span></span>
<span id="cb457-4"><a href="#cb457-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">merge</span>(<span class="fu">as.zoo</span>(TB3MS), <span class="fu">as.zoo</span>(TB10YS)), </span>
<span id="cb457-5"><a href="#cb457-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">plot.type =</span> <span class="st">&quot;single&quot;</span>, </span>
<span id="cb457-6"><a href="#cb457-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb457-7"><a href="#cb457-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb457-8"><a href="#cb457-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb457-9"><a href="#cb457-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Percent per annum&quot;</span>,</span>
<span id="cb457-10"><a href="#cb457-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">17</span>),</span>
<span id="cb457-11"><a href="#cb457-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Interest Rates&quot;</span>)</span>
<span id="cb457-12"><a href="#cb457-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb457-13"><a href="#cb457-13" aria-hidden="true" tabindex="-1"></a><span class="co"># add the term spread series</span></span>
<span id="cb457-14"><a href="#cb457-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">as.zoo</span>(TSpread), </span>
<span id="cb457-15"><a href="#cb457-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb457-16"><a href="#cb457-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb457-17"><a href="#cb457-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb457-18"><a href="#cb457-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Percent per annum&quot;</span>,</span>
<span id="cb457-19"><a href="#cb457-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Term Spread&quot;</span>)</span>
<span id="cb457-20"><a href="#cb457-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb457-21"><a href="#cb457-21" aria-hidden="true" tabindex="-1"></a><span class="co"># shade the term spread</span></span>
<span id="cb457-22"><a href="#cb457-22" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(<span class="fu">time</span>(TB3MS), <span class="fu">rev</span>(<span class="fu">time</span>(TB3MS))), </span>
<span id="cb457-23"><a href="#cb457-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(TB10YS, <span class="fu">rev</span>(TB3MS)),</span>
<span id="cb457-24"><a href="#cb457-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">&quot;steelblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb457-25"><a href="#cb457-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb457-26"><a href="#cb457-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb457-27"><a href="#cb457-27" aria-hidden="true" tabindex="-1"></a><span class="co"># add horizontal line at 0</span></span>
<span id="cb457-28"><a href="#cb457-28" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb457-29"><a href="#cb457-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb457-30"><a href="#cb457-30" aria-hidden="true" tabindex="-1"></a><span class="co"># add a legend</span></span>
<span id="cb457-31"><a href="#cb457-31" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, </span>
<span id="cb457-32"><a href="#cb457-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;TB3MS&quot;</span>, <span class="st">&quot;TB10YS&quot;</span>, <span class="st">&quot;Term Spread&quot;</span>),</span>
<span id="cb457-33"><a href="#cb457-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;steelblue&quot;</span>),</span>
<span id="cb457-34"><a href="#cb457-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb457-35"><a href="#cb457-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-731-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The plot suggests that long-term and short-term interest rates are cointegrated: both interest series seem to have the same long-run behavior. They share a common stochastic trend. The term spread, which is obtained by taking the difference between long-term and short-term interest rates, seems to be stationary. In fact, the expectations theory of the term structure suggests the cointegrating coefficient <span class="math inline">\(\theta\)</span> to be 1. This is consistent with the visual result.</p>
<div id="testing-for-cointegration" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Testing for Cointegration<a href="#testing-for-cointegration" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Following Key Concept 16.5, it seems natural to construct a test for cointegration of two series in the following manner: if two series <span class="math inline">\(X_t\)</span> and <span class="math inline">\(Y_t\)</span> are cointegrated, the series obtained by taking the difference <span class="math inline">\(Y_t - \theta X_t\)</span> must be stationary. If the series are not cointegrated, <span class="math inline">\(Y_t - \theta X_t\)</span> is nonstationary. This is an assumption that can be tested using a unit root test. We have to distinguish between two cases:</p>
<ol style="list-style-type: decimal">
<li><p><strong><span class="math inline">\(\theta\)</span> is known.</strong></p>
<p>Knowledge of <span class="math inline">\(\theta\)</span> enables us to compute differences <span class="math inline">\(z_t = Y_t - \theta X_t\)</span> so that Dickey-Fuller and DF-GLS unit root tests can be applied to <span class="math inline">\(z_t\)</span>. For these tests, the critical values are the critical values of the ADF or DF-GLS test.</p></li>
<li><p><strong><span class="math inline">\(\theta\)</span> is unknown.</strong></p>
<p>If <span class="math inline">\(\theta\)</span> is unknown, it must be estimated before the unit root test can be applied. This is done by estimating the regression <span class="math display">\[Y_t = \alpha + \theta X_t + z_t\]</span> using OLS (this is refered to as the first-stage regression). Then, a Dickey-Fuller test is used for testing the hypothesis that <span class="math inline">\(z_t\)</span> is a nonstationary series. This is known as the Engle-Granger Augmented Dickey-Fuller test for cointegration (or <em>EG-ADF test</em>) after <span class="citation">Engle and Granger (<a href="#ref-engle1987" role="doc-biblioref">1987</a>)</span>. The critical values for this test are special as the associated null distribution is nonnormal and depends on the number of <span class="math inline">\(I(1)\)</span> variables used as regressors in the first stage regression. You may look them up in Table 16.2 of the book. When there are only two presumably cointegrated variables (and thus a single <span class="math inline">\(I(1)\)</span> variable is used in the first stage OLS regression) the critical values for the levels <span class="math inline">\(10\%\)</span>, <span class="math inline">\(5\%\)</span> and <span class="math inline">\(1\%\)</span> are <span class="math inline">\(-3.12\)</span>, <span class="math inline">\(-3.41\)</span> and <span class="math inline">\(-3.96\)</span>.</p></li>
</ol>
</div>
<div id="application-to-interest-rates" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Application to Interest Rates<a href="#application-to-interest-rates" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As has been mentioned above, the theory of the term structure suggests that long-term and short-term interest rates are cointegrated with a cointegration coefficient of <span class="math inline">\(\theta = 1\)</span>. In the previous section we have seen that there is visual evidence for this conjecture since the spread of 10-year and 3-month interest rates looks stationary.</p>
<p>We continue by using formal tests (the ADF and the DF-GLS test) to see whether the individual interest rate series are integrated and if their difference is stationary (for now, we assume that <span class="math inline">\(\theta = 1\)</span> is known). Both is conveniently done by using the functions <tt>ur.df()</tt> for computation of the ADF test and <tt>ur.ers</tt> for conducting the DF-GLS test. Following the book we use data from 1962:Q1 to 2012:Q4 and employ models that include a drift term. We set the maximum lag order to <span class="math inline">\(6\)</span> and use the <span class="math inline">\(AIC\)</span> for selection of the optimal lag length.</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test for nonstationarity of 3-month treasury bills using ADF test</span></span>
<span id="cb458-2"><a href="#cb458-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ur.df</span>(<span class="fu">window</span>(TB3MS, <span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>)), </span>
<span id="cb458-3"><a href="#cb458-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">lags =</span> <span class="dv">6</span>, </span>
<span id="cb458-4"><a href="#cb458-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">selectlags =</span> <span class="st">&quot;AIC&quot;</span>, </span>
<span id="cb458-5"><a href="#cb458-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">&quot;drift&quot;</span>)</span>
<span id="cb458-6"><a href="#cb458-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb458-7"><a href="#cb458-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ############################################################### </span></span>
<span id="cb458-8"><a href="#cb458-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Augmented Dickey-Fuller Test Unit Root / Cointegration Test # </span></span>
<span id="cb458-9"><a href="#cb458-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ############################################################### </span></span>
<span id="cb458-10"><a href="#cb458-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb458-11"><a href="#cb458-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The value of the test statistic is: -2.1004 2.2385</span></span>
<span id="cb458-12"><a href="#cb458-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-13"><a href="#cb458-13" aria-hidden="true" tabindex="-1"></a><span class="co"># test for nonstationarity of 10-years treasury bonds using ADF test</span></span>
<span id="cb458-14"><a href="#cb458-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ur.df</span>(<span class="fu">window</span>(TB10YS, <span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>)), </span>
<span id="cb458-15"><a href="#cb458-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">lags =</span> <span class="dv">6</span>, </span>
<span id="cb458-16"><a href="#cb458-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">selectlags =</span> <span class="st">&quot;AIC&quot;</span>, </span>
<span id="cb458-17"><a href="#cb458-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">&quot;drift&quot;</span>)</span>
<span id="cb458-18"><a href="#cb458-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb458-19"><a href="#cb458-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ############################################################### </span></span>
<span id="cb458-20"><a href="#cb458-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Augmented Dickey-Fuller Test Unit Root / Cointegration Test # </span></span>
<span id="cb458-21"><a href="#cb458-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ############################################################### </span></span>
<span id="cb458-22"><a href="#cb458-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb458-23"><a href="#cb458-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The value of the test statistic is: -1.0079 0.5501</span></span>
<span id="cb458-24"><a href="#cb458-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-25"><a href="#cb458-25" aria-hidden="true" tabindex="-1"></a><span class="co"># test for nonstationarity of 3-month treasury bills using DF-GLS test</span></span>
<span id="cb458-26"><a href="#cb458-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ur.ers</span>(<span class="fu">window</span>(TB3MS, <span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>)),</span>
<span id="cb458-27"><a href="#cb458-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">model =</span> <span class="st">&quot;constant&quot;</span>, </span>
<span id="cb458-28"><a href="#cb458-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">lag.max =</span> <span class="dv">6</span>)</span>
<span id="cb458-29"><a href="#cb458-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb458-30"><a href="#cb458-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ############################################################### </span></span>
<span id="cb458-31"><a href="#cb458-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Elliot, Rothenberg and Stock Unit Root / Cointegration Test # </span></span>
<span id="cb458-32"><a href="#cb458-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ############################################################### </span></span>
<span id="cb458-33"><a href="#cb458-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb458-34"><a href="#cb458-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The value of the test statistic is: -1.8042</span></span>
<span id="cb458-35"><a href="#cb458-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-36"><a href="#cb458-36" aria-hidden="true" tabindex="-1"></a><span class="co"># test for nonstationarity of 10-years treasury bonds using DF-GLS test</span></span>
<span id="cb458-37"><a href="#cb458-37" aria-hidden="true" tabindex="-1"></a><span class="fu">ur.ers</span>(<span class="fu">window</span>(TB10YS, <span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>)),</span>
<span id="cb458-38"><a href="#cb458-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">model =</span> <span class="st">&quot;constant&quot;</span>, </span>
<span id="cb458-39"><a href="#cb458-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">lag.max =</span> <span class="dv">6</span>)</span>
<span id="cb458-40"><a href="#cb458-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb458-41"><a href="#cb458-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ############################################################### </span></span>
<span id="cb458-42"><a href="#cb458-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Elliot, Rothenberg and Stock Unit Root / Cointegration Test # </span></span>
<span id="cb458-43"><a href="#cb458-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ############################################################### </span></span>
<span id="cb458-44"><a href="#cb458-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb458-45"><a href="#cb458-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The value of the test statistic is: -0.942</span></span></code></pre></div>
<p>The corresponding <span class="math inline">\(10\%\)</span> critical value for both tests is <span class="math inline">\(-2.57\)</span> so we cannot reject the null hypotheses of nonstationary for either series, even at the <span class="math inline">\(10\%\)</span> level of significance.<a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a> We conclude that it is plausible to model both interest rate series as <span class="math inline">\(I(1)\)</span>.</p>
<p>Next, we apply the ADF and the DF-GLS test to test for nonstationarity of the term spread series, which means we test for non-cointegration of long- and short-term interest rates.</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="#cb459-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test if term spread is stationary (cointegration of interest rates) using ADF</span></span>
<span id="cb459-2"><a href="#cb459-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ur.df</span>(<span class="fu">window</span>(TB10YS, <span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>)) <span class="sc">-</span> <span class="fu">window</span>(TB3MS, <span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2012</span> ,<span class="dv">4</span>)), </span>
<span id="cb459-3"><a href="#cb459-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">lags =</span> <span class="dv">6</span>, </span>
<span id="cb459-4"><a href="#cb459-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">selectlags =</span> <span class="st">&quot;AIC&quot;</span>, </span>
<span id="cb459-5"><a href="#cb459-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">&quot;drift&quot;</span>)</span>
<span id="cb459-6"><a href="#cb459-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb459-7"><a href="#cb459-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ############################################################### </span></span>
<span id="cb459-8"><a href="#cb459-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Augmented Dickey-Fuller Test Unit Root / Cointegration Test # </span></span>
<span id="cb459-9"><a href="#cb459-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ############################################################### </span></span>
<span id="cb459-10"><a href="#cb459-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb459-11"><a href="#cb459-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The value of the test statistic is: -3.9308 7.7362</span></span>
<span id="cb459-12"><a href="#cb459-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb459-13"><a href="#cb459-13" aria-hidden="true" tabindex="-1"></a><span class="co"># test if term spread is stationary (cointegration of interest rates) using DF-GLS test</span></span>
<span id="cb459-14"><a href="#cb459-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ur.ers</span>(<span class="fu">window</span>(TB10YS, <span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>)) <span class="sc">-</span> <span class="fu">window</span>(TB3MS, <span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>)),</span>
<span id="cb459-15"><a href="#cb459-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">model =</span> <span class="st">&quot;constant&quot;</span>, </span>
<span id="cb459-16"><a href="#cb459-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">lag.max =</span> <span class="dv">6</span>)</span>
<span id="cb459-17"><a href="#cb459-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb459-18"><a href="#cb459-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ############################################################### </span></span>
<span id="cb459-19"><a href="#cb459-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Elliot, Rothenberg and Stock Unit Root / Cointegration Test # </span></span>
<span id="cb459-20"><a href="#cb459-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ############################################################### </span></span>
<span id="cb459-21"><a href="#cb459-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb459-22"><a href="#cb459-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The value of the test statistic is: -3.8576</span></span></code></pre></div>
<p>Table @ref(tab:spreadcoint) summarizes the results.</p>
<table>
<caption>(#tab:spreadcoint) ADF and DF-GLS Test Statistics for Interest Rate Series</caption>
<colgroup>
<col width="41%" />
<col width="27%" />
<col width="31%" />
</colgroup>
<thead>
<tr class="header">
<th>Series</th>
<th align="center">ADF Test Statistic</th>
<th align="center">DF-GLS Test Statistic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>TB3MS</td>
<td align="center"><span class="math inline">\(-2.10\)</span></td>
<td align="center"><span class="math inline">\(-1.80\)</span></td>
</tr>
<tr class="even">
<td>TB10YS</td>
<td align="center"><span class="math inline">\(-1.01\)</span></td>
<td align="center"><span class="math inline">\(-0.94\)</span></td>
</tr>
<tr class="odd">
<td>TB10YS - TB3MS</td>
<td align="center"><span class="math inline">\(-3.93\)</span></td>
<td align="center"><span class="math inline">\(-3.86\)</span></td>
</tr>
</tbody>
</table>
<p>Both tests reject the hypothesis of nonstationarity of the term spread series at the <span class="math inline">\(1\%\)</span> level of significance, which is strong evidence in favor of the hypothesis that the term spread is stationary, implying cointegration of long- and short-term interest rates.</p>
<p>Since theory suggests that <span class="math inline">\(\theta=1\)</span>, there is no need to estimate <span class="math inline">\(\theta\)</span> so it is not necessary to use the EG-ADF test which allows <span class="math inline">\(\theta\)</span> to be unknown. However, since it is instructive to do so, we follow the book and compute this test statistic. The first-stage OLS regression is <span class="math display">\[TB10YS_t = \beta_0 + \beta_1 TB3MS_t + z_t.\]</span></p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate first-stage regression of EG-ADF test</span></span>
<span id="cb460-2"><a href="#cb460-2" aria-hidden="true" tabindex="-1"></a>FS_EGADF <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(<span class="fu">window</span>(TB10YS, <span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>)) <span class="sc">~</span> <span class="fu">window</span>(TB3MS, <span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>)))</span>
<span id="cb460-3"><a href="#cb460-3" aria-hidden="true" tabindex="-1"></a>FS_EGADF</span>
<span id="cb460-4"><a href="#cb460-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb460-5"><a href="#cb460-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time series regression with &quot;ts&quot; data:</span></span>
<span id="cb460-6"><a href="#cb460-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Start = 1962(1), End = 2012(4)</span></span>
<span id="cb460-7"><a href="#cb460-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb460-8"><a href="#cb460-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb460-9"><a href="#cb460-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dynlm(formula = window(TB10YS, c(1962, 1), c(2012, 4)) ~ window(TB3MS, </span></span>
<span id="cb460-10"><a href="#cb460-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     c(1962, 1), c(2012, 4)))</span></span>
<span id="cb460-11"><a href="#cb460-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb460-12"><a href="#cb460-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb460-13"><a href="#cb460-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                           (Intercept)  window(TB3MS, c(1962, 1), c(2012, 4))  </span></span>
<span id="cb460-14"><a href="#cb460-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                2.4642                                 0.8147</span></span></code></pre></div>
<p>Thus we have
<span class="math display">\[\begin{align*}
  \widehat{TB10YS}_t = 2.46 + 0.81 \cdot TB3MS_t,
\end{align*}\]</span>
where <span class="math inline">\(\widehat{\theta} = 0.81\)</span>. Next, we take the residual series <span class="math inline">\(\{\widehat{z_t}\}\)</span> and compute the ADF test statistic.</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="#cb461-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the residuals</span></span>
<span id="cb461-2"><a href="#cb461-2" aria-hidden="true" tabindex="-1"></a>z_hat <span class="ot">&lt;-</span> <span class="fu">resid</span>(FS_EGADF)</span>
<span id="cb461-3"><a href="#cb461-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb461-4"><a href="#cb461-4" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the ADF test statistic</span></span>
<span id="cb461-5"><a href="#cb461-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ur.df</span>(z_hat, <span class="at">lags =</span> <span class="dv">6</span>, <span class="at">type =</span> <span class="st">&quot;none&quot;</span>, <span class="at">selectlags =</span> <span class="st">&quot;AIC&quot;</span>)</span>
<span id="cb461-6"><a href="#cb461-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb461-7"><a href="#cb461-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ############################################################### </span></span>
<span id="cb461-8"><a href="#cb461-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Augmented Dickey-Fuller Test Unit Root / Cointegration Test # </span></span>
<span id="cb461-9"><a href="#cb461-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ############################################################### </span></span>
<span id="cb461-10"><a href="#cb461-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb461-11"><a href="#cb461-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The value of the test statistic is: -3.1935</span></span></code></pre></div>
<p>The test statistic is <span class="math inline">\(-3.19\)</span> which is smaller than the <span class="math inline">\(10\%\)</span> critical value but larger than the <span class="math inline">\(5\%\)</span> critical value (see Table 16.2 of the book). Thus, the null hypothesis of no cointegration can be rejected at the <span class="math inline">\(10\%\)</span> level but not at the <span class="math inline">\(5\%\)</span> level. This indicates lower power of the EG-ADF test due to the estimation of <span class="math inline">\(\theta\)</span>: when <span class="math inline">\(\theta=1\)</span> is the correct value, we expect the power of the ADF test for a unit root in the residuals series <span class="math inline">\(\widehat{z} = TB10YS - TB3MS\)</span> to be higher than when some estimate <span class="math inline">\(\widehat{\theta}\)</span> is used.</p>
<div id="a-vector-error-correction-model-for-tb10ys_t-and-tb3ms" class="section level5 unnumbered hasAnchor">
<h5 class="unnumbered hasAnchor">A Vector Error Correction Model for <span class="math inline">\(TB10YS_t\)</span> and <span class="math inline">\(TB3MS\)</span><a href="#a-vector-error-correction-model-for-tb10ys_t-and-tb3ms" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>If two <span class="math inline">\(I(1)\)</span> time series <span class="math inline">\(X_t\)</span> and <span class="math inline">\(Y_t\)</span> are cointegrated, their differences are stationary and can be modeled in a VAR which is augmented by the regressor <span class="math inline">\(Y_{t-1} - \theta X_{t-1}\)</span>. This is called a <em>vector error correction model</em> (VECM) and <span class="math inline">\(Y_{t} - \theta X_{t}\)</span> is called the <em>error correction term</em>. Lagged values of the error correction term are useful for predicting <span class="math inline">\(\Delta X_t\)</span> and/or <span class="math inline">\(\Delta Y_t\)</span>.</p>
<p>A VECM can be used to model the two interest rates considered in the previous sections. Following the book we specify the VECM to include two lags of both series as regressors and choose <span class="math inline">\(\theta = 1\)</span>, as theory suggests (see above).</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true" tabindex="-1"></a>TB10YS <span class="ot">&lt;-</span> <span class="fu">window</span>(TB10YS, <span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2012</span> ,<span class="dv">4</span>))</span>
<span id="cb462-2"><a href="#cb462-2" aria-hidden="true" tabindex="-1"></a>TB3MS <span class="ot">&lt;-</span> <span class="fu">window</span>(TB3MS, <span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>))</span>
<span id="cb462-3"><a href="#cb462-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb462-4"><a href="#cb462-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set up error correction term</span></span>
<span id="cb462-5"><a href="#cb462-5" aria-hidden="true" tabindex="-1"></a>VECM_ECT <span class="ot">&lt;-</span> TB10YS <span class="sc">-</span> TB3MS</span>
<span id="cb462-6"><a href="#cb462-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb462-7"><a href="#cb462-7" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate both equations of the VECM using &#39;dynlm()&#39;</span></span>
<span id="cb462-8"><a href="#cb462-8" aria-hidden="true" tabindex="-1"></a>VECM_EQ1 <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(<span class="fu">d</span>(TB10YS) <span class="sc">~</span> <span class="fu">L</span>(<span class="fu">d</span>(TB3MS), <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">L</span>(<span class="fu">d</span>(TB10YS), <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">L</span>(VECM_ECT))</span>
<span id="cb462-9"><a href="#cb462-9" aria-hidden="true" tabindex="-1"></a>VECM_EQ2 <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(<span class="fu">d</span>(TB3MS) <span class="sc">~</span> <span class="fu">L</span>(<span class="fu">d</span>(TB3MS), <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">L</span>(<span class="fu">d</span>(TB10YS), <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">L</span>(VECM_ECT))</span>
<span id="cb462-10"><a href="#cb462-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb462-11"><a href="#cb462-11" aria-hidden="true" tabindex="-1"></a><span class="co"># rename regressors for better readability</span></span>
<span id="cb462-12"><a href="#cb462-12" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(VECM_EQ1<span class="sc">$</span>coefficients) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;D_TB3MS_l1&quot;</span>, <span class="st">&quot;D_TB3MS_l2&quot;</span>,</span>
<span id="cb462-13"><a href="#cb462-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;D_TB10YS_l1&quot;</span>, <span class="st">&quot;D_TB10YS_l2&quot;</span>, <span class="st">&quot;ect_l1&quot;</span>)</span>
<span id="cb462-14"><a href="#cb462-14" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(VECM_EQ2<span class="sc">$</span>coefficients) <span class="ot">&lt;-</span> <span class="fu">names</span>(VECM_EQ1<span class="sc">$</span>coefficients)</span>
<span id="cb462-15"><a href="#cb462-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb462-16"><a href="#cb462-16" aria-hidden="true" tabindex="-1"></a><span class="co"># coefficient summaries using HAC standard errors</span></span>
<span id="cb462-17"><a href="#cb462-17" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(VECM_EQ1, <span class="at">vcov. =</span> <span class="fu">NeweyWest</span>(VECM_EQ1, <span class="at">prewhite =</span> F, <span class="at">adjust =</span> T))</span>
<span id="cb462-18"><a href="#cb462-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb462-19"><a href="#cb462-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb462-20"><a href="#cb462-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb462-21"><a href="#cb462-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span id="cb462-22"><a href="#cb462-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Intercept    0.1227089  0.0551419  2.2253 0.027205 * </span></span>
<span id="cb462-23"><a href="#cb462-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; D_TB3MS_l1  -0.0016601  0.0727060 -0.0228 0.981807   </span></span>
<span id="cb462-24"><a href="#cb462-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; D_TB3MS_l2  -0.0680845  0.0435059 -1.5649 0.119216   </span></span>
<span id="cb462-25"><a href="#cb462-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; D_TB10YS_l1  0.2264878  0.0957071  2.3665 0.018939 * </span></span>
<span id="cb462-26"><a href="#cb462-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; D_TB10YS_l2 -0.0734486  0.0703476 -1.0441 0.297740   </span></span>
<span id="cb462-27"><a href="#cb462-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ect_l1      -0.0878871  0.0285644 -3.0768 0.002393 **</span></span>
<span id="cb462-28"><a href="#cb462-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb462-29"><a href="#cb462-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb462-30"><a href="#cb462-30" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(VECM_EQ2, <span class="at">vcov. =</span> <span class="fu">NeweyWest</span>(VECM_EQ2, <span class="at">prewhite =</span> F, <span class="at">adjust =</span> T))</span>
<span id="cb462-31"><a href="#cb462-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb462-32"><a href="#cb462-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb462-33"><a href="#cb462-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb462-34"><a href="#cb462-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span id="cb462-35"><a href="#cb462-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Intercept   -0.060746   0.107937 -0.5628  0.57422  </span></span>
<span id="cb462-36"><a href="#cb462-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; D_TB3MS_l1   0.240003   0.111611  2.1504  0.03276 *</span></span>
<span id="cb462-37"><a href="#cb462-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; D_TB3MS_l2  -0.155883   0.153845 -1.0132  0.31220  </span></span>
<span id="cb462-38"><a href="#cb462-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; D_TB10YS_l1  0.113740   0.125571  0.9058  0.36617  </span></span>
<span id="cb462-39"><a href="#cb462-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; D_TB10YS_l2 -0.147519   0.112630 -1.3098  0.19182  </span></span>
<span id="cb462-40"><a href="#cb462-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ect_l1       0.031506   0.050519  0.6236  0.53359  </span></span>
<span id="cb462-41"><a href="#cb462-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb462-42"><a href="#cb462-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Thus the two estimated equations of the VECM are
<span class="math display">\[\begin{align*}
\widehat{\Delta TB3MS}_t =&amp; \, -\underset{(0.11)}{0.06} + \underset{(0.11)}{0.24} \Delta TB3MS_{t-1} -\underset{(0.15)}{0.16} \Delta TB3MS_{t-2} \\ &amp;+ \underset{(0.13)}{0.11} \Delta TB10YS_{t-1} -\underset{(0.11)}{0.15} \Delta TB10YS_{t-2} + \underset{(0.05)}{0.03} ECT_{t-1} \\
\widehat{\Delta TB10YS}_t =&amp; \, \underset{(0.06)}{0.12} -\underset{(0.07)}{0.00} \Delta TB3MS_{t-1} -\underset{(0.04)}{0.07} \Delta TB3MS_{t-2} \\ &amp;+ \underset{(0.10)}{0.23} \Delta TB10YS_{t-1} -\underset{(0.07)}{0.07} \Delta TB10YS_{t-2} -\underset{(0.03)}{0.09} ECT_{t-1}.
\end{align*}\]</span></p>
<p>The output produced by <tt>coeftest()</tt> shows that there is little evidence that lagged values of the differenced interest series are useful for prediction. This finding is more pronounced for the equation of the differenced series of the 3-month treasury bill rate, where the error correction term (the lagged term spread) is not significantly different from zero at any common level of significance. However, for the differenced 10-years treasury bonds rate the error correction term is statistically significant at <span class="math inline">\(1\%\)</span> with an estimate of <span class="math inline">\(-0.09\)</span>. This can be interpreted as follows: although both interest rates are nonstationary, their conintegrating relationship allows to predict the <em>change</em> in the 10-years treasury bonds rate using the VECM. In particular, the negative estimate of the coefficient on the error correction term indicates that there will be a negative change in the next period’s 10-years treasury bonds rate when the 10-years treasury bonds rate is unusually high relative to the 3-month treasury bill rate in the current period.</p>
</div>
</div>
</div>
<div id="volatility-clustering-and-autoregressive-conditional-heteroskedasticity" class="section level2 hasAnchor" number="16.4">
<h2 class="hasAnchor"><span class="header-section-number">16.4</span> Volatility Clustering and Autoregressive Conditional Heteroskedasticity<a href="#volatility-clustering-and-autoregressive-conditional-heteroskedasticity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Financial time series often exhibit a behavior that is known as <em>volatility clustering</em>: the volatility changes over time and its degree shows a tendency to persist, i.e., there are periods of low volatility and periods where volatility is high. Econometricians call this <em>autoregressive conditional heteroskedasticity</em>. Conditional heteroskedasticity is an interesting property because it can be exploited for forecasting the variance of future periods.</p>
<p>As an example, we consider daily changes in the Whilshire 5000 stock index. The data is available for download at the <a href="https://fred.stlouisfed.org/series/WILL5000INDFC">Federal Reserve Economic Data Base</a>. For consistency with the book we download data from 1989-29-12 to 2013-12-31 (choosing this somewhat larger time span is necessary since later on we will be working with daily changes of the series).</p>
<p>The following code chunk shows how to format the data and how to reproduce Figure 16.3 of the book.</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import data on the Wilshire 5000 index</span></span>
<span id="cb463-2"><a href="#cb463-2" aria-hidden="true" tabindex="-1"></a>W5000 <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">&quot;data/Wilshire5000.csv&quot;</span>, </span>
<span id="cb463-3"><a href="#cb463-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stringsAsFactors =</span> F, </span>
<span id="cb463-4"><a href="#cb463-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">header =</span> T, </span>
<span id="cb463-5"><a href="#cb463-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>, </span>
<span id="cb463-6"><a href="#cb463-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">na.strings =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb463-7"><a href="#cb463-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb463-8"><a href="#cb463-8" aria-hidden="true" tabindex="-1"></a><span class="co"># transform the columns</span></span>
<span id="cb463-9"><a href="#cb463-9" aria-hidden="true" tabindex="-1"></a>W5000<span class="sc">$</span>DATE <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(W5000<span class="sc">$</span>DATE)</span>
<span id="cb463-10"><a href="#cb463-10" aria-hidden="true" tabindex="-1"></a>W5000<span class="sc">$</span>WILL5000INDFC <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(W5000<span class="sc">$</span>WILL5000INDFC)</span>
<span id="cb463-11"><a href="#cb463-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb463-12"><a href="#cb463-12" aria-hidden="true" tabindex="-1"></a><span class="co"># remove NAs</span></span>
<span id="cb463-13"><a href="#cb463-13" aria-hidden="true" tabindex="-1"></a>W5000 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(W5000)</span>
<span id="cb463-14"><a href="#cb463-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb463-15"><a href="#cb463-15" aria-hidden="true" tabindex="-1"></a><span class="co"># compute daily percentage changes</span></span>
<span id="cb463-16"><a href="#cb463-16" aria-hidden="true" tabindex="-1"></a>W5000_PC <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;Date&quot;</span> <span class="ot">=</span> W5000<span class="sc">$</span>DATE, </span>
<span id="cb463-17"><a href="#cb463-17" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Value&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">Delt</span>(W5000<span class="sc">$</span>WILL5000INDFC) <span class="sc">*</span> <span class="dv">100</span>))</span>
<span id="cb463-18"><a href="#cb463-18" aria-hidden="true" tabindex="-1"></a>W5000_PC <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(W5000_PC)</span></code></pre></div>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot percentage changes</span></span>
<span id="cb464-2"><a href="#cb464-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(W5000_PC, </span>
<span id="cb464-3"><a href="#cb464-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Percent&quot;</span>, </span>
<span id="cb464-4"><a href="#cb464-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Daily Percentage Changes&quot;</span>,</span>
<span id="cb464-5"><a href="#cb464-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span>  <span class="st">&quot;l&quot;</span>, </span>
<span id="cb464-6"><a href="#cb464-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span>  <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb464-7"><a href="#cb464-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span>  <span class="fl">0.5</span>)</span>
<span id="cb464-8"><a href="#cb464-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb464-9"><a href="#cb464-9" aria-hidden="true" tabindex="-1"></a><span class="co"># add horizontal line at y = 0</span></span>
<span id="cb464-10"><a href="#cb464-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="ITER_files/figure-html/pcw5000-1.png" alt="Daily Percentage Returns in the Wilshire 5000 Index" width="80%" />
<p class="caption">
(#fig:pcw5000)Daily Percentage Returns in the Wilshire 5000 Index
</p>
</div>
<p>The series of daily percentage changes in the Wilshire index seems to randomly fluctuate around zero, meaning there is little autocorrelation. This is confirmed by a plot of the sample autocorrelation function.</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="#cb465-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot sample autocorrelation of daily percentage changes</span></span>
<span id="cb465-2"><a href="#cb465-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(W5000_PC<span class="sc">$</span>Value, <span class="at">main =</span> <span class="st">&quot;Wilshire 5000 Series&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="ITER_files/figure-html/acfw5000-1.png" alt="Autocorrelation in Daily Price Changes of W5000 Index" width="80%" />
<p class="caption">
(#fig:acfw5000)Autocorrelation in Daily Price Changes of W5000 Index
</p>
</div>
<p>In Figure @ref(fig:acfw5000) we see that autocorrelations are rather weak so that it is difficult to predict future outcomes using, e.g., an AR model.</p>
<p>However, there is visual evidence in @ref(fig:pcw5000) that the series of returns exhibits conditional heteroskedasticity since we observe volatility clustering. For some applications it is useful to measure and forecast these patterns. This can be done using models which assume that the volatility can be described by an autoregressive process.</p>
<div id="arch-and-garch-models" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">ARCH and GARCH Models<a href="#arch-and-garch-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider <span class="math display">\[Y_t = \beta_0 + \beta_1 Y_{t-1} + \gamma_1 X_{t-1} + u_t,\]</span> an ADL(<span class="math inline">\(1\)</span>,<span class="math inline">\(1\)</span>) regression model. The econometrician Robert <span class="citation">Engle (<a href="#ref-engle1982" role="doc-biblioref">1982</a>)</span> proposed to model <span class="math inline">\(\sigma^2_t = Var(u_t | u_{t-1},u_{t-2},\ldots)\)</span>, the conditional variance of the error <span class="math inline">\(u_t\)</span> given its past, by an order <span class="math inline">\(p\)</span> distributed lag model,
<span class="math display">\[\begin{align}
\sigma^2_t = \alpha_0 + \alpha_1 u_{t-1}^2 + \alpha_2 u_{t-2}^2 + \dots + \alpha_p u_{t-p}^2, (\#eq:archmodel)
\end{align}\]</span>
called the <em>autoregressive conditional heteroskedasticity</em> (ARCH) model of order <span class="math inline">\(p\)</span>, or short ARCH(<span class="math inline">\(p\)</span>).<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a> We assume <span class="math inline">\(\alpha_0&gt;0\)</span> and <span class="math inline">\(\alpha_1,\ldots,\alpha_p\geq0\)</span> to ensure a positive variance <span class="math inline">\(\sigma_t^2&gt;0\)</span>. The general idea is apparent from the model structure: positive coefficients <span class="math inline">\(\alpha_0,\alpha_1,\dots,\alpha_p\)</span> imply that recent large squared errors lead to a large variance, and thus large squared errors, in the current period.</p>
<p>The generalized ARCH (GARCH) model, developed by Tim <span class="citation">Bollerslev (<a href="#ref-bollerslev1986" role="doc-biblioref">1986</a>)</span>, is an extension of the ARCH model, where <span class="math inline">\(\sigma^2_t\)</span> is allowed to depend on its own lags and lags of the squared error term. The GARCH(<span class="math inline">\(p\)</span>,<span class="math inline">\(q\)</span>) model is given by
<span class="math display">\[\begin{align}
\sigma^2_t = \alpha_0 + \alpha_1 u_{t-1}^2 + \alpha_2 u_{t-2}^2 + \dots + \alpha_p u_{t-p}^2 + \phi_1 \sigma^2_{t-1} + \dots + \phi_p \sigma^2_{t-q}. (\#eq:garchmodel)
\end{align}\]</span>
The GARCH model is an ADL(<span class="math inline">\(p\)</span>,<span class="math inline">\(q\)</span>) model and thus can provide more parsimonious parameterizations than the ARCH model (see the discussion in Appendix 15.2 of the book).</p>
</div>
<div id="application-to-stock-price-volatility" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Application to Stock Price Volatility<a href="#application-to-stock-price-volatility" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Maximum likelihood estimates of ARCH and GARCH models are efficient and have normal distributions in large samples, such that the usual methods for conducting inference about the unknown parameters can be applied. The <tt>R</tt> package <tt>fGarch</tt> is a collection of functions for analyzing and modelling the heteroskedastic behavior in time series models. The following application reproduces the results presented in Chapter 16.5 of the book by means of the function <tt>garchFit()</tt>. This function is somewhat sophisticated. It allows for different specifications of the optimization procedure, different error distributions and much more (use <code>?GarchFit</code> for a detailed description of the arguments). In particular, the reported standard errors by <tt>garchFit()</tt> are robust.</p>
<p>The GARCH(<span class="math inline">\(1\)</span>,<span class="math inline">\(1\)</span>) model of daily changes in the Wilshire 5000 index we estimate is given by
<span class="math display">\[\begin{align}
  R_t =&amp; \, \beta_0 + u_t \ , \ u_t \sim \mathcal{N}(0,\sigma^2_t), \\
  \sigma^2_t =&amp; \, \alpha_0 + \alpha_1 u_{t-1}^2 + \phi_1 \sigma_{t-1}^2 (\#eq:w5000g11)
\end{align}\]</span>
where <span class="math inline">\(R_t\)</span> is the percentage change in period <span class="math inline">\(t\)</span>. <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\alpha_0\)</span>, <span class="math inline">\(\alpha_1\)</span> and <span class="math inline">\(\phi_1\)</span> are unknown coefficients and <span class="math inline">\(u_t\)</span> is an error term with conditional mean zero. We do not include any lagged predictors in the equation of <span class="math inline">\(R_t\)</span> because the daily changes in the Wilshire 5000 index reflect daily stock returns which are essentially unpredictable. Note that <span class="math inline">\(u_t\)</span> is assumed to be normally distributed and the variance <span class="math inline">\(\sigma^2_t\)</span> depends on <span class="math inline">\(t\)</span> as it follows the GARCH(<span class="math inline">\(1\)</span>,<span class="math inline">\(1\)</span>) recursion @ref(eq:w5000g11).</p>
<p>It is straightforward to estimate this model using <tt>garchFit()</tt>.</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="#cb466-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate GARCH(1,1) model of daily percentage changes</span></span>
<span id="cb466-2"><a href="#cb466-2" aria-hidden="true" tabindex="-1"></a>GARCH_Wilshire <span class="ot">&lt;-</span> <span class="fu">garchFit</span>(<span class="at">data =</span> W5000_PC<span class="sc">$</span>Value, <span class="at">trace =</span> F)</span></code></pre></div>
<p>We obtain
<span class="math display">\[\begin{align}
  \widehat{R}_t =&amp; \, \underset{(0.010)}{0.068}, (\#eq:w5000g11est1) \\
  \widehat{\sigma}^2_t =&amp; \, \underset{(0.002)}{0.011} + \underset{(0.007)}{0.081} u_{t-1}^2 + \underset{(0.008)}{0.909} \sigma_{t-1}^2, (\#eq:w5000g11est2)
\end{align}\]</span>
so the coefficients on <span class="math inline">\(u_{t-1}^2\)</span> and <span class="math inline">\(\sigma^2_{t-1}\)</span> are statistically significant at any common level of significance. One can show that the persistence of movements in <span class="math inline">\(\sigma^2_t\)</span> is determined by the sum of both coefficients, which is <span class="math inline">\(0.99\)</span> here. This indicates that movements in the conditional variance are highly persistent, implying long-lasting periods of high volatility which is consistent with the visual evidence for volatility clustering presented above.</p>
<p>The estimated conditional variance <span class="math inline">\(\widehat{\sigma}^2_t\)</span> can be computed by plugging the residuals from @ref(eq:w5000g11est1) into equation @ref(eq:w5000g11est2). This is performed automatically by <tt>garchFit()</tt>, so to obtain the estimated conditional standard deviations <span class="math inline">\(\widehat{\sigma}_t\)</span> we only have to read out the values from <tt>GARCH_Wilshire</tt> by appending <tt>@sigma.t</tt>.</p>
<p>Using the <span class="math inline">\(\widehat{\sigma}_t\)</span> we plot bands of <span class="math inline">\(\pm\)</span> one conditional standard deviation along with deviations of the series of daily percentage changes in the Wilshire 5000 index from its mean. The following code chunk reproduces Figure 16.4 of the book.</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="#cb467-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute deviations of the percentage changes from their mean</span></span>
<span id="cb467-2"><a href="#cb467-2" aria-hidden="true" tabindex="-1"></a>dev_mean_W5000_PC <span class="ot">&lt;-</span> W5000_PC<span class="sc">$</span>Value <span class="sc">-</span> GARCH_Wilshire<span class="sc">@</span>fit<span class="sc">$</span>coef[<span class="dv">1</span>]</span>
<span id="cb467-3"><a href="#cb467-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-4"><a href="#cb467-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot deviation of percentage changes from mean</span></span>
<span id="cb467-5"><a href="#cb467-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(W5000_PC<span class="sc">$</span>Date, dev_mean_W5000_PC, </span>
<span id="cb467-6"><a href="#cb467-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb467-7"><a href="#cb467-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb467-8"><a href="#cb467-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Percent&quot;</span>, </span>
<span id="cb467-9"><a href="#cb467-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb467-10"><a href="#cb467-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Estimated Bands of +- One Conditional Standard Deviation&quot;</span>,</span>
<span id="cb467-11"><a href="#cb467-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="fl">0.2</span>)</span>
<span id="cb467-12"><a href="#cb467-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-13"><a href="#cb467-13" aria-hidden="true" tabindex="-1"></a><span class="co"># add horizontal line at y = 0</span></span>
<span id="cb467-14"><a href="#cb467-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb467-15"><a href="#cb467-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-16"><a href="#cb467-16" aria-hidden="true" tabindex="-1"></a><span class="co"># add GARCH(1,1) confidence bands (one standard deviation) to the plot</span></span>
<span id="cb467-17"><a href="#cb467-17" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(W5000_PC<span class="sc">$</span>Date, </span>
<span id="cb467-18"><a href="#cb467-18" aria-hidden="true" tabindex="-1"></a>      GARCH_Wilshire<span class="sc">@</span>fit<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> GARCH_Wilshire<span class="sc">@</span>sigma.t, </span>
<span id="cb467-19"><a href="#cb467-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>, </span>
<span id="cb467-20"><a href="#cb467-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="fl">0.5</span>)</span>
<span id="cb467-21"><a href="#cb467-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-22"><a href="#cb467-22" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(W5000_PC<span class="sc">$</span>Date, </span>
<span id="cb467-23"><a href="#cb467-23" aria-hidden="true" tabindex="-1"></a>      GARCH_Wilshire<span class="sc">@</span>fit<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">-</span> GARCH_Wilshire<span class="sc">@</span>sigma.t, </span>
<span id="cb467-24"><a href="#cb467-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>, </span>
<span id="cb467-25"><a href="#cb467-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-739-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The bands of the estimated conditional standard deviations track the observed heteroskedasticity in the series of daily changes of the Wilshire 5000 index quite well. This is useful for quantifying the time-varying volatility and the resulting risk for investors holding stocks summarized by the index. Furthermore, this GARCH model may also be used to produce forecast intervals whose widths depend on the volatility of the most recent periods.</p>
</div>
<div id="summary-8" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Summary<a href="#summary-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>We have discussed how vector autoregressions are conveniently estimated and used for forecasting in <tt>R</tt> by means of functions from the <tt>vars</tt> package.</p></li>
<li><p>The package <tt>urca</tt> supplies advanced methods for unit root and cointegration analysis like the DF-GLS and the EG-ADF tests. In an application we have found evidence that 3-months and 10-year interest rates have a common stochastic trend (that is, they are cointegrated) and thus can be modeled using a vector error correction model.</p></li>
<li><p>Furthermore, we have introduced the concept of volatility clustering and demonstrated how the function <tt>garchFit()</tt> from the package <tt>fGarch</tt> can be employed to estimate a GARCH(<span class="math inline">\(1\)</span>,<span class="math inline">\(1\)</span>) model of the conditional heteroskedasticity inherent to returns of the Wilshire 5000 stock index.</p></li>
</ul>
<!--chapter:end:16-ch16.Rmd-->
</div>
</div>
</div>
<div id="references" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">References<a href="#references" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:references.Rmd-->
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-R-rmarkdown" class="csl-entry">
Allaire, JJ, Yihui Xie, Christophe Dervieux, Jonathan McPherson, Javier Luraschi, Kevin Ushey, Aron Atkins, et al. 2023. <em><span class="nocase">rmarkdown: Dynamic Documents for R</span></em> (version 2.21). <a href="https://CRAN.R-project.org/package=rmarkdown">https://CRAN.R-project.org/package=rmarkdown</a>.
</div>
<div id="ref-bollerslev1986" class="csl-entry">
Bollerslev, Tim. 1986. <span>“<span>Generalized Autoregressive Conditional Heteroskedasticity</span>.”</span> <em>Journal of Econometrics</em> 31 (3): 307–27.
</div>
<div id="ref-card1993" class="csl-entry">
Card, D. 1993. <span>“Using Geographic Variation in College Proximity to Estimate the Return to Schooling.”</span> National Bureau of Economic Research.
</div>
<div id="ref-card1994" class="csl-entry">
Card, D., and Alan B. Krueger. 1994. <span>“<span>M</span>inimum <span>W</span>ages and <span>E</span>mployment: <span>A</span> <span>C</span>ase <span>S</span>tudy of the <span>F</span>ast-<span>F</span>ood <span>I</span>ndustry in <span>N</span>ew <span>J</span>ersey and <span>P</span>ennsylvania.”</span> <em>The American Economic Review</em> 84 (4): 772–93.
</div>
<div id="ref-chow1960" class="csl-entry">
Chow, Gregory C. 1960. <span>“<span>T</span>ests of <span>E</span>quality <span>B</span>etween <span>S</span>ets of <span>C</span>oefficients in <span>T</span>wo <span>L</span>inear <span>R</span>egressions.”</span> <em><span>E</span>conometrica</em> 28 (3): 591–605.
</div>
<div id="ref-cochrane1949" class="csl-entry">
Cochrane, D., and G. H Orcutt. 1949. <span>“<span>A</span>pplication of <span>L</span>east <span>S</span>quares <span>R</span>egression to <span>R</span>elationships <span>C</span>ontaining <span>A</span>uto-<span>C</span>orrelated <span>E</span>rror <span>T</span>erms.”</span> <em><span>J</span>ournal of the <span>A</span>merican <span>S</span>tatistical <span>A</span>ssociation</em> 44 (245): 32–61. <a href="https://doi.org/10.1080/01621459.1949.10483290">https://doi.org/10.1080/01621459.1949.10483290</a>.
</div>
<div id="ref-R-plm" class="csl-entry">
Croissant, Yves, Giovanni Millo, and Kevin Tappe. 2022. <em><span class="nocase">plm: Linear Models for Panel Data</span></em> (version 2.6-2). <a href="https://CRAN.R-project.org/package=plm">https://CRAN.R-project.org/package=plm</a>.
</div>
<div id="ref-dickey1979" class="csl-entry">
Dickey, David A., and Wayne A. Fuller. 1979. <span>“<span>D</span>istribution of the <span>E</span>stimators for <span>A</span>utoregressive <span>T</span>ime <span>S</span>eries with a <span>U</span>nit <span>R</span>oot.”</span> <em><span>J</span>ournal of the <span>A</span>merican <span>S</span>tatistical <span>A</span>ssociation</em> 74 (366): pp. 427–431.
</div>
<div id="ref-elliott1996" class="csl-entry">
Elliott, Graham, Thomas J Rothenberg, and James H Stock. 1996. <span>“<span class="nocase">Efficient Tests for an Autoregressive Unit Root</span>.”</span> <em>Econometrica</em> 64 (4): 813–36.
</div>
<div id="ref-engle1982" class="csl-entry">
Engle, Robert. 1982. <span>“Autoregressive Conditional Heteroscedasticity with Estimates of the Variance of United Kingdom Inflation.”</span> <em>Econometrica</em> 50 (4): 987–1007.
</div>
<div id="ref-engle1987" class="csl-entry">
Engle, Robert, and Clive Granger. 1987. <span>“<span class="nocase">Co-integration and Error Correction: Representation, Estimation and Testing</span>.”</span> <em>Econometrica</em> 55 (2): 251–76.
</div>
<div id="ref-R-mvtnorm" class="csl-entry">
Genz, Alan, Frank Bretz, Tetsuhisa Miwa, Xuefei Mi, and Torsten Hothorn. 2021. <em><span class="nocase">mvtnorm: Multivariate Normal and t Distributions</span></em> (version 1.1-3). <a href="http://mvtnorm.R-forge.R-project.org">http://mvtnorm.R-forge.R-project.org</a>.
</div>
<div id="ref-granger1969" class="csl-entry">
Granger, C. W. J. 1969. <span>“<span>I</span>nvestigating <span>C</span>ausal <span>R</span>elations by <span>E</span>conometric <span>M</span>odels and <span>C</span>ross-<span>S</span>pectral <span>M</span>ethods.”</span> <em><span>E</span>conometrica</em> 37: 424–38.
</div>
<div id="ref-heiss2016" class="csl-entry">
Heiss, Florian. 2016. <em><span>U</span>sing <span>R</span> for <span>I</span>ntroductory <span>E</span>conometrics</em>. <span>C</span>reateSpace <span>I</span>ndependent <span>P</span>ublishing <span>P</span>latform. <a href="http://www.urfie.net/">http://www.urfie.net/</a>.
</div>
<div id="ref-R-stargazer" class="csl-entry">
Hlavac, Marek. 2022. <em><span class="nocase">stargazer: Well-Formatted Regression and Summary Statistics Tables</span></em> (version 5.2.3). <a href="https://CRAN.R-project.org/package=stargazer">https://CRAN.R-project.org/package=stargazer</a>.
</div>
<div id="ref-R-forecast" class="csl-entry">
Hyndman, Rob, George Athanasopoulos, Christoph Bergmeir, Gabriel Caceres, Leanne Chhay, Kirill Kuroptev, Mitchell O’Hara-Wild, et al. 2023. <em><span class="nocase">forecast: Forecasting Functions for Time Series and Linear Models</span></em> (version 8.21). <a href="https://CRAN.R-project.org/package=forecast">https://CRAN.R-project.org/package=forecast</a>.
</div>
<div id="ref-R-AER" class="csl-entry">
Kleiber, Christian, and Achim Zeileis. 2022. <em><span class="nocase">AER: Applied Econometrics with R</span></em> (version 1.2-10). <a href="https://CRAN.R-project.org/package=AER">https://CRAN.R-project.org/package=AER</a>.
</div>
<div id="ref-kleiber2008" class="csl-entry">
Kleiber, C., and A. Zeileis. 2008. <em><span>A</span>pplied <span>E</span>conometrics with <span>R</span></em>. <span>S</span>pringer.
</div>
<div id="ref-mackinnon1985" class="csl-entry">
MacKinnon, James G, and Halbert White. 1985. <span>“<span class="nocase">Some heteroskedasticity-consistent covariance matrix estimators with improved finite sample properties</span>.”</span> <em>Journal of Econometrics</em> 29 (3): 305–25.
</div>
<div id="ref-newey1987" class="csl-entry">
Newey, Whitney K., and Kenneth D. West. 1987. <span>“<span>A</span> <span>S</span>imple, <span>P</span>ositive <span>S</span>emi-Definite, <span>H</span>eteroskedasticity and <span>A</span>utocorrelation <span>C</span>onsistent <span>C</span>ovariance <span>M</span>atrix.”</span> <em><span>E</span>conometrica</em> 55: 703–8.
</div>
<div id="ref-R-urca" class="csl-entry">
Pfaff, Bernhard. 2022. <em><span class="nocase">urca: Unit Root and Cointegration Tests for Time Series Data</span></em> (version 1.3-3). <a href="https://CRAN.R-project.org/package=urca">https://CRAN.R-project.org/package=urca</a>.
</div>
<div id="ref-R-vars" class="csl-entry">
———. 2023. <em><span class="nocase">vars: VAR Modelling</span></em> (version 1.5-9). <a href="https://www.pfaffikus.de">https://www.pfaffikus.de</a>.
</div>
<div id="ref-R-nlme" class="csl-entry">
Pinheiro, José, Douglas Bates, and R Core Team. 2023. <em><span class="nocase">nlme: Linear and Nonlinear Mixed Effects Models</span></em> (version 3.1-162). <a href="https://svn.r-project.org/R-packages/trunk/nlme/">https://svn.r-project.org/R-packages/trunk/nlme/</a>.
</div>
<div id="ref-quandt1960" class="csl-entry">
Quandt, Richard E. 1960. <span>“<span>T</span>ests of the <span>H</span>ypothesis <span>T</span>hat a <span>L</span>inear <span>R</span>egression <span>S</span>ystem <span>O</span>beys <span>T</span>wo <span>S</span>eparate <span>R</span>egimes.”</span> <em><span>J</span>ournal of the <span>A</span>merican <span>S</span>tatistical <span>A</span>ssociation</em> 55 (290): 324–30. <a href="https://doi.org/10.1080/01621459.1960.10482067">https://doi.org/10.1080/01621459.1960.10482067</a>.
</div>
<div id="ref-R-base" class="csl-entry">
R Core Team. 2023. <em><span class="nocase">R: A Language and Environment for Statistical Computing</span></em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-R-MASS" class="csl-entry">
Ripley, Brian. 2023. <em><span class="nocase">MASS: Support Functions and Datasets for Venables and Ripley’s MASS</span></em> (version 7.3-58.3). <a href="http://www.stats.ox.ac.uk/pub/MASS4/">http://www.stats.ox.ac.uk/pub/MASS4/</a>.
</div>
<div id="ref-R-quantmod" class="csl-entry">
Ryan, Jeffrey A., and Joshua M. Ulrich. 2022. <em><span class="nocase">quantmod: Quantitative Financial Modelling Framework</span></em> (version 0.4.20). <a href="https://CRAN.R-project.org/package=quantmod">https://CRAN.R-project.org/package=quantmod</a>.
</div>
<div id="ref-R-orcutt" class="csl-entry">
Spada, Stefano. 2018. <em><span class="nocase">orcutt: Estimate Procedure in Case of First Order Autocorrelation</span></em> (version 2.3). <a href="https://CRAN.R-project.org/package=orcutt">https://CRAN.R-project.org/package=orcutt</a>.
</div>
<div id="ref-R-rddtools" class="csl-entry">
Stigler, Matthieu, and Bastiaan Quast. 2022. <em><span class="nocase">rddtools: Toolbox for Regression Discontinuity Design (RDD)</span></em> (version 1.6.0). <a href="https://qua.st/rddtools/">https://qua.st/rddtools/</a>.
</div>
<div id="ref-stock2015" class="csl-entry">
Stock, J. H., and M. W. Watson. 2015. <em><span>I</span>ntroduction to <span>E</span>conometrics, <span>T</span>hird <span>U</span>pdate, <span>G</span>lobal <span>E</span>dition</em>. <span>P</span>earson <span>E</span>ducation <span>L</span>imited.
</div>
<div id="ref-venables2010" class="csl-entry">
Venables, W. N., and D. M. Smith. 2010. <em><span>A</span>n <span>I</span>ntroduction to <span>R</span></em>. <a href="https://cran.r-project.org/doc/manuals/r-release/R-intro.pdf">https://cran.r-project.org/doc/manuals/r-release/R-intro.pdf</a>.
</div>
<div id="ref-white1980" class="csl-entry">
White, Halbert. 1980. <span>“<span>A</span> <span>H</span>eteroskedasticity-<span>C</span>onsistent <span>C</span>ovariance <span>M</span>atrix <span>E</span>stimator and a <span>D</span>irect <span>T</span>est for <span>H</span>eteroskedasticity.”</span> <em><span>E</span>conometrica</em> 48 (4): pp. 817–838.
</div>
<div id="ref-R-readxl" class="csl-entry">
Wickham, Hadley, and Jennifer Bryan. 2023. <em><span class="nocase">readxl: Read Excel Files</span></em> (version 1.4.2). <a href="https://CRAN.R-project.org/package=readxl">https://CRAN.R-project.org/package=readxl</a>.
</div>
<div id="ref-R-dplyr" class="csl-entry">
Wickham, Hadley, Romain François, Lionel Henry, Kirill Müller, and Davis Vaughan. 2023. <em><span class="nocase">dplyr: A Grammar of Data Manipulation</span></em> (version 1.1.1). <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a>.
</div>
<div id="ref-R-scales" class="csl-entry">
Wickham, Hadley, and Dana Seidel. 2022. <em><span class="nocase">scales: Scale Functions for Visualization</span></em> (version 1.2.1). <a href="https://CRAN.R-project.org/package=scales">https://CRAN.R-project.org/package=scales</a>.
</div>
<div id="ref-R-tidyr" class="csl-entry">
Wickham, Hadley, Davis Vaughan, and Maximilian Girlich. 2023. <em><span class="nocase">tidyr: Tidy Messy Data</span></em> (version 1.3.0). <a href="https://CRAN.R-project.org/package=tidyr">https://CRAN.R-project.org/package=tidyr</a>.
</div>
<div id="ref-wooldridge2016" class="csl-entry">
Wooldridge, Jeffrey. 2016. <em><span>I</span>ntroductory <span>E</span>conometrics</em>. Sixth. <span>C</span>engage <span>L</span>earning.
</div>
<div id="ref-R-fGarch" class="csl-entry">
Wuertz, Diethelm, Yohan Chalabi, Tobias Setz, and Martin Maechler. 2022. <em><span class="nocase">fGarch: Rmetrics - Autoregressive Conditional Heteroskedastic Modelling</span></em> (version 4022.89). <a href="https://www.rmetrics.org">https://www.rmetrics.org</a>.
</div>
<div id="ref-R-bookdown" class="csl-entry">
Xie, Yihui. 2023a. <em><span class="nocase">bookdown: Authoring Books and Technical Documents with R Markdown</span></em> (version 0.33). <a href="https://CRAN.R-project.org/package=bookdown">https://CRAN.R-project.org/package=bookdown</a>.
</div>
<div id="ref-R-knitr" class="csl-entry">
———. 2023b. <em><span class="nocase">knitr: A General-Purpose Package for Dynamic Report Generation in R</span></em> (version 1.42). <a href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>.
</div>
<div id="ref-R-dynlm" class="csl-entry">
Zeileis, Achim. 2019. <em><span class="nocase">dynlm: Dynamic Linear Regression</span></em> (version 0.3-6). <a href="https://CRAN.R-project.org/package=dynlm">https://CRAN.R-project.org/package=dynlm</a>.
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p><span class="citation">Heiss (<a href="#ref-heiss2016" role="doc-biblioref">2016</a>)</span> builds on the popular <em>Introductory Econometrics</em> <span class="citation">(<a href="#ref-wooldridge2016" role="doc-biblioref">Wooldridge 2016</a>)</span> and demonstrates how to replicate the applications discussed therein using <tt>R</tt>.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>The <tt>R</tt> session is initialized by clicking into the widget. This might take a few seconds. Just wait for the indicator next to the button <em>Run</em> to turn green.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p><em>Hint:</em> <tt>T</tt> and <tt>F</tt> are alternatives for <tt>TRUE</tt> and <tt>FALSE</tt>.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>See Chapter @ref(ittsraf) for more on autoregressive processes and time series analysis in general.<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>See Chapter 4.4 of the book.<a href="#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>The package <tt>sandwich</tt> is a dependency of the package <tt>AER</tt>, meaning that it is attached automatically if you load <tt>AER</tt>.<a href="#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p>Appending <tt>HiEL * HiSTR</tt> to the formula will add <tt>HiEL</tt>, <tt>HiSTR</tt> <em>and</em> their interaction as regressors while <tt>HiEL:HiSTR</tt> only adds the interaction term.<a href="#fnref7" class="footnote-back">↩︎</a></p></li>
<li id="fn8"><p>This is in contrast to the case of a numeric dependent variable where we use the squared errors for assessment of the quality of the prediction.<a href="#fnref8" class="footnote-back">↩︎</a></p></li>
<li id="fn9"><p>See Chapter 13.4 of the book for some example studies that are based on quasi-experiments.<a href="#fnref9" class="footnote-back">↩︎</a></p></li>
<li id="fn10"><p>Also see the box <em>What is the Effect on Employment of the Minimum Wage?</em> in Chapter 13.4 of the book.<a href="#fnref10" class="footnote-back">↩︎</a></p></li>
<li id="fn11"><p>The <span class="math inline">\(t\)</span>-statistic of the Dickey-Fuller test is computed using homoskedasticity-only standard errors since under the null hypothesis, the usual <span class="math inline">\(t\)</span>-statistic is robust to conditional heteroskedasticity.<a href="#fnref11" class="footnote-back">↩︎</a></p></li>
<li id="fn12"><p>Note: <tt>ur.df()</tt> reports two test statistics when there is a drift in the ADF regression. The first of which (the one we are interested in here) is the <span class="math inline">\(t\)</span>-statistic for the test that the coefficient on the first lag of the series is 0. The second one is the <span class="math inline">\(t\)</span>-statistic for the hypothesis test that the drift term equals <span class="math inline">\(0\)</span>.<a href="#fnref12" class="footnote-back">↩︎</a></p></li>
<li id="fn13"><p>Although we introduce the ARCH model as a component in an ADL(<span class="math inline">\(1\)</span>,<span class="math inline">\(1\)</span>) model, it can be used for modelling the conditional zero-mean error term of any time series model.<a href="#fnref13" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
